"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="d1f4f461-3eac-5414-96a7-2689bfaf0e02")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([[1976],{151126:(e,t,s)=>{s.d(t,{F3:()=>n,WA:()=>i,e:()=>r,r:()=>a});let n="asset_panel_recents--bottomPadding--DS0JT",a="asset_panel_recents--buffer--Ti0t5",i="asset_panel_recents--resultsWrapper--BTvA3",r="asset_panel_recents--resultsWrapperList--bt7Ky"},175268:(e,t,s)=>{s.d(t,{Bm:()=>i,Gr:()=>p,HR:()=>g,K2:()=>o,Md:()=>n,NP:()=>d,OW:()=>u,QT:()=>m,QX:()=>f,Rm:()=>a,UU:()=>r,Vw:()=>h,iE:()=>l,u2:()=>_,wi:()=>c,x6:()=>x});let n="asset_panel_tile--fileName--odHbi ellipsis--ellipsis--70pHK",a="asset_panel_tile--secondary--56xTp",i="asset_panel_tile--nameWrapper--wOdDS",r="asset_panel_tile--name--dqzW2 ellipsis--ellipsis--70pHK",l="asset_panel_tile--wrapper--KXz0O asset_panel_tile--_wrapperBase---sbFt library_item_tile--_variantHover--FYwBc",o="asset_panel_tile--gridWrapper--GdfPx asset_panel_tile--wrapper--KXz0O asset_panel_tile--_wrapperBase---sbFt library_item_tile--_variantHover--FYwBc",c="asset_panel_tile--thumbWrapper--SGU3x",d="asset_panel_tile--visualAssetsGridWrapper--HFRX2 asset_panel_tile--wrapper--KXz0O asset_panel_tile--_wrapperBase---sbFt library_item_tile--_variantHover--FYwBc",u="asset_panel_tile--caret--oVg-B asset_panel_tile--_caretBase--UD-oa",x="asset_panel_tile--button--ja3D6",m="asset_panel_tile--focusableElementWrapper--1jtv-",p="asset_panel_tile--shownInFlyout--LZQ7t",h="asset_panel_tile--transparentBackground--OeUIM",g="asset_panel_tile--selectedFlyoutFocus--28Ko0",f="asset_panel_tile--tileWrapper--hmz50 asset_panel_tile--_tileWrapperBase--BVobl",_="asset_panel_tile--tileWrapperList--1SfmZ asset_panel_tile--_tileWrapperBase--BVobl"},581275:(e,t,s)=>{s.d(t,{OS:()=>i,c:()=>a,wt:()=>n});let n="asset_panel_virtualization--virtualRow--MNbBj",a="asset_panel_virtualization--virtualRowFirst--ppt4K asset_panel_virtualization--virtualRow--MNbBj",i="asset_panel_virtualization--virtualRowList--9KXW-"},99711:(e,t,s)=>{s.d(t,{$A:()=>n,kL:()=>a,to:()=>i});let n="40px",a="header_container--container--YLgui",i="header_container--withShadow--bnL1-"},648008:(e,t,s)=>{s.d(t,{D6:()=>a,kF:()=>n});let n="asset_description_lexical_editor--contentEditableReadOnly--DDs9m asset_description_lexical_editor--contentEditableBase--6dooz",a="asset_description_lexical_editor--contentEditableCollapsed--DWO7L asset_description_lexical_editor--contentEditableReadOnly--DDs9m asset_description_lexical_editor--contentEditableBase--6dooz"},436134:(e,t,s)=>{s.d(t,{A_:()=>m,C6:()=>r,ET:()=>u,G9:()=>c,I9:()=>l,Kz:()=>f,L1:()=>h,P3:()=>n,RN:()=>_,Ub:()=>p,W8:()=>i,WH:()=>a,WX:()=>g,hQ:()=>d,qd:()=>x,yl:()=>o});let n="sites_full_page_preview--fullPagePreview--elETi",a="sites_full_page_preview--previewBounds--guLL-",i="sites_full_page_preview--horizontalResizeContainer--INnx-",r="sites_full_page_preview--bottomResizeHandle--jfXtP sites_full_page_preview--resizeHandle--MUumX",l="sites_full_page_preview--leftRightResizeHandle--ug-pE sites_full_page_preview--resizeHandle--MUumX",o="sites_full_page_preview--previewHeader--4Yon6",c="sites_full_page_preview--progressBarContainer--UpXY3",d="sites_full_page_preview--contentContainer--xU6di",u="sites_full_page_preview--resizeContainer--5Skaf",x="sites_full_page_preview--headerTitle--Ea6KA",m="sites_full_page_preview--pageSelectDropdownContainer--I5Zck",p="sites_full_page_preview--leftControlGroup--i4Byz sites_full_page_preview--controlGroup--58Fzo",h="sites_full_page_preview--rightControlGroup--rPaTp sites_full_page_preview--controlGroup--58Fzo",g="sites_full_page_preview--leftControls--PggYK",f="sites_full_page_preview--centerControls--c2FfE",_="sites_full_page_preview--rightControls--sn7n-"},850465:(e,t,s)=>{s.d(t,{Kk:()=>n.Kk,nw:()=>d,G1:()=>n.G1,Om:()=>n.Om,qA:()=>n.qA,ru:()=>w,wc:()=>C,Si:()=>n.Si,yq:()=>n.yq,hM:()=>n.hM,FI:()=>n.FI,UK:()=>n.UK,aA:()=>y,fC:()=>T,pF:()=>n.pF,lK:()=>f,wS:()=>_,KP:()=>o,VB:()=>n.VB,Og:()=>c,xs:()=>n.xs});var n=s(798721),a=s(466082),i=s(445019),r=s(19047),l=s(378811);let o=(0,i.Iz)(e=>(0,i.eU)(new Map)),c=(0,i.Iz)(e=>(0,i.eU)(new Map)),d=(0,i.Iz)(e=>(0,i.eU)(new Set)),u=(0,i.Iz)(e=>(0,i.eU)(null)),x=(0,i.Iz)(e=>(0,i.eU)(new Map)),m=(0,i.Iz)(e=>(0,i.eU)(new Map)),p=(0,i.Iz)(e=>(0,i.eU)(new Set)),h=(0,i.Iz)(e=>(0,i.eU)(null)),g=(0,i.Iz)(e=>(0,i.eU)(t=>{let s=t(u(e)),n=t(c(e));return s?{isGenerating:s.isGenerating,selectedOptionId:s.selectedOptionId,hasOptions:s.options.length>0,optionStatuses:s.options.map(e=>({id:e.id,status:e.status,hasError:!!e.error})),thumbnailStates:Array.from(n.entries()).map(([e,t])=>({id:e,isGenerating:t.isGenerating,hasUrl:!!t.thumbnailUrl}))}:null})),f=(0,i.Iz)(e=>(0,i.eU)(t=>{let s=t(d(e)),n=0;return s.forEach(e=>{let s=t(g(e));s&&(n+=s.isGenerating?1:0,n+=s.optionStatuses.length,n+=s.optionStatuses.filter(e=>"completed"===e.status).length,n+=s.thumbnailStates.filter(e=>e.isGenerating).length)}),n})),_=new class{getWorkspace(e){let t=u(e);return i.zl.get(t)}updateWorkspace(e,t){let s=u(e);i.zl.set(s,t)}setWorkspace(e,t){let s=u(e);i.zl.set(s,t)}getOptionNodes(e){let t=x(e);return i.zl.get(t)}setOptionNodes(e,t){let s=x(e);i.zl.set(s,new Map(t))}setOptionNode(e,t,s){let n=x(e);i.zl.set(n,e=>{let n=new Map(e);return n.set(t,s),n})}getResultNodes(e){let t=m(e);return i.zl.get(t)}setOptionResultNode(e,t,s){let n=m(e);i.zl.set(n,e=>{let n=new Map(e);return n.set(t,s),n})}setResultNodes(e,t){let s=m(e);i.zl.set(s,new Map(t))}persistBackupManager(e,t){if(!t||!e){console.warn("[MultipleOptions] Cannot persist BackupManager state: missing backupManager or clientLifecycleId");return}let s={backupNodeId:t.backupNode?.guid,activeNodeId:t.activeNode?.guid,parentNodeId:t.parent?.guid};if(!s.backupNodeId||!s.activeNodeId||!s.parentNodeId){(0,r.x1)("MultipleOptions","Invalid BackupManager state:",{clientLifecycleId:e,state:s});return}let n=h(e);i.zl.set(n,s)}getBackupManager(e){if(!e)return console.warn("[MultipleOptions] Cannot restore BackupManager: missing clientLifecycleId"),null;try{let t=h(e),s=i.zl.get(t);if(!s)return(0,r.x1)("MultipleOptions","No BackupManager state found in atoms for clientLifecycleId:",{clientLifecycleId:e}),null;let n=(0,a.UN)(),o=n.get(s.backupNodeId),c=n.get(s.activeNodeId),d=n.get(s.parentNodeId);if(!o||!c||!d)return null;if(!l.IO)return(0,r.x1)("MultipleOptions","BackupManager not available"),null;let u=Object.create(l.IO.prototype);return u.backupNode=o,u.activeNode=c,u.parent=d,u}catch(t){return(0,r.x1)("MultipleOptions","Failed to restore BackupManager from state:",{clientLifecycleId:e,error:t instanceof Error?t.message:t}),null}}getBackupManagerState(e){let t=h(e);return i.zl.get(t)}clearBackupManagerState(e){let t=h(e);i.zl.set(t,null)}trackCreatedNode(e,t){let s=p(e);i.zl.set(s,e=>{let s=new Set(e);return s.add(t),s})}getTrackedNodes(e){let t=p(e);return i.zl.get(t)}clearTrackedNodes(e){let t=p(e);i.zl.set(t,new Set)}hasActiveWorkspace(e){return null!==this.getWorkspace(e)}cleanup(e){let t=u(e),s=x(e),n=m(e),a=h(e),r=c(e),l=p(e),d=o(e);i.zl.set(t,null),i.zl.set(s,new Map),i.zl.set(n,new Map),i.zl.set(a,null),i.zl.set(r,new Map),i.zl.set(l,new Set),i.zl.set(d,new Map)}};function y(e,t){let s=d(e);for(let e of i.zl.get(s)){let s=u(e),n=i.zl.get(s);if(n?.options.some(e=>e.id===t))return e}return null}var k=s(692376),v=s(522568),b=s(351298),j=s(322519);let C=(0,i.Iz)(()=>(0,i.eU)((0,b.ux)())),w=(0,i.Iz)(e=>{let t=(0,i.eU)((0,b.Ok)());return(0,i.eU)(e=>e(t),(s,n,a)=>{let r=E.get(e);if(r&&(clearTimeout(r),E.delete(e)),n(t,a),(0,b.Mx)(a)){let a=Date.now(),r=setTimeout(()=>{(0,b.Mx)(s(t))&&(n(t,(0,b.uW)(Error("Restore timed out after 10 seconds"))),v.az.trackDefinedEvent("ai_assistant.restore_completed",{clientLifecycleId:e,success:!1,error:"timeout",duration:1e4})),E.delete(e)},1e4);E.set(e,r),function(e,t,s){let n=!1,a=i.zl.sub(N,()=>{let r=i.zl.get(t);if(!(0,b.Mx)(r)){a();return}let l=i.zl.get(N);if(l===k.kul.UNJOINED&&(n=!0),l===k.kul.JOINED&&n){let r=E.get(e);r&&(clearTimeout(r),E.delete(e)),n=!1;let l=i.zl.get(T);if(!l){console.error("No current version ID found after restore"),i.zl.set(t,(0,b.uW)(Error("No current version ID found after restore"))),s(),a();return}i.zl.set(t,(0,b.NY)({restoreVersionId:l})),function(e){let t=i.zl.sub(S,()=>{let s=i.zl.get(e),n=i.zl.get(T);if(!(0,b.xj)(s)){t();return}s.value.restoreVersionId!==n&&(i.zl.set(e,(0,b.Ok)()),t())})}(t),s(),a()}})}(e,t,()=>{v.az.trackDefinedEvent("ai_assistant.restore_completed",{clientLifecycleId:e,success:!0,duration:Date.now()-a})})}(0,b.ok)(a)&&v.az.trackDefinedEvent("ai_assistant.restore_completed",{clientLifecycleId:e,success:!1,error:a.error.message||"unknown_error"})})}),E=new Map,N=(0,j.bt)(e=>e.mirror.appModel.multiplayerSessionState),S=(0,j.bt)(e=>e.versionHistory),T=(0,i.eU)(e=>{let t=e(S);return t.versions.length>0&&t.versions[0]?.id||null})},393700:(e,t,s)=>{s.d(t,{Lb:()=>l,ct:()=>a,hT:()=>r,lq:()=>o,ye:()=>i});var n=s(445019);let a=(0,n.eU)(!1),i=(0,n.eU)(0),r=(0,n.eU)(0),l=(0,n.eU)(!1),o=(0,n.eU)("")},431080:(e,t,s)=>{s.d(t,{A:()=>t3,i:()=>t0});var n,a=s(239976),i=s(105652),r=s(20002),l=s(291061),o=s(607696),c=s(292933),d=s(528001),u=s(834370),x=s(864967);function m(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class p extends x.g{buildRequest({messages:e,serverSideChatParams:t}){return{messages:e,serverSideChatParams:t,configurationKey:this.configurationKey,globalOptions:this.globalOptions,serverOptionDebugOverrides:this.serverOptionDebugOverrides,serverOverridesOpaqueKey:this.serverOverridesOpaqueKey}}constructor({configurationKey:e,globalOptions:t,serverOptionDebugOverrides:s,serverOverridesOpaqueKey:n,...a}){super(a),m(this,"configurationKey",void 0),m(this,"globalOptions",void 0),m(this,"serverOptionDebugOverrides",void 0),m(this,"serverOverridesOpaqueKey",void 0),this.configurationKey=e,this.globalOptions=t,this.serverOptionDebugOverrides=s,this.serverOverridesOpaqueKey=n}}var h=s(13965),g=s(471348),f=s(134670),_=s(244487),y=s(761790),k=s(524326),v=s(214742),b=s(295870),j=s(466082),C=s(379141),w=s(270450),E=s(445019),N=s(74372),S=s(593749),T=s.n(S),I=s(122026),A=s.n(I),M=s(522568),z=s(945040),L=s(844169),O=s(931974),P=s(411074),R=s(723850),D=s(493064),F=s(865702),q=s(7995),G=s(7857),U=s(129416),K=s(19047),H=s(577225),B=s(522935),V=s(347012),$=s(665477),W=s(562418),Y=s(750665),X=s(914750),Z=s(793567),J=s(809012),Q=s(772293),ee=s(1007),et=s(276571),es=s(605985),en=s(790016),ea=s(569313),ei=s(362844),er=s(279758),el=s(581121),eo=s(378811),ec=s(210709),ed=s(633373);let eu=ec.z.object({fastShouldRouteToStandardForMultiSelect:ec.z.boolean(),routeToFallbackForL1Edits:ec.z.boolean().optional(),routeToFallbackForL2Edits:ec.z.boolean().optional(),routeToFallbackForL2EditsZTO:ec.z.boolean().optional()}),ex={fastShouldRouteToStandardForMultiSelect:!0,routeToFallbackForL1Edits:!1,routeToFallbackForL2Edits:!0,routeToFallbackForL2EditsZTO:!0};var em=s(348149),ep=s(964665);async function eh(e,t,s,n){let a=eu.safeParse((await (0,em.w0)("make_edits_dynamic_routing_config")).value),i=a.success?a.data:ex,r=(0,ep.b4)(e,t),l=(0,j.UN)(),o=function(e,t,s){let n=t.makeEditsFallbackConfigurationKey,a=t.makeEditsZTOConfigurationKey,i=(s.inferredContext.enabledLibraryKeys?.length??0)>0,r=i||(s.sceneGraph?.getInternalCanvas()?.childrenNodes.some(e=>"NONE"!==e.styleType)??!1)||(s.sceneGraph?.getInternalCanvas()?.childrenNodes.some(e=>"VARIABLE"===e.type)??!1);if(a){let t=s.inferredContext.extraComponentGuids&&s.inferredContext.extraComponentGuids.length>0,r=i&&n&&e.routeToFallbackForL2EditsZTO?{targetConfigKey:n,fallbackReason:"routeToFallbackForL2EditsZTO"}:null;if(!t){if(s.inferredContext.selectedNodeIds?.length===0)return r??{targetConfigKey:a,ztoReason:"EmptySelection"};let e=s.inferredContext.selectedNodeIds?.[0];if(e){let t=s.sceneGraph.get(e);if(t){let e=t?.containingCanvas;if(!e)return r??{targetConfigKey:a,ztoReason:"EmptySelection"};if((0,ed.Pg)(t))return r??{targetConfigKey:a,ztoReason:"EmptyFrame"};let n=s.sceneGraph.get(e);if(n&&0===n.childrenGuids.length)return r??{targetConfigKey:a,ztoReason:"EmptyPage"}}}}}if(n){if(e.fastShouldRouteToStandardForMultiSelect&&s.inferredContext.selectedNodeIds&&(0,y.AR)(s.options,s.inferredContext.selectedNodeIds))return{targetConfigKey:n,fallbackReason:"fastShouldRouteToStandardForMultiSelect"};if(e.routeToFallbackForL1Edits&&s.inferredContext.selectedNodeIds.length>=1){let{componentsAndStateGroups:e,variantGuids:t}=(0,y.zA)(s.sceneGraph,s.inferredContext.selectedNodeIds.map(e=>s.sceneGraph.get(e)).filter(e=>null!==e),new Set(s.inferredContext.extraComponentGuids??[]));if(e.length>0||t.size>0)return{targetConfigKey:n,fallbackReason:"routeToFallbackForL1Edits"}}if(e.routeToFallbackForL2Edits&&r)return{targetConfigKey:n,fallbackReason:"routeToFallbackForL2Edits"}}return null}(i,t,{inferredContext:n,options:r.options,sceneGraph:l});return o?(o.fallbackReason&&(s.fallbackReason=o.fallbackReason),o.ztoReason&&(s.ztoReason=o.ztoReason),(0,ep.b4)(e,{makeEditsOpaqueConfigurationKey:o.targetConfigKey,makeEditsGlobalOptionOverrides:{}})):r}var eg=s(303219),ef=s(255812),e_=s(96955),ey=s(183290),ek=s(399488),ev=s(973407),eb=s(740414),ej=s(850465),eC=s(251799);let ew={WIDTH:256,HEIGHT:256,MAX_SCALE:10,TIMEOUT_MS:1e4,CLEAR_COLOR:"#FFFFFF",PADDING:8,TYPE:"PNG"};var eE=s(393700);function eN(){let e=[(0,C.t)("assistant.chat.status.loading"),(0,C.t)("ai_assistant.cursor.status.thinking_pondering"),(0,C.t)("ai_assistant.cursor.status.thinking_analyzing"),(0,C.t)("ai_assistant.cursor.status.thinking_considering"),(0,C.t)("ai_assistant.cursor.status.thinking_reflecting"),(0,C.t)("ai_assistant.cursor.status.thinking_contemplating"),(0,C.t)("ai_assistant.cursor.status.thinking_deliberating"),(0,C.t)("ai_assistant.cursor.status.thinking_reasoning"),(0,C.t)("ai_assistant.cursor.status.thinking_processing"),(0,C.t)("ai_assistant.cursor.status.thinking_evaluating"),(0,C.t)("ai_assistant.cursor.status.thinking_examining"),(0,C.t)("ai_assistant.cursor.status.thinking_assessing"),(0,C.t)("ai_assistant.cursor.status.thinking_reviewing"),(0,C.t)("ai_assistant.cursor.status.thinking_studying"),(0,C.t)("ai_assistant.cursor.status.thinking_investigating"),(0,C.t)("ai_assistant.cursor.status.thinking_exploring"),(0,C.t)("ai_assistant.cursor.status.thinking_calculating"),(0,C.t)("ai_assistant.cursor.status.thinking_computing"),(0,C.t)("ai_assistant.cursor.status.thinking_figuring_out"),(0,C.t)("ai_assistant.cursor.status.thinking_working_on_it"),(0,C.t)("ai_assistant.cursor.status.thinking_brainstorming"),(0,C.t)("ai_assistant.cursor.status.thinking_strategizing"),(0,C.t)("ai_assistant.cursor.status.thinking_planning"),(0,C.t)("ai_assistant.cursor.status.thinking_weighing_options"),(0,C.t)("ai_assistant.cursor.status.thinking_deep_diving"),(0,C.t)("ai_assistant.cursor.status.thinking_concentrating"),(0,C.t)("ai_assistant.cursor.status.thinking_focusing"),(0,C.t)("ai_assistant.cursor.status.thinking_speculating"),(0,C.t)("ai_assistant.cursor.status.thinking_hypothesizing"),(0,C.t)("ai_assistant.cursor.status.thinking_deducing"),(0,C.t)("ai_assistant.cursor.status.thinking_inferring"),(0,C.t)("ai_assistant.cursor.status.thinking_synthesizing"),(0,C.t)("ai_assistant.cursor.status.thinking_formulating"),(0,C.t)("ai_assistant.cursor.status.thinking_conceptualizing"),(0,C.t)("ai_assistant.cursor.status.thinking_theorizing"),(0,C.t)("ai_assistant.cursor.status.thinking_puzzling"),(0,C.t)("ai_assistant.cursor.status.thinking_deciphering"),(0,C.t)("ai_assistant.cursor.status.thinking_unpacking"),(0,C.t)("ai_assistant.cursor.status.thinking_dissecting"),(0,C.t)("ai_assistant.cursor.status.thinking_interpreting"),(0,C.t)("ai_assistant.cursor.status.thinking_understanding"),(0,C.t)("ai_assistant.cursor.status.thinking_comprehending"),(0,C.t)("ai_assistant.cursor.status.thinking_discerning")];return e[Math.floor(Math.random()*e.length)]??(0,C.t)("assistant.chat.status.loading")}function eS(e,t){let s=t.get(e);if(!s||!s.absoluteBoundingBox)return null;let n=s.absoluteBoundingBox;return{x:n.x+n.w/2,y:n.y+n.h/2}}let eT=(0,E.eU)(new class{constructor(){this.activeNodes=[],this.sceneGraphRef=null,this.cycleIntervalId=null,this.currentNodeIndex=0,this.lastTransitionTime=0}addNodes(e,t,s){if(0===e.length)return;let n=performance.now();this.sceneGraphRef=t;let a=Array.isArray(s)?s:e.map(()=>s||eN());e.forEach((e,t)=>{let s=a[t]||eN(),i=this.activeNodes.findIndex(t=>t.nodeId===e);if(-1!==i)this.activeNodes[i]={nodeId:e,message:s,addedAt:n};else{let a=this.currentNodeIndex+1+t;this.activeNodes.splice(a,0,{nodeId:e,message:s,addedAt:n})}}),this.startCyclingAt(e[0])}removeNodes(e){e.forEach(e=>{let t=this.activeNodes.find(t=>t.nodeId===e);if(!t)return;let s=performance.now()-t.addedAt;s>=5e3?this.deleteNode(e):setTimeout(()=>{this.deleteNode(e)},5e3-s)})}deleteNode(e){let t=this.activeNodes.findIndex(t=>t.nodeId===e);-1!==t&&this.activeNodes.splice(t,1),0===this.activeNodes.length&&this.onNoMoreNodes()}startCyclingAt(e){if(0!==this.activeNodes.length){if(1===this.activeNodes.length){this.restartCycleStartingWithNode(e);return}performance.now()-this.lastTransitionTime>=1e3&&this.restartCycleStartingWithNode(e)}}restartCycleStartingWithNode(e){if(0===this.activeNodes.length)return;this.lastTransitionTime=performance.now(),null!==this.cycleIntervalId&&(clearInterval(this.cycleIntervalId),this.cycleIntervalId=null);let t=this.activeNodes.findIndex(t=>t.nodeId===e);-1!==t&&(this.currentNodeIndex=t),E.zl.get(eE.ct)?this.animateToCurrentNode():(this.teleportToNode(e),E.zl.set(eE.ct,!0)),this.cycleIntervalId=setInterval(()=>{0!==this.activeNodes.length&&(this.currentNodeIndex=(this.currentNodeIndex+1)%this.activeNodes.length,this.animateToCurrentNode())},1e3)}teleportToNode(e){if(!this.sceneGraphRef||0===this.activeNodes.length||!this.sceneGraphRef.get(e))return;let t=eS(e,this.sceneGraphRef);t&&(E.zl.set(eE.Lb,!0),E.zl.set(eE.ye,t.x),E.zl.set(eE.hT,t.y))}animateToCurrentNode(){if(!this.sceneGraphRef||0===this.activeNodes.length)return;let e=this.activeNodes[this.currentNodeIndex%this.activeNodes.length];if(!e)return;let t=eS(e.nodeId,this.sceneGraphRef);t&&(E.zl.set(eE.lq,e.message),E.zl.set(eE.ye,t.x),E.zl.set(eE.hT,t.y))}onNoMoreNodes(){E.zl.set(eE.lq,eN())}stop(){null!==this.cycleIntervalId&&(clearInterval(this.cycleIntervalId),this.cycleIntervalId=null),this.activeNodes=[],this.currentNodeIndex=0,this.lastTransitionTime=0,E.zl.set(eE.ct,!1),E.zl.set(eE.Lb,!1),E.zl.set(eE.lq,"")}});var eI=s(281919),eA=s(316833),eM=s(88611),ez=s(13782),eL=s(426223);let eO=(0,i.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24L",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M17.5 16a.5.5 0 0 1 .5.5V18h1.5a.5.5 0 0 1 0 1H18v1.5a.5.5 0 0 1-1 0V19h-1.5a.5.5 0 0 1 0-1H17v-1.5a.5.5 0 0 1 .5-.5M9.366 5.122c.565-1.496 2.718-1.496 3.283 0l.051.154 1.117 3.912 3.91 1.119c1.701.486 1.701 2.898 0 3.384l-3.91 1.118L12.7 18.72c-.486 1.702-2.898 1.702-3.384 0l-1.118-3.91-3.918-1.104c-1.704-.48-1.711-2.894-.01-3.385L8.198 9.19l1.119-3.913zm2.372.429c-.21-.735-1.251-.735-1.461 0l-1.27 4.446-4.46 1.286c-.734.212-.731 1.254.005 1.461L9.008 14l1.269 4.446c.196.69 1.125.732 1.413.13l.048-.13L13.008 14l4.444-1.27c.689-.198.732-1.125.13-1.414l-.13-.047-4.444-1.272zM17.5 3a2.5 2.5 0 1 1 0 5 2.5 2.5 0 0 1 0-5m0 1a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3"})})});var eP=s(402731),eR=s(323264);let eD=new Set;function eF({onPromptSelect:e,hasSelection:t,clientLifecycleId:s}){let n=function(){let e=new Date().getHours();return e>=5&&e<12?(0,C.t)("ai_assistant.empty_state.greeting.morning"):e>=12&&e<17?(0,C.t)("ai_assistant.empty_state.greeting.afternoon"):(0,C.t)("ai_assistant.empty_state.greeting.evening")}(),r=i.useMemo(()=>[{id:"start_new",icon:eI.k,title:(0,C.t)("ai_assistant.empty_state.blank.start_new.title"),description:(0,C.t)("ai_assistant.empty_state.blank.start_new.description"),prompts:[{pillText:(0,C.t)("ai_assistant.empty_state.blank.start_new.landing_page"),promptText:(0,C.t)("ai_assistant.empty_state.blank.start_new.landing_page_prompt")},{pillText:(0,C.t)("ai_assistant.empty_state.blank.start_new.details_card"),promptText:(0,C.t)("ai_assistant.empty_state.blank.start_new.details_card_prompt")}]},{id:"explore",icon:eA.h,title:(0,C.t)("ai_assistant.empty_state.blank.explore.title"),description:(0,C.t)("ai_assistant.empty_state.blank.explore.description"),prompts:[{pillText:(0,C.t)("ai_assistant.empty_state.blank.explore.layout_options"),promptText:(0,C.t)("ai_assistant.empty_state.blank.explore.layout_options_prompt")},{pillText:(0,C.t)("ai_assistant.empty_state.blank.explore.visual_styles"),promptText:(0,C.t)("ai_assistant.empty_state.blank.explore.visual_styles_prompt")}]},{id:"learn_figma",icon:eM.V,title:(0,C.t)("ai_assistant.empty_state.blank.learn_figma.title"),description:(0,C.t)("ai_assistant.empty_state.blank.learn_figma.description"),prompts:[{pillText:(0,C.t)("ai_assistant.empty_state.blank.learn_figma.feature_demo"),promptText:(0,C.t)("ai_assistant.empty_state.blank.learn_figma.feature_demo_prompt")},{pillText:(0,C.t)("ai_assistant.empty_state.blank.learn_figma.best_practices"),promptText:(0,C.t)("ai_assistant.empty_state.blank.learn_figma.best_practices_prompt")}]}],[]),l=i.useMemo(()=>[{id:"changes",icon:ez.J,title:(0,C.t)("ai_assistant.empty_state.selected.changes.title"),description:(0,C.t)("ai_assistant.empty_state.selected.changes.description"),prompts:[{pillText:(0,C.t)("ai_assistant.empty_state.selected.changes.dark_mode"),promptText:(0,C.t)("ai_assistant.empty_state.selected.changes.dark_mode_prompt")},{pillText:(0,C.t)("ai_assistant.empty_state.selected.changes.update_content"),promptText:(0,C.t)("ai_assistant.empty_state.selected.changes.update_content_prompt")}]},{id:"build",icon:eI.k,title:(0,C.t)("ai_assistant.empty_state.selected.build.title"),description:(0,C.t)("ai_assistant.empty_state.selected.build.description"),prompts:[{pillText:(0,C.t)("ai_assistant.empty_state.selected.build.next_screen"),promptText:(0,C.t)("ai_assistant.empty_state.selected.build.next_screen_prompt")},{pillText:(0,C.t)("ai_assistant.empty_state.selected.build.empty_state"),promptText:(0,C.t)("ai_assistant.empty_state.selected.build.empty_state_prompt")}]},{id:"explore",icon:eA.h,title:(0,C.t)("ai_assistant.empty_state.selected.explore.title"),description:(0,C.t)("ai_assistant.empty_state.selected.explore.description"),prompts:[{pillText:(0,C.t)("ai_assistant.empty_state.selected.explore.layout_variations"),promptText:(0,C.t)("ai_assistant.empty_state.selected.explore.layout_variations_prompt")},{pillText:(0,C.t)("ai_assistant.empty_state.selected.explore.style_variations"),promptText:(0,C.t)("ai_assistant.empty_state.selected.explore.style_variations_prompt")}]},{id:"feedback",icon:eL.f,title:(0,C.t)("ai_assistant.empty_state.selected.feedback.title"),description:(0,C.t)("ai_assistant.empty_state.selected.feedback.description"),prompts:[{pillText:(0,C.t)("ai_assistant.empty_state.selected.feedback.design_review"),promptText:(0,C.t)("ai_assistant.empty_state.selected.feedback.design_review_prompt")},{pillText:(0,C.t)("ai_assistant.empty_state.selected.feedback.edge_cases"),promptText:(0,C.t)("ai_assistant.empty_state.selected.feedback.edge_cases_prompt")}]}],[]),o=t?l:r,[c,d]=i.useState(()=>o.length>0?o[0].id:null);i.useEffect(()=>{c&&!o.some(e=>e.id===c)&&d(o.length>0?o[0].id:null)},[c,o]);let u=e=>{d(e)},x=t=>{e(t)};return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x6s0dn4 x1iyjqo2 xi4r6k5 x9f619 xh8yej3",children:[(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x6s0dn4 xl56j7k x1i71x30 xvwx85",children:[(0,a.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k xcr9a89 x1d36bvo x1vi7shn xp6roeo x8rdmch xctkrei x1aue78i",children:(0,a.jsx)(eO,{})}),(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x6s0dn4 x2b8uid",children:[(0,a.jsx)("h2",{className:"xor4psk x1ncjjhx xaoa4km x2i041 x14terfx x1akne3o",children:n}),(0,a.jsx)("p",{className:"xuzfeq1 x8yk33q x1e00guj x18zpg43 x22v61l x1n0bwc9",children:(0,C.t)("ai_assistant.empty_state.subheading")})]})]}),(0,a.jsx)("div",{className:"x78zum5 xdt5ytf x1nfngrj xh8yej3",children:(0,a.jsx)("div",{className:"x78zum5 xdt5ytf x1yjdb4r xmkeg23 x1y0btm7 x7z60cl x1mxnbhz xb3r6kr",children:o.map((e,n)=>(0,a.jsx)(eq,{section:e,isExpanded:c===e.id,onToggle:()=>u(e.id),onPromptClick:x,isLast:n===o.length-1,clientLifecycleId:s,hasSelection:t,shownSectionsSet:eD},e.id))})})]})}function eq({section:e,isExpanded:t,onToggle:s,onPromptClick:n,isLast:r,clientLifecycleId:l,hasSelection:o,shownSectionsSet:c}){let d=e.icon,u=e.description,x=e.prompts,m=e.noLibrariesText;i.useEffect(()=>{if(t&&x&&x.length>0&&l){let t=`${l}-${e.id}-${o?"selected":"blank"}`;c.has(t)||(c.add(t),x.forEach((t,s)=>{M.az.trackDefinedEvent("ai_assistant.empty_state_prompt_shown",{clientLifecycleId:l,sectionId:e.id,hasSelection:o,shortPrompt:t.pillText,fullPrompt:t.promptText,rank:s+1,totalPromptsShown:x.length})}))}},[t,x,l,e.id,o,c]);let p=i.useCallback((t,s)=>{l&&M.az.trackDefinedEvent("ai_assistant.empty_state_prompt_chosen",{clientLifecycleId:l,sectionId:e.id,hasSelection:o,shortPrompt:t.pillText,fullPrompt:t.promptText,rank:s+1,totalPromptsShown:x?.length||0}),n(t.promptText)},[l,e.id,o,x?.length,n]);return(0,a.jsxs)("div",{...{0:{className:"x78zum5 xdt5ytf xso031l x1q0q8m5 xertd99"},1:{className:"x78zum5 xdt5ytf x1q0q8m5 xertd99 x1qhh985"}}[!!r<<0],children:[(0,a.jsxs)("button",{...{0:{className:"x78zum5 x6s0dn4 x1qughib xc7ga6q xc342km xh8yej3 xdpxx8g"},1:{className:"x78zum5 x6s0dn4 x1qughib xc7ga6q xc342km xh8yej3 xdpxx8g xp6roeo"}}[!!t<<0],onClick:s,type:"button","aria-expanded":t,children:[(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x1nfngrj",children:[(0,a.jsx)(d,{}),(0,a.jsx)("span",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x1akne3o",children:e.title})]}),(0,a.jsx)("div",{...{0:{className:"x78zum5 x6s0dn4 xl56j7k x7p49u4 x11xpdln x13dflua x9lcvmn"},1:{className:"x78zum5 x6s0dn4 xl56j7k x11xpdln x13dflua x9lcvmn x1iffjtl"}}[!!t<<0],children:(0,a.jsx)(eP.k,{})})]}),t&&u&&(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1nfngrj xexx8yu xsag5q8 xf18ygs xnuq7ks",children:[(0,a.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9 xilkfi8",children:u}),m&&(0,a.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9 xilkfi8",children:m}),x&&x.length>0&&(0,a.jsx)("div",{className:"x78zum5 x1a02dak x1nfngrj",children:x.map((e,t)=>(0,a.jsx)("button",{className:"x78zum5 x6s0dn4 xl56j7k x1gskr33 x1ihwiht x8rdmch xctkrei xmkeg23 x1y0btm7 x7z60cl x1mxnbhz xjbqb8w xv2f06h x1277o0a xts7igz xx6bhzk x9lcvmn",onClick:()=>p(e,t),type:"button",children:(0,a.jsx)("span",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:e.pillText})},t))})]})]})}var eG=s(798913);s(786001),s(748011),s(234522),s(582902);var eU=s(475300),eK=s(545242);let eH=()=>E.zl.get(J.J)||0,eB={MAX_OPTIONS:3,REQUIRED_TARGET_SELECTION:1,DEFAULT_SELECTED_OPTION_ID:"",RANDOM_TRIGGER_OPTION_COUNT:2},eV="OPTION_DELETED_DURING_RECONCILIATION";async function e$({config:e,options:t,basePrompt:s,trackingContext:n,updateOptionStatus:a,abortControllers:i=[],toolCallId:r,extraStyleIds:l,extraVariableIds:o}){let c=0,d=0,u=!1,x=[],m=t.map(async(t,m)=>{let p=i[m]||new AbortController;try{a({optionId:t.id,status:"running",toolCallId:r});let i=await (0,eo.nR)({params:{config:e,userInput:{userPrompt:s},inferredContext:{selectedNodeIds:[t.nodeId],extraStyleIds:l,extraVariableIds:o},trackingContext:n,aiTrackingContext:n,setThinkingState:()=>{}},abortController:p}),d=i.nodeId&&i.nodeId===j.UN().getInternalCanvas()?.guid,u=(0,j.UN)().get(t.nodeId);if(d&&!u)throw new v.C({name:eV,friendlyErrorMessage:"Unable to find the option node on the canvas after reconciliation.",severity:"total",cause:{},retryable:!1,fallbackToDifferentModel:!1,healable:!1});let m={...i,originalOptionNodeId:t.nodeId};return a({optionId:t.id,status:"completed",result:m,toolCallId:r}),c++,x.push(t.id),{option:t,result:m,success:!0}}catch(e){switch(p.signal.aborted&&"JSX reconciliation error detected in sibling option"===p.signal.reason?"aborted":e instanceof v.C?e.message.includes("reconcile JSX")||e.message.includes("Couldn't reconcile JSX")||e.payload.name===eV?"reconciliation":!0===e.payload.llmInduced?"llm_induced":"system":"system"){case"reconciliation":return d++,u||(u=!0,i.forEach((e,t)=>{t===m||e.signal.aborted||e.abort("JSX reconciliation error detected in sibling option")})),a({optionId:t.id,status:"failed",error:e,toolCallId:r}),{option:t,error:e,success:!1,isReconciliationError:!0};case"aborted":return d++,a({optionId:t.id,status:"failed",error:e,toolCallId:r}),{option:t,error:e,success:!1,isReconciliationError:!1};case"llm_induced":{let s=eW(e),n={originalOptionNodeId:t.nodeId,llmInducedError:!0,message:s};return a({optionId:t.id,status:"completed",result:n,toolCallId:r}),c++,x.push(t.id),{option:t,result:n,success:!0}}case"system":{let s=eW(e);return a({optionId:t.id,status:"failed",error:e,toolCallId:r}),(0,K.x1)("MultipleOptions","System error generating option",{optionId:t.id,error:s}),{option:t,error:e,success:!1,isReconciliationError:!1}}}}});await Promise.allSettled(m);let p=c===t.length,h=c>0,g=0===c,f=g&&d===t.length;return{allSucceeded:p,anySucceeded:h,allFailed:g,allFailedWithReconciliationError:f,successfulOptions:x}}function eW(e){return e instanceof v.C&&e.payload.friendlyErrorMessage||e.message}async function eY({args:e,toolCallId:t,selectedNodeIdsForLLM:s,updateOptionStatus:n,resolveInteractiveTool:a,generateThumbnail:i,fileKey:r,toolTrackingContext:l,includeExtraContext:c,abortControllers:d,trackDefinedEvent:u,aiDataSharingEnabled:x,extraVariableIds:m,extraStyleIds:p}){let h=l.clientLifecycleId,g=l.persistentEntityId;try{let f=e.selectedLayerIds??s,_=l.randomlyTriggered??!1,y=_?eB.RANDOM_TRIGGER_OPTION_COUNT:e.variants?Math.min(e.variants,eB.MAX_OPTIONS):0,k=null!=e.variants&&e.variants>1;u&&u("ai_assistant.multiple_options_triggered",{persistentEntityId:g,clientLifecycleId:h,optionCount:y,selectedNodeIds:f,assistantTriggered:k,randomizedTriggered:_,sequenceNumber:eH(),aiDataSharingEnabled:x??!1,configurationKey:e.config.configurationKey});let v=(0,j.UN)(),b=function(e,t){if(!t)return!1;let s=(0,j.UN)(),n=e[0];return!!n&&!!s.get(n)}(f,c),C=v.get(f[0]||"");if(!C)throw Error("Unable to generate design options - the selected layer was not found. It may have been deleted or moved.");let w=v.getInternalCanvas();if(!w)throw Error("Internal canvas not found");let N=Array.from({length:y},(e,t)=>{let s=null;if(eG.l7.ai("multiple-options-node-duplication",()=>{(s=C.clone())&&w.appendChild({guid:s})}),!s)throw Error(`Failed to create option ${t+1}`);let n=`option_${t+1}`;return ej.wS.trackCreatedNode(h,s),{id:n,nodeId:s,status:"pending"}});if(eo.IO){let e=new eo.IO(C);ej.wS.persistBackupManager(h,e)}let S=new Map;N.forEach(e=>{S.set(e.id,e.nodeId)}),ej.wS.setOptionNodes(h,S);let T={originalNodeId:C.guid,options:N,selectedOptionId:eB.DEFAULT_SELECTED_OPTION_ID,isGenerating:!0,clientLifecycleId:h,...b?{originalSelectedNodeIds:f}:{}};if(ej.wS.setWorkspace(h,T),g){let e=(0,ej.nw)(g);E.zl.set(e,e=>new Set([...e,h]))}if(r)try{await i("original",C.guid,r,void 0,h)}catch(e){(0,K.x1)("MultipleOptions","Failed to generate thumbnail for original node",{error:e})}e.config.options.previewIncrementalEdits=!1,e.config.options.isMultipleOutputsRequest=!0;let I=await e$({config:e.config,options:N,basePrompt:e.instructions||"",trackingContext:l,updateOptionStatus:n,abortControllers:d,toolCallId:t,extraStyleIds:p,extraVariableIds:m});if(I.allFailed){let s=I.allFailedWithReconciliationError?"jsx_reconciliation_error":"all_options_failed";if(u?.("ai_assistant.multiple_options_fallback_to_single",{persistentEntityId:g,clientLifecycleId:h,reason:s,optionCount:y,isRandomlyTriggered:_,sequenceNumber:eH(),configurationKey:e.config.configurationKey}),!v.get(C.guid)){(0,ej.VB)([]),eJ(h),a(t,{success:!1,error:"Unable to complete edit - the selected layer was modified or deleted during the attempt."});return}let n=ej.wS.getWorkspace(h);n&&ej.wS.setWorkspace(h,{...n,isGenerating:!1,retryingAsSingle:!0});try{let s={...e.config,options:{...e.config.options,isMultipleOutputsRequest:!1}},n=new AbortController,i=await (0,eo.nR)({params:{config:s,userInput:{userPrompt:e.instructions||""},inferredContext:{selectedNodeIds:f,extraStyleIds:p,extraVariableIds:m},trackingContext:l,aiTrackingContext:{action:el.JT.MAKE_EDITS,source:o.lV.AI_ASSISTANT,quick_actions_session_id:"invalid",file_key:r,product_type:e.editorType,...l},setThinkingState:()=>{}},abortController:n});(0,ej.VB)([]),a(t,{success:!0,message:i.message||"Edit completed successfully",image:i.image,imageCaption:i.image?"This is what the layer looks like now with the edits applied:":void 0}),eJ(h)}catch(s){(0,K.x1)("MultipleOptions","Single output retry also failed",{clientLifecycleId:h,error:s}),(0,ej.VB)([]);let e=eW(s);a(t,{success:!1,error:e}),eJ(h)}return}}catch(s){let e=s instanceof Error?eW(s):"Unknown error during option generation";(0,K.x1)("MultipleOptions","There was an error during multiple options generation",{clientLifecycleId:h,friendlyErrorMessage:e}),a(t,{success:!1,error:e})}}function eX(e){let t=ej.wS.getTrackedNodes(e);if(0===t.size)return;let s=(0,j.UN)();s.getInternalCanvas()&&eG.l7.ai("multiple-options-cleanup",()=>{let e=[];t.forEach(t=>{let n=s.get(t);if(n){if("CANVAS"===n.type){e.push(`CANVAS node: ${t}`);return}n.removeSelfAndChildren()}})})}function eZ(e){let t=(0,ej.nw)(e),s=E.zl.get(t);s.forEach(e=>{eX(e)}),s.forEach(e=>{ej.wS.cleanup(e)}),E.zl.set(t,new Set)}function eJ(e){eX(e),ej.wS.cleanup(e)}function eQ(e,t){if(!e)return{isGenerating:!1,options:[],originalNodeId:null};let s=t.get("original"),n={id:"original",status:s?.isGenerating?"thumbnail-generating":"completed",nodeId:e.originalNodeId,thumbnailUrl:s?.thumbnailUrl,isOriginal:!0};return{isGenerating:e.isGenerating,options:[n,...e.options.map(e=>{let s;let n=t.get(e.id);return s=n?.isGenerating?"thumbnail-generating":"running"===e.status?"pending":e.status||"completed",{id:e.id,status:s,nodeId:e.nodeId,error:e.error,thumbnailUrl:n?.thumbnailUrl,isOriginal:!1}})],originalNodeId:e.originalNodeId}}function e0(e){if(e.isArtifact)return{content:[{type:"multipleOptions",isToolResultArtifact:!0,selectedOptionThumbnailUrl:e.selectedOptionThumbnailUrl,selectedOptionId:e.selectedOptionId,id:e.messageId}],shouldStartGeneration:!1};let{messageId:t,textContent:s,renderState:n,editDesignToolCall:a,messageIndex:i}=e;return n.hasUI?function(e){let{messageId:t,textContent:s,renderState:n,editDesignToolCall:a,messageIndex:i,createOptionSelectionHandler:r,onContinue:l}=e,o=n.optionsState.isGenerating||n.optionsState.options.length>0||n.workspace?.retryingAsSingle===!0,c=a?.toolCallId||`fallback-${i}`,d=!o&&(void 0===a||a.isPending);if(n.workspace?.retryingAsSingle)return{content:s?[{type:"plan",plan:s,title:"Plan",id:`${t}-plan-${i}`}]:[],shouldStartGeneration:!1};if(!l)return{content:[{type:"plan",plan:s,title:"Plan",id:`${t}-plan-${i}`}],shouldStartGeneration:d,toolCallIdForGeneration:d?a?.toolCallId:void 0};if(!n.optionsState||!Array.isArray(n.optionsState.options))return console.error("[MultipleOptions] Invalid optionsState:",n.optionsState),{content:s?[{type:"plan",plan:s,title:"Plan",id:`${t}-plan-${i}`}]:[],shouldStartGeneration:d,toolCallIdForGeneration:d?a?.toolCallId:void 0};let u=n.optionsState.options.every(e=>"pending"!==e.status&&"thumbnail-generating"!==e.status),x=n.optionsState.options.some(e=>"completed"===e.status);return{content:[{type:"plan",plan:s,title:"Plan",id:`${t}-plan-${i}`},{type:"multipleOptions",options:n.optionsState.options.map(e=>({id:e.id,status:e.status,isLoading:"pending"===e.status||"thumbnail-generating"===e.status,isDisabled:"completed"!==e.status,thumbnailUrl:e.thumbnailUrl,isOriginal:e.isOriginal,alt:e.isOriginal?(0,C.t)("ai_assistant.multiple_options.original_design"):(0,C.t)("ai_assistant.multiple_options.option_alt",{optionId:e.id})})),selectedId:n.selectedOptionId,onSelectionChange:r?.(c),isToolResultArtifact:!1,onContinue:l,id:`${t}-options-${i}`,allOptionsGenerated:u&&x}],shouldStartGeneration:d,toolCallIdForGeneration:d?a?.toolCallId:void 0}}(e):a?.isPending?{content:[],shouldStartGeneration:!0,toolCallIdForGeneration:a.toolCallId}:s?{content:[{type:"plan",plan:s,title:"Plan",id:`${t}-plan-${i}`}],shouldStartGeneration:!1}:{content:[],shouldStartGeneration:!1}}function e1(e,t,s,n){if(!s||!n)return;let a=ej.wS.getWorkspace(t);if(a?.retryingAsSingle)return;let{toolData:i}=function(e,t){if(!t)return{isPending:!1,toolData:null};let s=(0,ej.KP)(t),n=E.zl.get(s).get(e);return{isPending:!!n&&n.args?.variants>1,toolData:n}}(e,t);i&&s(i.args,e,i.trackingContext,n)}var e5=s(396609),e2=s(582300),e3=s(502527),e4=s(422572),e6=s(563567);async function e7(e,t,s){let{instruction:n,clientLifecycleId:a}=e,i=e8(t,n,a),r=e9(t),[l,o]=await Promise.all([i,r]),c=l.map(e=>e.nodeId),d=o.filter(e=>-1!==c.indexOf(e.node_id));return await te(s,d)}async function e8(e,t,s){try{return await Y.Ay.shared.assistantFindRelevantDsAssets({libraryKey:e,instruction:t},(0,Z.sF)({clientLifecycleId:s}))}catch(t){return console.error(`Failed to fetch component recomendations for ${e}:`,t),[]}}async function e9(e){let{components:t,state_groups:s}=(await e6.Z.getLibraryPublishedComponentsV2({libraryKey:e})).data.meta;return[...t,...s]}async function te(e,t){let s=t.map(t=>e((0,e4.YF)(t)));return await Promise.all(s)}var tt=s(820857),ts=s(672328),tn=s(445059),ta=s(223487),ti=s(816505),tr=s(134784),tl=s(421564),to=s(534998),tc=s(729059);async function td({orgId:e,query:t,openFileKey:s,enabledLibraryKeys:n,toolTrackingContext:a}){return 0===n.size?[]:[...await tu({orgId:e,query:t,openFileKey:s,enabledLibraryKeys:n,toolTrackingContext:a}),...await tx({query:t,enabledLibraryKeys:n})]}async function tu({orgId:e,query:t,openFileKey:s,enabledLibraryKeys:n,toolTrackingContext:a}){return(await to.D.recommendComponents({source:"make_edits_components",org_id:e,query:t,open_file_key:s,subscribed_library_keys:Array.from(n),used_product_components:[],query_id:a.toolCallId,persistent_entity_id:a.persistentEntityId,client_lifecycle_id:a.clientLifecycleId,feature_entrypoint:a.featureEntrypoint})).data.meta.components}async function tx({query:e,enabledLibraryKeys:t}){let s=await tc.$W.getAssetsFromCommunityLibraries({query:e,assetTypes:(0,tc.in)([tl.PW.COMPONENT,tl.PW.STATE_GROUP]).join(",")}),{communitySearchResults:n}=(0,tr.lR)({results:s.data.meta.results,subscribedLibraryKeys:t,usedAssetKeys:new Set});return n}var tm=s(798721),tp=s(956434),th=s(14566),tg=s(425519),tf=s(28254),t_=s(231305),ty=s(493259),tk=s(702746),tv=s(778046),tb=s(906445),tj=s(201218),tC=s(162251),tw=s(579762),tE=s(412974),tN=s(418379);let tS={container:{kVAEAm:"x10l6tqk",k87sOh:"x13vifvy",kbCHJM:"xu96u03",kCIrl2:"x3m8u43",kLqNvP:null,kt4wiu:null,krVfgx:"x1ey2m1c",k1xSpc:"x78zum5",kGNEyG:"x6s0dn4",kjj79g:"xl56j7k",kWkggS:"x1wedvq4",kaIpWk:"x19y5rnk",krdFHd:null,kfmiAY:null,kVL7Gh:null,kT0f0o:null,kIxVMA:null,ksF3WI:null,kqGeR4:null,kYm2EN:null,kfzvcC:"x47corl",kKVMdj:"x1s8il3r",k44tkh:"xmg6eyc",kyAemX:"xa3vuyk",kWV6AL:"x10e4vud",$$css:!0},icon:{kzqmXN:"xh8yej3",kZKoxP:"x5yr21d",ku685b:"xdrobes",$$css:!0}};function tT(){return(0,a.jsx)("div",{...eR.xk(tS.container),children:(0,a.jsx)(tN.T,{...eR.xk(tS.icon)})})}var tI=s(692376),tA=s(805650),tM=s(854225),tz=s(689799),tL=s(112018);async function tO(e){let t=await s.e(3721).then(s.bind(s,913721));return{jsx:(await t.serializeJSX(e,{includeIDs:!0,excludeVectorData:!0,includeNames:!0,ignoreFetchingComponentData:!0,includeNodeTypes:["RECTANGLE","ROUNDED_RECTANGLE","TEXT","FRAME","GROUP","INSTANCE"],fieldGroups:[],strict:!1,includeInstanceSublayers:!0,ignoreDeveloperFriendlyIds:!0,focusNodeId:e.guid,maxSerializeNodes:500})).jsxStr}}async function tP(e){let t=await e.loadImagesAndExport([{imageType:"PNG",constraint:{type:"CONTENT_SCALE",value:1},contentsOnly:!0}]);if(0===t.length)throw Error("No image bytes exported for node: "+e.guid);return t}async function tR({node:e,imageBase64:t,imageName:s,functionalDependencies:n}){if(!e.isAlive)return;let{decodeImage:a}=n,i=(0,tA.u)(t),r=await a(i,"image/png",s);e.isAlive&&eG.l7.ai("replace-image",()=>{let t=(0,tL.R1)(e),s=[...e.fills];e.insertImageInFillPaint(r);let n=e.fills[s.length];if(!n)throw new tz.nK("Failed to get new image fill after replacing image");t&&(n.imageScaleMode=t.imageScaleMode)})}var tD=s(50270),tF=s(532909);async function tq({scenegraph:e,imageNode:t,functionalDependencies:s,additionalContext:n,abortController:a,trackingContext:i}){if(a?.signal.aborted)return;let r=(0,tF.g)(),{serverEndpoint:l,addOverlayToNode:o,removeOverlayToNode:c,reportError:d,trackImageFromContextEvent:u}=s,{clientLifecycleId:x,persistentEntityId:m}=i;u("start",{...i,clientGeneratedRequestUuid:r});let p=Date.now();o(t);try{let o;let c=t.findContainingTopLevelFrameOrSelf(),d=e.get(c)??t;if(!d)throw new tz._M("Top level frame or node not found");let{jsx:h}=await tO(d),g=e.get(t.containingCanvas),f=g?.isInternalOnlyNode??!1,_=new j.qo(tM.juq.AI_TOOLS),y=null;if(f)y=d,o=t;else{tI.MRD?.getOrCreateTemporaryScene();let e=tI.MRD?.copyNodeToTemporaryScene(d.guid);if(!e)throw Error("Failed to copy node to temporary scene");if(!(y=_.get(e)))throw new tz._M("Top level frame not found in temporary scene");let{activeToTemporaryGuidsMap:s}=function(e,t){let s=new Map,n=new Map,a=[],i=[];if(!e||!t)return{activeToTemporaryGuidsMap:s,temporaryToActiveGuidsMap:n};if((0,e2.hV)(e,e=>{a.push(e.guid)}),(0,e2.hV)(t,e=>{i.push(e.guid)}),a.length!==i.length)throw Error("Cannot create temporary scene guid map because active and temporary guid arrays have different lengths");return a.forEach((e,t)=>{let a=i[t];a&&(s.set(e,a),n.set(a,e))}),{activeToTemporaryGuidsMap:s,temporaryToActiveGuidsMap:n}}(d,y),n=_.get(s.get(t.guid)??null);if(!n)throw new tz._M("Image node not found in temporary scene");o=n}eG.l7.ai("replace-image-temp-manipulation",()=>{!function(e){if(e.fills){let t=e.fills.map(e=>"IMAGE"===e.type?{...e,visible:!1}:e);e.fills=t}}(o),function(e,t=3){let s=e.strokePaints?.data||[];e.strokePaints={data:[...s,{type:"SOLID",color:{r:1,g:0,b:0,a:1},visible:!0,opacity:1}],blobs:[]},e.strokeAlign="OUTSIDE",e.strokeWeight=t}(o)});let k=await tP(y),v=(0,tA.K)(k);f&&eG.l7.ai("replace-image-cleanup",()=>{var e;!function(e){if(e.fills){let t=e.fills.map(e=>"IMAGE"===e.type?{...e,visible:!0}:e);e.fills=t}}(o),(e=o).strokePaints={data:[],blobs:[]},e.strokeWeight=0});let b=await l({request:{requests:[{width:t.size.x,height:t.size.y,imageNodeId:t.guid,jsx:h,imageScreenshot:v,userPrompt:n?.userPrompt}]},clientLifecycleId:x,clientGeneratedRequestUuid:r,persistentEntityId:m});if(!b||!b.responses||!b.responses[0]?.image)throw new tz.lU("Replace image response is empty");let{image:C,imagePrompt:w,metrics:E}=b.responses[0],{llmRequestMs:N,imageRequestMs:S}=E;if(a?.signal.aborted){u("end",{...i,clientGeneratedRequestUuid:r,totalDurationMs:Date.now()-p,completionStatus:"canceled"});return}return await tR({node:t,imageBase64:C,imageName:w,functionalDependencies:s}),u("end",{...i,clientGeneratedRequestUuid:r,totalDurationMs:Date.now()-p,llmPromptStepDurationMs:N,imageGenerationStepDurationMs:S,completionStatus:"success"}),b}catch(e){throw console.error("Error running replace image",e),("reportToSentry"in e&&e.reportToSentry||e instanceof tD.G&&(!e.statusCode||e.statusCode>=500)||e instanceof f.G1&&(!e.data.statusCode||e.data.statusCode>=500))&&d(e),u("end",{...i,clientGeneratedRequestUuid:r,totalDurationMs:Date.now()-p,errorMessage:e.message,completionStatus:"error"}),e}finally{c(t)}}async function tG(e){let t=await tq(e);if(t)return{responses:t.responses.map(e=>({imageNodeId:e.imageNodeId,imagePrompt:e.imagePrompt}))}}!function(e){e.MAKE_EDITS="MAKE_EDITS",e.ASSISTANT_TOOL_CALL="ASSISTANT_TOOL_CALL"}(n||(n={}));var tU=s(652154),tK=s(680912),tH=s(419312);function tB(e,t){"start"===e?M.az.trackDefinedEvent("expressive_ai.image_from_context_started",t):"end"===e?M.az.trackDefinedEvent("expressive_ai.image_from_context_ended",t):console.warn("Unhandled event type:",e)}var tV=s(264152),t$=s(623002),tW=s(442623),tY=s(142037),tX=s(230706);let tZ=(0,i.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M11.5 6a5.5 5.5 0 0 1 4.226 9.019l2.127 2.127a.5.5 0 1 1-.707.707l-2.127-2.127A5.5 5.5 0 1 1 11.5 6m0 1a4.5 4.5 0 1 0 0 9 4.5 4.5 0 0 0 0-9m-.485 2.44c.126-.505.844-.505.97 0l.315 1.26 1.26.315c.505.126.505.844 0 .97l-1.26.315-.315 1.26c-.126.505-.844.505-.97 0L10.7 12.3l-1.26-.315c-.505-.126-.505-.844 0-.97l1.26-.315z"})})});function tJ(){return(0,a.jsx)("div",{...eR.xk(tS.container),children:(0,a.jsx)(tZ,{...eR.xk(tS.icon)})})}let tQ=(0,E.eU)(null);function t0(e){E.zl.set(tQ,e)}let t1="scenegraph-fallback",t5=new Map;function t2({makeNodeGuid:e}){let t=(0,j.UN)().get(e);if(!t)return null;let s=(0,eb.hh)(t),n=s?.guid||e;return(0,a.jsx)(ef.H,{codeInstanceNode:t,codeInstanceNodeGuid:e,entryPointCodeFile:s,entryPointCodeFileGuid:n,featureType:o.lV.FIGMAKE_IN_DESIGN,forceReadOnly:!1,hideChatBox:!1,isResizingPanel:!1,newCodeLayerState:null,previewState:e_.Oy.EMPTY,setCodeInstanceNode:F.lQ,setEntryPointCodeFile:F.lQ})}function t3(e){return(0,a.jsx)(G.u9,{label:"DesignLeftPanelAssistant",children:(0,a.jsx)(t4,{...e})})}function t4(e){let t=function(){let e=(0,er.Tv)();return i.useMemo(()=>{if(!e||e.length>1||!e[0])return null;let t=(0,j.UN)().get(e[0]);return t&&(t.isCodeFile||t.isCodeComponent||t.isCodeInstance||t.isCodeLibrary)?t.guid:null},[e])}();return t&&(0,w.kc)().assistant_threading_prototype?(0,a.jsx)(t2,{makeNodeGuid:t}):(0,a.jsx)(t6,{...e})}function t6({assistantOptionOverrides:e}){let t=(0,w.kc)().ai_assistant_stop_button??!1,s=(0,w.kc)().ai_assistant_blobstore??!1,x=(0,es.iZ)(),m=(0,et.Td)(),S=(0,W.lg)(),I=(0,R.hC)(),G=(0,er.Tv)(),ec=(0,E.md)(ej.pF),ed=(0,E.md)(X.eb),eu=(0,E.md)(ej.yq),ex=(0,E.md)(ej.UK),em=(0,ea.Vc)(m),ep=(0,en.S2)(),{Sprig:ef}=(0,H.A)(),e_=i.useMemo(()=>e?A()(T()(ex),e):ex,[ex,e]),eb=(0,r.wA)(),[eE,eN]=i.useState(!1),{pendingInteractiveTools:eS,showInteractiveTool:eI,showAutoResolvingTool:eA,resolveInteractiveTool:eM}=(0,tt.RG)(e_.trackingContext?.clientLifecycleId),{generateThumbnail:ez}=function(){let e=i.useRef(new Set),t=i.useCallback((e,t,s)=>{if(!s)return;let n=(0,ej.Og)(s);E.zl.set(n,s=>{let n=new Map(s),a={...n.get(e)||{isGenerating:!1},...t};return n.set(e,a),n})},[]);return{generateThumbnail:i.useCallback(async(s,n,a,i,r)=>{let l=(0,j.UN)(),o=l.get(n),c=n;if(!o){t(s,{isGenerating:!1,error:Error(`Node ${n} not found in scene graph`)},r);return}if(i&&i.has(s)){let e=i.get(s),t=l.get(e);t&&(o=t,c=e)}let d=o;d.visible||(d.visible=!0);let u=`${s}-${n}`;if(!e.current.has(u)){e.current.add(u);try{t(s,{isGenerating:!0,error:void 0},r);let e=new Promise((e,t)=>{(0,eC.WN)(c,!0,a,ew.WIDTH,ew.HEIGHT,{onSuccess:({dataUrl:t,metadata:s})=>{e(t)},onFailure:({reason:e,guid:s,fileKey:n})=>{t(Error(e))}},ew.MAX_SCALE,{type:ew.TYPE,clearColor:ew.CLEAR_COLOR,padding:ew.PADDING})}),n=new Promise((e,t)=>{setTimeout(()=>t(Error("Thumbnail generation timeout")),ew.TIMEOUT_MS)}),i=await Promise.race([e,n]);t(s,{thumbnailUrl:i,isGenerating:!1,error:void 0},r)}catch(n){let e=n instanceof Error?n:Error("Unknown thumbnail error");t(s,{isGenerating:!1,error:e},r),console.warn(`Failed to generate thumbnail for option ${s}:`,e)}finally{e.current.delete(u)}}},[t])}}(),{updateOptionStatus:eL,resolveWithSelectedOption:eO}={updateOptionStatus:i.useCallback(({optionId:e,status:t,trackDefinedEvent:s,persistentEntityId:n,result:a,error:i})=>{let r=(0,ej.aA)(n,e);if(!r){console.warn(`Could not find clientLifecycleId for option ${e}`);return}let l=ej.wS.getWorkspace(r);if(!l)return;let o={...l,options:l.options.map(s=>s.id===e?{...s,status:t,result:a,error:i}:s),isGenerating:l.options.some(s=>s.id===e?"running"===t:"running"===s.status)};if("completed"===t&&a?.originalOptionNodeId&&(ej.wS.trackCreatedNode(r,a.originalOptionNodeId),ej.wS.setOptionResultNode(r,e,a.originalOptionNodeId)),function({workspace:e,wasGenerating:t}){return!!e.options.every(e=>"completed"===e.status||"failed"===e.status)&&!!t}({workspace:o,wasGenerating:l.isGenerating})&&(o.isGenerating=!1,(0,ej.VB)([])),ej.wS.updateWorkspace(r,()=>o),"completed"===t&&a?.originalOptionNodeId&&m&&ez(e,a.originalOptionNodeId,m,void 0,r),"completed"===t||"failed"===t){let a=o.options.findIndex(t=>t.id===e),i=-1!==a?o.options[a]:null;i&&s("ai_assistant.multiple_options_options_shown",{persistentEntityId:n,clientLifecycleId:r,optionId:a+1,selectedNodeIds:l.originalSelectedNodeIds||[l.originalNodeId],generatedNodeId:i.nodeId,generationStatus:t,sequenceNumber:E.zl.get(J.J)||0})}let c=ej.wS.getWorkspace(r),d=c?.options.filter(e=>"completed"===e.status)||[];"completed"===t&&0===d.length&&s("ai_assistant.multiple_options_option_selected",{persistentEntityId:n,clientLifecycleId:r,optionId:0,selectedNodeIds:l.originalSelectedNodeIds||[l.originalNodeId],generatedNodeId:l.originalNodeId,sequenceNumber:E.zl.get(J.J)||0})},[ez,m]),resolveWithSelectedOption:i.useCallback(({clientLifecycleId:e,toolCallId:t,resolveInteractiveTool:s,threadId:n,trackDefinedEvent:a})=>{let i;if(!s)return;let r=ej.wS.getWorkspace(e);if(!r)return;let l=r.options.filter(e=>"failed"===e.status);if(l.length>0){let e=l.filter(e=>e.error).map(e=>({optionId:e.id,error:eW(e.error)}));e.length>0&&(0,K.x1)("MultipleOptions","Failed options (logged for debugging)",{failedOptions:e})}let o=r.options.filter(e=>"completed"===e.status&&e.result?.llmInducedError);if(o.length>0){let e=o.map(e=>({optionId:e.id,message:e.result?.message||"Unknown LLM-induced error"}));(0,K.x1)("MultipleOptions","LLM-induced errors:",{llmInducedErrors:e})}let c=(0,ej.Og)(e),d=eQ(r,E.zl.get(c)).options.find(e=>e.id===r.selectedOptionId);if(!d)return;let u=r.options.filter(e=>"completed"===e.status),x=r.options.length,m=u.length,p=l.length>0;i=o.length===x&&o.length>0?o[0]?.result?.message||"No changes made":"original"===d.id?"User declined to select a generated option and continued with the original design. In your response, be sure to note that although new designs were generated, the user declined to move forward with the changes and opted to keep their original design instead.":p?`User selected one of ${m} of ${x} successfully generated options`:"User selected one of the presented options";let h=r.options.findIndex(e=>e.id===r.selectedOptionId);a("ai_assistant.multiple_options_continue_clicked",{persistentEntityId:n,clientLifecycleId:e,optionId:"original"===r.selectedOptionId?0:h+1,selectedNodeIds:r.originalSelectedNodeIds||[r.originalNodeId],generatedNodeId:"original"===r.selectedOptionId?r.originalNodeId:d?.nodeId,toolCallId:t,toolName:"edit_design",sequenceNumber:E.zl.get(J.J)||0}),s(t,{success:!0,message:i,selectedOptionThumbnailUrl:d.thumbnailUrl,selectedOptionId:d.id}),eZ(n)},[])},[eP,eR]=i.useState(new Map),[eD,eq]=(0,E.fp)(ej.qA),[eV,e$]=(0,E.fp)(tQ),[eX,eJ]=(0,E.fp)(ej.hM),e6=(0,E.md)(ej.G1),e8=(0,E.Xr)(ej.G1),{appendPersistedMessagesForCurrentThread:e9,setPersistedMessagesForCurrentThread:te,getPersistedMessagesForCurrentThread:tr}=function(e){let[t,s]=i.useState(new Map),n=i.useCallback(()=>e?t.get(e)??[]:[],[e,t]),a=i.useCallback(t=>{e&&s(s=>{let n=new Map(s);return n.set(e,t),n})},[e]);return{appendPersistedMessagesForCurrentThread:i.useCallback(t=>{e&&s(s=>{let n=new Map(s),a=n.get(e)??[];return n.set(e,[...a,...t]),n})},[e]),setPersistedMessagesForCurrentThread:a,getPersistedMessagesForCurrentThread:n}}(e6),tl=i.useCallback(()=>e6?eP.get(e6)??[]:[],[e6,eP]),to=i.useCallback(e=>{e6&&eR(t=>{let s=new Map(t);return s.set(e6,e),s})},[e6]),{threadId:tc,setThreadId:tu,isLoadingThreadId:tx}=(0,O.dJ)(m,tl().length,te,tr,"idle"!==eD),tN=i.useRef(""),tS=tc||t1,tI=i.useCallback(e=>{E.zl.set((0,ey.mC)(tS),e)},[tS]),tA=em.unwrapOr(null),tM=tl().length>0,tL=(0,ej.xs)().length>0,tO=tM||tx||"loaded"!==em.status||!tA,tP=tO||tL,tR=t&&tM,tD=tA?.aiDataSharingEnabled?.status===D.tT.Loaded&&(tA.aiDataSharingEnabled.data??!1),{maybeAddTopKStylesToInternalCanvas:tF}=(0,B.S9)({enabled:(ec.options.enableStyles||ec.fallbackOptions?.enableStyles)??!1,k:ec.options.subscribedStyleCountPerType}),{maybeAddTopKVariablesToInternalCanvas:tq}=(0,V.p)({enabled:(ec.options.enableVariables||ec.fallbackOptions?.enableStyles)??!1,k:ec.options.subscribedVariableCountPerType}),{startMultipleOptionsGenerationCallback:tZ,createOptionSelectionHandlerCallback:t0,resolveWithSelectedOptionCallback:t2}=function({selectedNodeIdsForLLM:e,updateOptionStatus:t,resolveInteractiveTool:s,generateThumbnail:n,fileKey:a,includeExtraContext:r,persistentEntityId:l,trackDefinedEvent:o,resolveWithSelectedOption:c,aiDataSharingEnabled:d,maybeAddTopKStylesToInternalCanvas:u,maybeAddTopKVariablesToInternalCanvas:x}){let m=i.useCallback(({optionId:e,status:n,result:a,error:i,toolCallId:r})=>t({optionId:e,status:n,trackDefinedEvent:o,persistentEntityId:l,result:a,error:i,resolveInteractiveTool:s,toolCallId:r}),[t,o,l,s]);return{startMultipleOptionsGenerationCallback:i.useCallback(async(t,i,l,c)=>{let p=Array(t.variants?Math.min(t.variants,eB.MAX_OPTIONS):0).fill(null).map(()=>new AbortController),h=E.zl.get((0,ey.Z3)(c)),g=await u()??[],f=await x()??[];return h&&h.signal.addEventListener("abort",()=>{p.forEach(e=>{e.signal.aborted||e.abort()}),s(i,{success:!1})}),eY({args:t,toolCallId:i,selectedNodeIdsForLLM:e,updateOptionStatus:m,resolveInteractiveTool:s,generateThumbnail:n,fileKey:a,toolTrackingContext:l,includeExtraContext:r,abortControllers:p,trackDefinedEvent:o,aiDataSharingEnabled:d,extraVariableIds:f,extraStyleIds:g})},[e,m,s,n,a,r,o,d,u,x]),createOptionSelectionHandlerCallback:i.useCallback(e=>t=>new Promise((n,a)=>{try{let s=null,a=null;if(e&&l){let t=(0,ej.nw)(l),n=E.zl.get(t);for(let t of n){let n=(0,ej.KP)(t);if(E.zl.get(n).has(e)){a=t,s=ej.wS.getWorkspace(a);break}}if(!a&&!s)for(let e of n){let t=ej.wS.getWorkspace(e);if(t){a=e,s=t;break}}}if(!s||!a){(0,K.x1)("MultipleOptions","Could not find workspace or clientLifecycleId:",{hasWorkspace:!!s,hasClientLifecycleId:!!a,toolCallId:e});return}let i={...s,selectedOptionId:t};ej.wS.setWorkspace(a,i);let r=s.options.findIndex(e=>e.id===t),c=-1!==r?s.options[r]:null,d="original"===t?0:r+1;o("ai_assistant.multiple_options_option_selected",{persistentEntityId:l,clientLifecycleId:a,optionId:d,selectedNodeIds:s.originalSelectedNodeIds||[s.originalNodeId],generatedNodeId:"original"===t?s.originalNodeId:c?.nodeId,toolCallId:e,toolName:"edit_design",sequenceNumber:eH()});let u=ej.wS.getBackupManager(a),x=ej.wS.getOptionNodes(a);u||(0,K.x1)("MultipleOptions","Failed to restore BackupManager from atoms - option selection will fail"),x&&0!==x.size||(0,K.x1)("MultipleOptions","No option nodes found in atoms - option selection may fail"),function(e,t,s,n,a){if("original"===e){let e=s.restoreFromBackup();s.updateActiveNode(e),ej.wS.persistBackupManager(t.clientLifecycleId,s),a(t=>t?{...t,originalNodeId:e.guid}:null)}else{let i=t.options.find(t=>t.id===e),r=(0,j.UN)(),l=null;if(t.originalSelectedNodeIds){let t=n.get(e);t&&(l=r.get(t))}else{let t=i?.result?.nodeId?r.get(i.result.nodeId):null;if(t&&"CANVAS"!==t.type)l=t;else{let t=n.get(e);t&&(l=r.get(t))}}l&&eG.l7.ai("multiple-options-node-swap",()=>{let e=r.get(t.originalNodeId);if(e?.parentNode){let n=s.originalParent,i=r.get(l.clone());if(i&&n){(function(e,t,s){let n=e.childrenGuids.findIndex(e=>e===t.guid);e.insertChild(s,n),s.size=t.size,s.relativeTransform=t.relativeTransform,s.stackPositioning=t.stackPositioning,s.verticalConstraint=t.verticalConstraint,s.horizontalConstraint=t.horizontalConstraint})(n,e,i),e.removeSelfAndChildren();let l=r.getCurrentPage();l&&l.setSelectionToSingleNode(i.guid),s.updateActiveNode(i),ej.wS.persistBackupManager(t.clientLifecycleId,s),a(e=>e?{...e,originalNodeId:i.guid}:null)}}})}}(t,i,u,x,e=>{let t=e(i);if(t&&a){let e={...i,originalNodeId:t.originalNodeId};ej.wS.setWorkspace(a,e)}}),n()}catch(t){(0,K.x1)("MultipleOptions","Error during option selection:",{error:t}),s(e,{success:!1,error:t instanceof Error?t.message:"Unknown error during option selection"}),a(t)}}),[l,o,s]),resolveWithSelectedOptionCallback:i.useCallback(({clientLifecycleId:e,toolCallId:t,resolveInteractiveTool:s,threadId:n})=>c({clientLifecycleId:e,toolCallId:t,resolveInteractiveTool:s,threadId:n,trackDefinedEvent:o}),[c,o])}}({selectedNodeIdsForLLM:G??[],updateOptionStatus:eL,resolveInteractiveTool:eM,generateThumbnail:ez,fileKey:m,includeExtraContext:ec.options.includeExtraContext??!1,persistentEntityId:tc??"",trackDefinedEvent:I,aiDataSharingEnabled:tD,resolveWithSelectedOption:eO,maybeAddTopKStylesToInternalCanvas:tF,maybeAddTopKVariablesToInternalCanvas:tq}),t3=function({fileKey:e,plan:t,threadId:s,setThreadId:n,newChatTrigger:a,setNewChatTrigger:r,trackDefinedEvent:l}){return i.useCallback(async()=>{let i="pendingCreation"===a;if(null!=s&&!i)return s;if(!e)throw new P.fC("No file key for creating thread");if(!t)throw new P.fC("No plan metadata for creating thread");let o=await (0,L.q)({context:"ai_assistant",fileKey:e,plan:t});if("error"===o.status)throw new P.fC(`Failed to create AiChatThread: ${o.error}`);let{status:c,threadId:d}=o;return"created"===c&&((0,P.pF)("AiChatThread created",{newThreadId:d}),l("ai_assistant.new_chat_created",{}),n(d),r("idle")),d},[e,s,a,n,r,t,l])}({fileKey:m,plan:tA,threadId:tc,setThreadId:tu,newChatTrigger:eD,setNewChatTrigger:eq,trackDefinedEvent:I}),{enabledLibraryKeys:t4,libraryKeyToName:t6}=(0,e5.s)(),{executeSearchClientSide:t7}=function({topK:e=3}){let t=(0,ti.dq)(),s=(0,ta.tS)(),n=(0,r.wA)(),{enabledLibraryKeys:a,libraryKeyToName:l}=(0,e5.s)(),o=i.useCallback(async(i,r)=>{let o=(await td({orgId:t,query:i.query,openFileKey:s,enabledLibraryKeys:a,toolTrackingContext:r})).slice(0,e),c=await Promise.all(o.map(async e=>({guid:await n((0,e4.YF)(e)),name:e.name,libraryName:l[e.library_key]})));return{query:i.query,rankedResults:c}},[t,a,s,l,e,n]);return i.useMemo(()=>({executeSearchClientSide:o}),[o])}({topK:e_.globalOptions.componentSearchMaxResults}),{executeReplaceImageClientSide:t8}=function(){let e=(0,j.UN)(),t=(0,tU.uQ)(),s=i.useCallback(async(s,i,r,l)=>{let o=s?.imageNodeGuid??t,c=e.get(o),d=s?.userPrompt;return c?await tG({scenegraph:e,imageNode:c,functionalDependencies:{serverEndpoint:e=>{let{request:t,clientLifecycleId:s,clientGeneratedRequestUuid:n,persistentEntityId:a}=e;return Y.Ay.shared.replaceImage(t,{...(0,tK.Ay)(),clientLifecycleId:s,clientGeneratedRequestUuid:n,persistentEntityId:a})},decodeImage:tH.UD,addOverlayToNode:e=>(0,eK.Vm)(e.guid,(0,a.jsx)(eU.A,{})),removeOverlayToNode:e=>(0,eK.ks)(e.guid),reportError:e=>(0,U.$D)(b.e.EXPRESSIVE_AI,e),trackImageFromContextEvent:tB},trackingContext:{source:n.ASSISTANT_TOOL_CALL,clientLifecycleId:r,persistentEntityId:l},additionalContext:{userPrompt:d},abortController:i})??{responses:[]}:((0,U.$D)(b.e.AI_ASSISTANT,new tz._M("Image node not found for replace image tool from Assistant")),{responses:[]})},[e,t]);return i.useMemo(()=>({executeReplaceImageClientSide:s}),[s])}(),{executeSerializeNodesClientSide:t9}=function({serializerOptions:e,clientLifecycleId:t,options:s}){let n=i.useCallback(async n=>{let i=q.J.startUserFlow({name:"use_serialize_nodes__tool",team:b.e.AI_GENERATION,trackFps:!0}),r=(0,w.kc)().jsx_tracking?(0,h.DN)("use_serialize_nodes__tool",i,{clientLifecycleId:t}):void 0;try{let t=(0,j.UN)();if(!t)throw Error("No active scene graph");let i={sceneGraph:t,serializerOptions:{...e,jsxTrackingContext:r,taskRunner:(0,tX.C)()},onNodesFocused:e=>{if((0,w.kc)().assistant_cursor_ui){let s=E.zl.get(eT),n=e.map(e=>{let s=t.get(e);return s?(0,C.t)("ai_assistant.cursor.status.looking_at_node",{nodeName:s.name||"node"}):(0,C.t)("ai_assistant.cursor.status.looking")});s.addNodes(e,t,n)}},onNodesUnfocused:e=>{(0,w.kc)().assistant_cursor_ui?E.zl.get(eT).removeNodes(e):e.forEach(e=>(function(e,t=1500){let s=`ai-search-${e}-${Date.now()}`;(0,eK.Vm)(e,(0,a.jsx)(tJ,{}),{overlayId:s}),setTimeout(()=>{(0,eK.ks)(e,s)},t)})(e))}};return await (0,g.YC)(n,i,s)}catch(e){throw(0,K.x1)("Failed to serialize nodes:",e),e}finally{i.end()}},[e,t,s]);return i.useMemo(()=>({executeSerializeNodesClientSide:n}),[n])}({serializerOptions:(0,h.DP)(e_.globalOptions),clientLifecycleId:e_.trackingContext?.clientLifecycleId,options:{returnExtraInfo:e_.globalOptions.returnExtraSerializedNodesInfo}}),{executeRenderNodeClientSide:se}=function(){let e=i.useCallback(async e=>{try{let t=(0,j.UN)();if(!t)throw Error("No active scene graph");return await (0,g.VO)(e,{sceneGraph:t,renderImageDataEmbeddedUrl:tE.vr,onNodesRendering:e=>{if((0,w.kc)().assistant_cursor_ui){let s=E.zl.get(eT),n=e.map(e=>{let s=t.get(e);return(0,C.t)("ai_assistant.cursor.status.looking_at_node",{nodeName:s?.name||"node"})});s.addNodes(e,t,n)}},onNodesRendered:e=>{(0,w.kc)().assistant_cursor_ui?E.zl.get(eT).removeNodes(e):e.forEach(e=>(function(e,t=1500){let s=`ai-image-${e}-${Date.now()}`;(0,eK.Vm)(e,(0,a.jsx)(tT,{}),{overlayId:s}),setTimeout(()=>{(0,eK.ks)(e,s)},t)})(e))}})}catch(e){throw(0,K.x1)("Failed to render node(s):",e),e}},[]);return i.useMemo(()=>({executeRenderNodeClientSide:e}),[e])}(),{executeExportAssetsClientSide:st}=function(){let e=(0,tC.Gt)("assets");return{executeExportAssetsClientSide:i.useCallback(t=>{if(!e)return{error:"No assets in current selection"};let s={},n=!1,a=t.assetTypes||g.IG;if(a.forEach(t=>{switch(t){case"ASSET_ICON":e.icons&&Object.keys(e.icons).length>0&&(s[t]=Object.keys(e.icons).length,n=!0);break;case"ASSET_ILLUSTRATION":e.illustrations&&Object.keys(e.illustrations).length>0&&(s[t]=Object.keys(e.illustrations).length,n=!0);break;case"ASSET_IMAGE":e.images&&Object.keys(e.images).length>0&&(s[t]=Object.keys(e.images).length,n=!0);break;case"ASSET_GIF":e.gifs&&Object.keys(e.gifs).length>0&&(s[t]=Object.keys(e.gifs).length,n=!0)}},[]),!n)return{error:"No assets in current selection"};let i=(0,tw.Y)({nodeId:t.layerId,assetTypes:a});return{numberOfAssetsFound:s,message:`To show the user an asset export dialog, reply with: ${i}`}},[e])}}(),{executeSearchCurrentDesignFileClientSide:ss}=function({serializerOptions:e}){let t=(0,tY.iW)(),s=i.useMemo(()=>({searchLayerNames:!0,searchAnnotationTextContent:t,matchCase:!1,wholeWords:!1}),[t]),n=i.useCallback(async({query:t,page:n})=>{n||(n=0);let a=(0,j.UN)();if(!a)throw Error("No active scene graph");let i=a.getCurrentPage()?.guid;if(!i)throw Error("No active scene graph page");let{resultsByPage:r}=await tW.H1.search(t,s),l=r[i]||[],o=20*n,c=l.slice(o,o+20).map(async t=>{let s=a.get(t.guid);if(!s)return;let n=await (0,tV.oy)(s,{...e,maxSerializeNodes:1,excludeVectorData:!0,focusNodeId:t.guid}),i=n.incompleteNodeIds||[];return{id:t.guid,parentId:s.parentGuid,jsxPreview:n.jsxStr,isPreviewTruncated:i.length>0}});return{searchResults:(await Promise.all(c)).filter(t$.t),page:n,numberOfPagesAvailable:Math.min(Math.ceil(l.length/20),10)}},[s,e]);return i.useMemo(()=>({executeSearchCurrentDesignFileClientSide:n}),[n])}({serializerOptions:(0,h.DP)(e_.globalOptions)}),{findAndLoadRelevantDesignSystemAssets:sn}=function(){let{enabledLibraryKeys:e}=(0,e5.s)(),t=(0,r.wA)(),s=i.useCallback(async s=>{let n=Array.from(e).map(e=>e7(s,e,t));return(await Promise.all(n)).flat()},[e,t]);return i.useMemo(()=>({findAndLoadRelevantDesignSystemAssets:s}),[s])}(),{executePluginCodeClientSide:sa}=function(){let e=i.useCallback(async e=>{let t=E.zl.get(X.eb),s=E.zl.get(tm.yq),n={selectedNodeIds:e.selectedNodeIds},a=e.configurationKeyOverride?{...s,makeEditsOpaqueConfigurationKey:e.configurationKeyOverride}:s,i=await eh(t,a,{},n);return await (0,eo.nR)({params:{config:i,userInput:{userPrompt:e.prompt},inferredContext:n,trackingContext:{},setThinkingState:()=>{},aiTrackingContext:{action:el.JT.MAKE_EDITS,source:o.lV.AI_ASSISTANT,quick_actions_session_id:"invalid",file_key:e.fileKey,product_type:"design",clientLifecycleId:"dummy-id-from-plugin-api"}},abortController:e.abortController})??{nodeId:null}},[]);(0,t_.vB)(e);let t=i.useCallback(async e=>{let t=q.J.startUserFlow({name:"use_execute_plugin_code__tool",team:b.e.AI_GENERATION,trackFps:!0});try{let t=E.zl.get(ta.ze),s=(0,tv.o8)(),n=E.zl.get(tm.G1);if(!t)throw Error("No file key found");if(!s)throw Error("Cannot run plugin while logged out");if(!n)throw Error("No conversation ID found");await (0,ty.wY)();let a=`(async function() {
        try {
          ${e.code}
        } catch (error) {
          figma.ai.resumeExchange({ content: [
            { type: 'text', text: error.message },
            { type: 'text', text: 'Stack: ' + error.stack || '' }
          ], isError: true });
        }
        })()`,i=(0,tp.oP)(),r=(0,ty.mv)();ty.iu.currentPluginRunID=r,(0,tf.E9)({allowedDomains:tb.gH,apiVersion:th.pS,capabilities:[],stats:new tj.P,checkSyntax:!0,code:a,command:"",disableSilenceConsole:!0,enablePrivatePluginApi:!1,enableProposedApi:!1,errorHandler:e=>{(0,tp.xH)({isError:!0,content:[{type:"text",text:e}]})},isLocal:!0,isWidget:!1,name:"AI Assistant Plugin Code",openFileKey:t,permissions:tg.qH.forFirstPartyPlugin(),pluginID:`ai-assistant-plugin-code-${n}`,pluginRunID:r,pluginVersionID:"0",queryMode:!1,showLaunchErrors:!0,showRuntimeErrors:!0,titleIconURL:"",userID:s,vmType:"cppvm",editorType:[tk.FW.FIGMA],incrementalSafeApi:!1,enableNativeJsx:!1});let l=await i;if(await (0,ty.wY)(),l&&l.isError)throw Error(l.content[0]?.type==="text"?l.content[0].text:"Error");let o=l.content.filter(e=>"image"!==e.type).map(e=>e.text).join("");if(o.length>4e4)throw Error("Result exceeded 40,000 character limit (approximately 10k tokens). The output has been truncated. Consider refining your query to return fewer nodes or less data per node. For example, return just node IDs first, then query specific nodes for details.");return{result:o,images:function(e){let t=[];for(let s of e.content)"image"===s.type&&t.push({image:s.data,imageCaption:s.imageCaption||""});return t}(l)}}catch(e){throw(0,K.x1)("Failed to execute plugin code:",e),e}finally{(0,tp.Zz)(),t.end()}},[]);return i.useMemo(()=>({executePluginCodeClientSide:t}),[t])}(),si=i.useCallback(async({userInput:e,clientLifecycleId:t},n)=>{let a=G??[];if("canvas"===n&&e.selectedNodeIds&&e.selectedNodeIds.length&&(a=e.selectedNodeIds),!m){console.warn("No file key found");return}let i=await t3();if(!i)throw Error("Missing exchange thread ID");let r={fileKey:m,threadId:i,startFileSeqNum:String(E.zl.get(J.J)??0)};tI(""),to([]);let x=new AbortController;E.zl.set((0,ey.Z3)(i??t1),x);let h=e.selectedNodeIds??a;(0,ej.VB)(h);let N=Q.Y5.getViewportInfo(),T=(0,ee.qc)(N),A=(0,j.UN)(),M=Array.from(t4).map(e=>({libraryKey:e,libraryName:t6?.[e]||e})),L=await (0,u.J)({plainText:e.plainText,clientLifecycleId:t,context:{selectedNodeIds:e.selectedNodeIds,viewport:T,enabledLibraries:M},sceneGraph:A,globalOptions:e_.globalOptions}),O="ai_assistant",P={clientLifecycleId:t,persistentEntityId:i,featureEntrypoint:n,configurationKey:e_.configurationKey,makeEditsConfigurationKey:ec.configurationKey};x.signal.addEventListener("abort",()=>{eZ(i),I("ai_assistant.aborted_request",{...P,reason:(0,k.xr)(x.signal.reason)})});let R=(0,z.xO)(i,m),H=await tF()??[],B=await tq()??[];async function V(e,s){let n=a.filter(t=>!(e.contextNodeIds??[]).includes(t)),i=e.editNodeIds??n,r=(0,j.UN)(),l=r&&(0,y.nN)(r,i.map(e=>r.get(e)).filter(e=>null!==e));ec.options.allowMissingFonts&&l&&await eI({...e,missingFontsInfo:{hasMissingFonts:l}},s,"edit_design");let c={},d=e.extraComponentGuids;if(ec.options.useComponentsFromGlossary)try{d=await sn({instruction:e.instructions,clientLifecycleId:t})}catch(e){console.error("Failed to generate relevant design assets")}let u={selectedNodeIds:i,contextNodeIds:e.contextNodeIds??[],viewport:(0,ee.qc)(Q.Y5.getViewportInfo()),extraComponentGuids:d,enabledLibraryKeys:Array.from(t4),extraStyleIds:H,extraVariableIds:B},p=await eh(ed,eu,c,u);p.options.jsxSerializerOverrides.editorType??=(0,ei.y9)(S)??void 0;let h=ep.unwrapOr(null),g=h?.aiDataSharingEnabled?.status===D.tT.Loaded&&(h.aiDataSharingEnabled.data??!1),f=function({targetSelection:e,makeEditsOptions:t,makeEditsDebugSettings:s,selectedModelConfiguration:n,aiDataSharingEnabled:a}){if(e.length!==eB.REQUIRED_TARGET_SELECTION)return 0;let i=s?.options?.multipleOutputsRandomProbability;if(null!=i&&i>=0)return Math.random()<=i?eB.RANDOM_TRIGGER_OPTION_COUNT:0;let r=t.multipleOutputsRandomProbability;return void 0!==r&&!(r<=0)&&n.tags?.includes("1P")&&(a||(0,w.kc)().ai_assistant_multiple_options_no_data_share_check)&&Math.random()<=r?eB.RANDOM_TRIGGER_OPTION_COUNT:0}({targetSelection:i,makeEditsOptions:p.options,makeEditsDebugSettings:ed,selectedModelConfiguration:eu,aiDataSharingEnabled:g}),_=f>0?{...e,variants:f}:e;if(f>0&&(s.randomlyTriggered=!0),function({args:e,targetSelection:t}){let s=e.variants&&e.variants>1,n=t.length===eB.REQUIRED_TARGET_SELECTION;return!!(s&&n)}({args:{..._,config:p},targetSelection:i}))return eA({..._,config:p},s,"edit_design");try{if((0,w.kc)().assistant_cursor_ui){let e=E.zl.get(eT);r&&e.addNodes(i,r,(0,C.t)("ai_assistant.cursor.status.making_edits"))}let t=await (0,eo.nR)({params:{config:p,userInput:{userPrompt:e.instructions??""},inferredContext:u,contextPromise:void 0,setThinkingState:F.lQ,aiTrackingContext:{action:el.JT.MAKE_EDITS,source:o.lV.AI_ASSISTANT,quick_actions_session_id:"invalid",file_key:m,product_type:S,...s},trackingContext:s,debugContext:c},abortController:x});(0,w.kc)().assistant_cursor_ui&&E.zl.get(eT).removeNodes(i);let n=(t.createdTopLevelNodeGuids??[]).map(e=>({guid:e,name:j.UN().get(e)?.name}));return{image:t.image,selectedNodeIds:i,createdTopLevelNodes:n,imageCaption:"This is what the layer looks like now with the edits applied:",message:t.message||void 0}}catch(e){if(e instanceof v.C){let t=Error(e.payload.friendlyErrorMessage);throw t.name=e.name,t.stack=e.stack,t}throw e}}let W=(0,g.Eh)(e_.globalOptions),X=(0,d.E7)({toolInterface:g.zs,executeClientSide:(e,t)=>V((0,g.Yq)({options:e_.globalOptions,params:e}),t)}),et=new p({configurationKey:e_.configurationKey,globalOptions:e_.globalOptions,serverOptionDebugOverrides:e_.serverOptionDebugOverrides,serverOverridesOpaqueKey:e_.serverOverridesOpaqueKey,trackingContext:P,tools:{[g.It.name]:(0,d.E7)({toolInterface:g.It,executeClientSide:(e,t)=>eI(e,t,"select_layers")}),[g.t9.name]:(0,d.E7)({toolInterface:g.t9,executeClientSide:t9}),[g.U_.name]:(0,d.E7)({toolInterface:g.U_,executeClientSide:se}),[W.name]:X,[g.tE.name]:(0,d.E7)({toolInterface:g.tE,executeClientSide:t7}),[g.vb.name]:(0,d.E7)({toolInterface:g.vb,executeClientSide:async e=>await t8(e,x,t,i)}),[g.fm.name]:(0,d.E7)({toolInterface:g.fm,executeClientSide:async e=>await st(e)}),[g.LA.name]:(0,d.E7)({toolInterface:g.LA,executeClientSide:ss}),[g.T6.name]:(0,d.E7)({toolInterface:g.T6,executeClientSide:()=>Promise.resolve({visibleLibraries:Object.entries(t6).map(([e,t])=>({libraryKey:e,libraryName:t}))})}),[g.xX.name]:(0,d.E7)({toolInterface:g.xX,executeClientSide:sa})},clientDependencies:{streamResponse:e=>Y.Ay.shared.aiAssistantChat(e,{...(0,Z.sF)({clientLifecycleId:t}),persistentEntityId:i},{abortSignal:x.signal})},clientCallbacks:{trackEvent:e=>{let t={[c.LP.MESSAGE_SENT]:{modelSelection:JSON.stringify(eu),modelSelectionTags:JSON.stringify(eu.tags??[])}};I(`${O}.${e.name}`,{...P,...e.fields,...t[e.name]??{}})},handleError:e=>{(e instanceof _.OutdatedClientError||e instanceof f.G1&&("parse_request"===e.type||"Not found"===e.message))&&(q.J.addAction("ai_assistant.outdated_client_error",b.e.AI_ASSISTANT,l.$b.ERROR,{clientLifecycleId:t}),E.zl.set((0,ev.QK)(i),{error:Error(ev.T_.OUTDATED_CLIENT_ERROR),cortexClientGeneratedRequestUuid:t})),e instanceof f.G1&&"Aborted"===e.message||e instanceof v.C&&"omit"===e.payload.severity||(0,U.$D)(b.e.AI_ASSISTANT,e)},sloge:(e,t)=>(0,K.x1)(O,e,t),onUpdateThread:(e,t)=>{i&&(t?(i===tc&&e9(e),eR(e=>{let t=new Map(e);return t.set(i,[]),t}),(0,ej.VB)([])):eR(t=>{let s=new Map(t);return s.set(i,[...e]),s}))},tryUploadToolResultToBlobStore:s?R:void 0},persistedMessages:[]});if((0,w.kc)().assistant_cursor_ui){let e=E.zl.get(eT),t=(0,j.UN)();t&&a.length>0&&(e.addNodes(a,t,(0,C.t)("ai_assistant.cursor.status.getting_started")),e.removeNodes(a))}try{await et.sendMessage({newUserMessage:L,serverSideChatParams:r,metadata:{enabledLibraryKeys:Array.from(t4)}}),ef("track","ai_assistant_chat_message_sent",{featureEntrypoint:n,editorType:S})}finally{(0,ej.VB)([]),(0,w.kc)().assistant_cursor_ui&&E.zl.get(eT).stop(),(0,w.kc)().ai_assistant_force_savepoints&&eb($.Y({fileKey:m,clientLifecycleId:t,persistentEntityId:i}))}},[t4,t6,e_,G,m,t3,tI,to,t9,se,t7,ss,s,tF,tq,I,eI,ec.configurationKey,ec.options.allowMissingFonts,ec.options.useComponentsFromGlossary,ed,sa,eu,S,ep,sn,eA,eb,t8,st,tc,e9,ef]);i.useEffect(()=>{eV&&!tO&&("idle"===eD||"pendingCreation"===eD&&null===tc)&&(si(eV,"canvas"),e$(null))},[eV,eD,tO,tc,si,e$]);let sr=e=>{switch(e.type){case"user":case"system":return e.id;case"assistant":return e.messages[e.messages.length-1]?.id??""}},sl=(0,E.md)((0,ej.lK)(tc||t1)),{messagesForRendering:so,exchangeMessageIds:sc}=i.useMemo(()=>{let e={selectedOptionId:eB.DEFAULT_SELECTED_OPTION_ID,createOptionSelectionHandler:t0,startMultipleOptionsGeneration:tZ,resolveWithSelectedOption:t2},t=(t,s)=>(function({user:e,messages:t,pendingInteractiveTools:s,resolveInteractiveTool:n,currentSelectedNodeIds:a,annotateClientLifecycleIdForTracking:i,multipleOptionsContext:r,chatAtomKey:l,currentThreadId:c}){return(function(e){let t=[],s=[];for(let n of e)"user"===n.role&&n.clientId&&(t.push(s),s=[]),s.push(n);return t.push(s),t.filter(e=>e.length>0)})(t).flatMap((t,d)=>{let u=t[0];if(i&&(u?.role!=="user"||!u?.clientId))throw Error(`First message in a cook must be a user message with a clientId. Got a ${u?.role} message`);let x=u?.clientId??"unknown",m=u?.clientId||"",p=function(e){if(!e)return{optionsState:{isGenerating:!1,options:[],originalNodeId:null},workspace:null,hasUI:!1,selectedOptionId:eB.DEFAULT_SELECTED_OPTION_ID};let t=ej.wS.getWorkspace(e),s=(0,ej.Og)(e),n=eQ(t,E.zl.get(s)),a=n.options.length>0||n.isGenerating;return n&&Array.isArray(n.options)?{optionsState:n,workspace:t,hasUI:a,selectedOptionId:t?.selectedOptionId||eB.DEFAULT_SELECTED_OPTION_ID}:{optionsState:{isGenerating:!1,options:[],originalNodeId:null},workspace:null,hasUI:!1,selectedOptionId:eB.DEFAULT_SELECTED_OPTION_ID}}(m),h={current:!1};return t.flatMap((u,f)=>{let _=u.createdAtMs?.toString(),y=u.role,k=r?.createOptionSelectionHandler;switch(y){case"user":{let t=u.content.filter(e=>"text"===e.type).map(e=>e.text).join(""),s=u.content.filter(e=>"selected-node-ids"===e.type).flatMap(e=>e.selectedNodeIds);return[{type:"user",user:e,id:u.clientId??`converted-${f}-${d}`,uniqueId:(0,o.ob)(u),plainText:t,imports:void 0,inspectedElement:void 0,selectedNodeIds:s,libraryKey:void 0,sentAt64:_}]}case"assistant":return function({message:e,pendingInteractiveTools:t,currentSelectedNodeIds:s,resolveInteractiveTool:n,sentAt64:a,index:i,cookIndex:r,cookMessages:l,multipleOptionsContext:c,chatAtomKey:d,multipleOptionsRenderState:u,clientLifecycleId:x,createMultipleOptionsSelectionHandler:m,multipleOptionsUIAdded:p,isLastMessageInCook:h,annotateClientLifecycleIdForTracking:f,currentThreadId:_,messageId:y}){let k=[],v=e.content.filter(e=>"reasoning"===e.type).map(e=>e.text).join("");v.length>0&&!e.content.filter(e=>"tool-call"===e.type).some(e=>(function(e,t){if("edit_design"!==e.toolName)return!1;let s=t.get(e.toolCallId);return s&&s.args.variants>1})(e,t))&&k.push({type:"reasoning",reasoning:v,id:`reasoning-${i}-${r}`,sentAt64:a});let b=e.content.filter(e=>"text"===e.type).map(e=>e.text).join(""),j=e.content.filter(e=>"tool-call"===e.type).find(e=>"select_layers"===e.toolName),C=e.content.filter(e=>"tool-call"===e.type).find(e=>"edit_design"===e.toolName),w=e.content.filter(e=>"tool-call"===e.type).find(e=>e.toolName===g.fm.name);if(j){let e=t.get(j.toolCallId)?{type:"selectionRequest",message:b,selectedNodeIds:s??void 0,onContinue:e=>{(0,ej.VB)(e),n(j.toolCallId,{selectedLayerIds:e,message:e.length>0?`User has selected ${e.length} layer(s): ${e.join(", ")}. Please proceed with the original request.`:"User clicked continue but no layers are currently selected."})},id:j.toolCallId,sentAt64:a}:null;e&&k.push(e)}else if(C){let e=t.get(C.toolCallId);if(e?.args.missingFontsInfo)k.push({type:"missingFontsResolution",message:b,onContinue:()=>{n(C.toolCallId,{success:!0,message:"User chose to continue with make edits despite missing fonts."})},id:C.toolCallId});else{let t=e0({messageId:y,isArtifact:!1,textContent:b,renderState:u,editDesignToolCall:{toolCallId:C.toolCallId,isPending:!!e},messageIndex:i,createOptionSelectionHandler:m,onContinue:c&&c.resolveWithSelectedOption?()=>{c&&c.resolveWithSelectedOption&&c.resolveWithSelectedOption({clientLifecycleId:x,toolCallId:C.toolCallId,resolveInteractiveTool:n,threadId:_||""})}:void 0}),s=p&&p.current?t.content.filter(e=>"multipleOptions"!==e.type):t.content;k.push(...s),t.content.some(e=>"multipleOptions"===e.type&&!!e.onContinue)&&(p.current=!0),t.shouldStartGeneration&&e1(t.toolCallIdForGeneration||C.toolCallId,x,c?.startMultipleOptionsGeneration,d)}}else if(w){let e=function(e,t,s,n,a){let i=t.get(e.toolCallId);return i?{type:"exportAssets",id:e.toolCallId,message:s,onContinue:()=>{n(e.toolCallId,{message:"The user was shown an export dialog for their assets."})},sentAt64:a,...i.args}:null}(w,t,b,n,a);e&&k.push(e)}else if(b){let e=e0({isArtifact:!1,textContent:b,renderState:u,editDesignToolCall:void 0,messageIndex:i,createOptionSelectionHandler:m,onContinue:F.lQ,messageId:`multiple-options-${i}-${r}`}),t=e.content.filter(e=>"multipleOptions"!==e.type);if(k.push(...t),e.shouldStartGeneration){let t=e.toolCallIdForGeneration||function(e){if(!e)return;let t=(0,ej.KP)(e);for(let[e,s]of E.zl.get(t).entries())if("edit_design"===s.toolName&&s.args?.variants>1)return e}(x);t&&e1(t,x,c?.startMultipleOptionsGeneration,d)}}e.content.filter(e=>"tool-call"===e.type).forEach((e,s)=>{let n=t.get(e.toolCallId);n&&(0,tt.p$)(e.toolName,n.args)||k.push({type:"toolCall",name:e.toolName,id:`toolCall-${i}-${r}-${s}`,sentAt64:a})}),b&&0===k.length&&k.push({type:"plan",plan:b,title:"Plan",id:`plan-${i}-${r}`,sentAt64:a});let N=e.content.filter(e=>"tool-call"===e.type).find(e=>e.toolName===g.xX.name);if(N){let e=function(e,t,s,n,a,i){try{let r=JSON.parse(e.argsJSON).code||"";if(r){let l;for(let n=s+1;n<t.length;n++){let s=t[n];if(s&&"tool"===s.role){let t=s.content.find(t=>"tool-result"===t.type&&t.toolCallId===e.toolCallId);if(t&&"tool-result"===t.type){l=t.resultJSON;break}}}return{type:"pluginCode",code:r,isCodeComplete:!!l,toolResult:l,id:`plugin-code-${n}-${a}`,sentAt64:i}}}catch(e){console.warn("Failed to parse executePluginCode args:",e)}return null}(N,l,i,i,r,a);e&&k.push(e)}return[{type:"assistant",messages:k,clientLifecycleId:h&&f?x:void 0,uniqueId:(0,o.ob)(e),sentAt64:a}]}({message:u,pendingInteractiveTools:s,currentSelectedNodeIds:a,resolveInteractiveTool:n,sentAt64:_,index:f,cookIndex:d,cookMessages:t,multipleOptionsContext:r,chatAtomKey:l,multipleOptionsRenderState:p,clientLifecycleId:m,createMultipleOptionsSelectionHandler:k,multipleOptionsUIAdded:h,isLastMessageInCook:f===t.length-1,annotateClientLifecycleIdForTracking:i,currentThreadId:c,messageId:x});case"system":{let e=u.content.filter(e=>"text"===e.type).map(e=>e.text).join("");return[{type:"system",id:`${x}-converted-${f}-${d}`,uniqueId:(0,o.ob)(u),systemMessageType:"generic",plainText:e,title:void 0,sentAt64:_}]}case"tool":{let e=function(e){let t=e.content.find(e=>"tool-result"===e.type);if(!t)return null;let s=JSON.parse(t.resultJSON??"{}");return{selectedOptionThumbnailUrl:s?.selectedOptionThumbnailUrl??"",selectedOptionId:s?.selectedOptionId??""}}(u);if(e){let s=[],n=f===t.length-1;return s.push(...e0({messageId:x,messageIndex:f,isArtifact:!0,selectedOptionThumbnailUrl:e.selectedOptionThumbnailUrl,selectedOptionId:e.selectedOptionId}).content),[{type:"assistant",messages:s,clientLifecycleId:n&&i?m:void 0,uniqueId:(0,o.ob)(u),sentAt64:_}]}return[]}default:throw Error(`Unknown message role: ${y}`)}})})})({user:x,messages:t,pendingInteractiveTools:eS,resolveInteractiveTool:eM,currentSelectedNodeIds:G,annotateClientLifecycleIdForTracking:s,multipleOptionsContext:e,chatAtomKey:tS,currentThreadId:e6}),s=t(tr()||[],!0),n=t(tl(),!1);return{messagesForRendering:[...s,...n],exchangeMessageIds:new Set(n.map(e=>sr(e)))}},[x,tr,tl,G,eS,eM,t0,tZ,tS,sl,t2,e6]);i.useEffect(()=>{let e=!tN.current;tN.current=(0,N.g)(),e&&M.az.trackDefinedEvent("ai_assistant.assistant_chat_opened",{clientLifecycleId:tN.current,featureEntrypoint:"left_panel"})},[e6]);let{FirstPartyExplanationPointer:sd}=(0,eg.i7)(!0,"code_chat_message_container");return i.useEffect(()=>{"shouldCreate"===eD&&(eq("pendingCreation"),eR(new Map),tI(""),eJ(null))},[eD,eq,tI,eJ]),i.useEffect(()=>{e8(tc)},[tc,e8]),i.useEffect(()=>{eX&&eX!==tc&&(tu(eX),tI(""),eq("idle"),eJ(null))},[eX,tc,tu,tI,eq,eJ]),!function({fileKey:e,selectedNodeIds:t,threadId:s,setThreadId:n,setInput:a,setNewChatTrigger:r}){let l=(0,w.kc)().assistant_threading_prototype??!1,[o,c]=i.useState(null);i.useEffect(()=>{if(!l||!e)return;let i=function(e){if(0===e.length)return"global";let t=(0,j.UN)();if(!t)return null;let s=new Set;for(let n of e){let e=(0,e2.E6)(t,n);e&&s.add(e.guid)}return s.size>1?"global":1===s.size?Array.from(s)[0]??null:"global"}(t);if(!i)return;let o=(0,e3.dG)(),d=`${e}:${i}`,u=o[d];u&&u!==s?(n(u),a(""),r("idle")):u||(c(d),r("shouldCreate"))},[l,e,t,s,n,a,r]),i.useEffect(()=>{if(!l||!s||!o)return;let e=(0,e3.dG)();if(!Object.entries(e).find(([e,t])=>t===s&&e!==o)&&!e[o]){let t={...e,[o]:s};(0,e3.xI)(t)}c(null)},[l,s,o])}({fileKey:m,selectedNodeIds:G??[],threadId:tc,setThreadId:tu,setInput:tI,setNewChatTrigger:eq}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ek.r,{canCancelGeneration:tR,chatBoxLeftExtraContent:(0,w.kc)().ai_assistant_ds_library_selector?(0,a.jsx)(ts.V,{isOpen:eE,onOpenChange:eN,featureEntrypoint:"left_panel"},"library-dropdown"):null,chatBoxRightExtraContent:[(0,a.jsx)(tn.Y,{},"model-picker")],chatMessagesNodeGuid:tS,clientLifecycleIdMap:t5,codeFileChanges:void 0,codeInstanceGuid:null,emptyState:(0,a.jsx)(eF,{onPromptSelect:tI,hasSelection:null!==G&&G.length>0,clientLifecycleId:tN.current}),exchangeMessageIds:sc,featureType:o.lV.AI_ASSISTANT,generationInProgress:tR,messagesForRendering:so,sendDisabled:tP,sendMessage:async e=>{let t=!(so.length>0)&&tN.current||(0,N.g)();await si({userInput:e,clientLifecycleId:t},"left_panel")},setInput:tI,showCodeStreaming:!1}),(0,a.jsx)(sd,{})]})}},396609:(e,t,s)=>{s.d(t,{s:()=>u});var n=s(105652),a=s(22291),i=s(445019),r=s(798254),l=s.n(r),o=s(850465),c=s(223487),d=s(119347);function u(){let e=(0,d.$)(),t="loading"===e.status,s="errors"===e.status,r=n.useMemo(()=>e.data??[],[e.data]),u=n.useMemo(()=>new Set(r.map(e=>e.library_key)),[r]),[x,m]=(0,i.fp)(o.Om),p=(0,c.tS)()??"unknown",h=n.useMemo(()=>x?.[p??""]??{},[x,p]),g=n.useMemo(()=>new Set(Object.entries(h).filter(([e,t])=>t&&u.has((0,a.l)(e))).map(([e,t])=>(0,a.l)(e))),[h,u]),f=n.useCallback(e=>{m(t=>l()({},t,{[p]:{[e]:!0}}))},[p,m]),_=n.useCallback(e=>{m(t=>l()({},t,{[p]:{[e]:!1}}))},[p,m]),y=n.useMemo(()=>r.reduce((e,t)=>(e[t.library_key]=t.library_name,e),{}),[r]);return n.useMemo(()=>({enabledLibraries:h,enabledLibraryKeys:g,enableLibrary:f,disableLibrary:_,subscribedLibraryKeys:u,subscribedLibraries:r,libraryKeyToName:y,isLoading:t,hasError:s}),[h,g,f,_,u,r,y,t,s])}},522935:(e,t,s)=>{s.d(t,{S9:()=>k});var n=s(105652),a=s(20002),i=s(787049),r=s(449979),l=s(104626),o=s(207474),c=s(270450),d=s(979769),u=s(422572),x=s(28083),m=s(710625),p=s(994047),h=s(244735),g=s(5618),f=s(396609);let _=["FILL","EFFECT","TEXT","GRID"],y=({k:e,styleType:t,libraryKeys:s})=>({library_keys:s,entity_type:"STYLE",entity_value_type:t,max_results_per_library:e});function k({k:e=50,enabled:t}){let s=(0,p.je)(),{enabledLibraryKeys:c}=(0,f.s)(),h=(0,d.wm)(()=>s.data?.filter(e=>c.has(e.libraryKey))??[],[c,s.data]);(0,m.Bh)(h);let{isLoading:k,styles:b}=function({k:e,enabled:t,enabledLibraryKeys:s}){let a=(0,d.wm)(()=>Array.from(s),[s]),i=(0,d.k9)(()=>_.map(t=>y({k:e,styleType:t,libraryKeys:a})),[e,a]),[l,o]=n.useState(()=>i.map(e=>(0,g.kk)(e).cachedValue)),c=l.every(r.Vq);return n.useEffect(function(){0!==a.length&&!c&&t&&Promise.all(i.map(g.kA)).then(e=>{o(e)})},[e,a,i,c,t]),(0,d.k9)(()=>({isLoading:!c&&t,styles:l.filter(r.Vq)}),[c,t,l])}({k:e,enabled:t,enabledLibraryKeys:c}),j=n.useMemo(()=>(function(e,t){let s=[],n=new Set;if(t)return s;for(let t of e)for(let[e,a]of t.entries())for(let e of a){let t=(0,o.n3)(e);n.has(t)||s.push(t),n.add(t)}return s})(b,k),[b,k]),C=v({styleType:"FILL",topKStyleKeys:j,k:e,enabledLibraries:h}),w=v({styleType:"EFFECT",topKStyleKeys:j,k:e,enabledLibraries:h}),E=v({styleType:"TEXT",topKStyleKeys:j,k:e,enabledLibraries:h}),N=(0,d.k9)(()=>{let e=[C,w,E];return e.some(e=>"loading"===e.status)||!t?[]:e.map(e=>e.topKStyles).flat()},[C,w,E,t]);n.useEffect(function(){if(t)for(let e of N)x.Eo.getCanvas(e)},[t,N]);let S=(0,a.wA)(),T=n.useCallback(async()=>{if(!k&&t)return await Promise.all(N.map(e=>S((0,u.RT)(e)))),(0,i.RP)(N,e=>e.content_hash?l.PK.fromRef({key:e.key,version:(0,o.IA)(e.content_hash)}):null)},[S,t,k,N]);return n.useMemo(()=>({topKStyles:N,isLoading:k,maybeAddTopKStylesToInternalCanvas:T}),[k,T,N])}function v({styleType:e,topKStyleKeys:t,k:s,enabledLibraries:n}){let{status:a,stylesByFileKey:r}=(0,h.Zk)({styleType:e,initialSelectedSubscribedStyle:null,selectedLibraries:n,forceSelectedLibraries:!0}),l=function({allStyles:e,topKStyleKeys:t,k:s}){if(t.length>0){let n=Object.fromEntries(e.map(e=>[e.key,e])),a=t.map(e=>n[e]).filter(e=>!!e);if((0,c.kc)().ai_assistant_top_k_styles_fallback){let n=e.filter(e=>!t.includes(e.key));for(let e of((0,i.KQ)(n,"name"),n)){if(a.length>=s)break;a.push(e)}}return a}return(0,c.kc)().ai_assistant_top_k_styles_fallback?((0,i.KQ)(e,"name"),e.slice(0,s)):[]}({allStyles:Object.values(r).map(({styles:e})=>e).flat(),topKStyleKeys:t,k:s});return(0,d.k9)(()=>({status:a,stylesByFileKey:r,topKStyles:l}),[a,r,l])}},347012:(e,t,s)=>{s.d(t,{p:()=>k});var n=s(105652),a=s(20002),i=s(787049),r=s(449979),l=s(104626),o=s(854225),c=s(445019),d=s(979769),u=s(422572),x=s(28083),m=s(565039),p=s(994047),h=s(5618),g=s(842708),f=s(396609);let _=["COLOR","FLOAT","STRING","BOOLEAN"],y=({k:e,resolvedType:t,libraryKeys:s})=>({library_keys:s,entity_type:"VARIABLE",entity_value_type:t,max_results_per_library:e});function k({k:e=100,enabled:t}){let s=(0,p.je)(),{enabledLibraryKeys:c,isLoading:m}=(0,f.s)(),g=(0,d.wm)(()=>s.data?.filter(e=>c.has(e.libraryKey))??[],[c,s.data]),{isLoading:k,variables:b}=function({k:e,enabled:t,enabledLibraryKeys:s}){let a=(0,d.wm)(()=>Array.from(s),[s]),i=(0,d.k9)(()=>_.map(t=>y({k:e,resolvedType:t,libraryKeys:a})),[e,a]),[l,o]=n.useState(()=>i.map(e=>(0,h.kk)(e).cachedValue)),c=l.every(r.Vq);return n.useEffect(function(){0!==a.length&&!c&&t&&Promise.all(i.map(h.kA)).then(e=>{o(e)})},[e,a,i,c,t]),(0,d.k9)(()=>({isLoading:!c&&t,variables:l.filter(r.Vq)}),[c,t,l])}({k:e,enabled:t,enabledLibraryKeys:c}),j=m||k,C=n.useMemo(()=>(function(e,t){let s=new Set;if(t)return s;for(let t of e)for(let[e,n]of t.entries())for(let e of n)s.add(e);return s})(b,j),[b,j]),w=v({resolvedType:o.rXF.FLOAT,topKVariableKeys:C,k:e,enabledLibraries:g}),E=v({resolvedType:o.rXF.COLOR,topKVariableKeys:C,k:e,enabledLibraries:g}),N=v({resolvedType:o.rXF.STRING,topKVariableKeys:C,k:e,enabledLibraries:g}),S=v({resolvedType:o.rXF.BOOLEAN,topKVariableKeys:C,k:e,enabledLibraries:g}),T=(0,d.k9)(()=>{let e=[w,E,N,S];return e.some(e=>"loading"===e.status)||!t?[]:e.map(e=>e.topKVariables).flat()},[w,E,N,S,t]);n.useEffect(function(){if(t)for(let e of T)x.Eo.getCanvas(e)},[t,T]);let I=(0,a.wA)(),A=n.useCallback(async()=>{if(!j&&t)return await Promise.all(T.map(e=>I((0,u.Oe)(e)))),(0,i.RP)(T,e=>l.sD.fromString(e.node_id))},[I,t,j,T]);return n.useMemo(()=>({topKVariables:T,isLoading:j,maybeAddTopKVariablesToInternalCanvas:A}),[j,A,T])}function v({resolvedType:e,topKVariableKeys:t,k:s,enabledLibraries:a}){let{status:r,variablesByLibraryKey:l}=function({resolvedType:e,selectedLibraries:t}){let s=n.useMemo(()=>t.map(e=>e.libraryKey).sort(),[t]),a=(0,c.md)((0,g.Ho)(s)),i={};if(Object.values(a).some(e=>"loaded"!==e.status))return{status:"loading",variablesByLibraryKey:i};for(let[t,s]of Object.entries(a))i[t]=(0,m.q0)(s,!1).filter(t=>t.resolvedType===e);return{status:"loaded",variablesByLibraryKey:i}}({resolvedType:e,selectedLibraries:a}),o=function(e,t,s){let n=Object.values(e).reduce((e,t)=>(e.push(...t),e),[]);if(!(t.size>0))return(0,i.KQ)(n,"name"),n.slice(0,s);{let e=n.filter(e=>t.has(e.key)),a=n.filter(e=>!t.has(e.key));for(let t of((0,i.KQ)(a,"name"),a)){if(e.length>=s)break;e.push(t)}return e}}(l,t,s);return(0,d.k9)(()=>({status:r,variablesByLibraryKey:l,topKVariables:o}),[r,l,o])}},820857:(e,t,s)=>{s.d(t,{RG:()=>o,p$:()=>l});var n=s(105652),a=s(471348),i=s(445019),r=s(850465);function l(e,t){return!!("select_layers"===e||e===a.fm.name||"edit_design"===e&&t?.missingFontsInfo)||!!("edit_design"===e&&t?.variants>1)}function o(e){let[t,s]=(0,i.fp)((0,r.KP)(e));return{pendingInteractiveTools:t,showInteractiveTool:(e,t,n)=>{let a=t.clientLifecycleId,l=(0,r.KP)(a);return i.zl.set(l,s=>{let a=new Map(s);return a.set(t.toolCallId,{toolName:n||"unknown",args:e,trackingContext:t}),a}),new Promise(a=>{s(s=>new Map(s).set(t.toolCallId,{toolName:n||"unknown",args:e,resolve:a,trackingContext:t}))})},showAutoResolvingTool:(e,t,n)=>{let a=t.clientLifecycleId,l=(0,r.KP)(a);return i.zl.set(l,s=>{let a=new Map(s);return a.set(t.toolCallId,{toolName:n||"unknown",args:e,trackingContext:t}),a}),new Promise(a=>{s(s=>new Map(s).set(t.toolCallId,{toolName:n||"unknown",args:e,resolve:a,trackingContext:t,autoResolve:!0}))})},resolveInteractiveTool:(e,t)=>{s(s=>{let n=s.get(e);if(n&&n.resolve){n.resolve(t);let a=new Map(s);a.delete(e);let l=n.trackingContext.clientLifecycleId;if(l){let t=(0,r.KP)(l);i.zl.set(t,t=>{let s=new Map(t);return s.delete(e),s})}return a}return s})},cancelInteractiveTool:e=>{s(t=>{let s=t.get(e);if(s&&s.resolve){s.resolve({message:"Cancelled"});let n=new Map(t);return n.delete(e),n}return t})},getPersistedTools:n.useCallback(e=>{let t=(0,r.KP)(e);return i.zl.get(t)},[])}}},672328:(e,t,s)=>{s.d(t,{V:()=>R});var n=s(239976),a=s(105652),i=s(20002),r=s(796557),l=s(320598),o=s(179189),c=s(379141),d=s(875253),u=s(536378),x=s(396609),m=s(931547),p=s(517478),h=s(943360),g=s(135487),f=s(288350),_=s(942356),y=s(254056),k=s(445019),v=s(323264),b=s(723850),j=s(585066),C=s(198548),w=s(308251),E=s(421564),N=s(747079),S=s(267447),T=s(16475),I=s(274412);function A({library:e,isEnabled:t,onToggle:s}){let a=(0,k.md)(I.TG);return(0,n.jsxs)(h.E,{className:v.xW(P.libraryListItem),onClick:()=>s(e.library_key,!t),"aria-label":t?(0,c.t)("ai_assistant.library.disable",{libraryName:e.library_name}):(0,c.t)("ai_assistant.library.enable",{libraryName:e.library_name}),children:[(0,n.jsx)("div",{className:"x186iv6y",children:(0,n.jsx)(T.D,{thumbnailUrl:e.thumbnail_url,coverThumbnail:!1,name:e.library_name})}),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1iyjqo2 xeuugli",children:[(0,n.jsx)("span",{className:"xuzfeq1 x8yk33q x1e00guj x18zpg43 x22v61l x1akne3o xb3r6kr xlyipyv xuxw1ft xxk0z11",children:e.library_name}),(0,n.jsx)("span",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9 xb3r6kr xlyipyv xuxw1ft",children:"team"===e.library_type?e.team_name??e.workspace_name??null:a.has(e.library_key)?(0,c.t)("community.detail_view.ui_kit"):(0,c.t)("community.community")})]}),(0,n.jsx)(g.d,{checked:t,onChange:t=>s(e.library_key,t),label:(0,n.jsx)(f.h,{children:`Toggle ${e.library_name}`})})]},e.library_key)}function M(){return(0,n.jsx)("div",{className:"x78zum5 xl56j7k x6s0dn4 x1iyjqo2",children:(0,n.jsx)(j.k,{})})}function z({onReload:e}){return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x6s0dn4 xl56j7k x1i71x30 xvwx85 x1dao9b2 x2b8uid x1iyjqo2",children:[(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xg2d0mh x6s0dn4",children:[(0,n.jsx)("div",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x1akne3o",children:(0,c.t)("ai_assistant.library.error_loading_libraries")}),(0,n.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,c.t)("ai_assistant.library.error_body")})]}),(0,n.jsx)(_.$n,{variant:"secondary",onClick:e,children:(0,c.t)("ai_assistant.library.reload")})]})}function L({onExploreLibraries:e}){return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x6s0dn4 xl56j7k x1i71x30 xvwx85 x1dao9b2 x2b8uid x1iyjqo2",children:[(0,n.jsx)("div",{className:"xon4yw5 xn0whsw x19y5rnk xeq5yr9",children:(0,n.jsx)(o.l,{})}),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xg2d0mh x6s0dn4",children:[(0,n.jsx)("div",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x1akne3o",children:(0,c.tx)("design_systems.assets_panel.empty_state_title_ui3")}),(0,n.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,c.tx)("design_systems.assets_panel.empty_state_subtitle_ui3")}),(0,n.jsx)(y.N,{newTab:!0,trusted:!0,href:"https://help.figma.com/hc/articles/360038662654",children:(0,c.tx)("design_systems.assets_panel.learn_more")})]}),(0,n.jsx)(_.$n,{onClick:e,children:(0,c.tx)("design_systems.assets_panel.empty_state_cta_ui3")})]})}let O=(0,N.Ju)(function({defaultPosition:e,onCloseCallback:t,onEnableLibrary:s,onDisableLibrary:r,featureEntrypoint:l}){let o=(0,i.wA)(),d=(0,b.hC)(),h=(0,i.d4)(e=>e.modalShown),g=(0,i.d4)(e=>e.userFlags),f=(0,i.d4)(e=>e.fonts),{enabledLibraryKeys:_,enableLibrary:y,disableLibrary:k,subscribedLibraries:v,isLoading:j,hasError:N}=(0,x.s)(),{onToggleLibraryModal:T}=(0,w.u)({entrypoint:S.r6.QUICK_ACTION,modalType:"editor",initialTab:E.Wv.TEAM_LIBRARIES}),I=a.useCallback(async(e,t)=>{t?await (0,C.RJ)(o,e,C.jE.LOAD_COMPONENT,g,f)&&(y(e),s(e)):(k(e),r(e)),d("ai_assistant.ds_selector_library_toggled",{isEnabled:t,featureEntrypoint:l,libraryKey:e})},[o,f,g,y,k,s,r,l,d]),O=a.useCallback(()=>{t?.(),o((0,u.AS)())},[o,t]),P=a.useCallback(()=>{h&&(o((0,u.AS)()),setTimeout(()=>{o((0,u.to)({...h,type:{type:h.type}}))}))},[o,h]),R=a.useCallback(()=>{O(),T()},[O,T]);return(0,n.jsx)(m.bL,{defaultPosition:e,width:340,maxHeight:340,onClose:O,children:(0,n.jsxs)(p.vo,{children:[(0,n.jsx)(p.Y9,{children:(0,n.jsx)(p.hE,{children:(0,c.tx)("ai_assistant.library.title")})}),(0,n.jsx)(p.nB,{padding:0,children:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1nfngrj xwfx9td xh8yej3 x9f619 xf7z5ut",children:[j&&(0,n.jsx)(M,{}),N&&(0,n.jsx)(z,{onReload:P}),!j&&!N&&(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xg2d0mh x1iyjqo2",children:0===v.length?(0,n.jsx)(L,{onExploreLibraries:R}):v.map(e=>(0,n.jsx)(A,{library:e,isEnabled:!!_?.has(e.library_key),onToggle:I},e.library_key))})]})})]})})},"AIAssistantLibrarySelectorModal",N.ZU.YES),P={libraryListItem:{k1xSpc:"x78zum5",kGNEyG:"x6s0dn4",kOIVth:"x1i71x30",khm7nJ:null,k1C7PZ:null,kmVPX3:"xf7z5ut",kg3NbH:null,kuDDbn:null,kE3dHu:null,kP0aTx:null,kpe85a:null,k8WAf4:null,kLKAdn:null,kGO01o:null,kWkggS:"x1yjdb4r xv2f06h",kaIpWk:"x19y5rnk",krdFHd:null,kfmiAY:null,kVL7Gh:null,kT0f0o:null,kIxVMA:null,ksF3WI:null,kqGeR4:null,kYm2EN:null,kzqmXN:"xh8yej3",k7Eaqz:"xeuugli",kB7OPa:"x9f619",kkrTdU:"xt0e3qv",$$css:!0}};function R({isOpen:e,onOpenChange:t,featureEntrypoint:s}){let m=a.useRef(null),p=(0,i.wA)(),{enabledLibraryKeys:h,enableLibrary:g,disableLibrary:f,subscribedLibraryKeys:_}=(0,x.s)(),y=_?.size>0,k=h?.size??!1,v=y&&k?l.r:o.l;return(0,n.jsx)("div",{ref:m,children:(0,n.jsx)(r.d,{"aria-label":(0,c.t)("sites.modal.select_library"),"aria-expanded":e,"aria-haspopup":"menu",onClick:()=>{let n=m.current;if(!n)return;if(e){p((0,u.AS)()),t(!1);return}let a=n.getBoundingClientRect(),i=new d.Mi(a.left,a.top);t(!0),p(u.to({type:O,data:{defaultPosition:{left:i.x,bottom:window.innerHeight-i.y+12},onEnableLibrary:g,onDisableLibrary:f,onCloseCallback:()=>{t(!1)},featureEntrypoint:s}}))},children:(0,n.jsx)(v,{})})})}},445059:(e,t,s)=>{s.d(t,{Y:()=>E});var n=s(239976),a=s(105652),i=s(245838),r=s(943735),l=s(795205),o=s(796557),c=s(177102),d=s(751543),u=s(379141),x=s(270450),m=s(445019);s(323264);var p=s(723850),h=s(348149),g=s(409084),f=s(562418),_=s(914750),y=s(362844),k=s(850465);let v=a.lazy(()=>s.e(7723).then(s.bind(s,997723)));function b({onClose:e}){return(0,n.jsx)(a.Suspense,{fallback:null,children:(0,n.jsx)(v,{onClose:e})})}var j=s(964665);function C(e,t){return(0,g.Yd)(e,t)}function w({ariaLabel:e}){let{isOpen:t}=l.WM(),[s]=(0,_.BZ)(),a=!!(0,x.kc)().make_edits_debug&&null!==s;return(0,n.jsx)(l.l9,{id:"model-picker-trigger",...{0:{className:"x78zum5 x6s0dn4 xg2d0mh x1pshirs xmkeg23 x1y0btm7 x9r1u3d x1kogg8i x9f619"},1:{className:"x78zum5 x6s0dn4 xg2d0mh x1pshirs xmkeg23 x1y0btm7 x1kogg8i x9f619 x1mt81i5 xcsr5xj x1bk3zrz x1qn31il"}}[!!a<<0],"aria-label":e,children:(0,n.jsx)(o.d,{"aria-label":(0,u.t)("ai_assistant.model_picker.select_ai_model"),children:(0,n.jsx)(d.P,{}),"aria-expanded":t})})}function E(){let e=(0,f.E3)(),t=(0,m.Xr)(k.Si),s=(0,m.Xr)(_.eb),l=(0,m.md)(k.yq),o=(0,p.hC)(),d=!!(0,x.kc)().make_edits_debug,[v,E]=a.useState(!1),N=a.useRef(l.productString);a.useEffect(()=>{N.current=l.productString},[l.productString]);let S=(0,h.gP)("make_edits_global_configuration"),T=(0,i._C)(S.value,e?(0,y.xq)(e):void 0);if(T.length<=1&&!d)return null;let I=l.productString,A=C(l.productString,l.productStringEnglishFallback);return(0,n.jsxs)("div",{className:"x1n2onr6 x2lah0s",children:[(0,n.jsxs)(c.Root,{value:I,onChange:e=>{if(e===j._l){E(!0);return}let n=T.find(t=>t.productString===e);n&&(o("ai_assistant.model_selected",{selectedModel:n.productString,selectedModelLabel:C(n.productString,n.productStringEnglishFallback),previousModel:N.current,isDefault:n.default,featureEntrypoint:"left_panel"}),s(null),n.default?t(void 0):t({key:n.productString}))},placement:"bottom-start",customMiddleware:[(0,r.cY)({alignmentAxis:-8}),(0,r.UU)({padding:{top:12,bottom:12,left:8,right:8}}),(0,r.BN)({padding:{top:12,bottom:12,left:8,right:8}}),(0,r.Ej)({apply({rects:e,availableWidth:t,elements:s}){Object.assign(s.floating.style,{minWidth:`${e.reference.width+16}px`,maxWidth:`${t}px`})},padding:{top:12,bottom:12,left:8,right:8}})],children:[(0,n.jsx)(w,{ariaLabel:A}),(0,n.jsxs)(c.Container,{children:[(0,n.jsx)(c.Group,{title:(0,n.jsx)(c.Title,{children:(0,u.t)("ai_assistant.model_picker.select_ai_model")}),children:T.map(e=>{let t=e.description||e.descriptionEnglishFallback?(0,g.Yd)(e.description,e.descriptionEnglishFallback||""):null;return(0,n.jsx)(c.Option,{value:e.productString,children:(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xg2d0mh x1mh6rdz",children:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf",children:[(0,n.jsx)("div",{children:C(e.productString,e.productStringEnglishFallback)}),t&&(0,n.jsx)("div",{className:"xfifm61 x1n0bwc9 xo0entv",children:t})]})})},e.productString)})}),d&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Separator,{}),(0,n.jsx)(c.Option,{value:j._l,children:(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xg2d0mh x1mh6rdz",children:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf",children:[(0,n.jsx)("div",{children:(0,u.t)("assistant.debug_settings.dropdown.title")}),(0,n.jsx)("div",{className:"xfifm61 x1n0bwc9 xo0entv",children:(0,u.t)("assistant.debug_settings.dropdown.description")})]})})},j._l)]})]})]}),d&&v&&(0,n.jsx)(b,{onClose:()=>E(!1)})]})}},502527:(e,t,s)=>{s.d(t,{ZG:()=>o,dG:()=>r,xI:()=>l});var n=s(692376),a=s(270450);let i="ai_assistant_frame_thread_mapping";function r(){try{let e=localStorage.getItem(i);return e?JSON.parse(e):{}}catch(e){return console.warn("Failed to read frame-to-thread mapping from localStorage:",e),{}}}function l(e){try{localStorage.setItem(i,JSON.stringify(e))}catch(e){console.warn("Failed to save frame-to-thread mapping to localStorage:",e)}}function o(e,t){if((0,a.kc)().assistant_threading_prototype&&t)try{let s=r(),a=Object.entries(s).find(([t,s])=>s===e)?.[0];if(a){let e=a.replace(`${t}:`,"");if(e.length===a.length)return;e&&"global"!==e&&n.glU?.panToNode(e,!0)}}catch(e){console.warn("Failed to select associated frame for thread:",e)}}},428217:(e,t,s)=>{s.d(t,{O5:()=>c,QZ:()=>o,W3:()=>x,aG:()=>l,gl:()=>r,kt:()=>d,mk:()=>u,xi:()=>i});var n=s(445019),a=s(861241),i=(e=>(e.OVERVIEW="OVERVIEW",e.CREATE_REQUEST_SELECT_ASSETS="CREATE_REQUEST_SELECT_ASSETS",e.CREATE_REQUEST_ADD_DETAILS="CREATE_REQUEST_ADD_DETAILS",e.ACTIVE_REQUEST="ACTIVE_REQUEST",e.REVIEW_ASSET="REVIEW_ASSET",e))(i||{});let r=(0,n.eU)({type:"OVERVIEW"}),l=(0,n.eU)(new Set),o=(0,n.eU)(""),c=(0,n.eU)((0,a.Rs)()),d=(0,n.eU)(""),u=(0,n.eU)(null),x=(0,n.eU)(!0)},264629:(e,t,s)=>{s.d(t,{E0:()=>k,Ie:()=>v,KW:()=>E,Tc:()=>_,Xn:()=>h,hL:()=>p,mX:()=>j,mk:()=>y,oA:()=>C,rf:()=>S,uw:()=>b,wL:()=>g,wX:()=>w});var n=s(105652),a=s(692376),i=s(854225),r=s(466082),l=s(445019),o=s(605985),c=s(456556),d=s(955869),u=s(182793),x=s(861241),m=s(428217);function p(e){switch(e){case m.xi.OVERVIEW:return"Reviews & Approvals";case m.xi.ACTIVE_REQUEST:return"Active review";case m.xi.CREATE_REQUEST_SELECT_ASSETS:case m.xi.CREATE_REQUEST_ADD_DETAILS:return"Request review";case m.xi.REVIEW_ASSET:return"Review request";default:return"Reviews & Approvals"}}function h(e,t){switch(e){case m.xi.CREATE_REQUEST_SELECT_ASSETS:t({type:m.xi.OVERVIEW});break;case m.xi.CREATE_REQUEST_ADD_DETAILS:t({type:m.xi.CREATE_REQUEST_SELECT_ASSETS});break;case m.xi.REVIEW_ASSET:t({type:m.xi.ACTIVE_REQUEST});break;default:throw Error(`Invalid back button click on Approvals view: ${e}`)}}function g(e){switch(e){case i.z34.IN_REVIEW:return"In review";case i.z34.APPROVED:return"Approved";case i.z34.CHANGES_REQUESTED:return"Needs iteration";default:return"No status"}}function f(e,t){return e.map(e=>{let s=(0,r.UN)().get(e);if(!s||!a.Vzr)return null;let n=null,[i,l]=a.Vzr.generateThumbnailForNode(e,100,100,4,{});if(l){let e=new Blob([l],{type:"image/png"});n=URL.createObjectURL(e)}let o=t?.get(e)??s.buzzApprovalNodeStatusInfo()?.currentStatus??null;return{guid:e,name:s?.name||"",imageUrl:n,templateTypeMetadata:a.fZl?.getCooperTemplateTypeMetadata(e)??null,status:o}}).filter(e=>null!==e)}function _(){let e=j(),t=(0,l.md)(m.mk);return(0,c.Fk)((e,s)=>f(s,t),e?.assetsInRequest??[])}function y(){let e=a.Ez5?.canvasGrid().canvasGridArray.getCopy();return(0,c.Fk)((e,t)=>f(t),e?.flat()??[])}function k(){let e=[],t=(0,l.md)(m.QZ),s=(0,l.md)(m.O5),n=(0,l.md)(m.kt);return t.length||e.push({field:"title",message:"Enter a title",type:"blocking"}),0===s.tokens.length&&e.push({field:"reviewers",message:"Select at least one reviewer",type:"blocking"}),t.length>160&&e.push({field:"title",message:"Title must be less than 160 characters",type:"validation"}),n.length>1e3&&e.push({field:"description",message:"Description must be less than 1000 characters",type:"validation"}),e}function v(){let e=(0,l.md)(m.QZ),t=(0,l.md)(m.kt),s=(0,l.md)(m.aG),n=N();return{title:e,description:t,selectedAssetGuids:Array.from(s),reviewerIds:n}}function b(){let e=(0,l.Xr)(m.aG),t=(0,l.Xr)(m.QZ),s=(0,l.Xr)(m.O5),a=(0,l.Xr)(m.kt);return n.useCallback(()=>{e(new Set),t(""),s((0,x.Rs)()),a("")},[a,s,e,t])}let j=()=>{let e=a.Ez5?.canvasGrid(),t=e?.gridGUID()||null;return(0,c.Fk)((e,t)=>{if(!t)return null;let s=e.get(t);if(!s)return null;let n=s.buzzApprovalRequests();return n&&n.requests.length&&n.requests[0]||null},t)},C=()=>j()?{type:m.xi.ACTIVE_REQUEST}:{type:m.xi.OVERVIEW};function w(e){a.Ez5?.cooperFocusView().isInFocusedNodeView.getCopy()?a.Ez5?.cooperFocusView().focusNodeInFocusedNodeView(e,!0):(a.Egt?.replaceSelection([e],!0),a.Ez5?.cooperFocusView().zoomToNode(e,.5))}function E(){let e=_(),t=(0,l.md)(m.mk);return t?e.filter(e=>{let s=t.get(e.guid);return s===i.z34.CHANGES_REQUESTED||s===i.z34.APPROVED}).length:0}function N(){let e=(0,l.md)(m.O5).tokens.filter(e=>e.state===d.d.OK).map(e=>{let t=e.content;return"string"==typeof t||(0,u.d)(t)?null:t.id}).filter(e=>null!==e),t=new Set;return e.reduce((e,s)=>(t.has(s)||(t.add(s),e.push(s)),e),[])}function S(){let e=(0,o.TA)();return[...N(),e].filter(e=>null!==e)}},243771:(e,t,s)=>{s.d(t,{LE:()=>eF,$1:()=>ew,SG:()=>eO,aX:()=>eM,IP:()=>eL,p0:()=>ez,tR:()=>eA});var n=s(239976),a=s(105652),i=s(20002),r=s(295870),l=s(735786),o=s(943360),c=s(378721),d=s(931547),u=s(517478),x=s(248317),m=s(288350),p=s(623494),h=s(442182),g=s(4245),f=s(692376),_=s(854225),y=s(379141),k=s(445019),v=s(575015),b=s(224542),j=s.n(b),C=s(616246),w=s.n(C),E=s(882268),N=s.n(E),S=s(522568),T=s(40297),I=s(719749),A=s(499735),M=s(129416),z=s(487626),L=s(585066),O=s(888903),P=s(287736),R=s(506127),D=s(22377),F=s(652154),q=s(712650),G=s(212198),U=s(741400),K=s(862390),H=s(776888),B=s(603163),V=s(162251),$=s(964731),W=s(384203),Y=s(223487),X=s(666534),Z=s(610604),J=s(157750),Q=s(684520),ee=s(456556),et=s(663738),es=s(748765),en=s(236410),ea=s(604687);let ei=new class{async getZip(e,t,s){let n=JSON.stringify({sha1s:t,names:s});try{let t=await fetch(`/file/${e}/image/batch_download`,{method:"POST",body:n,headers:{"Content-Type":"application/json","Content-Length":`${n.length}`,Accept:"application/zip"}});if(!t.ok||200!==t.status)return{error:!0};let s=await t.blob();return{imagesZip:await s.arrayBuffer(),error:!1}}catch(e){return{error:!0}}}},er=new class{async getExtensions(e,t,s){let n=JSON.stringify({sha1s:t});await fetch(`/file/${e}/image/file_extensions`,{method:"POST",body:n,headers:{"Content-Type":"application/json","Content-Length":`${n.length}`,Accept:"application/json"}}).then(e=>{e.json().then(e=>{let t=e?.meta?.extensions;t&&Object.keys(t).length>0&&s(t)})}).catch(()=>{s({})})}};var el=s(803575),eo=s(138076),ec=s(775667),ed=s(314008),eu=s(720091),ex=s(571351),em=s(911470);let ep="asset_panel--addPadding--TMnTB",eh="asset_panel--exportDropdown--dCu0F",eg="asset_panel--exportMeta--UfsIP",ef="asset_panel--dot--gcK1B",e_="asset_panel--sourceName--DJB4X ellipsis--ellipsis--70pHK",ey=4*(0,T.jz)(em.devHandoffAssetPreviewMaxWidth),ek=4*(0,T.jz)(em.devHandoffAssetPreviewMaxHeight),ev=(0,k.E3)("asset_panel_export_list",{[es.PW.ASSET_ICON]:[ej("SVG")],[es.PW.ASSET_ILLUSTRATION]:[ej("SVG")],[es.PW.ASSET_IMAGE]:[ej("PNG")],[es.PW.ASSET_GIF]:void 0}),eb=(0,k.E3)("asset_panel_img_include_source",!0);function ej(e){let t=(0,eu.jj)([]);return"JPEG"===e||"PDF"===e?{...t,imageType:e,quality:1}:"SVG"===e?{...t,imageType:e,svgOutlineText:!1,svgIDMode:"IF_NEEDED",svgForceStrokeMasks:!1}:{...t,imageType:e}}let eC={format:e=>{switch(e){case"PNG":return"PNG";case"JPEG":return"JPG";case"SVG":return"SVG";case"PDF":return"PDF"}return e}},ew=a.memo(({assetInfo:e,media:t=[],addPadding:s=!0})=>{let r=(0,v.nl)(),d=(0,Y.tS)(),[u,x]=(0,k.fp)(D.g6),m=!eT()||u,g=(0,i.d4)(e=>e.saveAsState),_=(0,J.J2)((0,G.UK)().showGuids),{assetId:b,assetName:C,thumbnailVersion:w}=e,E=e.instancesGUIDs?.[0]??e.duplicateGUIDs?.[0]??b,N=(0,R.O)({assetId:E,thumbnailVersion:w,width:ey,height:ek,scale:4}),T=function(e,t){let s=(0,k.md)(ev),n=t&~es.PW.ASSET_COMPONENT,a=[ej(n&(es.PW.ASSET_ICON|es.PW.ASSET_ILLUSTRATION)?"SVG":"PNG")];return void 0===n||n===es.PW.NOT_ASSET||n===es.PW.ASSET_VIDEO||n===es.PW.ASSET_GIF?[]:s?.[n]||a}(0,e.type),I=e.type&(es.PW.ASSET_ICON|es.PW.ASSET_ILLUSTRATION)?"SVG":"PNG",A=T?.[0]?.imageType,M=a.useMemo(()=>T?.length&&A?T.every(e=>e.imageType===A)?(0,y.t)("dev_handoff.assets.files_same_format",{count:T.length,format:A}):(0,y.t)("dev_handoff.assets.files",{count:T.length}):I,[T,A,I]),z=(0,i.wA)(),{getTriggerProps:L,manager:O}=l.b(),{getTriggerProps:P,manager:F}=l.b(),U=a.useCallback(async e=>{m||(e.stopPropagation(),(0,S.sx)("Asset Panel Export Clicked"),x(!0),await (0,Q.Dc)(Q.hV.Export,g,z,"export-assets-handoff",[E],"export-assets-handoff",{guids:[E],exportSettings:T?.length?T:[ej(I)]}),z(q.rg()),O.isOpen&&O.setOpen(!1),x(!1))},[E,I,m,z,T,O,g,x]),H=e?.instancesGUIDs?.[0]??b,B=a.useCallback(()=>{K.tJ([H]),z((0,D.vI)(H))},[z,H]),V=a.useMemo(()=>[...e?.instancesGUIDs??[],...e?.duplicateGUIDs??[],b],[b,e?.duplicateGUIDs,e?.instancesGUIDs]),$=!!(e.type&es.PW.ASSET_ICON),W=!!(e.type&es.PW.ASSET_IMAGE),X=!!(e.type&es.PW.ASSET_GIF),Z=!!(e.type&es.PW.ASSET_VIDEO),ee=X||Z,et=!!(e.type&es.PW.ASSET_ILLUSTRATION),ea=($||W)&&!ee,ei=t?.length>0&&!!d;return(0,n.jsx)("div",{className:j()("asset_panel--assetContainer--iHYyC",{[ep]:s}),onMouseEnter:()=>f.Ez5?.canvasViewState().temporarilyHoveredNodes.set(V),onMouseLeave:()=>f.Ez5?.canvasViewState().temporarilyHoveredNodes.set([]),children:(0,n.jsxs)("div",{className:j()("asset_panel--assetRow--md-sv text--fontPos11--rO47d text--_fontBase--VaHfk",{"asset_panel--forceHovered--l6-cX":O.isOpen||r,[ep]:s}),children:[(0,n.jsx)(o.E,{className:"asset_panel--assetPreview--aXHic",style:N.backgroundStyle,onClick:B,"data-tooltip-type":en.Ib.TEXT,"data-tooltip":(0,y.t)("inspect_panel.interactions.select_layer"),children:N&&(0,n.jsx)(el.J,{src:N.url,style:N.imgStyle})}),(0,n.jsxs)("div",{className:"asset_panel--assetDetails--vsNYb",children:[(0,n.jsx)("div",{className:"asset_panel--assetName--Bf6rg ellipsis--ellipsis--70pHK",children:_?`${C} (${b})`:C}),(0,n.jsx)("div",{className:"asset_panel--assetType--3QXRz ellipsis--ellipsis--70pHK text--fontPos11--rO47d text--_fontBase--VaHfk",children:(0,n.jsx)(D.$R,{assetInfo:e,media:ea?t:[],dataTestId:"assetPanel",hideDot:!0})})]}),(0,n.jsxs)("div",{className:"asset_panel--buttons--Nl9RG",children:[(ea||et)&&(0,n.jsx)("div",{className:"asset_panel--exportIcon--yUbtY",children:ei?(0,n.jsxs)(l.bL,{manager:O,children:[(0,n.jsxs)(o.E,{"aria-label":m?(0,y.t)("fullscreen.properties_panel.export_disabled"):(0,y.t)("fullscreen.export.export"),"data-tooltip":m?(0,y.t)("fullscreen.properties_panel.export_disabled"):(0,y.t)("fullscreen.export.export"),"data-tooltip-type":en.Ib.TEXT,disabled:m,className:eh,recordingKey:`export-${b}`,...L(),children:[(0,n.jsx)(p.W,{}),(0,n.jsx)(h.r,{})]}),(0,n.jsxs)(l.mc,{children:[t.map(e=>(0,n.jsx)(eE,{asset:e,onClose:()=>O.setOpen(!1)},e.hash)),(0,n.jsx)(l.q7,{onClick:U,recordingKey:"asset-export-layer",children:(0,n.jsxs)("div",{children:[(0,y.t)("fullscreen.export.layer_export"),(0,n.jsx)(l.ME,{children:(0,n.jsxs)("div",{className:eg,children:[(0,n.jsx)(D.$R,{assetInfo:e,dataTestId:"assetPanel",hideDot:!0}),(0,n.jsx)("div",{className:ef,children:"\xb7"}),(0,n.jsx)("div",{className:e_,children:eC.format(M)})]})})]})})]})]}):(0,n.jsx)(c.K,{onClick:U,"aria-label":m?(0,y.t)("fullscreen.properties_panel.export_disabled"):(0,y.t)("fullscreen.export.export"),disabled:m,"data-tooltip":m?(0,y.t)("fullscreen.properties_panel.export_disabled"):(0,y.t)("fullscreen.export.export"),"data-tooltip-type":en.Ib.TEXT,recordingKey:`export-${b}`,children:(0,n.jsx)(p.W,{})})}),ee&&(0,n.jsx)(n.Fragment,{children:m?(0,n.jsx)(c.K,{"aria-label":(0,y.t)("fullscreen.properties_panel.export_disabled"),disabled:!0,"data-tooltip":(0,y.t)("fullscreen.properties_panel.export_disabled"),"data-tooltip-type":en.Ib.TEXT,children:(0,n.jsx)(p.W,{})}):t.length>1?(0,n.jsxs)(l.bL,{manager:F,children:[(0,n.jsxs)(o.E,{"aria-label":(0,y.t)("fullscreen.export.export"),"data-tooltip":(0,y.t)("fullscreen.export.export"),"data-tooltip-type":en.Ib.TEXT,className:eh,recordingKey:`export-${b}`,...P(),children:[(0,n.jsx)(p.W,{}),(0,n.jsx)(h.r,{})]}),(0,n.jsx)(l.mc,{children:t.map(e=>(0,n.jsx)(eE,{asset:e,onClose:()=>F.setOpen(!1)},e.hash))})]}):(0,n.jsx)(eN,{assetInfo:e})})]})]})})});function eE({asset:e,onClose:t}){let s=(0,Y.tS)()??"",r=(0,i.wA)(),{ref:o,...c}=(0,eo.X)(e.name),{name:d,extension:u}=e,x=a.useCallback(e=>{e.stopPropagation(),t(),r(q.aK())},[r,t]);return(0,n.jsx)(l.N_,{href:(0,ed.Me)(s,e.hash),download:e.name,onClick:x,htmlAttributes:c,recordingKey:"asset-export-source",children:(0,n.jsxs)("div",{children:[(0,y.t)("fullscreen.export.source"),(0,n.jsx)(l.ME,{children:(0,n.jsxs)("div",{className:eg,children:[(0,n.jsx)(D.yP,{pxWidth:e.width,pxHeight:e.height,dataTestId:"assetPanel"}),(0,n.jsx)("div",{className:ef,children:"\xb7"}),(0,n.jsx)("div",{className:e_,"data-content-start":d,"data-content-end":u?`.${u}`:void 0,ref:o})]})})]})})}function eN({assetInfo:e}){let t=(0,ee.Fk)((e,t)=>{if(!t)return null;let s=e.get(t);return s?B.N9(s?.fills)?.filter(e=>e.opacity>0&&e.visible):null},e?.assetId);return((0,D.p2)(e)||(0,D.cZ)(e))&&t&&t.length&&t[0]?(0,n.jsx)(ed.iV,{image:t[0],loadingChildren:(0,n.jsx)(L.k,{}),variant:"icon",children:(0,n.jsx)(p.W,{})}):null}function eS({asset:e,assetId:t}){let{thumbnailVersion:s}=e??{},a=(0,R.O)({assetId:t,thumbnailVersion:s,width:64,height:64,scale:4});return(0,n.jsx)("div",{className:"asset_panel--assetIcon--uMz5t",style:a.backgroundStyle,children:(0,n.jsx)(el.J,{className:"asset_panel--assetIconImg--6SY3b",src:a.url})})}function eT(){let e=(0,Y.tS)()??"",t=(0,I.Rs)((0,Z.nlH)({key:e}));return!!(0,v.nl)()||t.data?.file&&"error"!==t.data.file.status&&t.data?.file?.data?.hasPermission}function eI({chits:e,totalItems:t}){return(0,n.jsxs)("span",{className:"asset_panel--assetIconRow--x1NLK",children:[e.map(e=>(0,n.jsx)(eS,{asset:e,assetId:e?.instancesGUIDs?.[0]??e?.duplicateGUIDs?.[0]??e.assetId},e.assetId)),t>3&&(0,n.jsxs)("span",{children:["+",t-3]})]})}function eA(){let e=(0,Y.tS)()??"",t=(0,k.md)(et.O),[s,n]=(0,k.fp)(D.Qm);return a.useEffect(()=>{if(!t)return;let a=new Set(Object.keys(s)),i=Object.values(t).filter(e=>"video"!==e.type&&!a.has(e.hash)).map(e=>e.hash);i.length>0&&e&&er.getExtensions(e,i,e=>n(t=>({...t,...e})))},[t,e,s,n]),a.useMemo(()=>{let e={};if(!t)return e;let n=new Set(Object.keys(s));for(let a of Object.values(t))if("video"!==a.type&&a.guids){let t=n.has(a.hash)?s?.[a.hash]:void 0;for(let s of a.guids){let n={...a,extension:t};e[s]=[...e[s]??[],n]}}return e},[s,t])}function eM(e){switch(e){case es.PW.ASSET_ICON:return(0,y.t)("dev_handoff.assets.icons_download");case es.PW.ASSET_ILLUSTRATION:return(0,y.t)("dev_handoff.assets.illustrations_download");case es.PW.ASSET_IMAGE:return(0,y.t)("dev_handoff.assets.images_download");case es.PW.ASSET_GIF:return(0,y.t)("dev_handoff.assets.gifs_download");default:return(0,y.t)("fullscreen.export.export")}}function ez({assetType:e,assets:t,mediaByGuid:s}){let[n,l]=(0,k.fp)(D.g6),[o,c]=a.useState(!1),d=!eT()||n||o,u=(0,Y.q5)(),x=(0,i.d4)(e=>e.saveAsState),m=(0,i.wA)(),p=(0,k.md)(ev)[e],h=(0,k.md)(eb),g=(0,F.uQ)(),_=(0,H.dh)(),v=g??_,b=!p||0===p.length,j=a.useMemo(()=>e!==es.PW.ASSET_GIF&&(e===es.PW.ASSET_IMAGE?b&&!h:b),[b,h,e]),C=N()(Object.values(s??{})).filter(t=>t.type===(e===es.PW.ASSET_GIF?"gif":"image")),E=a.useMemo(()=>(e===es.PW.ASSET_GIF||e===es.PW.ASSET_IMAGE&&!!h)&&C.length>20,[e,h,C.length]);return{onExportAll:a.useCallback(async s=>{let n=e===es.PW.ASSET_GIF,a=e===es.PW.ASSET_IMAGE,i=Object.keys(t).map(e=>t[e]?.instancesGUIDs?.[0]??t[e]?.duplicateGUIDs?.[0]??e),o=(a&&h||n)&&!!C.length,g=!!i.length,_=!!p?.length;if(d||!(g&&_||o)||!f.w3z||!u)return;s.stopPropagation(),c(!0),l(!0),(0,S.sx)("Asset Panel Export Clicked");let k=i.length*(p?.length??0);m(O.F.enqueue({message:o?(0,y.t)("dev_handoff.assets.preparing_time",{count:(_?k:0)+C.length}):(0,y.t)("dev_handoff.assets.preparing",{count:k}),icon:P.zX.SPINNER,preventDismissal:!0,type:"dev-mode-all-asset-download"}));let b=!1;try{let t=o&&_&&!n,s=[];if(o){let e=await ei.getZip(u.key,C.map(e=>e.hash),C.map(e=>e.name||e.hash));if(e.error)m(O.F.enqueue({message:(0,y.t)("dev_handoff.assets.too_many_image_sources"),icon:P.zX.EXCLAMATION,timeoutOverride:1/0,error:!0}));else{let{imagesZip:a}=e;if(t){let e=new(w())().load(new Uint8Array(a));for(let t of Object.keys(e.files)){if(!e.files[t])continue;let a=e.files[t].asUint8Array(),i=n?"gif":t.includes("jp")?"jpg":"png";s.push({filename:`source/${t}`,jsBuffer:a,mimeType:`image/${i}`,error:""})}}else(0,ed.PE)(new Blob([a]),`${u.name}_${n?"gif":"img"}.zip`);m(q.aK()),b=!0}}t&&s.length&&f.w3z.prepareSourceImagesForZip(s),!n&&p?.length&&(await (0,Q.Dc)(Q.hV.Export,x,m,"export-assets-handoff",[v],"export-assets-handoff",{guids:i,exportSettings:p,assetType:(0,D.Vx)(e),withSourceImages:t&&!!s.length}),m(q.rg()))}catch(e){(0,M.$D)(r.e.DEV_MODE,e),o&&C.length>1&&!b&&m(O.F.enqueue({message:(0,y.t)("dev_handoff.assets.too_many_image_sources"),icon:P.zX.EXCLAMATION,timeoutOverride:1/0,error:!0}))}finally{m(O.F.dequeue({matchType:"dev-mode-all-asset-download"})),c(!1),l(!1)}},[C,t,e,d,m,p,h,u,v,x,l]),isLocalExporting:o,nothingToExport:j,tooManyMediaToExport:E}}function eL(e){switch(e){case es.PW.ASSET_ICON:return(0,y.t)("dev_handoff.assets.icons_open_settings");case es.PW.ASSET_ILLUSTRATION:return(0,y.t)("dev_handoff.assets.illustrations_open_settings");case es.PW.ASSET_IMAGE:return(0,y.t)("dev_handoff.assets.images_open_settings");default:return(0,y.t)("general.open")}}function eO({assetType:e,rowRef:t,onClose:s,pickerPosition:r}){r=t.current?r||(0,ea.cn)(t.current,248):void 0;let[l,o]=(0,k.fp)(ev),[c,p]=(0,k.fp)(eb),h=(0,i.wA)(),g=(0,$.Um)(),f=(0,X.Xo)(),v=(0,Y.q5)(),b=(0,W.p8)("currentSelectedProperty"),j=l?.[e],C=a.useCallback(t=>{o({...l,[e]:t})},[e,l,o]),w=a.useCallback(()=>{let e=j||[],t=(0,eu.jj)(e);C(e.concat([t]))},[j,C]),E=a.useCallback(e=>{let t=j||[],s=(0,eu.jj)(t);if("PNG"===e){C(t.concat([s]));return}(0,eu.MU)(s,e,()=>C(t.concat([s])))},[j,C]),N=function(e){switch(e){case es.PW.ASSET_ICON:return(0,y.t)("dev_handoff.assets.icons_settings");case es.PW.ASSET_ILLUSTRATION:return(0,y.t)("dev_handoff.assets.illustrations_settings");case es.PW.ASSET_IMAGE:return(0,y.t)("dev_handoff.assets.images_settings");default:return(0,y.t)("general.settings")}}(e);return(0,n.jsx)(d.bL,{onClose:s,defaultPosition:r,width:"sm",children:(0,n.jsxs)(u.vo,{children:[(0,n.jsx)(u.Y9,{children:(0,n.jsx)(u.hE,{children:N})}),(0,n.jsxs)(u.nB,{padding:0,children:[(0,n.jsx)(eu.df,{addProperty:w,currentSelectedProperty:b,dispatch:h,dropdownShown:g,entrypointMenu:(0,n.jsx)(ex.n3,{addExportOfType:E}),idPrefix:`assetType${e}-`,onChange:C,openFile:v,pickerShown:f,propertyList:j,recordingKey:A.Pt("assets",e,"exportList"),selectedPropertyType:_.rrT.ASSET_ALL_EXPORT}),(0,n.jsx)("div",{className:"asset_panel--settingsModalRow--Zj8Q7",children:e===es.PW.ASSET_IMAGE&&(0,n.jsx)(x.S,{checked:c,onChange:p,label:(0,n.jsx)(m.J,{children:(0,y.tx)("dev_handoff.assets.images_include_source")})})})]})]})})}function eP({assetType:e,assets:t,mediaByGuid:s,rowRef:i}){let{getTriggerProps:r,manager:o}=l.b(),d=(0,k.md)(D.g6),[u,x]=a.useState(!1),{onExportAll:m,isLocalExporting:p,nothingToExport:h,tooManyMediaToExport:f}=ez({assetType:e,assets:t,mediaByGuid:s}),_=!eT()||d||p,v=function(e){switch(e){case es.PW.ASSET_ICON:return(0,y.t)("dev_handoff.assets.icons_download_menu");case es.PW.ASSET_ILLUSTRATION:return(0,y.t)("dev_handoff.assets.illustrations_download_menu");case es.PW.ASSET_IMAGE:return(0,y.t)("dev_handoff.assets.images_download_menu");case es.PW.ASSET_GIF:return(0,y.t)("dev_handoff.assets.gifs_download_menu");default:return(0,y.t)("dev_handoff.assets")}}(e),b=eL(e),j=eM(e);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.bL,{manager:o,children:[(0,n.jsx)(c.K,{"aria-label":_?(0,y.t)("fullscreen.properties_panel.export_disabled"):v,"data-tooltip":_?(0,y.t)("fullscreen.properties_panel.export_disabled"):v,"data-tooltip-type":en.Ib.TEXT,disabled:_,recordingKey:`assets-download-menu-${eR(e)}`,...r(),children:(0,n.jsx)(g.J,{})}),(0,n.jsxs)(l.mc,{children:[(0,n.jsx)(l.q7,{onClick:m,disabled:f||h,recordingKey:`assets-download-all-${eR(e)}`,children:(0,n.jsxs)("div",{className:"asset_panel--downloadAllMenuItem--qkS-1",children:[j,f?(0,n.jsx)(l.ME,{children:(0,y.tx)("dev_handoff.assets.too_many_image_sources_disabled")}):h?(0,n.jsx)(l.ME,{children:(0,y.tx)("dev_handoff.assets.nothing_to_export")}):null]})}),e!==es.PW.ASSET_GIF&&(0,n.jsx)(l.q7,{onClick:()=>x(!0),recordingKey:`assets-download-open-settings-${eR(e)}`,children:b})]})]}),u&&(0,n.jsx)(eO,{assetType:e,rowRef:i,onClose:()=>x(!1)})]})}function eR(e){switch(e){case es.PW.ASSET_ICON:return"icons";case es.PW.ASSET_ILLUSTRATION:return"illustrations";case es.PW.ASSET_IMAGE:return"images";case es.PW.ASSET_GIF:return"gifs";case es.PW.ASSET_VIDEO:return"videos";default:return"assets"}}function eD({items:e,mediaByGuid:t,assetType:s}){let i=a.useMemo(()=>Object.keys(e??{}),[e]),{visibleItems:r,showMoreButton:l,totalItems:o}=(0,z.y)({items:i,pageSize:3,shouldResetOnSelectionChange:!0}),c=a.useRef(null);if(0===o||!e)return null;let d=s!==es.PW.ASSET_VIDEO;return(0,n.jsxs)(ec.VZ,{title:function(e){switch(e){case es.PW.ASSET_ICON:return(0,y.t)("dev_handoff.assets.icons");case es.PW.ASSET_ILLUSTRATION:return(0,y.t)("dev_handoff.assets.illustrations");case es.PW.ASSET_IMAGE:return(0,y.t)("dev_handoff.assets.images");case es.PW.ASSET_GIF:return(0,y.t)("dev_handoff.assets.gifs");case es.PW.ASSET_VIDEO:return(0,y.t)("dev_handoff.assets.videos");default:return(0,y.t)("dev_handoff.assets")}}(s),recordingKey:eR(s),isSubsection:!0,noBorder:!0,additionalHeaders:d?(0,n.jsx)(eP,{assetType:s,assets:e,mediaByGuid:t,rowRef:c}):void 0,headerRef:c,children:[r.map(s=>e[s]?(0,n.jsx)(ew,{assetInfo:e[s],media:t?.[s]},s):null),l]})}function eF(){let e=(0,V.Gt)("assets"),t=eA();if(!e)return null;let{totalAssets:s=0,chits:a,icons:i,illustrations:r,images:l,gifs:o,videos:c}=e;return 0===s?null:(0,n.jsx)(n.Fragment,{children:s>0&&(0,n.jsxs)(ec.VZ,{hideHeader:U.z4.getIsExtension(),title:(0,y.t)("dev_handoff.assets"),recordingKey:"assets",collapsiblePanelKey:"assets",collapsedHeaders:(0,n.jsx)(eI,{chits:Object.values(a??{}),totalItems:s}),children:[(0,n.jsx)(eD,{items:i,assetType:es.PW.ASSET_ICON}),(0,n.jsx)(eD,{items:r,assetType:es.PW.ASSET_ILLUSTRATION}),(0,n.jsx)(eD,{items:l,assetType:es.PW.ASSET_IMAGE,mediaByGuid:t}),(0,n.jsx)(eD,{items:o,assetType:es.PW.ASSET_GIF,mediaByGuid:t}),(0,n.jsx)(eD,{items:c,assetType:es.PW.ASSET_VIDEO})]})})}},665477:(e,t,s)=>{s.d(t,{L:()=>m,Y:()=>x});var n=s(379141),a=s(445019),i=s(522568),r=s(351298),l=s(888903),o=s(850465),c=s(423434),d=s(152599),u=s(17453);let x=(0,d.nF)(async(e,{fileKey:t,clientLifecycleId:s,persistentEntityId:l})=>{let d;a.zl.set((0,o.wc)(s),(0,r.ux)());try{if((d=await c.J(t,(0,n.t)("ai_assistant.restore.version_label"),(0,n.t)("ai_assistant.restore.version_description"),e.dispatch,!0))&&d.id)a.zl.set((0,o.wc)(s),(0,r.NY)({restoreVersionId:d.id})),i.az.trackDefinedEvent("ai_assistant.created_savepoint",{persistentEntityId:l,clientLifecycleId:s,restoreVersionId:d.id,success:!0});else throw Error("No savepoint ID returned")}catch(e){console.error("Error creating savepoint for AI assistant",e.message),a.zl.set((0,o.wc)(s),(0,r.uW)(e)),i.az.trackDefinedEvent("ai_assistant.created_savepoint",{persistentEntityId:l,clientLifecycleId:s,success:!1,error:e.message})}}),m=(0,d.nF)((e,t)=>{let{fileKey:s,restoreVersionId:c,trackingContext:d}=t;i.az.trackDefinedEvent("ai_assistant.restore_initiated",{...d,restoreVersionId:c}),e.dispatch(l.F.enqueue({message:(0,n.t)("ai_assistant.restore.in_progress")})),a.zl.set((0,o.ru)(t.trackingContext.clientLifecycleId),(0,r.ux)());try{e.dispatch((0,u.PF)({fileKey:s,versionId:c,source:u.C0.AI_ASSISTANT_CHAT}))}catch(e){console.error("Error restoring version from assistant chat",e),a.zl.set((0,o.ru)(d.clientLifecycleId),(0,r.uW)(e))}})},362051:(e,t,s)=>{s.d(t,{C:()=>m});var n=s(105652),a=s(445019),i=s(634020),r=s(719749),l=s(223487),o=s(605985),c=s(920675),d=s(610604),u=s(790016),x=s(274412);function m(e){let t=(0,u.px)(),s=(0,l.q5)(),m=(0,o.TA)(),p=(0,r.bc)((0,d.dHY)({}));return(0,n.useMemo)(()=>i.Qw.transformAll([t,p],(t,n)=>!!s&&!!m&&(!!(t.key.type===c.h4.ORG_USER||t.seatTypeLicenseTypes?.includes(c.G_.DESIGN))||!!n.currentUser.inStudentPlan||a.zl.get(x.TG).has(e))),[t,s,m,p,e])}},611034:(e,t,s)=>{s.d(t,{p:()=>k});var n=s(405228),a=s(766274),i=s(337812);function r(e){if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e))throw Error("Invalid MCP server ID format")}let l=n.z.object({id:n.z.string(),name:n.z.string(),url:n.z.string(),logo_url:n.z.string().nullable().optional(),transport:n.z.string(),user_id:n.z.string(),is_public:n.z.boolean(),tagline:n.z.string().nullable().optional(),description:n.z.string().nullable().optional()}).transform(e=>({id:e.id,name:e.name,url:e.url,transport:e.transport,logoUrl:e.logo_url,userId:e.user_id,isPublic:e.is_public,tagline:e.tagline,description:e.description})),o=n.z.object({id:n.z.string(),mcp_server_id:n.z.string(),user_id:n.z.string(),created_at:n.z.string()}).transform(e=>({id:e.id,mcpServerId:e.mcp_server_id,userId:e.user_id,createdAt:e.created_at})),c=n.z.object({id:n.z.string(),mcp_server_id:n.z.string(),user_id:n.z.string(),created_at:n.z.string(),server:l}).transform(e=>({id:e.id,mcpServerId:e.mcp_server_id,userId:e.user_id,createdAt:e.created_at,server:e.server})),d=n.z.object({clients:n.z.array(c)}),u=n.z.object({servers:n.z.array(l)}),x=n.z.object({server:l}),m=n.z.object({server:l}),p=n.z.object({server:l}),h=n.z.object({server:l}),g=n.z.object({client:o}),f=n.z.object({client:o}),_=n.z.object({success:n.z.boolean()}),y=n.z.object({}),k=new class{constructor(){this.GetMcpServersSchemaValidator=(0,a.YV)("GetMcpServersSchemaValidator",u,null),this.GetMcpServerSchemaValidator=(0,a.YV)("GetMcpServerSchemaValidator",x,null),this.CreateMcpServerSchemaValidator=(0,a.YV)("CreateMcpServerSchemaValidator",m,null),this.UpdateMcpServerSchemaValidator=(0,a.YV)("UpdateMcpServerSchemaValidator",p,null),this.DeleteMcpServerSchemaValidator=(0,a.YV)("DeleteMcpServerSchemaValidator",h,null),this.GetMcpClientsSchemaValidator=(0,a.YV)("GetMcpClientsSchemaValidator",d,null),this.CreateMcpClientSchemaValidator=(0,a.YV)("CreateMcpClientSchemaValidator",g,null),this.DeleteMcpClientSchemaValidator=(0,a.YV)("DeleteMcpClientSchemaValidator",f,null),this.McpOauthCallbackSchemaValidator=(0,a.YV)("McpOauthCallbackSchemaValidator",_,null),this.CreateMcpOauthClientSchemaValidator=(0,a.YV)("CreateMcpOauthClientSchemaValidator",y,null)}getMcpServers(e){return this.GetMcpServersSchemaValidator.validate(async({xr:t})=>await t.get("/api/mcp/servers",{file_key:e}))}getMcpServer(e,t){return r(e),this.GetMcpServerSchemaValidator.validate(async({xr:s})=>await s.get(`/api/mcp/servers/${e}`,{file_key:t}))}createMcpServer(e){return this.CreateMcpServerSchemaValidator.validate(async({xr:t})=>await t.post("/api/mcp/servers",a.td.toAPIParameters(e)))}updateMcpServer(e){return r(e.serverId),this.UpdateMcpServerSchemaValidator.validate(async({xr:t})=>await t.put(`/api/mcp/servers/${e.serverId}`,a.td.toAPIParameters(e)))}deleteMcpServer(e){return r(e.serverId),this.DeleteMcpServerSchemaValidator.validate(async({xr:t})=>await t.del(`/api/mcp/servers/${e.serverId}`,{file_key:e.fileKey}))}getMcpClients(e){return this.GetMcpClientsSchemaValidator.validate(async({xr:t})=>await t.get("/api/mcp/clients",{file_key:e}))}createMcpClient(e){return this.CreateMcpClientSchemaValidator.validate(async({xr:t})=>await t.post("/api/mcp/clients",a.td.toAPIParameters(e)))}deleteMcpClient(e){let{id:t,fileKey:s}=e;return this.DeleteMcpClientSchemaValidator.validate(async({xr:e})=>await e.del(`/api/mcp/clients/${t}`,{file_key:s}))}mcpOauthCallback(e,t){r(e.serverId);let s={...i.Ay.defaults.headers};return t&&(s["X-Figma-User-ID"]=t),this.McpOauthCallbackSchemaValidator.validate(async({xr:t})=>await t.post(`/api/mcp/servers/${e.serverId}/oauth_callback`,a.td.toAPIParameters(e),{headers:s}))}createMcpOauthClient(e){return r(e.serverId),this.CreateMcpOauthClientSchemaValidator.validate(async({xr:t})=>await t.post(`/api/mcp/server/${e.serverId}/oauth/client`,a.td.toAPIParameters(e)))}}},690149:(e,t,s)=>{s.d(t,{Ay:()=>C,BZ:()=>v,m4:()=>b});var n=s(239976),a=s(105652),i=s(20002),r=s(379141),l=s(445019),o=s(393463),c=s(639184),d=s(859100),u=s(574220),x=s(634224),m=s(776888),p=s(384203),h=s(456556),g=s(215496),f=s(289252),_=s(527205),y=s(355441),k=s(271625);let v="ui3-layers-horizontal-scroll-onboarding-key",b="ui2-layers-horizontal-scroll-onboarding-key",j=(0,x.r1)("seen_ui3_layers_horizontal_scroll_overlay");function C(){let e=(0,p.aV)(),t=(0,l.md)(u.Fy),s=(0,i.d4)(e=>e.mirror.appModel.currentPage),x=(0,h.Fk)((e,t)=>!(0,m.zC)(e,t),s),b=(0,l.md)(j),{show:C,isShowing:w,complete:E}=(0,d.e)({overlay:k.vlG,priority:g.N.SECONDARY_MODAL},[t,b]);return a.useEffect(()=>{C({canShow:(t,s)=>t&&!e&&x&&!s})},[C,e,x,t]),(0,n.jsx)(_.rq,{arrowPosition:y.F_.RIGHT_TITLE,description:(0,r.tx)("ui3_layers_horizontal_scroll_overlay.ui3_description"),disableHighlight:!0,isShowing:w,media:(0,n.jsx)(f.w,{src:(0,o.ck)("86193716c443398bbd6b55d19b65db2eaf0fe3c1"),aspectRatio:16/9}),onClose:E,primaryCta:{label:(0,r.tx)("general.got_it"),ctaTrackingDescriptor:c.c.GOT_IT,type:"button",onClick:E},targetKey:v,title:(0,r.tx)("ui3_layers_horizontal_scroll_overlay.ui3_title"),trackingContextName:"UI3 Layers Horizontal Scroll Overlay"})}},642165:(e,t,s)=>{s.d(t,{j:()=>r});var n=s(424976),a=s(271625);let i=(0,n.Op)({initial:"ready_to_show",states:[{id:"ready_to_show",transitions:[(0,n.nr)("curator_content_shown","no_figma_basics_onboarding_was_shown_in_current_session",{condition:({event:e})=>e.properties.shown===a.WD4.id})]},{id:"no_figma_basics_onboarding_was_shown_in_current_session",terminal:!0}]}),r=(0,n.rn)("track_no_figma_basics_onboarding_shown",i)},326790:(e,t,s)=>{s.d(t,{T:()=>j,g:()=>b});var n=s(239976),a=s(105652),i=s(20002),r=s(379141),l=s(7857),o=s(488051),c=s(136393),d=s(639184),u=s(826151),x=s(859100),m=s(223487),p=s(605985),h=s(748181),g=s(215496),f=s(527205),_=s(584441),y=s(890305),k=s(271625),v=s(482621);let b={[v.a5]:!1,[v.fc]:!1,[v.bo]:!1},j=(0,l._d)(function(){let e=(0,m.MY)(),t=(0,m.q5)(),s=(0,i.wA)(),l=(0,p.iZ)(),{show:j,isShowing:C,complete:w,uniqueId:E}=(0,x.e)({overlay:k.TrJ,priority:g.N.SECONDARY_MODAL},[e]),N=(0,o.te)(),S=!!(0,h.f)(v.fc),T=t?.canEdit,{currentView:I,visualAssetsType:A}=(0,_.wV)();return(0,u.E)(E,["Reset Visual Assets Tooltips",v.io],()=>{l&&t&&s(c.b(b))}),(0,a.useEffect)(()=>{T&&N()&&!S&&A&&I===_.S5.VisualAssets&&j(),C&&I!==_.S5.VisualAssets&&w()},[j,w,C,T,N,S,A,I]),(0,n.jsx)(f.rq,{arrowPosition:y.F_.LEFT_TITLE,clickOutsideToHide:!0,description:(0,r.tx)("rcs.visual_assets.drag_visual_assets_description"),disableHighlight:!0,isShowing:C,onClose:w,pointToLeftEdge:!0,primaryCta:{label:(0,r.tx)("onboarding_pointers.got_it"),type:"button",onClick:w,ctaTrackingDescriptor:d.c.GOT_IT},targetKey:v.ko,title:(0,r.tx)("rcs.visual_assets.drag_visual_assets_title"),trackingContextName:"Visual Assets Search Tooltip",userFlagOnShow:v.fc})},"VisualAssetsPanelTooltip")},840589:(e,t,s)=>{s.d(t,{WC:()=>eo,Jc:()=>ea,Y1:()=>el});var n=s(239976),a=s(105652),i=s(943360),r=s(692376),l=s(379141),o=s(270450),c=s(445019);s(323264);var d=s(40297),u=s(943866),x=s(585066),m=s(157750),p=s(994047),h=s(410518),g=s(789382),f=s(960883),_=s(123388),y=s(466082),k=s(74372),v=s(393463),b=s(19047),j=s(591791),C=s(223487),w=s(835585),E=s(870975),N=s(279758),S=s(26620),T=s(627068),I=s(102462),A=s(640753);let M={loadTimeMs:2e3,numSuggestions:4},z="mockAutoSuggestConfig";function L(){return(0,v.b5)()&&(0,o.kc)().anticipation_mock}L()?window.mockAutoSuggestConfig={get(){if(!L())return;let e=localStorage.getItem(z);return e?{...M,...JSON.parse(e)}:M},set(e){if(!L())return;let t={...this.get(),...e};localStorage.setItem(z,JSON.stringify(t))},reset(){L()&&localStorage.setItem(z,JSON.stringify(M))}}:localStorage.removeItem(z);let O=(0,A.rt)(new Map);async function P({targetNodeGuid:e}){if(!L())return{suggestions:[]};let t=window.mockAutoSuggestConfig?.get();if(!t)return{suggestions:[]};let s=c.zl.get(O),n=s.get(e);if(!n){let t=I.D.getState(),a=[...Object.values(t.library.publishedByLibraryKey.components).map(e=>Object.values(e).map(e=>Object.values(e))).flat(2),...Object.values(t.library.publishedByLibraryKey.stateGroups).map(e=>Object.values(e).map(e=>Object.values(e))).flat(2)];if(0===a.length)throw Error("MOCK: COULD NOT FIND ANY ASSETS - maybe they are still loading?");n=a.sort(()=>Math.random()-.5).map(e=>({...e,suggestionSource:_.Ou.RECENTS}));let i=new Map(s);i.set(e,n),c.zl.set(O,i)}return await new Promise(e=>{setTimeout(()=>{e({suggestions:n.slice(0,t.numSuggestions)})},t.loadTimeMs)})}var R=s(355370),D=s(47904);let F=e=>e?`${e.name} ${e.guid}`:"NO TARGET";async function q(e){return(0,o.kc)().anticipation_mock?await P({targetNodeGuid:e.targetNode.guid}):await (0,S.A)(e)}var G=s(138709),U=s(675341),K=s(365841),H=s(209067),B=s(420434),V=s(715243),$=s(584441),W=s(922534),Y=s(575987),X=s(345481),Z=s(358445),J=s(542531),Q=s(887555),ee=s(151126),et=s(99711);let es=$.S5.Libraries,en=(0,d.jz)(et.$A),ea=(0,c.eU)(0);function ei({suggestions:e,analyticsData:t,hasLibraries:s,subscribedLibraries:i}){let r=ec(),o=(0,c.Xr)(g.a),d=a.useCallback(()=>{(0,f.gb)(t,_.GG.RESULT_INSERTED,_.qd.ASSET_PANEL)},[t]),u=(0,W.O)(),x=a.useMemo(()=>{let e={};return i?.forEach(t=>{e[t.libraryKey]=t.name}),e},[i]),m=a.useMemo(()=>{let{props:t,numColumns:s}=(0,W.Z)(u,Y.$H.GRID,G.rp.NORMAL);return e.map((e,a)=>(0,n.jsx)(B.z,{asset:e,fileName:x?x[e.library_key]:"",sectionPosition:a,keyboardPosition:(0,H.pg)([U.ON.SUGGESTIONS],a,s),onSuccessfulAssetInsert:d,...t,sourceForTracking:f.tM},`${e.id}-${a}`))},[e,u,x,d]);a.useEffect(()=>{e.length>0&&t.queryId&&((0,f.gb)(t,_.GG.RESULTS_SHOWN,_.qd.ASSET_PANEL),o())},[e,t,o]);let p=(0,l.tx)("auto_suggest.asset_panel.no_libraries"),y=(0,l.tx)("auto_suggest.suggestion_shelf_no_suggestions"),k=(0,n.jsx)("div",{className:"xh8yej3 x1iyjqo2 x1r8uery x1l90r2v",children:(0,n.jsx)("div",{className:ee.WA,children:m})});return(0,h.NB)(),(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x6s0dn4 xl56j7k",style:{minHeight:r},children:s?m.length>0?k:y:p})}function er(){let e;let{width:t}=(0,K.G)(),s=(0,p.He)().size>0,d=!s,u=(0,p.je)(),h=a.useRef(null),{suggestions:S,isLoading:I,analyticsData:A,debugString:M,isInitialized:z}=function(e=!1){let t=function(e){(0,v.Ay)().anticipation_config||((0,v.Ay)().anticipation_config=_.PV);let t=(0,v.Ay)().anticipation_config.dominantFrameConfig;return function({targetNodeGuid:e,disabled:t}){let[{suggestions:s,analyticsData:n},i]=(0,c.fp)(g.P),{isLoaded:l}=(0,E.y)(),o=function(){let{isLoaded:e}=(0,E.y)();return{isLoaded:e,assets:(0,j.g5)(w.$A.Design).productComponents.map(e=>({...e,suggestionSource:_.Ou.RECENTS}))}}(),d=a.useMemo(()=>l&&o.isLoaded,[l,o.isLoaded]),[u,x]=a.useState(d);a.useEffect(()=>{!u&&d&&(x(!0),0===s.length&&i({suggestions:o.assets,analyticsData:_.YQ}))},[d,o,u,s.length,i]);let{suggestions:m,analyticsData:h,isLoading:v,suggestionsNodeGuid:N,debugString:S}=function({targetNodeGuid:e,disabled:t}){let[s,n]=a.useState([]),[i,l]=a.useState(`${e} - INIT`),[o,c]=a.useState(_.YQ),[d,u]=a.useState(!1),[x,m]=a.useState(void 0),h=(0,C.tS)(),g=(0,p.He)(),v=(0,D.r8)();return a.useEffect(()=>{if(t||!v)return;let s=(0,y.UN)(),a=e?s.get(e):void 0,i=new AbortController;if(a&&h){if(a&&_.b4.includes(a.type)){u(!0),n([]),m(a.guid),l(F(a)+" - STARTED");let e={fileKey:h,queryId:(0,k.g)(),selectionId:a?.guid};c(e);let t=(0,D.k1)(),s=new f.O({analyticsData:e,config:t,entryPoint:_.qd.ASSET_PANEL}),{signal:o}=i,d=new T.I(r.otU.COMPONENTS,i);q({targetNode:a,openFileKey:h,signal:o,subscribedLibraryKeys:g,autoSuggestSession:d,logger:s,config:t}).then(({suggestions:e})=>{o.aborted||n(e)}).catch(e=>{if((0,b.x1)("auto_suggest","Error fetching suggestions",{error:e}),"AbortError"===e.name)return}).finally(()=>{o.aborted||(u(!1),l(F(a)+" - FINISHED"));try{d.destroy()}catch(e){}})}else a&&(u(!1),n([]),m(a.guid),l(F(a)+" - INVALID TARGET"))}else n([]),l(F(a)+" - NO TARGET/OPEN FILE"),u(!1),m(void 0),c(_.YQ);return()=>{i&&i.abort()}},[e,t,h,g,v]),{suggestions:s,isLoading:d,analyticsData:o,suggestionsNodeGuid:x,debugString:i}}({targetNodeGuid:e,disabled:t});a.useEffect(()=>{m.length>0&&i({suggestions:m,analyticsData:h})},[m,h,i]);let I=(0,D.r8)();return t||!I?{suggestions:[],analyticsData:_.YQ,isLoading:!1,isInitialized:!1,suggestionsNodeGuid:void 0,debugString:""}:{suggestions:s,analyticsData:n,isLoading:v,isInitialized:u||s.length>0,suggestionsNodeGuid:N,debugString:S}}({targetNodeGuid:function({selectedNode:e,config:t,disabled:s}){let n=!(0,o.kc)().anticipation,[i,r]=a.useState(void 0),{debouncedViewportInfo:l,viewportIsStable:c}=(0,R.pJ)(n),d=!!e&&_.b4.includes(e.type)&&(0,R.Mw)(e,l,.4),u=(0,R.pW)(l,s||n||d,t);return a.useEffect(()=>{if(c&&!n){if(d){r(e.findContainingFragmentOrSelf());return}r(u)}},[u,d,e,n,c]),i}({selectedNode:(0,N.Vr)(),config:t,disabled:e}),disabled:e})}(e);return e?{suggestions:[],analyticsData:_.YQ,isLoading:!1,isInitialized:!1,suggestionsNodeGuid:void 0,debugString:""}:t}(d),L=(0,c.Xr)(ea),O=ec(),P=(0,m.ut)(r.Ez5?.editorPreferences().showAssetAutoSuggest,!0),[G,U]=a.useState(null),H=P&&S.length>0&&s&&z||!!G,B=a.useCallback(()=>{let e=!H;r.Ez5?.editorPreferences().showAssetAutoSuggest.set(e),U(e),(0,f.gb)(A,e?_.GG.PANEL_OPENED:_.GG.PANEL_CLOSED,_.qd.ASSET_PANEL)},[H,A]);a.useEffect(()=>{if(h.current?.clientHeight)L(h.current?.clientHeight);else{let e=en+8;H&&(e+=O),(0,o.kc)().anticipation_trigger_debug&&(e+=16),L(e)}},[H,O,L]);let{currentView:V}=(0,$.wV)(),W=V===$.S5.Libraries?0:1,Y=(0,c.md)(g.a);return d||(!z||H&&I||H&&"loading"===u.status?e=(0,n.jsx)(x.k,{size:"md"}):H||(e=(0,n.jsx)("div",{...{0:{className:"xw4jnvo x1qx5ct2 xy3p2pi x78zum5 x6s0dn4 xl56j7k x16rqkct xcr9a89 x1fgql6j"},1:{className:"xw4jnvo x1qx5ct2 xy3p2pi x78zum5 x6s0dn4 xl56j7k x16rqkct x1v8gsql x1n0bwc9"}}[!!Y<<0],children:S.length}))),(0,n.jsxs)("div",{className:"xso031l x1q0q8m5 xertd99 x1e56ztr",ref:h,children:[(0,n.jsx)(Z.B,{children:(0,n.jsxs)(J.H,{children:[(0,n.jsxs)(i.E,{onClick:B,className:"x1iyjqo2",children:[(0,n.jsx)(Q.g,{isExpanded:H}),(0,l.tx)("auto_suggest.asset_panel.title")]}),(0,n.jsx)("div",{className:"x78zum5 x6s0dn4",children:e})]})}),H&&(0,n.jsxs)(X.A,{index:W,width:t,children:[(0,n.jsx)("div",{children:(0,n.jsx)(ei,{suggestions:S,analyticsData:A,hasLibraries:s,subscribedLibraries:u.data})}),(0,n.jsx)("div",{})]}),(0,o.kc)().anticipation_trigger_debug&&(0,n.jsx)("div",{className:"xh8yej3 xlup9mm xw2csxc x10wlt62",children:M})]})}function el(){let e=(0,D.r8)(),{currentView:t}=(0,$.wV)();return e&&t===es}function eo(){let e=el();return(function(){let e=(0,c.md)($.W9),t=(0,u.ZC)(e),{suggestions:s,analyticsData:n}=(0,c.md)(g.P),{currentView:i}=(0,$.wV)(),r=(0,u.ZC)(i);a.useEffect(()=>{!1===t&&!0===e&&s.length>0&&n.queryId&&r===es&&(0,f.gb)(n,_.GG.STARTED_SEARCH,_.qd.ASSET_PANEL)},[t,e,s,n,r])}(),e)?(0,n.jsx)(er,{}):null}function ec(){let e=(0,W.O)();return Math.max(a.useMemo(()=>{let t=e.numColumnsByLayout[G.rp.NORMAL];return Math.ceil(_.lS/t)*((0,V.Hw)(e.componentTilePropsByLayout[G.rp.NORMAL].thumbHeight,Y.$H.GRID,{showFileName:!0})+16)},[e]),150)}},293147:(e,t,s)=>{s.d(t,{f:()=>eF});var n=s(239976),a=s(105652),i=s(20002),r=s(57712),l=s(288350),o=s(378721),c=s(726577),d=s(943360),u=s(269751),x=s(346524),m=s(321204),p=s(730436),h=s(6477),g=s(25300),f=s(692376),_=s(854225),y=s(2227),k=s(379141),v=s(270450),b=s(445019),j=s(224542),C=s.n(j),w=s(916626),E=s(193397),N=s(184743),S=s(289555),T=s(29161),I=s(499735),A=s(86742),M=s(770957),z=s(17147),L=s(684170),O=s(564669),P=s(282746),R=s(971340),D=s(933870),F=s(259714),q=s(888903),G=s(39171),U=s(540098),K=s(772293),H=s(557909),B=s(319971),V=s(341153),$=s(862390),W=s(384203),Y=s(323747),X=s(741402),Z=s(236410),J=s(735786),Q=s(429921),ee=s(415839),et=s(563225),es=s(964731),en=(e=>(e[e.NONE=0]="NONE",e[e.TOP=1]="TOP",e[e.MIDDLE=2]="MIDDLE",e[e.BOTTOM=3]="BOTTOM",e[e.ALL=4]="ALL",e))(en||{}),ea=(e=>(e[e.NONE=0]="NONE",e[e.SINGLE=1]="SINGLE",e[e.MULTI=2]="MULTI",e))(ea||{}),ei=s(36001);let er=(0,b.eU)(!1),el=a.memo(function(e){let t=(0,b.Xr)(er),s=(0,i.wA)(),a=(0,i.d4)(e=>e.canvasSearch.scope),r=(0,i.d4)(e=>e.mirror.appModel.pagesList),{allInstancesExpanded:l}=e,{getTriggerProps:o,manager:c}=J.b(),u=ec(a);return(0,n.jsx)(Q.o,{eventListeners:["onClick"],children:(0,n.jsxs)(J.bL,{manager:c,children:[(0,n.jsxs)(d.E,{recordingKey:"figma_design_search_page_scope_dropdown",className:ei.Vz,"aria-label":(0,k.t)("canvas_search.scope_dropdown_aria_label",{scope:u}),"data-testid":"figma-design-search-scope-dropdown",...o(),children:[u,(0,n.jsx)(et.O,{})]}),(0,n.jsxs)(J.mc,{children:[(0,n.jsx)(eo,{option:f.Lov.ACTIVE_PAGE,activeOption:a,onClickCallback:e=>{s(U.V2(e))}}),(0,n.jsx)(eo,{option:f.Lov.ALL_PAGES,activeOption:a,onClickCallback:e=>{(0,Y.lH)(r)||!l?(t(!0),requestAnimationFrame(()=>{s(U.V2(e)),t(!1)})):s(U.V2(e))}})]})]})})});function eo({option:e,activeOption:t,onClickCallback:s}){let a=(0,es.BK)("CANVAS_SEARCH_PAGE_SCOPE_DROPDOWN");return(0,n.jsx)(ee.H_,{recordingKey:`figma_design_search_page_scope.${e}`,checked:e===t,onChange:()=>{a.hide(),s(e)},children:ec(e)},e)}let ec=e=>{switch(e){case f.Lov.ACTIVE_PAGE:return(0,k.t)("canvas_search.this_page");case f.Lov.ALL_PAGES:return(0,k.t)("canvas_search.all_pages")}};var ed=s(787049),eu=s(103922);s(323264);var ex=s(14681),em=s(579263),ep=s(599249);function eh({short:e,options:t,recordingKey:s}){let r=(0,i.wA)(),l=(0,i.d4)(e=>e.canvasSearch.filters),o=(0,em.HY)(),c=(0,P.b)()||o,d=a.useCallback(e=>{r(U.DI(e))},[r]),u=a.useMemo(()=>(0,ed.RP)(t,e=>l[e]?(0,n.jsx)(eu.v,{hasCloseButton:!0,onClose:()=>d(e),"aria-label":(0,k.t)("canvas_search.filter.remove_filter",{filter:(0,ep.p9)(e)}),recordingKey:I.Pt(s,ex.kM[e],"remove"),children:(0,ep.p9)(e)},`filter-chip-${e}`):null),[l,d,t,s]);return u.length?(0,n.jsx)("div",{"data-testid":"search-filter-chip-container",...{0:{className:"x78zum5 x1a02dak x1jnr06f xexx8yu xy13l1i x1ykpatu x163pfp"},2:{className:"x78zum5 x1a02dak x1jnr06f xexx8yu xyfqnmn xsag5q8 xnm25rq"},1:{className:"x78zum5 x1a02dak x1jnr06f xexx8yu xy13l1i x163pfp xjkvuk6"},3:{className:"x78zum5 x1a02dak x1jnr06f xexx8yu xyfqnmn xnm25rq xjkvuk6"}}[!!c<<1|!!e<<0],children:u}):null}var eg=s(382367),ef=s(575385);function e_({short:e,mode:t,recordingKey:s}){let a=(0,i.wA)(),r=(0,i.d4)(e=>e.canvasSearch.filters),l=t===f.EW4.FIND?ep.D4:ep.IM,o=(0,P.b)(),c=(0,ed.RP)(l,e=>r[e]?(0,n.jsx)(ey,{option:e,onClose:()=>{a(U.DI(e))},recordingKey:s},e):null);return 0===c.length?null:(0,n.jsx)("div",{className:C()(ef.VS,{[ef.JE]:e,[ef.oZ]:o}),children:c})}function ey({option:e,onClose:t,recordingKey:s}){return(0,n.jsxs)("div",{className:ef.WP,children:[(0,ep.p9)(e),(0,n.jsx)(d.E,{className:ef._0,onClick:t,"aria-label":(0,k.t)("canvas_search.filter.remove"),"aria-describedby":(0,ep.p9)(e),recordingKey:I.Pt(s,ex.kM[e],"remove"),children:(0,n.jsx)(eg.f,{})})]})}var ek=s(109965),ev=s(363198),eb=s(544392),ej=s(17248),eC=s(479690),ew=s(99932),eE=s(473583),eN=s(865702),eS=s(723850),eT=s(577355);function eI(e,t=!1){if(t||(0,eT.U5)(e,eT.W0.YES)){let t=(0,eT.f7)(e);return t&&e.stopPropagation(),t}return!1}function eA(e,t,s,n){let r=(0,eC.II)(),l=function(){let e=(0,V.Z)("canvas_search_navigate"),t=(0,i.d4)(e=>e.canvasSearch.scope),s=(0,eS.am)(),n=(0,a.useContext)(eC.EA),r=(0,a.useCallback)(()=>{s("canvas_search_multi_hierarchy",{order:"down"}),f.YEY&&e(f.YEY.moveActiveResultsDownOneLevelAndGetViewportSettings(),{additionalTrackEventParams:{searchScope:f.Lov[t]}})},[e,t,s]);return n?r:eN.lQ}(),o=function(){let e=(0,V.Z)("canvas_search_navigate"),t=(0,i.d4)(e=>e.canvasSearch.scope),s=(0,eS.am)(),n=(0,a.useContext)(eC.EA),r=(0,a.useCallback)(()=>{s("canvas_search_multi_hierarchy",{order:"up"}),f.YEY&&e(f.YEY.moveActiveResultsUpOneLevelAndGetViewportSettings(),{additionalTrackEventParams:{searchScope:f.Lov[t]}})},[e,t,s]);return n?r:eN.lQ}(),c=(0,a.useContext)(eC.EA);return(0,a.useCallback)(a=>{switch(c?(0,N.Fo)(a)&&!a.shiftKey?n(ea.SINGLE):a.shiftKey?n(ea.MULTI):n(ea.NONE):n(ea.NONE),a.keyCode){case N.Uz.P:case N.Uz.UP_ARROW:(a.keyCode!==N.Uz.P||T.Ay.mac&&(0,N.vN)(a,N.xH.CONTROL))&&(e(ep.OP.PREV,"keyboard"),a.stopPropagation(),a.preventDefault());break;case N.Uz.N:case N.Uz.DOWN_ARROW:(a.keyCode!==N.Uz.N||T.Ay.mac&&(0,N.vN)(a,N.xH.CONTROL))&&(e(ep.OP.NEXT,"keyboard"),a.stopPropagation(),a.preventDefault());break;case N.Uz.ENTER:if(f.YEY&&(0,N.Fo)(a)){f.YEY.exitSearchMode(f.dNx.SELECT_ACTIVE);break}if(r())break;a.shiftKey?t?o():e(ep.OP.PREV,"keyboard"):t?l():e(ep.OP.NEXT,"keyboard"),a.stopPropagation(),a.preventDefault();break;case N.Uz.ESCAPE:f.YEY&&f.YEY.exitSearchMode(f.dNx.NONE),a.preventDefault(),a.stopPropagation();break;default:s(a)}},[c,n,r,s,e,t,o,l])}function eM(e){return(0,a.useCallback)(t=>{if(t.keyCode===N.Uz.SHIFT){(!T.Ay.mac||t.metaKey)&&(T.Ay.mac||t.ctrlKey)||e(ea.NONE);return}let s=T.Ay.mac&&"Meta"===t.key,n=!T.Ay.mac&&t.keyCode===N.Uz.CTRL;(s||n)&&!t.shiftKey&&e(ea.NONE)},[e])}function ez(e){switch(e.keyCode){case N.Uz.DELETE:case N.Uz.BACKSPACE:if(f.YEY)return f.YEY.getNextResultForActiveResultRemoval();break;case N.Uz.X:if((0,N.Te)(e)&&f.YEY)return f.YEY.getNextResultForActiveResultRemoval();break;case N.Uz.H:case N.Uz.R:if((0,N.Fo)(e)&&e.shiftKey&&f.YEY)return f.YEY.getNextResultForActiveResultRemoval()}return y.AD}var eL=s(225622),eO=s(334272),eP=s(96780),eR=s(684081),eD=s(479304);let eF=(0,w.w)(a.memo(function({showFilter:e,showCloseButton:t=!0}){let{query:s,resultsOnOtherPages:i,next:r,exit:d,setNavigateNearestOnce:u,search:x,showSearch:h,mode:g,isLoading:_,allInstancesExpanded:j,missingResultsOnSomePages:w}=(0,eC.SQ)(),[E,S]=(0,a.useState)(""),{focusedByButtons:T,inputRef:I}=(0,eC.CT)(),A=(0,a.useRef)(null),M=(0,G.to)(),O=(0,V.Z)("canvas_search_navigate"),D=(0,b.md)(L.Wy),F=(0,b.md)(L.ml),q=(0,b.md)(L.Ch),U=(0,a.useContext)(eC.EA),H=(0,b.md)(er),[$,W]=(0,a.useState)(null),[Y,J]=(0,a.useState)(ea.NONE),[Q,ee]=(0,a.useState)(!1),et=(0,a.useId)();(0,a.useLayoutEffect)(()=>{if(U){if(F.size>1||D.size>1){ee(!0);return}for(let e of D.values())e.size>1&&ee(!0)}},[D,U,F]);let es=(0,a.useCallback)((e,t)=>{ee(!1),r(e,t)},[r]),en=function(e,t,s){if(!s)return!1;if(t.size>1||e.size>1)return!0;for(let t of e.values())return t.size>1;return!1}(D,F,U),el=function(e,t,s,n,i){let r=eA(e,s,e=>{let s=(e.keyCode===N.Uz.D||e.keyCode===N.Uz.F)&&(0,N.Fo)(e)&&e.shiftKey;eI(e)&&!s&&t.current?.focus()},i);return(0,a.useCallback)(e=>{let a=ez(e);switch(e.keyCode){case N.Uz.RIGHT_ARROW:case N.Uz.LEFT_ARROW:(0,N.Te)(e)||r(e);break;case N.Uz.C:case N.Uz.X:(0,N.Te)(e)&&window.getSelection&&!window.getSelection().toString()&&(K.Y5.triggerAction(e.keyCode===N.Uz.C?"copy":"cut"),e.preventDefault(),e.stopPropagation(),e.keyCode===N.Uz.X&&t.current?.focus());break;case N.Uz.V:case N.Uz.Z:break;default:r(e)}f.YEY&&!s&&a!==y.AD&&n(f.YEY.setActiveResultAndGetViewportSettings(a,0),{delay:300})},[s,r,t,n])}(es,A,en,O,J),eo=eM(J);(0,eC.A5)(I,r,T);let ec=(0,eC.aH)(),ed=(0,P.b)(),eu=(0,em.HY)();if(!h)return null;let ex=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.h,{htmlFor:et,children:(0,k.tx)("canvas_search.find")}),(0,n.jsx)("div",{className:C()(ei.v9,{[ei.ei]:""===s}),children:(0,n.jsx)(m.W,{})}),(0,n.jsx)(eC.ih,{ariaActiveDescendant:eK(q),editorType:X._Y.DESIGN,focusedByButtons:T,id:et,innerRef:I,onChange:e=>{ee(!1),x(e)},onKeyDown:el,onKeyUp:eo,onPasteCapture:e=>{(0,B.gk)(e)&&(K.Y5.triggerActionInUserEditScope("paste"),e.preventDefault(),A.current?.focus())},query:s})]}),eg=(0,n.jsxs)("div",{"data-testid":"search-sidebar",className:ei.G$,onBlurCapture:e=>{e.relatedTarget&&!e.currentTarget.contains(e.relatedTarget)&&(f.YEY.setOverlayVisible(!1),u(),J(ea.NONE))},children:[(0,n.jsxs)("div",{className:ei.PP,children:[(0,n.jsxs)("div",{className:C()(ei.Wv,(ed||eu)&&ei.Fn),children:[(0,n.jsx)("div",{className:ei.Z9,children:ex}),e&&(0,n.jsx)(eE.Od,{lean:eE.I_.RIGHT,shouldShowSearchCategories:!M,minWidth:(0,v.kc)().eu_fpl_migration_search_settings_menu?156:void 0,recordingKey:"figma_design_search"}),t&&!eu&&(0,n.jsx)(o.K,{onClick:e=>{d(),ec(e)},"aria-label":(0,k.t)("canvas_search.close"),recordingKey:"figma_design_search.close","data-tooltip-type":Z.Ib.TEXT,"data-tooltip":(0,k.t)("canvas_search.close"),children:(0,n.jsx)(p.X,{})})]}),(0,v.kc)().eu_fpl_search_result_chips&&(0,n.jsx)(eh,{recordingKey:"figma_design_search.filterChips",options:g===f.EW4.FIND?ep.D4:ep.IM,short:g===f.EW4.REPLACE}),!(0,v.kc)().eu_fpl_search_result_chips&&(0,n.jsx)(e_,{mode:g,short:g===f.EW4.REPLACE,recordingKey:"figma_design_search.filterPills"}),g===f.EW4.REPLACE&&(0,n.jsx)(ew.a,{query:s,value:E,onChange:S,onFocus:(e,t)=>{!s&&t&&I.current?.focus()},hasMultipleSelections:en,recordingKey:"figma_design_search"})]}),_||H?(0,n.jsx)("div",{className:C()(ei.S,ei.dz),children:(0,n.jsx)(R.dW,{size:"medium",testId:"canvas-search-loading-spinner"})}):s&&!(0,z.jN)(s)&&(0,n.jsx)(eq,{allInstancesExpanded:j,hasMultipleSelections:en,hoverSelectMode:Y,hoveredResult:$,isInMultiselectMode:Q,missingResultsOnSomePages:w,navigate:O,onNext:es,replacement:g===f.EW4.REPLACE?E:void 0,resultInputHandlerRef:A,resultsOnOtherPages:i,setHoverSelectMode:J,setHoveredResult:W,setIsInMultiselectMode:ee})]});return eu?eg:(0,n.jsx)(c.i,{children:eg})}),"FigmaSearchSidebar");function eq({onNext:e,navigate:t,replacement:s,resultsOnOtherPages:l,resultInputHandlerRef:c,hoveredResult:u,hasMultipleSelections:x,isInMultiselectMode:m,missingResultsOnSomePages:p,hoverSelectMode:v,setIsInMultiselectMode:j,setHoverSelectMode:w,setHoveredResult:S,allInstancesExpanded:T}){let I=(0,i.wA)(),M=(0,eC.WB)(),z=(0,eC.II)(),O=(0,W.p8)("currentPage"),P=(0,a.useRef)(null),F=(0,i.d4)(e=>e.canvasSearch.scope),q=f.YEY.hasDirtyPrimaryInstances(),G=(0,b.md)(L.Fk),H=(0,b.md)(L.Ch),B=(0,b.md)(L.Wy),$=(0,b.md)(L.ml),Y=(0,b.md)(L.hw),X=(0,a.useContext)(eC.EA),J=!m,Q=null==s,ee=(0,eC.L4)(),et=function(e,t){let s=(0,V.Z)("canvas_search_navigate"),n=(0,i.d4)(e=>e.canvasSearch.scope),r=(0,eS.am)(),l=(0,a.useContext)(eC.EA),o=(0,a.useCallback)(a=>{if(!f.YEY)return;let{nav:i,numNewNodes:l,numNewTextMatches:o}=f.YEY.addActiveResultsAndGetViewportSettings(a);e&&r("canvas_search_enter_multi_select",{numberOfNodes:l,numberOfTextMatches:o,source:"shift+click",mode:t?"find":"replace"}),s(i,{additionalTrackEventParams:{searchScope:f.Lov[n]}})},[t,s,n,r,e]);return l?o:eN.lQ}(J,Q),es=function(){let e=(0,V.Z)("canvas_search_navigate"),t=(0,i.d4)(e=>e.canvasSearch.scope),s=(0,a.useContext)(eC.EA),n=(0,a.useCallback)((s,n,a)=>{f.YEY&&e(f.YEY.removeActiveResultAndGetViewportSettings(s,n,a),{additionalTrackEventParams:{searchScope:f.Lov[t]}})},[e,t]);return s?n:eN.lQ}(),[er,el]=function(...e){let[t,s]=(0,a.useState)(()=>e.reduce((e,t)=>(e[t]=!0,e),{}));return[t,(0,a.useCallback)((e,t=!0)=>{s(s=>s[e]!==t?{...s,[e]:t}:s)},[])]}(y.Xy,O),eo=(0,a.useRef)({}),ec=(0,a.useMemo)(()=>{let e=[],t=M.find(e=>e.pageId===y.Xy),s=F===f.Lov.ALL_PAGES||!!t,n=M.find(e=>e.pageId===O),a=M;F===f.Lov.ACTIVE_PAGE&&(a=[],t&&a.push(t),n&&a.push(n));let i=0;for(let{pageId:t,results:n}of(eo.current={},a)){if(0===n.length)continue;let a=!!er[t];if(s&&(e.push({type:"header",data:{pageId:t,open:a,numResults:n.reduce((e,t)=>e+=t.textMatches.length,0)}}),++i),s&&!a)continue;eo.current[t]=i;let r=0;for(let s of n){let{textMatches:n,...a}=s;n.forEach((s,n)=>{e.push({type:"result",data:{...a,matchIndex:n,textMatch:s,index:r,pageId:t}}),++r,++i})}}return e},[O,er,F,M]);(0,a.useEffect)(()=>{null!=H&&el(H.pageId)},[H,el]);let ed=(0,r.z)({size:ec.length,parentRef:P,overscan:10}),eu=(0,a.useCallback)(e=>{if(null==H||null==H.index)return[];let t=eo.current[H.pageId];if(null==t)return[];let s=t+H.index;if(s===e||ec[e]&&"header"===ec[e].type)return[];let n=[],a=Math.min(s,e),i=Math.max(s,e);for(let e=a;e<=i&&e<ec.length;e++){let t=ec[e];t&&"result"===t.type&&n.push(t.data)}return n},[H,ec]),ex=(0,a.useCallback)(e=>!!X&&"header"!==e.type&&(!!m||v!==ea.NONE)&&(e.data.textMatch.matchType===f.Ifi.TEXT_MATCH&&$.has(e.data.resultGuid)&&!B.has(e.data.resultGuid)||Y.has(e.data.resultGuid)),[B,X,$,v,Y,m]),em=(0,a.useCallback)(e=>"header"!==e.type&&(X?e.data.textMatch.matchType===f.Ifi.PAGE_MATCH?e.data.index===H?.index&&e.data.pageId===H?.pageId:e.data.textMatch.matchType===f.Ifi.LAYER_MATCH?$.has(e.data.resultGuid)&&!B.get(e.data.resultGuid):B.get(e.data.resultGuid)?.has(e.data.matchIndex)??!1:e.data.index===H?.index&&e.data.pageId===H?.pageId),[H?.index,H?.pageId,B,X,$]),eh=(0,a.useCallback)((e,t,s)=>{let n=e+s,a=t+s,i=e=>"result"===e.type&&(em(e)||ex(e));for(;n>0&&n<=ec.length&&ec[n-1]&&i(ec[n-1]);)n-=1;for(;a<ec.length&&ec[a]&&i(ec[a]);)a+=1;return[n-s,a-s]},[ex,em,ec]),eg=(0,a.useCallback)((e,t)=>{if(e+t>=ec.length)return!1;let s=ec[e+t];return s&&!em(s)&&!ex(s)},[ex,em,ec]),ef=(0,a.useCallback)((e,t,s)=>{let n=!1;for(let a=e;a<=t&&!(a+s>=ec.length);a+=1){let e=ec[a+s];if(e&&!em(e)&&!ex(e)){n=!0;break}}return n},[ex,em,ec]),[e_,ey]=(0,a.useMemo)(()=>{let e=u?.nodeGuid??y.AD,t=H?.pageId!=null?eo.current[H.pageId]:null;if(X&&v!==ea.NONE&&u&&e!==y.AD&&u.pageId===H?.pageId&&null!=t){let s=u.index,n=u.matchIndex;if((v===ea.SINGLE||H?.index==null)&&eg(s,t))return[s,f.YEY.getSingleHoveredSelectionEndIndex(e,n)];if(v===ea.MULTI&&H?.index!=null&&H.index!==u.index){let a=s>H.index?H.index:s;return ef(a,s>H.index?s:H.index,t)?eh(a,f.YEY.getMultiHoveredSelectionEndIndex(e,n),t):[null,null]}}return[null,null]},[H?.index,H?.pageId,X,eh,v,u,ef,eg]),ek=(0,a.useCallback)(e=>!X||null==e_||null==ey||e<e_||e>=ey?en.NONE:e===e_&&e===ey-1?en.ALL:e===e_?en.TOP:e===ey-1?en.BOTTOM:en.MIDDLE,[X,e_,ey]),ej=(0,E.$)(H);(0,a.useEffect)(()=>{if(m||v!==ea.NONE||null==H||null==H.index||0===ec.length||!ej)return;let e=eo.current[H.pageId];if(null==e)return;let t=e+H.index,s=t>=ed.virtualItems[0].index&&t<=ed.virtualItems[ed.virtualItems.length-1].index,n=!1;if(s){let e=ed.virtualItems.find(e=>e.index===t);if(e){let{start:t,size:s}=e;n=function(e,t){if(!t)return!0;let s=t.scrollTop,n=s+t.clientHeight;return e.top>=s&&e.bottom<=n}({top:t,bottom:t+s},P.current)}}n||q||ed.scrollToIndex(t,{align:"center"})},[H,ej,c,m,ec,q,ed,v]);let ew=(0,a.useCallback)((e,t)=>{t?es(e.resultGuid,e.matchIndex,e.textMatch.matchType):et([{nodeId:e.resultGuid,matchIndices:[e.matchIndex],searchResultType:e.textMatch.matchType}])},[et,es]),eE=(0,a.useCallback)(e=>{let t=eu(e),s=[];t.forEach(e=>{let t=s.length?s[s.length-1]:void 0;t?.nodeId===e.resultGuid&&t?.searchResultType===f.Ifi.TEXT_MATCH?t.matchIndices.push(e.matchIndex):s.push({nodeId:e.resultGuid,matchIndices:[e.matchIndex],searchResultType:e.textMatch.matchType})}),et(s)},[et,eu]),eT=(0,a.useCallback)((e,t,s,n)=>{t.pageId===y.Xy?(z(t.guid),el(t.guid),j(!1)):X&&t.pageId===H?.pageId?e.shiftKey&&H?.index==null?(n||ew(t,n),j(!0)):e.shiftKey?(eE(s),j(!0)):(0,N.Fo)(e)&&t.textMatch.matchType!==f.Ifi.PAGE_MATCH?(ew(t,n),j(!0)):(ee(t.resultGuid,t.matchIndex),j(!1)):(ee(t.resultGuid,t.matchIndex),j(!1))},[X,H?.pageId,H?.index,z,el,j,ee,ew,eE]),eL=function(e,t,s,n,r,l,o){let c=function(e,t){let s=(0,V.Z)("canvas_search_navigate"),n=(0,i.d4)(e=>e.canvasSearch.scope),r=(0,eS.am)(),l=(0,a.useContext)(eC.EA),o=(0,a.useCallback)(()=>{if(!f.YEY)return;let{nav:a,numNewNodes:i,numNewTextMatches:l}=f.YEY.setAllResultsAsActiveAndGetViewportSettings();e&&r("canvas_search_enter_multi_select",{numberOfNodes:i,numberOfTextMatches:l,source:"cmd/ctrl+A",mode:t?"find":"replace"}),s(a,{additionalTrackEventParams:{searchScope:f.Lov[n]}})},[t,s,n,r,e]);return l?o:eN.lQ}(s,n),d=(0,a.useContext)(eC.EA),u=eA(e,r,eI,l);return(0,a.useCallback)(e=>{let s=ez(e);switch(e.keyCode){case N.Uz.UP_ARROW:case N.Uz.DOWN_ARROW:case N.Uz.RIGHT_ARROW:case N.Uz.LEFT_ARROW:r?(!function(){let e=document.getElementById("fullscreen-root")?.getElementsByClassName("focus-target");if(null!=e&&0!==e.length){for(let t of e)if(t.hasAttribute("readonly")&&"application"===t.getAttribute("role")){t?.focus();break}}}(),eI(e,!0)):u(e);break;case N.Uz.A:if(d&&(0,N.Te)(e)){c(),o(!0),e.stopPropagation(),e.preventDefault();break}eI(e);break;case N.Uz.C:(0,N.Te)(e)?(K.Y5.triggerActionInUserEditScope("copy"),e.stopPropagation()):eI(e);break;case N.Uz.V:(0,N.Te)(e)?(K.Y5.triggerActionInUserEditScope("paste"),e.stopPropagation()):eI(e);break;case N.Uz.X:(0,N.Te)(e)?(K.Y5.triggerActionInUserEditScope("cut"),e.stopPropagation()):eI(e);break;case N.Uz.DELETE:case N.Uz.BACKSPACE:eI(e,!0);break;default:u(e)}f.YEY&&!r&&s!==y.AD&&t(f.YEY.setActiveResultAndGetViewportSettings(s,0),{delay:300})},[r,d,u,c,o,t])}(e,t,J,Q,x,w,j),eO=eM(w),eP=(0,ev.cJ)(),eR=(0,b.Xr)(eb.lx),eD=(0,a.useCallback)(()=>{f.YEY&&f.YEY.exitSearchMode(f.dNx.SELECT_ACTIVE),eP&&eR(_.Nfd.FILE)},[eP,eR]),eF=(0,a.useMemo)(()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.D8,{style:{height:ed.totalSize,position:"relative"},tabIndex:0,role:"listbox","aria-multiselectable":"true",recordingKey:"figma_design_search.results_list",onKeyDown:eL,onKeyUp:eO,forwardedRef:c,"aria-label":(0,k.t)("search.search_results"),children:ed.virtualItems.map(e=>{let t=ec[e.index];if(!t)return null;let a=em(t),i="result"===t.type&&t.data.pageId===H?.pageId?ek(t.data.index):en.NONE;return(0,n.jsx)("div",{ref:e.measureRef,className:C()({[ei.T]:i===en.TOP,[ei.fz]:i===en.MIDDLE,[ei.Nf]:i===en.BOTTOM,[ei.HR]:(v===ea.SINGLE||H?.index==null)&&u?.isPurple}),style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${e.start}px)`},children:"header"===t.type?(0,n.jsx)(eU,{...t.data,setOpen:e=>el(t.data.pageId,e)}):(0,n.jsx)(eH,{activePageId:H?.pageId,hasMultipleSelections:x,indirectlySelected:ex(t),isInHoveredSelectMode:v!==ea.NONE&&!!u,isInMultiselectMode:m,onDoubleClick:eD,onSelect:s=>eT(s,t.data,e.index,a),replacement:s,result:t.data,resultInputHandlerRef:c,selected:a,setHoveredResult:S,singletonHoverSelected:i===en.ALL})},"header"===t.type?t.data.pageId:`${t.data.pageId}#${t.data.index}`)})}),q&&(0,n.jsx)("div",{className:ei.S,children:(0,n.jsx)(R.dW,{size:"medium"})}),l&&F===f.Lov.ACTIVE_PAGE&&(0,n.jsx)(d.E,{recordingKey:"figma_design_search.other_pages_button",className:C()(ei.fp,ei.AX),onClick:()=>{I(U.V2(f.Lov.ALL_PAGES))},children:(0,k.tx)("canvas_search.results_other_pages")}),p&&F===f.Lov.ALL_PAGES&&(0,n.jsx)("div",{className:ei.du,children:(0,k.tx)("canvas_search.results_unavailable_offline")})]}),[H?.index,H?.pageId,I,ek,eT,x,v,u,m,ex,em,eL,eO,p,eD,s,c,ec,l,F,S,el,q,ed.totalSize,ed.virtualItems]);return(0,n.jsxs)("div",{className:ei.sb,children:[(0,n.jsxs)("div",{className:ei.Jo,children:[(0,n.jsx)(eG,{totalOnActivePage:G.total,resultsOnOtherPages:l,allInstancesExpanded:T}),0!==ec.length&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.K,{onClick:t=>{e(ep.OP.PREV,"button")},"aria-label":(0,k.t)("canvas_search.previous"),recordingKey:"figma_design_search.previous",disabled:G.total<=1,"data-tooltip-type":Z.Ib.TEXT,"data-tooltip":(0,k.t)("canvas_search.previous"),"data-tooltip-shortcut-key":"canvas-search-prev",children:(0,n.jsx)(h.l,{})}),(0,n.jsx)(o.K,{onClick:t=>{e(ep.OP.NEXT,"button")},"aria-label":(0,k.t)("canvas_search.next"),recordingKey:"figma_design_search.next",disabled:G.total<=1,"data-tooltip-type":Z.Ib.TEXT,"data-tooltip":(0,k.t)("canvas_search.next"),"data-tooltip-shortcut-key":"canvas-search-next",children:(0,n.jsx)(g.k,{})})]})]}),(0,n.jsx)(D.P,{className:ei.bB,scrollContainerRef:P,children:eF})]})}function eG({totalOnActivePage:e,resultsOnOtherPages:t,allInstancesExpanded:s}){let a=(0,ej.sO)(),r=(0,ev.cJ)(),l=(0,G.to)(),o=(0,i.d4)(e=>e.mirror.appModel.pagesList),c="";c=0===e?(0,Y.lH)(o)||!s?a?(0,k.t)("canvas_search.no_results_in_this_deck"):r?(0,k.t)("canvas_search.no_results_on_site"):l?(0,k.t)("canvas_search.no_results_in_buzz_file"):(0,k.t)("canvas_search.no_results_on_page"):t?(0,k.t)("canvas_search.no_results"):(0,k.t)("canvas_search.no_results_in_file"):(0,k.t)("canvas_search.results_count",{total:e});let d=(!a&&!r&&!l||(0,v.kc)().interop_pages)&&(e>0||t||(0,Y.lH)(o)||!s);return(0,n.jsxs)("div",{className:ei._M,children:[(0,n.jsx)(u.T,{"data-testid":"canvas-search-info",className:ei.qp,role:e>0?"status":"alert",children:c}),d&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:ei.hY,children:"\xb7"}),(0,n.jsx)(el,{allInstancesExpanded:s})]})]})}function eU({pageId:e,open:t,setOpen:s,numResults:a}){let i=(0,W.eY)().get(e),r=e===y.Xy?(0,k.t)("fullscreen.canvas_search.pages"):i.name;return(0,n.jsxs)(A.GG,{className:ei.kQ,onClick:()=>s(!t),"aria-expanded":t,children:[(0,n.jsx)(F.B,{className:ei.eO,svg:t?eL.A:eO.A}),(0,n.jsx)("span",{className:ei.rB,children:r}),(0,n.jsx)("span",{className:ei.hs,children:a})]})}function eK(e){return e&&null!==e.index?`search-result-option-page-${e.pageId}-index-${e.index}`:""}function eH({result:e,replacement:t,activePageId:s,resultInputHandlerRef:r,selected:l,indirectlySelected:o,singletonHoverSelected:c,onSelect:d,onDoubleClick:u,isInMultiselectMode:x,isInHoveredSelectMode:m,hasMultipleSelections:p,setHoveredResult:h}){let g=(0,W.eY)(),_=(0,W.p8)("currentPage"),v=e.textMatch.matchType===f.Ifi.TEXT_MATCH,b=null!=t&&v&&(g.get(e.guid)?.hasMissingFont||!1),j=!(0,S.yZ)(),w=(0,i.d4)(e=>e.mirror.appModel.pagesList),E=j&&e.textMatch.matchType===f.Ifi.PAGE_MATCH&&f.h3O.isIncrementalSession()&&(0,Y.Fy)(w,e.resultGuid)!==f.xal.LOADED,N=(0,i.wA)(),M=C()(ei.V3,{[ei.HR]:e.isPurple,[ei.wH]:l,[ei.r9]:E}),z=(0,n.jsx)(ek.Bf,{className:M,guid:e.guid});b?z=(0,n.jsx)("div",{className:ei.v9+" "+M,children:(0,n.jsx)(F.B,{svg:eD.A})}):e.guid===_&&(z=(0,n.jsx)("div",{className:ei.v9+" "+M,children:(0,n.jsx)(F.B,{svg:eP.A})}));let L=(0,a.useCallback)(e=>{x||E||u(e)},[x,E,u]),O=(0,a.useMemo)(()=>({nodeGuid:e.resultGuid,pageId:e.pageId,index:e.index,matchIndex:e.matchIndex,isPurple:e.isPurple}),[e]);return(0,n.jsxs)(A.GG,{"aria-selected":l||e.guid===_,className:C()({[ei.AX]:!0,[ei.wH]:l,[ei.Xt]:!l&&o,[ei.rX]:c,[ei.Dw]:m,[ei.HR]:e.isPurple,[ei.r9]:E}),id:eK(e),onClick:t=>{E?N(q.F.enqueue({type:"offline-page-switch",message:(0,k.t)("fullscreen.pages_panel.unavailable_offline")})):(r.current?.focus(),x||!l||(T.Ay.mac?t.metaKey:t.ctrlKey)||e.textMatch.matchType===f.Ifi.PAGE_MATCH?d(t):!p&&f.YEY&&f.YEY.setOverlayVisible(!0)),t.preventDefault(),t.stopPropagation()},onDoubleClick:L,onMouseDown:e=>{e.preventDefault()},onMouseEnter:()=>{e.pageId===y.Xy||e.pageId!==s?h(null):h(O),v?f.YEY&&f.YEY.setHoveredResult(e.resultGuid,e.matchIndex):e.textMatch.matchType===f.Ifi.LAYER_MATCH&&(0,$.Uc)(e.resultGuid)},onMouseLeave:()=>{(0,$.Uc)(""),h(null),f.YEY&&f.YEY.setHoveredResult(y.AD,-1)},recordingKey:I.Pt("figma_design_search","result",e.pageId,e.index),role:"option",children:[(0,n.jsx)("div",{className:ei._P,children:z}),(0,n.jsx)("div",{className:C()(ei.D6,{[ei.c1]:v}),children:e.textContent&&v?(0,n.jsx)(eV,{text:e.textContent,match:e.textMatch,replacement:b?void 0:t,multiline:!0}):(0,n.jsx)(eB,{result:e})}),E&&(0,n.jsx)("div",{className:ei.QF,"data-tooltip-type":Z.Ib.TEXT,"data-tooltip":(0,k.t)("fullscreen.pages_panel.unavailable_offline"),"data-onboarding-key":"page-unavailable-offline",children:(0,n.jsx)(F.B,{className:ei.VQ,svg:eR.A})})]})}function eB({result:e}){let{query:t}=(0,i.d4)(e=>e.canvasSearch),s=e.name&&e.stateGroupName?(0,M.w)(e.name):e.name;if(!s)return null;let a=e.stateGroupName||e.containerName,r=-1;e.textContent&&(s=e.textContent,r=e.name?.toLowerCase().indexOf(t)??-1,a=e.name);let l=s.toLowerCase().indexOf(t)??-1;return(0,n.jsxs)("div",{children:[s&&l>-1?(0,n.jsx)(eV,{text:s,match:{start:l,end:l+t.length,matchType:f.Ifi.LAYER_MATCH},multiline:!0}):(0,n.jsx)(O.ph,{text:s}),a&&(0,n.jsx)("div",{className:ei.Gu,children:r>-1?(0,n.jsx)(eV,{text:a,match:{start:r,end:r+t.length,matchType:f.Ifi.LAYER_MATCH}}):(0,n.jsx)(O.ph,{text:a})})]})}function eV({text:e,match:t,replacement:s,multiline:i}){let[r,l]=(0,a.useState)(e),[o,c]=(0,a.useState)(!1);(0,a.useEffect)(()=>{l(e)},[e]),(0,a.useEffect)(()=>{if(!o||r!==e)return;let s=t.start,n=0;for(let t=s-1;t>=0;--t)if(/\s/.test(e[t])&&n++,3===n){s=t;break}n<3&&(s=0),l(e.slice(s))},[o,r,e,t.start]);let d=(0,a.useMemo)(()=>(0,n.jsx)(e$,{text:r,replacement:s,fullString:e,match:t}),[r,t,s,e]);return(0,n.jsx)(O.ph,{className:i?ei.c1:"",text:d,multiline:i,onTruncationChange:c})}function e$({text:e,replacement:t,fullString:s,match:a}){let i=0;s&&e!==s&&(i=s.length-e.length);let r=a.start-i,l=a.end-i,o=e.substring(0,r),c=e.substring(r,l),d=e.substring(l);if(t&&c.toLocaleLowerCase()!==t.toLocaleLowerCase()){let e=H.r.detectTextTransform(c);t=H.r.applyTextTransform(t,e)}return(0,n.jsxs)(n.Fragment,{children:[i?"\u2026":"",o,t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.E,{children:(0,k.tx)("canvas_search.original_replace_value")}),(0,n.jsx)("span",{className:ei.of,children:(0,n.jsx)("s",{children:c})}),(0,n.jsx)(x.E,{children:(0,k.tx)("canvas_search.updated_replace_value")}),(0,n.jsx)("b",{children:t})]}):(0,n.jsx)("b",{children:c}),d]})}},188850:(e,t,s)=>{s.d(t,{Cj:()=>h,yO:()=>p});var n=s(239976),a=s(105652),i=s(20002),r=s(787049),l=s(445019),o=s(31201),c=s(421564),d=s(865420),u=s(10212),x=s(757691);let m=(0,l.eU)([]),p=(0,l.eU)([]);function h({children:e,testFetchFn:t}){let s=(0,a.useId)(),[i,r]=(0,l.fp)(m),o=s===i[0];return(0,a.useEffect)(()=>(r(e=>[...e,s]),()=>{r(e=>e.filter(e=>e!==s))}),[s,r]),(0,n.jsxs)(n.Fragment,{children:[o&&(0,n.jsx)(g,{testFetchFn:t}),e]})}function g({testFetchFn:e}){return e?.(),function(){let e=(0,i.d4)(o.MH),t=(0,i.d4)(o.dM),s=(0,l.Xr)(p),n=(0,a.useMemo)(()=>{let s=(0,u.Sg)(e,t).allItems;return(0,r.v7)(s,e=>(0,x.Pc)(e).join("/")),s},[e,t]);(0,a.useEffect)(()=>{let e=n.map(e=>({component:e}));e.length>0&&(function(e){if(0===e.length)return Promise.resolve({});let t=e.map(e=>f(e.component)).filter(e=>null!==e);return 0===t.length?Promise.resolve({}):d.Q.getInContextPublishedComponentsStatus(t).then(e=>e.data.meta.status).catch(e=>(console.error("Failed to fetch code connect statuses:",e),{}))})(e).then(t=>{s(e.map(e=>{let s=f(e.component),n=s?t[s]:void 0;return{...e,isCodeConnected:"connected"===n}}))}).catch(t=>{s(e.map(e=>({...e,isCodeConnected:!1}))),console.error("Promise rejected when fetching code connect statuses:",t)})},[n,s])}(),null}function f(e){return e.type===c.PW.COMPONENT&&"component_key"in e?e.component_key||e.node_id||null:e.type===c.PW.STATE_GROUP&&"key"in e?e.key||e.node_id||null:e.node_id||null}},381302:(e,t,s)=>{s.d(t,{xq:()=>t$,mW:()=>tU,PG:()=>tV});var n=s(239976),a=s(105652),i=s(692376),r=s(379141),l=s(270450),o=s(445019),c=s(789099),d=s(446232),u=s(916626),x=s(719749),m=s(7857),p=s(543595),h=s(850465),g=s(323264),f=s(563188),_=s(800307),y=s(931974),k=s(297094),v=s(585066),b=s(276571),j=s(610604),C=s(502527);function w(e){let t=new Date(e);return t.setDate(e.getDate()-e.getDay()),t.setHours(0,0,0,0),t}function E({}){let e=(0,b.Td)(),t=(0,o.Xr)(h.hM),s=(0,o.Xr)(h.FI),i=(0,o.md)(h.G1),l=a.useCallback(e=>e.metadata&&"object"==typeof e.metadata&&e.metadata.title?e.metadata.title:(0,r.t)("ai_assistant.chat.history.new_chat_title"),[]),c=a.useCallback(e=>{if(!e.latestUserMessage?.parts?.length)return(0,r.t)("ai_assistant.chat.history.no_messages");let t=(0,y.th)(e.latestUserMessage).content.filter(e=>"text"===e.type).map(e=>e.text);if(0===t.length)return(0,r.t)("ai_assistant.chat.history.no_messages");let s=t.join(" ").trim();return s.length>100?`${s.slice(0,100)}...`:s},[]),{data:u,status:m}=(0,x.Rs)((0,j.r3i)(e?{ownerId:e}:null)),p=(0,d.unwrap)(u?.fileAiChatThreads),g=p?.map(e=>({...e,title:l(e),preview:c(e)})),f=e=>{let t={},s=new Date;return e.forEach(e=>{let n=new Date(e.createdAt),a=Math.floor((s.getTime()-n.getTime())/864e5),i=(0,r.t)("ai_assistant.chat.history.earlier");t[i=0===a?(0,r.t)("ai_assistant.chat.history.today"):!function(e){let t=new Date;return e>=w(t)&&e<t}(n)?!function(e){let t=w(new Date),s=new Date(t);return s.setDate(t.getDate()-7),e>=s&&e<t}(n)?(0,r.t)("ai_assistant.chat.history.earlier"):(0,r.t)("ai_assistant.chat.history.last_week"):(0,r.t)("ai_assistant.chat.history.this_week")]||(t[i]=[]),t[i].push(e)}),t},E=a.useMemo(()=>f(g??[]),[g]),N=n=>{t(n),s(h.Kk.Thread),(0,C.ZG)(n,e)};function S({id:e,title:t,preview:s,createdAt:a}){return(0,n.jsxs)("button",{className:"x78zum5 x1af02g3 x1cy8zhl xe8ttls x1sxf85j x1ypdohk xh8yej3 xeuugli x9f619 x1yjdb4r xv2f06h",onClick:()=>N(e),tabIndex:0,style:{cursor:"pointer"},children:[(0,n.jsx)("div",{className:"x1n2onr6 x1td3qas x10w6t97 x2lah0s",children:(0,n.jsx)("div",{className:"x1td3qas x10w6t97 x1yrfp1h x1sxf85j x78zum5 x6s0dn4 xl56j7k xmkeg23 x1y0btm7 x1co876m",children:(0,n.jsx)(_.u,{})})}),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x195vfkc x1iyjqo2 xeuugli xnalus7",children:[(0,n.jsxs)("div",{className:"x78zum5 x167g77z x6s0dn4 xh8yej3 xeuugli",children:[(0,n.jsx)("div",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh xiuzu7u x1iyjqo2 xeuugli xb3r6kr xlyipyv xuxw1ft xdpxx8g",children:t||(0,r.t)("ai_assistant.chat.history.new_chat_title")}),(0,n.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up xv1l7n4 x2lah0s xuxw1ft xirqqd8 xb3r6kr xlyipyv",children:(0,k.JD)(a,"short")})]}),(0,n.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up xv1l7n4 xh8yej3 x104kibb x1h7i4cw x1ua5tub xb3r6kr xlyipyv xdpxx8g",children:s||"Chat conversation"})]})]},e)}return(0,n.jsxs)("div",{className:"xe8ttls x78zum5 xdt5ytf x1jnr06f x1iyjqo2 x1odjw0f x2lwn1j",children:["loading"===m&&(0,n.jsx)("div",{className:"x78zum5 xl56j7k x6s0dn4 x1o8uwn5 x1iyjqo2",children:(0,n.jsx)(v.k,{})}),"errors"===m&&(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x6s0dn4 xl56j7k x62rkhy x4l9tsp x2b8uid",children:(0,n.jsx)("div",{className:"xif65rj xv1l7n4",children:(0,r.t)("ai_assistant.chat.history.error_loading_threads")})}),"loaded"===m&&(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1jnr06f x1iyjqo2",children:[(!g?.length||0===g.length)&&(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 x1y1aw1k xy13l1i xjkvuk6 x163pfp",children:(0,n.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up xv1l7n4 x1sdyfia",children:(0,r.t)("ai_assistant.chat.history.today")})}),(0,n.jsx)(S,{id:i??"",title:(0,r.t)("ai_assistant.chat.history.new_chat_title"),preview:(0,r.t)("ai_assistant.chat.history.not_started"),createdAt:new Date})]},(0,r.t)("ai_assistant.chat.history.today")),(g?.length??0)>0&&Object.entries(E).map(([e,t])=>(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 x1y1aw1k xy13l1i xjkvuk6 x163pfp",children:(0,n.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up xv1l7n4 x1sdyfia",children:e})}),t.map(e=>(0,n.jsx)(S,{id:e.id,title:e.title,preview:e.preview,createdAt:e.createdAt},e.id))]},e))]})]})}var N=s(431080);function S({widthFallback:e,currentView:t,assistantOptionOverrides:s}){let i=a.useRef(null),r=f.wY(i)?.width,l=t===h.Kk.Thread?0:1;return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x1iyjqo2 xb3r6kr x5yr21d",children:(0,n.jsxs)(T,{index:l,width:r??e,ref:i,children:[(0,n.jsx)(N.A,{assistantOptionOverrides:s}),(0,n.jsx)(E,{})]})})}let T=a.forwardRef(function({children:e,index:t,width:s},i){let r=a.useMemo(()=>e.flat().filter(e=>!!e),[e]),l=Math.min(t,r.length-1);return(0,n.jsx)("div",{"data-testid":"chat-slide-carousel",...g.xk(A.container,A.containerWithTranslation(100*l)),ref:i,children:r.map((e,n)=>(0,a.createElement)("div",{...g.xk(A.item,A.itemWithWidth(s)),key:n,"data-testid":"chat-slide-carousel-item","aria-hidden":n!==t,inert:n!==t?"":void 0},e))})}),I={k3aq6I:"xsqj5wx",$$css:!0},A={container:{k1xSpc:"x78zum5",kXwgrk:"x15zctf7",kCS8Yb:"x1r8uery",kzQI83:"x1iyjqo2",kmuXW:"xs83m0k",kAzted:"x2lwn1j",kZKoxP:"x5yr21d",kmkexE:"x1ux5q4u",kzIqYQ:null,kIr0Dl:null,kIyJzY:null,k1ekBW:null,kAMwcw:null,$$css:!0},containerWithTranslation:e=>[I,{"--x-transform":`translateX(${e}%)`}],item:{kmuXW:"x2lah0s",kZKoxP:"x5yr21d",kAzted:"x2lwn1j",k1xSpc:"x78zum5",kXwgrk:"xdt5ytf",kORKVm:"x1odjw0f",$$css:!0},itemWithWidth:e=>[{kzqmXN:null!=e?"x5lhr3w":e,$$css:!0},{"--x-width":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(e)}]};var M=s(378721),z=s(318584),L=s(723850),O=s(581121),P=s(892691);function R(){return(0,n.jsx)(m.u9,{label:"ChatTabActions",children:(0,n.jsx)(D,{})})}function D(){let e=(0,o.Xr)(h.qA),t=(0,o.Xr)(h.hM),s=(0,o.Xr)(h.FI),i=(0,h.xs)().length>0,c=(0,L.hC)(),u=(0,b.Td)(),m=(0,o.md)(h.G1),p=(0,o.md)(h.FI),g=u&&m,f=(0,x.Rs)((0,j.A6w)(g?{ownerId:u,id:m}:null)),_=(0,d.unwrap)(f.data?.activeAiChatThread),y=a.useCallback(()=>{e(e=>"idle"===e?"shouldCreate":e),t(null),s(h.Kk.Thread),c("ai_assistant.new_chat_button_clicked",{})},[e,t,s,c]);if(!(0,l.kc)().ai_assistant_header)return null;let k=p===h.Kk.HistoryList||p===h.Kk.Thread&&_;return(0,n.jsxs)("div",{className:"x78zum5 x1qughib xrybvsa",children:[(0,l.kc)().ai_assistant_ds_library_selector?(0,n.jsx)(P.yi,{helpUrlVariant:O.JT.START_AI_ASSISTANT}):null,k&&(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 x1nfngrj xrybvsa",children:(0,n.jsx)(M.K,{onClick:y,disabled:i,"aria-label":i?(0,r.t)("ai_assistant.chat.new_chat_disabled_generating"):(0,r.t)("ai_assistant.chat.new_chat"),children:(0,n.jsx)(z.e,{})})})]})}var F=s(598066),q=s(707470),G=s(384203),U=s(223487),K=s(31201),H=s(479690),B=s(293147),V=s(702990),$=s(1539),W=s(632381),Y=s(191770),X=s(228768),Z=s(271650),J=s(839733),Q=s(79753),ee=s(692774),et=s(559579),es=s(798913),en=s(951740),ea=s(35131),ei=s(865702),er=s(562418),el=s(925270),eo=s(212198),ec=s(565039),ed=s(434183),eu=s(964731),ex=s(157750),em=s(178127),ep=s(903039),eh=s(570658),eg=s(133069),ef=s(253193),e_=s(564942),ey=s(466082),ek=s(397875),ev=s(943360),eb=s(225145),ej=s(402731),eC=s(365094),ew=s(863412);function eE({ariaLabel:e,children:t,iconPrefix:s,onClick:a,selected:i,showArrow:r}){return(0,n.jsxs)(ev.E,{onClick:a??ei.lQ,"aria-label":e,...{0:{className:"x78zum5 x1qughib x8rdmch x1cmmqis x6s0dn4 xjbqb8w x12tve8b x19y5rnk xxk0z11 xh8yej3 x4xl6zf x9v5kkp x1n7vjt0"},2:{className:"x78zum5 x1qughib x8rdmch x1cmmqis x6s0dn4 x19y5rnk xxk0z11 xh8yej3 x4xl6zf x9v5kkp x1n7vjt0 x1v8gsql xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh"},1:{className:"x78zum5 x1qughib x1cmmqis x6s0dn4 xjbqb8w x12tve8b x19y5rnk xxk0z11 xh8yej3 x4xl6zf x9v5kkp x1n7vjt0 x1uhho1l"},3:{className:"x78zum5 x1qughib x1cmmqis x6s0dn4 x19y5rnk xxk0z11 xh8yej3 x4xl6zf x9v5kkp x1n7vjt0 x1v8gsql xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x1uhho1l"}}[!!i<<1|!!s<<0],children:[(0,n.jsxs)("span",{className:"x78zum5 xlqzeqv x6s0dn4 xlyipyv xeuugli",children:[s,(0,n.jsx)("span",{className:"x1lliihq x12lumcd xeuugli xb3r6kr xlyipyv xuxw1ft x1vvkbs",children:t})]}),r&&(0,n.jsx)("span",{className:"x3psx0u",children:(0,n.jsx)(ej.k,{})})]})}function eN({ariaLabel:e,href:t,iconPrefix:s,label:a,onClick:i}){return(0,n.jsx)(eb._,{onClick:i??ei.lQ,href:t,newTab:!0,"aria-label":e,...{0:{className:"x78zum5 x1qughib x8rdmch x1cmmqis x6s0dn4 xjbqb8w x12tve8b x19y5rnk xxk0z11 xh8yej3 x4xl6zf x9v5kkp x1n7vjt0"},1:{className:"x78zum5 x1qughib x1cmmqis x6s0dn4 xjbqb8w x12tve8b x19y5rnk xxk0z11 xh8yej3 x4xl6zf x9v5kkp x1n7vjt0 x1uhho1l"}}[!!s<<0],children:(0,n.jsxs)("span",{className:"x78zum5 xlqzeqv x6s0dn4 xlyipyv xeuugli",children:[(0,n.jsx)("span",{children:s}),(0,n.jsx)("span",{className:"x1lliihq x12lumcd xeuugli xb3r6kr xlyipyv xuxw1ft x1vvkbs x1akne3o",children:(0,n.jsx)(ew.G,{text:a})}),(0,n.jsx)("span",{className:"xgg3mt9",children:(0,n.jsx)(eC.V,{})})]})})}function eS(){let e=(0,ek.K)(),t=(0,ey.UN)(),s=t?.get(e?.node_id||null);return s?(0,n.jsx)(n.Fragment,{children:s.symbolLinks?.map((e,t)=>e.uri?n.jsx(eN,{href:e.uri,iconPrefix:n.jsx(e_.a,{}),label:e.uri},`ds-file-home-link-${t}`):null)}):null}var eT=s(188850),eI=s(190531),eA=s(732629),eM=s(769831);let ez={kZKoxP:"x16ye13r",$$css:!0},eL={kVAEAm:"x10l6tqk",k87sOh:"x13vifvy",kbCHJM:"xu96u03",kLqNvP:"",kt4wiu:"",kzqmXN:"xh8yej3",kZKoxP:"x16ye13r",k3aq6I:"xsqj5wx",k1xSpc:"x78zum5",kGNEyG:"x6s0dn4",$$css:!0},eO={list:{k1xSpc:"x78zum5",kXwgrk:"xdt5ytf",kOIVth:"x1nfngrj",khm7nJ:null,k1C7PZ:null,kVAEAm:"x1n2onr6",kogj98:"x1y64a76",kUOVxO:null,keTefX:null,koQZXg:null,k71WvV:null,km5ZXQ:null,kqGvvJ:null,keoZOQ:null,k1K539:null,$$css:!0},listHeight:e=>[ez,{"--x-height":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(`${e}px`)}],virtualListItem:(e,t)=>[eL,{"--x-height":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(`${e}px`),"--x-transform":`translateY(${t}px)`}]};function eP(){let e=function(e){switch(e){case eM.q.COMPONENTS:return(0,n.jsx)(eD,{});case eM.q.COMPONENT:return(0,n.jsx)(eF,{});case eM.q.VARIABLES:return(0,n.jsx)(eq,{});default:return(0,n.jsx)(eR,{})}}((0,o.md)(eA.BE));return(0,n.jsx)(eT.Cj,{children:e})}function eR(){let[e,t]=(0,o.fp)(eA.BE);return(0,n.jsxs)("nav",{className:"x78zum5 xdt5ytf x1nfngrj x1n2onr6 x1y64a76",children:[(0,n.jsx)(eE,{ariaLabel:(0,r.t)("design_systems.home.editor.nav.overview"),iconPrefix:(0,n.jsx)($.L,{}),selected:e===eM.q.OVERVIEW,onClick:()=>t(eM.q.OVERVIEW),children:(0,r.tx)("design_systems.home.editor.nav.overview")}),(0,n.jsx)(eE,{ariaLabel:(0,r.t)("design_systems.home.editor.nav.components"),iconPrefix:(0,n.jsx)(W.P,{}),selected:e===eM.q.COMPONENTS,onClick:()=>t(eM.q.COMPONENTS),showArrow:!0,children:(0,r.tx)("design_systems.home.editor.nav.components")}),(0,n.jsx)(eE,{ariaLabel:(0,r.t)("design_systems.home.editor.nav.styles"),iconPrefix:(0,n.jsx)(Y.y,{}),selected:e===eM.q.STYLES,onClick:()=>t(eM.q.STYLES),children:(0,r.tx)("design_systems.home.editor.nav.styles")}),(0,n.jsx)(eE,{ariaLabel:(0,r.t)("design_systems.home.editor.nav.variables"),iconPrefix:(0,n.jsx)(X.g,{}),selected:e===eM.q.VARIABLES,onClick:()=>t(eM.q.VARIABLES),children:(0,r.tx)("design_systems.home.editor.nav.variables")}),(0,n.jsx)(eE,{ariaLabel:(0,r.t)("design_systems.home.editor.nav.guidelines"),iconPrefix:(0,n.jsx)(Z.C,{}),selected:e===eM.q.GUIDELINES,onClick:()=>t(eM.q.GUIDELINES),children:(0,r.tx)("design_systems.home.editor.nav.guidelines")})]})}function eD(){let e=(0,o.Xr)(eA.BE),t=(0,o.md)(eT.yO),s=(0,a.useRef)(null),i=(0,en.Te)({count:t.length,getScrollElement:()=>s.current,estimateSize:()=>32,overscan:10});return(0,n.jsxs)("nav",{className:"x1l8dxvs",children:[(0,n.jsxs)("header",{className:"x6s0dn4 x78zum5 x1q0g3np xg2d0mh xkdneqi xrybvsa x17qaar8 x3enpkt xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:[(0,n.jsx)(M.K,{"aria-label":(0,r.t)("design_systems.home.editor.nav.back"),"data-tooltip":(0,r.t)("design_systems.home.editor.nav.back"),"data-tooltip-type":"text",onClick:()=>e(eM.q.OVERVIEW),children:(0,n.jsx)(J.t,{})}),(0,r.tx)("design_systems.home.editor.nav.components")]}),(0,n.jsx)(V.P,{scroll:"y",fill:!0,ref:s,children:(0,n.jsx)("div",{...g.Ay.props(eO.list,eO.listHeight(i.getTotalSize())),children:i.getVirtualItems().map(e=>{let s=t[e.index];return s?(0,n.jsx)("div",{...g.Ay.props(eO.virtualListItem(e.size,e.start)),children:(0,n.jsx)(eE,{ariaLabel:s.component.name,onClick:()=>(0,eI.Cw)(s.component,eM.n.DESIGN),showArrow:!0,children:s.component.name},`ds-view-left-panel-${(0,el.V)(s.component)}`)},e.key):null})})})]})}function eF(){let e=(0,o.Xr)(eA.BE),t=(0,o.md)(eA.Px),s=(0,o.md)(eT.yO),i=(0,o.md)(eA.gS),l=(0,a.useMemo)(()=>i?i.isPublished?i.type===em.P.COMPONENT?s.find(e=>e.component.type===em.P.COMPONENT&&e.component.component_key===i.assetKey):i.type===em.P.STATE_GROUP?s.find(e=>e.component.type===em.P.STATE_GROUP&&e.component.key===i.assetKey):null:s.find(e=>e.component.node_id===i.assetKey):null,[i,s]);if(!i||!l)return null;let{component:c}=l;return(0,n.jsxs)("nav",{children:[(0,n.jsxs)("header",{className:"x6s0dn4 x78zum5 x1q0g3np xg2d0mh xkdneqi xrybvsa x17qaar8 x3enpkt xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:[(0,n.jsx)(M.K,{"aria-label":(0,r.t)("design_systems.home.editor.nav.back"),"data-tooltip":(0,r.t)("design_systems.home.editor.nav.back"),"data-tooltip-type":"text",onClick:()=>e(eM.q.COMPONENTS),children:(0,n.jsx)(J.t,{})}),c.name]}),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1nfngrj x1n2onr6 x1y64a76",children:[(0,n.jsx)(eE,{iconPrefix:(0,n.jsx)(Q.a,{}),selected:t===eM.n.DESIGN,onClick:()=>(0,eI.Cw)(c,eM.n.DESIGN),children:(0,r.tx)("design_systems.home.editor.nav.design")}),(0,n.jsx)(eE,{iconPrefix:(0,n.jsx)(ee.D,{}),selected:t===eM.n.CODE,onClick:()=>(0,eI.Cw)(c,eM.n.CODE),children:(0,r.tx)("design_systems.home.editor.nav.code")}),(0,n.jsx)(eE,{iconPrefix:(0,n.jsx)(et.p,{}),selected:t===eM.n.DOCUMENTATION,onClick:()=>(0,eI.Cw)(c,eM.n.DOCUMENTATION),children:(0,r.tx)("design_systems.home.editor.nav.documentation")}),(0,n.jsx)(eS,{})]})]})}function eq({hideNavHeader:e}){let t=(0,er.m0)();return(0,n.jsx)(ef.GP,{recordingKey:"designSystemViewLeftPanel",preset:t?ep.ub.READ_ONLY:ep.ub.WRITEABLE,children:(0,n.jsx)(eG,{hideNavHeader:e})})}function eG({hideNavHeader:e}){let t=(0,o.Xr)(eA.BE),s=(0,ex.J2)((0,eo.UK)().showGuids),{state:{currentVariableSet:c,selectedGroupNames:d,selectedVariableIDs:u,variableGroupList:x},actions:m,readOnlyModal:p}=(0,ef.cy)(),h=(0,ed.yp)(),g=(0,a.useCallback)(()=>{let e=(0,ec.UO)(h).map(e=>e.node_id);es.l7.user("sort-variable-collections",()=>{i.CWU?.reorderVariableSets("",e)})},[h]),f=(0,a.useCallback)((e,t)=>{es.l7.user("reorder-variable-collections",()=>{i.CWU?.reorderVariableSets(t||"",e)})},[]),_=(0,eu.ZS)(),y=(0,eu.BK)("variablesModal-context-menu"),{show:k}=(0,l.kc)().ds_variables_modal_fpl_menu?_:y,v=(0,l.kc)().ds_variables_modal_improvements_sidebar,b=void 0!==c;return(0,n.jsxs)("nav",{className:"x1l8dxvs",children:[!e&&(0,n.jsxs)("header",{className:"x6s0dn4 x78zum5 x1q0g3np xg2d0mh xkdneqi xrybvsa x17qaar8 x3enpkt xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:[(0,n.jsx)(M.K,{"aria-label":(0,r.t)("design_systems.home.editor.nav.back"),htmlAttributes:{"data-tooltip":(0,r.t)("design_systems.home.editor.nav.back"),"data-tooltip-type":"text"},onClick:()=>t(eM.q.OVERVIEW),children:(0,n.jsx)(J.t,{})}),(0,r.tx)("design_systems.home.editor.nav.variables")]}),(0,n.jsxs)(ea.hh,{children:[v&&(0,n.jsx)(eh.V,{currentVariableSet:c,hideBottomDivider:!b,onChangeVariableSet:m.setCurrentVariableSetID,onCreateVariableSet:m.createVariableSet,onCreateVariableSetExtension:m.createVariableSetExtension,onDeleteVariableSet:m.deleteVariableSet,onExportVariableSet:m.exportVariableSet,onLibraryPreferencesOpen:ei.lQ,onRenameVariableSet:m.renameVariableSet,onReorderLocalVariableSets:f,onSortLocalVariableSets:g,readOnly:p,recordingKey:"variablesModal.collectionList"}),b&&(0,n.jsx)(eg.a,{groups:x,isShowingGuids:s,isSidebarOpen:!0,onLibraryPreferencesOpen:ei.lQ,onMoveGroups:m.moveGroups,onMoveSelectedGroupsToGroup:m.moveSelectedGroupsToGroup,onMoveVariableToGroup:m.moveVariableToGroup,onRenameGroup:m.renameGroup,readOnly:p,recordingKey:"variablesModal",selectedGroupNames:d,selectedVariableIDs:u,setSelectedGroupNames:m.setSelectedGroupNames,showContextMenu:k,variableSet:c})]})]})}var eU=s(835996),eK=s(281962),eH=s(756654),eB=s(215256),eV=s(915520),e$=s(995522),eW=s(665933),eY=s(930494),eX=s(540892),eZ=s(289348),eJ=s(20002),eQ=s(888830),e0=s(193397),e1=s(844268),e5=s(285972),e2=s(526575),e3=s(776888),e4=s(948629),e6=s(674531),e7=s(330116),e8=s(690149),e9=s(656395),te=s(143973),tt=s(543735),ts=s(34503),tn=s(341153),ta=s(1007),ti=s(236410),tr=s(933384),tl=s(811996),to=s(27208),tc=s(968881);function td(){let e=(0,eJ.wA)(),t=(0,eJ.d4)(e=>!!e.modalShown),s=(0,eJ.d4)(e=>e.versionHistory.compareId);if(!i.AWq)throw Error("HistoryChangesBindings is not available");let l=i.AWq.getChunkChangeCount(),o=(0,tn.Z)("chunk_change_navigator_navigate"),c=(0,ts.E)(),d=a.useCallback(e=>{if(!i.Egt)throw Error("SceneGraphHelpers is not available");i.Egt.setSelectedNodeAndCanvas(e,!0),o((0,ta.QZ)({nodeId:e,...tl.ob}),tl.kh),c(e)},[o,c]),u=a.useCallback(e=>{if(!t&&0!==l){if(!i.glU)throw Error("Fullscreen is not available");"ArrowUp"===e.key||"ArrowLeft"===e.key||e.shiftKey&&"Tab"===e.key?d(i.glU.navigateToNextChange(-1)):("ArrowDown"===e.key||"ArrowRight"===e.key||"Tab"===e.key)&&d(i.glU.navigateToNextChange(1))}},[t,l,d]);return(a.useEffect(()=>{e(tt.Q.dequeue({type:te._.SEE_WHATS_CHANGED}))},[e]),a.useEffect(()=>{if(s&&0!==l){if(!i.glU)throw Error("Fullscreen is not available");d(i.glU.navigateToFirstVisibleOrClosestChange())}},[l,s,d]),a.useLayoutEffect(()=>{if(0!==l)return document.addEventListener("keydown",u),()=>{document.removeEventListener("keydown",u)}},[l,u]),0===l)?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"chunk_change_navigator--chunkChangeCount--LS57l",children:(0,r.tx)("collaboration.feedback.change_count",{changeCount:l})}),(0,n.jsxs)("div",{className:"chunk_change_navigator--chunkChangeNavigator--ibVvQ",children:[(0,n.jsx)(tr.K0,{svg:tc.A,onClick:e=>{if(e.stopPropagation(),!i.glU)throw Error("Fullscreen is not available");d(i.glU.navigateToNextChange(-1))},"data-tooltip-type":ti.Ib.TEXT,"data-tooltip":(0,r.t)("collaboration.feedback.previous_change"),recordingKey:"change_stepper.previous",disabled:0===l}),(0,n.jsx)(tr.K0,{svg:to.A,onClick:e=>{if(e.stopPropagation(),!i.glU)throw Error("Fullscreen is not available");d(i.glU.navigateToNextChange(1))},"data-tooltip-type":ti.Ib.TEXT,"data-tooltip":(0,r.t)("collaboration.feedback.next_change"),recordingKey:"change_stepper.next",disabled:0===l})]})]})}var tu=s(626041),tx=s(147766),tm=s(852130),tp=s(709326),th=s(943866),tg=s(290882),tf=s(805940),t_=s(456556),ty=s(279758);let tk=(0,tg.vv)(()=>i.Ez5?.boxSelectionState().isBoxSelecting,!1);function tv(){let e=(0,a.useContext)(tf.y0).focusSelectedNodes;return!!((0,l.kc)().ce_il_layer_focus&&e)}let tb=new Set;function tj(e,t){let s;if(t?.length===1&&(s=t[0])){let t=e.get(s);t&&(t.isExpanded=!0)}}var tC=s(129865),tw=s(53151),tE=s(311030),tN=s(223556),tS=s(251695),tT=s(309092),tI=s(208876),tA=s(341637),tM=s(157081),tz=s(654590),tL=s(320681),tO=s(854225);let tP=new Map;var tR=s(579263);function tD(){let e=(0,eW.cT)(),{pagesList:t,pageToNumChangesMap:s,isComparingChanges:i}=function(){let e=(0,eW.n0)(),t=(0,eJ.d4)(e=>!!(0,l.kc)().version_diffing&&e.mirror.appModel.activeCanvasEditModeType===tO.m1T.COMPARE_CHANGES),s=(0,eJ.d4)(e=>e.versionHistory.compareId);return a.useMemo(()=>{if(!t||!s)return{pagesList:e,pageToNumChangesMap:tP,isComparingChanges:t};let n=(0,tl.ee)(e);return{pagesList:e,pageToNumChangesMap:n,isComparingChanges:t}},[t,s,e])}(),r=(0,tz.g)({pagesList:t}),o=(0,eW.GQ)();return t.length?(0,n.jsx)(tF,{recordingKey:"pagesPanel",isReadOnly:e,width:o,pagesList:t,isComparingChanges:i,pageToNumChanges:s,onPageContextMenu:r}):null}function tF({width:e,isReadOnly:t,pagesList:s,onPageContextMenu:r,isComparingChanges:l,pageToNumChanges:c,recordingKey:d}){let u=(0,U.q5)(),x=(0,eJ.d4)(e=>t||!u?i.xae.LAYERS:e.leftPanel.activeTab),m=(0,eJ.d4)(e=>e.versionHistory),p=(0,e3.dh)();(0,e3.nn)();let h=(0,o.md)(tN.l7),g=(0,tS.U)(),f=(0,e4.T)(),{isLayersOpen:_,toggleLayersAction:y}=(0,eW.vr)(),{renamingNodeGuid:k,startRenamingNode:v,stopRenamingNode:b}=(0,tm.T)(),j=(0,eW._4)(),{height:C,setHeight:w,isOpen:E,setIsOpen:N}=(0,tL.d)({defaultIsOpen:!0}),S=x===i.xae.LAYERS,T=i.AWq?.getChunkChangeCount()??0,I=(0,eJ.Pj)(),A=(0,a.useCallback)(e=>{g.showLayersPanel(),(0,e2.ds)("pages_panel_open_toggle",u?.key,I.getState(),{isPagesOpen:e},{forwardToDatadog:!0}),N(e)},[u,g,N,I]),M=(0,a.useCallback)(()=>{A(!0)},[A]),z=(0,e1.F)(E),L=(0,a.useCallback)(()=>{A(!z.current)},[z,A]),O=(0,e0.$)(h);(0,a.useEffect)(()=>{h&&O&&!t&&M()},[O,h,t,M]);let{focusedNodes:P,onSelectNodesFromLayersPanel:R,clearFocusedNodes:D}=function(){let e=(0,ty.Tv)(),t=(0,G.eY)(),s=tv(),n=function(){let e=(0,G.KH)(),t=tv(),s=(0,t_.Fk)((e,s)=>{if(!t)return[];let n=new Set;return Object.keys(s).forEach(t=>{let s=function(e){for(;e;){if(e.parentNode?.type==="CANVAS")return e;e=e.parentNode}return null}(e.get(t));s&&n.add(s.guid)}),Array.from(n)},e);return(0,a.useMemo)(()=>new Set(s),[s])}(),i=(0,th.J0)(s),r=(0,th.J0)(n),l=(0,th.J0)(e),c=(0,a.useRef)(!1),d=(0,a.useRef)(new Set),u=r!==n,x=i!==s;(l!==e||u||x)&&function({focusedNodesRef:e,supportsFocus:t,isObjectsPanelClickRef:s,topLevelParents:n,didTopLevelParentsChange:a,scene:i,nodeIds:r}){if(!t||o.zl.get(tk)){e.current=tb;return}if(s.current){if(a&&e.current.size){let t=new Set(e.current);n.forEach(e=>t.add(e)),tj(i,r),e.current=t}s.current=!1;return}e.current=n,tj(i,r)}({focusedNodesRef:d,supportsFocus:s,isObjectsPanelClickRef:c,nodeIds:e,scene:t,topLevelParents:n,didTopLevelParentsChange:u});let m=(0,tp.C)(),p=(0,a.useCallback)(()=>{d.current=tb,m()},[m]),h=(0,a.useCallback)(()=>{c.current=!0},[]);return{onSelectNodesFromLayersPanel:s?h:void 0,focusedNodes:s?d.current:void 0,clearFocusedNodes:s?p:void 0}}(),F=(0,tR.HY)(),q=(0,o.md)(tx.wt),K=(0,o.md)(tx.R4),H=(0,e6.o3)(e6.nt.newResizablePanel),[B,V,$]=(0,tA.BN)(x,d),W=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tE.R,{height:C,isComparingChanges:l,isOpen:E,isReadOnly:t,onCanvasSearch:j,onHeightChange:w,onPageContextMenu:r,onToggle:L,pageToNumChanges:c,pages:s,showHeader:!f}),(0,n.jsxs)(tw.m,{children:[_&&(0,n.jsx)(e7.p,{children:(0,n.jsx)(e8.Ay,{})}),(0,n.jsx)(tI.o,{currentPage:p,focusedNodes:P,isLayersOpen:_,isReadOnly:t,onSelectNodesFromLayersPanel:R,onToggleLayers:y,recordingKey:d,renamingGuid:k,reserveBottomHeight:P?.size!==0,showAllLayers:D,startRenaming:v,stopRenaming:b,topNodeProperties:null,versionHistory:m,width:H&&q?K:e})]})]});return(0,n.jsxs)(tC.A,{isFullHeight:!0,children:[(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e5.$,{}),!t&&!F&&(0,n.jsx)(tM.I,{activeTab:x,onCanvasSearch:j,recordingKey:d,tabManager:$,tabPropsMap:B})]}),l&&S&&(0,n.jsxs)(n.Fragment,{children:[m.compareId&&(0,n.jsx)(tu.ZI,{compareId:m.compareId,versions:m.versions}),T>0&&(0,n.jsx)(tT.y,{withBorder:!0,children:(0,n.jsx)(td,{})})]}),u&&(0,n.jsx)(e9.QU,{fileKey:u.key}),(0,n.jsx)(tq,{isInTab:S,tabProps:V[tA.FV],children:W}),!F&&(0,n.jsx)(tq,{isInTab:x===i.xae.ASSETS,tabProps:V[tA.ay],children:(0,n.jsx)(eY.g,{width:e})})]})}function tq({children:e,isInTab:t,tabProps:s}){return(0,l.kc)().ui3_left_panel_tabs_fpl&&s?(0,n.jsx)(eQ.t.TabPanel,{height:"fill",...s,children:(0,n.jsx)("div",{className:"x5yr21d x78zum5 xdt5ytf",children:e})}):t?(0,n.jsx)(n.Fragment,{children:e}):null}var tG=s(431503);let tU=a.memo(function(){return(0,n.jsx)(u.k,{id:"DesignLeftPanel",children:(0,n.jsx)(m.u9,{label:"DesignLeftPanel",children:(0,n.jsx)(tK,{})})})}),tK=a.memo(function(){let e=(0,o.md)((0,K.Xh)(void 0)),t=(0,U.q5)(),s=(0,G.aV)();(0,eW.bi)();let i=!!t&&e,r=(0,G.p8)("showUi");a.useEffect(()=>{i&&(0,p.YQ)({id:"Found Updates To Publish"})},[i]);let[,c]=(0,H.bL)();a.useEffect(()=>()=>{c(null)},[c]);let d=(0,eW.Ye)(),u=(0,tR.HY)(),x=(0,tR.nb)(),m=(0,tR.sG)(),{isViewPanelMinimized:h}=(0,tR.MC)(),g=(0,eU.cE)();return(0,l.kc)().dont_render_ui&&!r?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tR.Mt,{}),!(u&&h)&&(0,n.jsx)(e$.Q,{ignoreRulers:s,...x,children:d?(0,n.jsx)(eH.s,{}):(0,n.jsx)(eK.$,{shouldDeferCanvasUpdateOnPanelResize:!g,...m,children:u?(0,n.jsx)(tB,{}):(0,n.jsx)(tH,{})})})]})});function tH(){let e=(0,F.X0)(),t=(0,q.L3)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eH.s,{}),(0,n.jsx)(eV.n,{}),(0,n.jsx)(eB.d,{shouldUseBottomBorder:!e}),t?(0,n.jsx)(H.EA.Provider,{value:!0,children:(0,n.jsx)(B.f,{showFilter:!0})}):(0,n.jsx)(tD,{})]})}function tB(){let e=(0,U.q5)(),[t,s]=(0,o.fp)(eZ.FZ),d=(0,F.X0)(),u=(0,eW.GQ)();switch(a.useEffect(()=>{e||s(eZ.UO.FILE)},[e,s]),(0,tG.v1)(),t){case eZ.UO.ASSETS:return(0,n.jsx)(c.Zf,{canvasActionName:(0,r.t)("design.navbar.assets"),additionalButtons:(0,n.jsx)(eX.g,{}),children:(0,n.jsx)(eY.g,{width:u})});case eZ.UO.CHAT:return(0,n.jsx)(t$,{width:u});case eZ.UO.SEARCH:return(0,n.jsx)(c.Zf,{canvasActionName:(0,r.t)("design.navbar.find"),children:(0,n.jsx)(H.EA.Provider,{value:!0,children:(0,n.jsx)(B.f,{showFilter:!0})})});case i.zx_.DESIGN_SYSTEM:if(!(0,l.kc)().ds_home)return null;return(0,n.jsx)(c.Zf,{canvasActionName:(0,r.t)("design.navbar.design_system"),children:(0,n.jsx)(eP,{})});case i.zx_.VARIABLES:return(0,n.jsx)(tV,{});default:return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eB.d,{shouldUseBottomBorder:!d}),(0,n.jsx)(tD,{})]})}}function tV(){let e=(0,U.q5)(),t=(0,eZ.b4)(i.zx_.VARIABLES),s=(0,o.Xr)(t),a=(0,tG.pu)();return(0,n.jsx)(c.sW,{fileName:e?e.name:"",setMinimized:s,onClickFileName:a,children:(0,n.jsx)(eq,{hideNavHeader:!0})})}function t$({width:e,handleClose:t,assistantOptionOverrides:s}){let[i,l]=(0,o.fp)(h.FI),u=U.q5()?.key??null,m=function(){let e=(0,o.md)(h.G1),t=(0,b.Td)(),s=t&&e,n=(0,x.Rs)((0,j.A6w)(s?{ownerId:t,id:e}:null)),a=(0,d.unwrap)(n.data?.activeAiChatThread);return a&&a.metadata&&"object"==typeof a.metadata&&a.metadata.title?a.metadata.title:(0,r.t)("ai_assistant.chat.history.new_chat_title")}(),{data:p}=(0,x.Rs)((0,j.r3i)(u?{ownerId:u}:null)),g=(0,d.unwrap)(p?.fileAiChatThreads),f=(g?.length??0)>0;a.useEffect(()=>()=>{l(h.Kk.Thread)},[l]);let _=a.useCallback(()=>{l(h.Kk.HistoryList)},[l]),y=i===h.Kk.HistoryList?(0,r.t)("ai_assistant.chat.previous_chats"):m,k=i===h.Kk.Thread&&f;return(0,n.jsx)(c.Zf,{canvasActionName:y,onClose:t,handleBack:k?_:void 0,additionalButtons:(0,n.jsx)(R,{}),children:(0,n.jsx)(S,{widthFallback:e,currentView:i,assistantOptionOverrides:s})})}},756654:(e,t,s)=>{s.d(t,{s:()=>w,_:()=>E});var n=s(239976),a=s(105652),i=s(20002),r=s(819805),l=s(384203),o=s(674531),c=s(359547),d=s(63546),u=s(551821),x=s(699589),m=s(955994),p=s(379141),h=s(223487),g=s(52768),f=s(869680),_=s(405539),y=s(347470),k=s(491743);function v(){let e=(0,h.q5)(),t=(0,g.Z)();return(0,n.jsxs)(f.O,{label:(0,p.t)("fullscreen_actions.expand-ui-with-filename",{fileName:t}),children:[(0,n.jsx)("div",{className:"design_dev_handoff_collapsed_left_panel_toggle--fileName--6b1Uh",children:(0,n.jsx)(y.n,{shouldShowConnectedBadge:!0})}),e&&(0,n.jsx)(_.s,{openFile:e}),(0,n.jsx)(m.n8,{}),(0,n.jsx)(k.A,{})]})}var b=s(499005),j=s(26517),C=s(58268);function w(){let{isLeftPanelCollapsed:e}=(0,a.useContext)(c.t),t=(0,l.aV)(),s=(0,i.d4)(e=>e.mirror.appModel.showUi),r=(0,o.o3)(o.nt.designNavBar);return t||!s?null:(0,n.jsxs)(b._,{isCollapsed:e,children:[(!r||e)&&(0,n.jsx)(u.Fr,{hideChevron:r}),e?(0,n.jsx)(v,{}):(0,n.jsx)(N,{})]})}function E(){let e=(0,l.aV)(),t=(0,i.d4)(e=>e.mirror.appModel.showUi),s=(0,o.o3)(o.nt.designNavBar);return e||!t?null:(0,n.jsxs)(b._,{isCollapsed:!1,children:[(0,n.jsx)(u.Fr,{hideChevron:!1}),!s&&(0,n.jsx)(N,{})]})}function N(){let e=(0,r.Zr)("toggle-sidebar");return(0,n.jsxs)("div",{className:"design_dev_handoff_left_panel_island--expandedIconSection--oToVF",children:[(0,n.jsx)(m.n8,{}),(0,n.jsx)(j.En,{}),(0,n.jsx)(C.J,{}),(0,n.jsx)(x.A,{}),(0,n.jsx)(d.I,{}),e&&(0,n.jsx)(k.n,{})]})}},499005:(e,t,s)=>{s.d(t,{_:()=>m});var n=s(239976),a=s(105652),i=s(20002),r=s(250730),l=s(424128),o=s(224542),c=s.n(o),d=s(324880),u=s(665933),x=s(362151);function m({isCollapsed:e,children:t,minWidth:s=u.Yh,maxWidth:o=u.g_}){let m=a.useRef(null),p=function({isShowing:e,isCollapsed:t,ref:s,minWidth:n,maxWidth:r}){let l=(0,i.d4)(e=>e.isRenaming),o=(0,x.E)(s,t&&!l&&e);return(0,a.useMemo)(()=>t?l&&"number"==typeof o?{width:Math.max(n,o)}:{maxWidth:r}:void 0,[t,l,o,n,r])}({isCollapsed:e,isShowing:!0,ref:m,minWidth:s,maxWidth:o}),h=(0,r.Mj)(),g=(0,a.useCallback)(t=>{(0,l.cZ)(m,t),h(e?t:null)},[h,e]);return(0,n.jsx)("div",{className:c()(d.Dm,"left_panel_island_container--islandContainer--qpBD5",{"left_panel_island_container--collapsed--2zd-I":e,"left_panel_island_container--withInsetEditor---IeeE":!e}),style:p,ref:g,children:t})}},915520:(e,t,s)=>{s.d(t,{n:()=>i});var n=s(239976),a=s(323264);function i({height:e}){let t=e??"calc(32px + var(--spacer-2) + var(--spacer-1))",s=e??"calc(32px + var(--spacer-2) + var(--spacer-1))";return(0,n.jsx)("div",{...a.Ay.props(r.height(t,s))})}let r={height:(e,t)=>[{kZKoxP:null!=e?"x16ye13r":e,kAzted:null!=t?"x82snj4":t,$$css:!0},{"--x-height":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(e),"--x-minHeight":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(t)}]}},869680:(e,t,s)=>{s.d(t,{O:()=>o});var n=s(239976),a=s(943360),i=s(379141),r=s(772293),l=s(236410);function o({label:e,children:t}){let s=(0,i.t)("fullscreen_actions.expand-ui");return(0,n.jsx)(a.E,{className:"toggle_expanded_sidebar_button--button--CSypM",onClick:()=>r.Y5.triggerAction("toggle-sidebar",{source:"left_panel",state:"expand"}),"aria-label":e??s,recordingKey:"left-panel-island.toggle-minimize-ui","data-tooltip-type":l.Ib.TEXT,"data-tooltip":s,"data-tooltip-shortcut-key":"toggle-sidebar",children:t})}},852130:(e,t,s)=>{s.d(t,{T:()=>y});var n=s(105652),a=s(20002),i=s(692376),r=s(798913),l=s(466082),o=s(379141),c=s(844268),d=s(543595),u=s(888903),x=s(772293),m=s(862390),p=s(406673),h=s(251695),g=s(881562),f=s(567910),_=s(665933);function y(){let[e,t]=(0,n.useState)(null),s=(0,c.F)(e),y=(0,h.U)(),k=(0,_.cT)(),v=(0,_.P5)(),b=(0,c.F)(v),j=(0,a.wA)(),{setIsLayersOpen:C}=(0,_.vr)(),w=(0,p.W)(),E=(0,f.s)(),N=(0,n.useCallback)(e=>{if(k)return;let s=(0,l.UN)().get(e);if(s?.isResponsiveSetOrWebpage&&s.parentNode?.siteHomepageId===e){j(u.F.enqueue({message:(0,o.t)("sites.panel.pages_panel.cant_rename_default_responsive_set")}));return}!s?.isReactFiber&&(b.current!==i.xae.LAYERS&&b.current!==i.xae.CODE&&y.showLayersPanel(),C(!0),t(e),s?.parentGuid&&m.hq(s.parentGuid))},[b,j,k,y,C]),S=(0,n.useCallback)((e,n,a)=>{if(k)return;let o=s.current;if(o&&e){let e=(0,l.UN)().get(o),t=n||"",s=i.xc1.INACTIVE;i.Ez5&&(s=i.Ez5.uiState().focusModeState.getCopy()),e?.isCodeFile?(t=(0,g.tu)(t),(!n||E(e.codeFilePath,a,t))&&(t=e.name),r.l7.user("set-node-name",()=>m.i(o,t))):e?.isResponsiveSetOrWebpage||e?.isResponsiveSetBreakpoint||e?.isWebpageBreakpoint?(t||=e?.name,r.l7.user("set-node-name",()=>m.i(o,t))):i.xc1.RESPONSIVE_SET===s||i.xc1.COMPONENT_SET===s?r.l7.user("set-node-name",()=>m.BH(t)):r.l7.user("set-node-name",()=>m.i(o,t)),x.Y5.commit(),t!==a&&e?.type&&["FRAME","SECTION"].includes(e.type)&&(w({newTitle:t,nodeType:e.type}),"FRAME"===e.type&&(0,p.d)(t).length>0&&(0,d.YQ)({id:"frame_node_name_changed_with_rfd_indicator",properties:{nodeId:o}}))}t(null)},[k,s,w,E]);return(0,n.useEffect)(()=>{let e=({nodeId:e})=>{N(e)};return x.Y5.fromFullscreen.on("startRenamingNode",e),()=>{x.Y5.fromFullscreen.removeListener("startRenamingNode",e)}},[N]),(0,n.useMemo)(()=>({renamingNodeGuid:e,startRenamingNode:N,stopRenamingNode:S}),[e,N,S])}},7562:(e,t,s)=>{s.d(t,{Q:()=>b});var n=s(239976),a=s(105652),i=s(20002),r=s(719749),l=s(985836),o=s(625754),c=s(154963),d=s(617852),u=s(680940),x=s(81164),m=s(223487),p=s(816505),h=s(610604),g=s(329076),f=s(898301),_=s(505013),y=s(230357);let k="asset_file_path--path--P6eCH text--fontPos11--rO47d text--_fontBase--VaHfk",v="asset_file_path--skeletonText--44oQV";function b({assetLibraryKey:e,assetNodeId:t}){let s=(0,f.ol)(),b=(0,p.sZ)(),j=!!b||(0,g.w5)(s),C=b?.id,{fileContext:w,fileName:E,isPresetLibrary:N,isLoading:S}=function(e){let t=(0,r.bc)(h.ffQ,{libraryKey:e}),s=(0,x.fd)(e);return a.useMemo(()=>({fileContext:t.data?.libraryKeyToFile?.file,fileName:t.data?.libraryKeyToFile?.hubFile?.currentHubFileVersion?.name??t.data?.libraryKeyToFile?.file?.name,isPresetLibrary:s,isLoading:"loading"===t.status}),[s,t.data?.libraryKeyToFile?.file,t.data?.libraryKeyToFile?.hubFile?.currentHubFileVersion?.name,t.status])}(e),T=function(e,t){let s=(0,d.b)({libraryKey:e,nodeId:t}),n=(0,i.d4)(m.tB);return a.useMemo(()=>{if(n?.libraryKey===e)return null;let t=s.data;return null==t?null:t.link},[e,n,s])}(e,t),I=w?.teamLimitedInfo?.id,A=I?function(e,t){let s=location.origin;return t?`${s}/files/${t}/team/${e}`:`${s}/files/team/${e}`}(I,C):void 0,M=w?.teamLimitedInfo?.name,z=I&&M&&j,L=w?.computedWorkspace?.workspace?.id,O=L&&C?_.fO(L,C):void 0,P=w?.computedWorkspace?.workspace?.name,R=L&&P&&j;return S?(0,n.jsxs)("div",{className:k,"data-testid":"asset-file-path-loader",children:[(0,n.jsx)(l.Wi,{className:v,opacity:50})," ",j&&(0,n.jsxs)(n.Fragment,{children:["/",(0,n.jsx)(l.Wi,{className:v,opacity:50})]})]}):(0,n.jsxs)("div",{className:k,children:[R&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.q,{tooltipText:P,children:(0,n.jsx)(y.X,{href:O??"",newTab:!0,children:P})}),"/"]}),z&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.q,{tooltipText:M,children:(0,n.jsx)(y.X,{href:A??"",newTab:!0,children:M})}),"/"]}),(0,n.jsx)(o.q,{tooltipText:E,children:T?(0,n.jsx)(y.X,{href:T,newTab:!0,children:E}):(0,n.jsx)("span",{children:E})}),N&&(0,n.jsx)("div",{className:c.s.flex.alignCenter.justifyCenter.ml2.$,children:(0,n.jsx)(u.E,{libraryKey:e,showTooltip:!0})})]})}},422677:(e,t,s)=>{s.d(t,{M:()=>p});var n=s(239976),a=s(105652),i=s(379141),r=s(446232),l=s(297094),o=s(985836),c=s(154963),d=s(363337),u=s(353338),x=s(65260),m=s(920675);function p({assetKey:e,type:t,updatedAt:s}){let p=(0,x.R8)({assetKey:e,type:t}),{avatar:h,authorName:g}=a.useMemo(()=>{if("loaded"!==p.status||!p.data?.assetAttribution)return{avatar:null,authorName:null};let e=(0,r.unwrap)(p.data.assetAttribution);if(!e)return{avatar:null,authorName:null};if(e.type===m.GC.COMMUNITY)return{avatar:(0,n.jsx)(u.e,{entity:(0,x.M)(e),size:d.Pf.SMALL}),authorName:e.name};let t=(0,x.G5)(e);return null!=t&&t.img_url&&(t.handle||t.name)?{avatar:(0,n.jsx)(d.H8,{user:t,size:d.Pf.SMALL}),authorName:t.handle}:{avatar:null,authorName:null}},[p]);return"loading"===p.status?(0,n.jsx)(o.Wi,{className:c.s.h16.w100.$,animationType:o.JR.LIGHT_SHIMMER}):h&&g?(0,n.jsxs)("div",{className:"asset_updated_details--updatedAtAvatar--tdUla",children:[h,(0,n.jsx)("span",{className:"asset_updated_details--handle--h8tYX",children:g}),s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"asset_updated_details--dot--yaElO",children:"\xb7"}),(0,n.jsx)(l.h1,{date:s})]}):null]}):s?(0,n.jsx)("div",{className:"asset_updated_details--updatedAt--phn8B",children:(0,i.tx)("design_systems.assets_panel.updated_at",{updatedAt:(0,n.jsx)(l.h1,{date:s})})}):null}},267765:(e,t,s)=>{s.d(t,{H:()=>q,a:()=>G});var n=s(239976),a=s(105652),i=s(942356),r=s(378721),l=s(37041),o=s(379141),c=s(270450),d=s(564669),u=s(346942),x=s(13421),m=s(985836),p=s(259714),h=s(879708),g=s(355723),f=s(384203),_=s(890030),y=s(712022),k=s(236410),v=s(880197),b=s(314154),j=s(933384),C=s(498461),w=s(422677),E=s(673868),N=s(224542),S=s.n(N),T=s(40297),I=s(943866),A=s(791330),M=s(504864),z=s(648008),L=s(911470);let O=(0,T.jz)(L.figmaComponentFlyoutTextMaxCollapsedHeight);function P({description:e,description_rt:t}){let s=a.useRef(null),[i,r]=a.useState(!0),[l,c]=a.useState(!1),d=(0,I.ZC)(e);a.useEffect(()=>{if(e&&s.current&&d!==e){let e=s.current.scrollHeight>O;r(e),c(e)}},[e,d]);let u=a.useCallback(()=>{i&&c(!0),r(!i)},[i]);if(!e&&!t)return null;let x=!!e&&(i||l);return(0,n.jsxs)("div",{className:"truncated_component_description--documentationSection--E1bel",children:[t?(0,n.jsx)("div",{children:(0,n.jsx)(M.C,{value:t,valueFormat:(0,A.j_)(t),namespace:"component-description-flyout-lexical-editor-readonly",lexicalContentClassName:i?z.D6:z.kF,innerRef:s})}):(0,n.jsx)("div",{ref:s,className:S()({"truncated_component_description--collapsed--MKzpu ellipsis--ellipsisAfter6Lines--9-7DS ellipsis--_ellipsisAfterNLines--5f-ox":i},"truncated_component_description--documentationDescription--etyLw text--fontPos11--rO47d text--_fontBase--VaHfk"),dir:"auto",children:e}),x&&(0,n.jsx)("button",{className:"truncated_component_description--showMore--jPjbe",onClick:u,children:i?(0,o.tx)("design_systems.assets_panel.show_more"):(0,o.tx)("design_systems.assets_panel.show_less")})]})}var R=s(426947),D=s(249775),F=s(373314);function q({renderedAssetData:e,errorType:t,canViewPlayground:s,onInsert:r,shouldHideError:l,onSetShouldHideError:m}){let[p,h]=a.useState(!1);a.useEffect(()=>{h(!1),m(!1)},[e.asset,m]);let g=(0,E.S)(e.asset),f=(0,b.Y)(e.asset),v=a.useMemo(()=>(0,y.kH)(e.asset.name??""),[e.asset.name]),j=a.useRef(null),C=(0,d.NG)({text:v,textRef:j}),N=e.asset,S=(0,o.tx)("design_systems.assets_panel.insert_instance");return(0,n.jsxs)("div",{className:"component_flyout_body--bodyWrapper--HfpxC",children:[g&&!p&&(0,n.jsx)("div",{className:"component_flyout_body--updateBanner--OEFRb component_flyout_body--_bodyPadding--xRiyy text--fontPos11--rO47d text--_fontBase--VaHfk",children:(0,n.jsx)(x.z,{orientation:"vertical",iconSrc:D.A,onClose:()=>h(!0),variant:"design",children:(0,o.tx)("design_systems.assets_panel.update_banner")})}),(0,n.jsxs)("div",{className:"component_flyout_body--headerFileNameWrapper--rQzEt component_flyout_body--_bodyPadding--xRiyy",children:[(0,n.jsx)("h2",{className:"component_flyout_body--header--6bIhh text--fontPos14--QJNQC text--_fontBase--VaHfk ellipsis--ellipsis--70pHK","data-tooltip":C?v:void 0,"data-tooltip-type":k.Ib.TEXT,ref:j,children:v}),!!f&&f>1&&(0,n.jsx)("div",{className:"component_flyout_body--numVariants--Ueb2T",children:(0,o.tx)("design_systems.assets_panel.variant_count",{numVariants:f})})]}),(0,n.jsx)("div",{className:"component_flyout_body--descriptionWrapper--UZLbh component_flyout_body--_bodyPadding--xRiyy",children:(0,n.jsx)(P,{description:N.description,description_rt:N.description_rt})}),N.updated_at&&(0,n.jsx)("div",{className:"component_flyout_body--updatedWrapper--2IF7x component_flyout_body--_bodyPadding--xRiyy",children:(0,n.jsx)(w.M,{assetKey:(0,_.Av)(N),type:N.type,updatedAt:N.updated_at})}),(0,n.jsx)("div",{className:"component_flyout_body--buttonWrapper--Jf5OS component_flyout_body--_bodyPadding--xRiyy",children:(0,c.kc)().dse_fpl_wave_1?(0,n.jsx)(i.IK,{onClick:r,recordingKey:"component_flyout_insert",children:S}):(0,n.jsx)(u.$$,{onClick:r,fullWidth:!0,recordingKey:"component_flyout_insert",children:S})}),(0,n.jsx)(G,{renderedAssetData:e,errorType:t,canViewPlayground:s,shouldHideError:l,onSetShouldHideError:m})]})}function G({renderedAssetData:e,errorType:t,canViewPlayground:s,shouldHideError:i,onSetShouldHideError:r}){let l=(0,f.T3)(),o=(0,C.w$)(e.nodeData?.modeData??{}),c=a.useMemo(()=>{let t=e.nodeData?.playgroundGUID;if(!t)return"";let s=l.get(t);if(!s)return"";let n=l.get(s.symbolId??"");return n?(n.isState?n.parentGuid:n.guid)??"":""},[e,l]),d=a.useMemo(()=>{if(t)return{errorType:t,shouldHideError:i,setShouldHideError:r}},[t,i,r]);return(0,n.jsxs)(n.Fragment,{children:[s&&!e?.nodeData&&!d&&(0,n.jsxs)("div",{className:"component_flyout_body--skeletonWrapper--3XK64",children:[(0,n.jsx)(m.Wi,{className:"component_flyout_body--skeletonHeader--H8FUm",opacity:50}),(0,n.jsx)(m.Wi,{className:"component_flyout_body--skeletonBody--pjRY9",opacity:50})]}),s&&(e?.nodeData||d)&&(0,n.jsxs)(f.q0.Provider,{value:l,children:[(0,n.jsx)("div",{className:"component_flyout_body--propsContainer--G4-XR",children:(0,n.jsx)(g.x,{componentProps:e.nodeData?.componentProps,containerWidth:v.O2.UNBOUNDED,errorData:d,instanceSwapPickerInitialHeight:200,instanceSwapPickerInitialPosition:"right-center",label:(0,n.jsx)(U,{renderedAssetData:e}),playgroundGUID:e.nodeData?.playgroundGUID,productComponentGUID:c,sceneGraph:l,shouldShowDividerAboveProps:!0})}),(0,n.jsx)("div",{className:"component_flyout_body--modeContainer--0Md8Y",children:(0,n.jsx)(h.b,{modes:o})})]})]})}function U({renderedAssetData:e}){let t=a.useCallback(()=>{e.refetchAndResetScene()},[e]);return(0,n.jsxs)("div",{className:"component_flyout_body--playgroundHeader--oYadB",children:[(0,n.jsxs)("div",{className:"component_flyout_body--flyoutLabel--NloKn text--fontPos11--rO47d text--_fontBase--VaHfk",children:[(0,n.jsx)(p.B,{className:"component_flyout_body--headerIcon--F7Wok",svg:R.A}),(0,o.tx)("design_systems.assets_panel.playground_label")]}),(0,c.kc)().dse_fpl_wave_1?(0,n.jsx)("span",{className:"component_flyout_body--resetButtonContainer--rfJfj",children:(0,n.jsx)(r.K,{"aria-label":(0,o.t)("design_systems.playground.reset_properties"),onClick:t,disabled:!e.hasChangesToReset,recordingKey:"resetPlaygroundProps","data-tooltip":(0,o.t)("design_systems.playground.reset_properties"),"data-tooltip-type":k.Ib.TEXT,children:(0,n.jsx)(l.q,{})})}):(0,n.jsx)(j.K0,{className:"component_flyout_body--resetButton--woF-r",svg:F.A,onClick:t,"data-tooltip":(0,o.t)("design_systems.playground.reset_properties"),"data-tooltip-type":k.Ib.TEXT,disabled:!e.hasChangesToReset,recordingKey:"resetPlaygroundProps"})]})}},527898:(e,t,s)=>{s.d(t,{m:()=>em,w:()=>ep});var n=s(239976),a=s(105652),i=s(20002),r=s(490643),l=s(931547),o=s(517478),c=s(649109),d=s(379141),u=s(270450),x=s(445019),m=s(522568),p=s(40297),h=s(490650),g=s(309742),f=s(7857),_=s(875253),y=s(901962),k=s(154963),v=s(227517),b=s(12419),j=s(422572),C=s(730903),w=s(526575),E=s(28083),N=s(368773),S=s(975182),T=s(925270),I=s(362051),A=s(853921),M=s(934650),z=s(835427),L=s(772293),O=s(223487),P=s(198541),R=s(890030),D=s(618428),F=s(31201),q=s(421564),G=s(835585),U=s(747079),K=s(410518),H=s(960883),B=s(10212),V=s(995586),$=s(274412),W=s(758440),Y=s(316157),X=s(890305),Z=s(7562),J=s(692376),Q=s(943866),ee=s(122313),et=s(585066),es=s(909196),en=s(267765),ea=s(135748);let ei={maxWidth:640,maxHeight:480};function er(e){return(0,n.jsx)(f.u9,{label:"ComponentFlyout",children:(0,n.jsx)(el,{...e})})}function el({asset:e,onInsert:t,onLoaded:s,flyoutHidden:r,onCloseIfHidden:l,setFlyoutHidden:o,sectionPosition:c,sectionNameForTracking:d,sectionDepth:u}){let x=(0,I.C)(e.library_key),[m,p]=a.useState(!1),h=a.useCallback(()=>p(!1),[]),g=(0,es.MO)({canvasAsset:e,canViewPlaygroundQueryResult:x,onLoaded:s,onError:h,thumbnailOptions:ei}),f=(0,D.H)(),_=(0,i.d4)(e=>e.fileVersion),y=(0,Q.ZC)(_);if(a.useEffect(()=>{g?.state==="LOADED"&&g?.currentAssetData?.nodeData?.playgroundGUID&&null!=y&&y!==_&&(f(),J.glU?.clearPlaygroundScene())},[_,y,f,e.type,g]),!g)return(0,n.jsx)("div",{className:"component_flyout--spinner--pbIPV",children:(0,n.jsx)(et.k,{})});let k="LOADED"===g.state?g.currentAssetData:g.previousAssetData,v="ERROR"===g.state?g.errorType:void 0;return(0,n.jsx)(ee.k,{name:"props_playground",children:(0,n.jsxs)("div",{className:"component_flyout--wrapper---zYsZ",children:[(0,n.jsx)(ea.r,{renderedAssetData:k,canViewPlayground:x.unwrapOr(!1),onCloseIfHidden:l,setFlyoutHidden:o,sectionPosition:c,sectionNameForTracking:d,sectionDepth:u}),!r&&(0,n.jsx)(en.H,{renderedAssetData:k,errorType:v,canViewPlayground:x.unwrapOr(!1),onInsert:t,onSetShouldHideError:p,shouldHideError:m})]})})}var eo=s(909328),ec=s(407186),ed=s(526865);let eu=(0,p.jz)(ed.LdP),ex=(0,p.jz)(ed.wkK),em=(0,U.Ju)(ep,ec.VI);function ep(e){return(0,n.jsx)(f.u9,{label:"ComponentFlyoutModal",children:(0,n.jsx)(eh,{...e})})}function eh({asset:e,searchSessionId:t,query:s,sectionPosition:p,sectionNameForTracking:f,assetTypeDropdownSelection:U,sectionDepth:J,containerWidth:Q,onGetKeyboardNavigationItemById:ee,sourceForTracking:et}){let es=a.useRef(null),en=a.useRef(null),ea=(0,x.Xr)(eo.T),ei=(0,I.C)(e.library_key),el=(0,x.md)($.TG),ed=(0,W.H)(e.library_key),em=(0,B._9)(e.library_key,"asset_panel_visual_assets_flyout_insert"),{closeFlyout:ep}=(0,ec.JA)(),eh=(0,N.fV)(e.library_key),eg=(0,O.q5)(),ef=(0,i.wA)(),e_=(0,i.d4)(e=>(0,F.e_)(e).local.thumbnails),ey=(0,D.H)(),ek=a.useCallback(({source:e,target:t})=>{if("outside"!==e)ep();else if(t){if(ea(!1),(0,h.NX)(t,ec.u2))return;ep()}},[ep,ea]),ev=(0,i.d4)(e=>e.instanceSwapPickerShown),eb=(0,V.k)(),ej=(0,z.tM)(et??"assets-panel");(0,g.h)(()=>{m.az.trackDefinedEvent("assets_panel.flyout_opened",{assetKey:(0,T.V)(e),assetType:(0,T.q)(e.type),assetLibraryKey:e.library_key,isLocal:e.isLocal,fileParentOrgId:eg?.parentOrgId??void 0,fileTeamId:eg?.teamId??void 0,assetsPanelVersion:eb,partnerType:(0,M.X)(e.library_key),queryId:ej??void 0})}),(0,g.h)(()=>()=>{ef((0,b.vq)()),ea(!1)}),a.useEffect(()=>{if(!(0,R.dx)(e)||!e.isLocal)return;let t=e.node_id?e_[e.node_id]:null,s=e.type===q.PW.COMPONENT?e.content_hash:e.version;t?.content_hash!==s&&requestAnimationFrame(()=>{let t=(0,E.r2)(e.node_id);null!=t&&ef(C.T1({thumbnails:[{nodeId:e.node_id,url:t,type:e.type}],styleKind:q.AT.LOCAL}))})},[e,ef,e_]);let eC=a.useCallback(()=>{requestAnimationFrame(()=>es?.current?.ensureModalOnScreen())},[]),ew=a.useCallback(()=>{ev?.isShown&&ef((0,b.vq)())},[ef,ev]),eE=(0,z.Hu)(e.library_key),eN=(0,Y.Nv)(!0),eS=(0,K.CK)(),eT=a.useCallback(()=>{if("loaded"!==ei.status)return;let n=L.Y5.getViewportInfo(),a={canvasPosition:{x:n.offsetX,y:n.offsetY},insertAsChildOfCanvas:!0,percentageOffset:new _.Mi(.5,.5),storeInRecentsKey:G.$A.Design,useSmartPositioning:!0,fromPlayground:ei.data};e.type===q.PW.COMPONENT?(ef((0,j.FU)({item:e,...a})),ed&&em(!0)):e.type===q.PW.STATE_GROUP?ef((0,j.b$)({item:e,...a})):e.type===q.PW.MODULE&&ef((0,j.Bs)({item:e,...a,insertionCallback:()=>L.Y5.triggerAction("commit")}));let i={aiResultsEnabled:eN,assetKey:(0,R.Av)(e),assetType:(0,T.q)(e.type),queryId:ej??void 0,scoreAi:e.ai_score??void 0,scoreLexical:e.lexical_score??void 0,assetTypeDropdownSelection:U,assetsPanelVersion:eb,fileKey:eg?.key??void 0,fileParentOrgId:eg?.parentOrgId??void 0,fileTeamId:eg?.teamId??void 0,isExample:(0,A.o)(e,el),libraryKey:e.library_key,partnerType:(0,M.X)(e.library_key),sectionDepth:J,sourceSection:f??void 0,productType:(0,w.pi)({editorType:eg?.editorType})};m.az.trackDefinedEvent("assets_panel.flyout_insert",{...i,libraryType:eE,searchSessionId:t??void 0,searchQuery:s,sectionPosition:p}),et!==H.tM?m.az.trackDefinedEvent("asset_search.result_inserted",{...i,libraryType:eE,position:p,reciprocalRank:(0,r.Et)(p)?1/(1+p):void 0,query:s,sessionId:t??void 0,entryPoint:"assets-panel",componentSuggestionSessionId:eS}):(0,H.k1)({...i,position:p})},[eS,ei.status,ei.data,e,eN,ej,U,eb,eg?.key,eg?.parentOrgId,eg?.teamId,eg?.editorType,el,J,f,eE,t,s,p,ef,ed,em,et]);a.useEffect(()=>{if((0,u.kc)().dse_fpl_wave_2)return;let e=e=>{let t=es.current?.getEl()??en.current;if(t){if(!t.contains(e.target)){if(!e.target?.isConnected||(ea(!1),(0,h.NX)(e.target,ec.u2)))return;ep();return}ea(!0)}};return document.addEventListener("pointerdown",e),()=>{document.removeEventListener("pointerdown",e)}},[ep,ef,ea]);let eI=a.useCallback((t,s)=>{let n=t.code??t.key,a=(0,T.V)(e),i=ee?.(a);if(i){if((0,y.c2)(t,!1)){i.getItemAbove()?.focus(),s?.();return}if((0,y.Nt)(t,!1)){i.getItemBelow()?.focus(),s?.();return}if((0,y.yn)(t,!1)){i.getItemToTheLeft()?.focus(),s?.();return}if((0,y.lv)(t,!1)){i.getItemToTheRight()?.focus(),s?.();return}if("Enter"===n){eT(),s?.();return}}},[e,eT,ee]),eA=a.useCallback(e=>{eI(e.event,()=>e.accept())},[eI]);var eM=(0,n.jsxs)("div",{className:k.s.minW0.flex1.$,children:[(0,n.jsx)("h1",{children:(0,d.t)("design_systems.assets_panel.details")}),(0,n.jsxs)(v.Y,{spacing:0,direction:"horizontal",children:[e&&(0,n.jsx)(Z.Q,{assetLibraryKey:e.library_key,assetNodeId:e.node_id}),eh&&(0,n.jsx)("div",{className:k.s.pr4.$,children:(0,n.jsx)(S.KP,{libraryKey:e.library_key,variant:"secondary",tooltipLocation:"below"})})]})]});let[ez,eL,eO]=(0,P.J)(!1),eP=a.useCallback(()=>{ez.current&&ey()},[ez,ey]);return"loaded"!==ei.status?null:(0,u.kc)().dse_fpl_wave_2?(0,n.jsx)(l.bL,{onClose:ek,defaultPosition:new _.Mi(Q+1,eu),width:ex,"data-testid":"component-flyout-modal",id:ec.Ev,hidden:eL,onKeyDown:eI,ref:en,maxHeight:"100vh",children:(0,n.jsxs)(o.vo,{children:[(0,n.jsx)(o.Y9,{children:(0,n.jsx)(c.J,{style:{margin:0,minWidth:0},children:eM})}),(0,n.jsx)(o.nB,{style:{padding:0},scrolling:"manual",children:(0,n.jsx)(er,{asset:e,onLoaded:eC,onInsert:eT,flyoutHidden:eL,onCloseIfHidden:eP,setFlyoutHidden:eO,sectionPosition:p,sectionNameForTracking:f,sectionDepth:J})})]})}):(0,n.jsx)(X.Ao,{ref:es,allowAutoExpanding:!0,alwaysEnsureModalOnScreen:!0,canRenderBelowViewport:!1,dataTestId:"component-flyout-modal",headerSize:"large",hidden:eL,id:ec.Ev,initialPosition:new _.Mi(Q+1,eu),initialWidth:ex,noCancelDragAndDrop:!0,onClick:ew,onClose:ey,onKeyDown:eA,title:eM,truncateTitleText:!0,children:(0,n.jsx)("div",{"data-not-draggable":!0,children:(0,n.jsx)(er,{asset:e,onLoaded:eC,onInsert:eT,flyoutHidden:eL,onCloseIfHidden:eP,setFlyoutHidden:eO,sectionPosition:p,sectionNameForTracking:f,sectionDepth:J})})})}},135748:(e,t,s)=>{s.d(t,{r:()=>k});var n=s(239976),a=s(105652),i=s(692376),r=s(379141),l=s(224542),o=s.n(l),c=s(75962),d=s(233277),u=s(585066),x=s(350433),m=s(28083),p=s(925270),h=s(732400),g=s(562792),f=s(451287),_=s(511311);let y="component_flyout_thumbnail--thumbnail--D9-t1";function k({canViewPlayground:e,renderedAssetData:t,onCloseIfHidden:s,setFlyoutHidden:i,sectionPosition:l,sectionNameForTracking:c,sectionDepth:u,enableDragInsert:p=!0,maxThumbnailSize:f,fallbackToPublishedThumbnail:y=!0}){let k=a.useCallback(()=>{i(!0)},[i]),{onInsertableResourcePointerDown:j,dragState:C}=(0,g.j)({resource:t.asset,isList:!1,clickToInsert_DEPRECATED:!1,sourceForTracking:_.iV,fromPlayground:e,recomputeCancelRectsOnPointerUp:!0,onDragStart:p?k:void 0,onPointerUpWithoutInsert:p?s:void 0,sectionPosition:l,sectionNameForTracking:c,sectionDepth:u}),w=a.useMemo(()=>{let e=(0,m.zR)(t.asset,null);if(null!=e)return x.F.format(e)},[t.asset]),E=!!f;return(0,n.jsxs)(d.S.div,{className:o()("component_flyout_thumbnail--thumbnailWrapper--k6-GG",E?"component_flyout_thumbnail--fullHeightThumbnailWrapper--ddpnE":void 0),onPointerDown:p?j:void 0,role:"img","aria-label":(0,r.t)("design_systems.playground.thumbnail_alt"),style:w?{backgroundColor:w}:void 0,children:[y?(0,n.jsx)(b,{canViewPlayground:e,renderedAssetData:t}):(0,n.jsx)(v,{canViewPlayground:e,renderedAssetData:t,maxThumbnailSize:f}),p&&(0,n.jsx)(h.q,{dragState:C,isList:!1,thumbnailOverrideSrc:e&&t?.thumbnailData?t.thumbnailData.src:void 0})]})}function v({canViewPlayground:e,renderedAssetData:t,maxThumbnailSize:s}){return e&&t?.thumbnailData?(0,n.jsx)(c.oW,{className:y,style:s,src:t.thumbnailData.src,alt:(0,r.t)("design_systems.playground.thumbnail_alt"),draggable:!1}):(0,n.jsx)(u.k,{})}function b({canViewPlayground:e,renderedAssetData:t}){let s=j(t.hasChangesToReset,t.nodeData?.modeData??null);return e&&t?.thumbnailData&&s?(0,n.jsx)(c.oW,{className:y,src:t.thumbnailData.src,alt:(0,r.t)("design_systems.playground.thumbnail_alt"),draggable:!1}):(0,n.jsx)(f.M,{className:y,draggable:!1,item:t.asset,localThumbnailGenerationBehavior:"skip"},(0,p.V)(t.asset))}let j=(e,t)=>a.useMemo(()=>{if(e)return!0;let s=i.glU?.getPlaygroundScene();return!!s&&Object.values(t||{}).some(e=>{let t=e.inheritMode;return"MIXED"!==t&&!!t&&i.CWU?.getVariableSetDefaultModeForScene(e.collectionID,s)!==t.guid})},[e,t])},511311:(e,t,s)=>{s.d(t,{iV:()=>i,se:()=>r});var n=s(105652);s(104626),s(692376),s(421564);var a=s(407186);let i="asset-description-preview";function r(){let{closeFlyout:e}=(0,a.JA)();return n.useCallback(()=>{e()},[e])}},930494:(e,t,s)=>{s.d(t,{g:()=>az});var n=s(239976),a=s(105652),i=s(379141),r=s(224542),l=s.n(r),o=s(522568),c=s(916626),d=s(563188),u=s(309742),x=s(7857),m=s(806130),p=s(282746),h=s(154963),g=s(536920),f=s(223487),_=s(994047),y=s(330116),k=s(482621),v=s(488051),b=s(639184),j=s(859100),C=s(536746),w=s(384203),E=s(748181),N=s(215496),S=s(527205),T=s(584441),I=s(355441),A=s(271625),M=s(642165);let z=(0,x._d)(function(){let e=(0,w.aV)(),t=f.q5()?.canEdit,s=(0,f.MY)(),{show:r,isShowing:l,complete:o}=(0,j.e)({overlay:A.QI3,priority:N.N.SECONDARY_MODAL},[s]),c=(0,v.te)(),{currentView:d}=(0,T.wV)(),u=!!(0,E.f)(k.bo),x="no_figma_basics_onboarding_was_shown_in_current_session"===(0,C.zl)(M.j).currentState;return(0,a.useEffect)(()=>{!e&&t&&c()&&!u&&!x&&d===T.S5.Libraries&&r(),l&&d!==T.S5.Libraries&&o()},[r,o,t,l,c,u,x,d,e]),(0,n.jsx)(S.rq,{arrowPadding:k.fg,arrowPosition:I.F_.LEFT_TITLE,description:(0,i.tx)("rcs.visual_assets.explore_within_assets_tab"),disableHighlight:!0,isShowing:l,onClose:o,primaryCta:{label:(0,i.tx)("onboarding_pointers.got_it"),type:"button",onClick:o,ctaTrackingDescriptor:b.c.GOT_IT},targetKey:k.Bs,title:(0,i.tx)("rcs.visual_assets.elevate_your_designs"),trackingContextName:"Visual Asset Packs Tooltip",userFlagOnShow:k.bo})},"VisualAssetPacksTooltip");var L=s(326790);let O=(0,x._d)(function({width:e}){return(0,n.jsxs)(y.p,{children:[(0,n.jsx)("div",{style:{left:`${e}px`,top:"195px"},className:"visual_assets_tooltip_and_target--hiddenNuxAnchor--zPNCT","data-onboarding-key":k.ko}),(0,n.jsx)(L.T,{}),(0,n.jsx)(z,{})]})},"VisualAssetsTooltipAndTarget");var P=s(410518),R=s(527898),D=s(407186),F=s(20002),q=s(295870),G=s(179189),U=s(585574),K=s(346942),H=s(554408),B=s(536378),V=s(136393),$=s(338630),W=s(550534);function Y(){let e=(0,F.wA)(),t=(0,f.q5)(),s=(0,F.d4)(e=>e.user?.id);if(!t)return null;let a=t.teamId,r=(0,n.jsx)(K.Us,{className:"library_upsell_banner--blueLink--DCJqa blue_link--blueLink--4ER8T",onClick:function(){(0,o.sx)("library_upsell_badge_clicked",{fileKey:t?.key,teamId:a,userId:s}),e((0,B.to)({type:H.V,data:{teamId:a??void 0,entrypoint:W.C.LIBRARY_UPSELL_BADGE,openCheckoutInNewTab:!0}}))},trackingProperties:{trackingDescriptor:b.c.UPGRADE_TO_PROFESSIONAL},trusted:!0,role:"button",children:(0,i.tx)("design_systems.assets_panel.library_upsell_upgrade")});return(0,n.jsx)(m.tH,{boundaryKey:"LibraryUpsellBanner",fallback:m.H4.NONE_I_KNOW_WHAT_IM_DOING,sentryTags:{area:q.e.MONETIZATION_UPGRADES},children:(0,n.jsx)($.fu,{name:"library upsell badge",properties:{fileKey:t?.key,teamId:t?.teamId},children:(0,n.jsx)("div",{className:"library_upsell_banner--bannerBackground--PdrvI",children:(0,n.jsxs)("div",{className:"library_upsell_banner--bannerContainer--0cQEw",children:[(0,n.jsx)(U.Jn,{className:"library_upsell_banner--closeButton--CcKYi",onClick:function(){(0,o.sx)("library_upsell_badge_dismissed",{fileKey:t?.key,teamId:a,userId:s}),e(V.b({has_dismissed_component_sidebar_library_upsell_banner:!0}))}}),(0,n.jsxs)("div",{className:"library_upsell_banner--bannerContent--wTfyi",children:[(0,n.jsx)("div",{className:"library_upsell_banner--bannerHeader--qRYu2",children:(0,n.jsx)(G.l,{})}),(0,n.jsx)("p",{className:"library_upsell_banner--bannerTitle--ldjfV",children:(0,i.tx)("design_systems.assets_panel.library_upsell_header")}),(0,n.jsx)("p",{className:"library_upsell_banner--bannerBody--LdmHm",children:(0,i.tx)("design_systems.assets_panel.library_upsell_body",{upgradeToProfessionalPlanLink:r})})]})]})})})})}var X=s(193397),Z=s(519990),J=s(11413),Q=s(81164);s(323752);var ee=s(908756),et=s(675341),es=s(863672),en=s(995586);let ea=!1;var ei=s(40297),er=s(853921),el=s(138709),eo=s(901962),ec=s(943360),ed=s(844303),eu=s(321096),ex=s(270450),em=s(86742),ep=s(840099);let eh="asset_panel_folder--folderButton--6ExSA",eg="asset_panel_folder--selected--pcEEJ",ef="asset_panel_folder--blankThumbnail--Z5WGB";var e_=s(371347);let ey=(0,ei.jz)(e_.CT),ek={height:ey,width:ey},ev=a.forwardRef(function({keyPrefix:e,name:t,onClick:s,onContextMenu:a,onMouseEnter:i,onMouseLeave:r,onMouseMove:o,previewAssetOrUrl:c,recordingKey:d,disabled:u,selected:x,variant:m,customThumbnailData:p,pageInfo:h,role:g},f){let _=(0,n.jsxs)(n.Fragment,{children:["preview"===m||"preview-no-padding"===m?(0,n.jsx)("div",{className:"asset_panel_folder--folderPreview--m2IZc",children:c?(0,n.jsx)(ep.V,{keyPrefix:e,previewAssetOrUrl:c,type:"preview-no-padding"===m?"no-padding":void 0,customThumbnailData:p,...ek,pageInfo:h}):(0,n.jsx)("div",{className:ef,style:ek})}):(0,n.jsx)("div",{className:"asset_panel_folder--folderIcon--o7tm7",children:(0,n.jsx)(ed.x,{})}),(0,n.jsx)("div",{className:"asset_panel_folder--folderName--mrEz- ellipsis--ellipsis--70pHK",children:t}),(0,n.jsx)("div",{className:l()("asset_panel_folder--folderNextIcon--LV2jD",{"asset_panel_folder--adjustMargin--6870-":"icon"===m}),children:(0,n.jsx)(eu.n,{})})]});return(0,n.jsx)("div",{className:"asset_panel_folder--folderContainer--ll7It",role:g,children:(0,ex.kc)().dse_fpl_wave_1?(0,n.jsx)(ec.E,{ref:f,"aria-label":t,className:l()(eh,{[eg]:x}),disabled:u,onClick:s,onContextMenu:a,onMouseEnter:i,onMouseLeave:r,onMouseMove:o,recordingKey:d,children:_}):(0,n.jsx)(em.GG,{"aria-label":t,className:l()(eh,{[eg]:x}),disabled:u,forwardedRef:f,onClick:s,onContextMenu:a,onMouseEnter:i,onMouseLeave:r,onMouseMove:o,recordingKey:d,children:_})})});var eb=s(332477),ej=s(209067),eC=s(575987);function ew({subtree:e,index:t,keyPrefix:s,depth:i}){let r=(0,eb.sN)(),{folderPath:l,currentView:o}=(0,T.wV)(),[c]=(0,eC.MA)(),{previewAsset:d}=e,{navigateToFolder:u}=(0,T.wV)(),x=a.useCallback(()=>{r("folderRow",u(e.name))},[r,u,e.name]),m=a.useMemo(()=>[et.ON.CONTENTS,et.lM.ASSETS+i,et.tM.FOLDERS,t],[i,t]),{keyboardNavigationItem:p,setKeyboardNavigationElement:h}=(0,eo.M3)({path:m,id:e.key,disabled:(l?.length??0)>i}),{focusFirstItem:g,focusSearchBar:f}=(0,ej.rl)();(0,ej.C0)(p,0===t&&i===(l?.length??0)&&o===T.S5.Assets);let _=(0,ej.MB)({onBoth:x,onKeyDown:g,onClick:f}),y=a.useMemo(()=>l&&l.length>i,[l,i]);return(0,n.jsx)(ev,{name:e.name,onClick:_,keyPrefix:`${s}${e.name}`,previewAssetOrUrl:d,recordingKey:`assetsFolder.${e.name}`,ref:h,disabled:y,variant:"list"===c?"icon":"preview",role:"list"===c?"listitem":"gridcell"})}var eE=s(718286),eN=s(999159),eS=s(715243),eT=s(757691),eI=s(445019),eA=s(640753),eM=s(377801);let ez=(0,eI.Iz)(()=>(0,eA.rt)(0));function eL({libraryKey:e,pageId:t,folderPath:s}={}){let{lastNavAction:n}=(0,eM.ZX)(),i=n===eM.r6.Back||n===eM.r6.Mount||n===eM.r6.ToggleView&&!s,[r,l]=(0,eI.fp)(ez("libraries")),[o,c]=(0,eI.fp)(ez(`pages-${e}`)),[d,u]=(0,eI.fp)(ez(`assets-${e}-${t}-${(s??[]).join("-")}`));return{librariesScrollTop:i?r:0,pagesScrollTop:i?o:0,assetsScrollTop:i?d:0,handleScrollLibraries:a.useCallback(e=>{l(e)},[l]),handleScrollPages:a.useCallback(t=>{e&&c(t)},[c,e]),handleScrollAssets:a.useCallback(s=>{e&&t&&u(s)},[u,e,t])}}var eO=s(922534),eP=s(925270),eR=s(421564),eD=s(365841),eF=s(299728),eq=s(323264),eG=s(863412),eU=s(422572),eK=s(835427),eH=s(712022),eB=s(857635),eV=s(236410),e$=s(400982),eW=s(613809),eY=s(10212),eX=s(599345),eZ=s(768799),eJ=s(316157),eQ=s(880867),e0=s(175268);let e1=(0,ei.jz)(e_._K);function e5(e){return(0,n.jsx)(x.u9,{label:"AssetPanelResponsiveSetTile",children:(0,n.jsx)(e2,{...e})})}function e2({asset:e,cmsCollectionMappings:t,sectionNameForTracking:s,sectionDepth:i,sectionPosition:r,keyboardPosition:o,isFirstTile:c=!1,keyboardPanelDepth:d=0,thumbHeight:u,thumbWidth:x,libraryName:m,hideName:p=!1,onDragStart:g}){let f=(0,eH.kH)(e.name),{currentView:_,folderPath:y}=(0,T.wV)(),[k]=(0,eC.ye)(),[v]=(0,eC.MA)(),b="list"===v,j=(0,eZ.jx)(),C=null!=t,w=a.useMemo(()=>({...o,path:[et.ON.CONTENTS,et.lM.ASSETS+d,...o.path]}),[o,d]),E=_===T.S5.Assets&&y&&k&&(y?.length??0)>d,{setKeyboardNavigationElement:N,keyboardNavigationItem:S}=(0,eo.M3)({...w,id:(0,eP.V)(e),disabled:E});(0,ej.C0)(S,c&&_===T.S5.Assets&&!E);let{logInsert:I}=e3({item:e,sectionNameForTracking:s,sectionPosition:r,sourceForTracking:eY.mZ,isList:b}),A=a.useCallback(()=>{I("drag"),(0,e$.$z)()},[I]),M=a.useMemo(()=>({sourceForTracking:eY.mZ,sectionNameForTracking:s,sectionDepth:i,afterSuccessfulInsert:A,onDragStart:g}),[s,i,A,g]),z=function({item:e,cmsCollectionMappings:t,sectionNameForTracking:s,sectionPosition:n,sourceForTracking:i,isList:r}){let l=(0,F.wA)(),{logInsert:o,logKeyboardInsert:c}=e3({item:e,sectionNameForTracking:s,sectionPosition:n,sourceForTracking:i,isList:r}),d=a.useCallback(()=>{l((0,eU.jR)({item:e,cmsCollectionMappings:t,insertAsChildOfCanvas:!1,useSmartPositioning:!0})),(0,e$.$z)()},[l,e,t]);return a.useCallback(e=>{let t=0===e.detail;t&&c(),o(t?"keyboard":"click"),d()},[d,o,c])}({item:e,cmsCollectionMappings:t,sectionNameForTracking:s,sectionPosition:r,sourceForTracking:eY.mZ,isList:b}),L=a.useMemo(()=>(0,eW.NR)(f),[f]),{listProps:O}=(0,eO.O)(),P=a.useMemo(()=>{if(p&&!b&&!C)return{"data-tooltip-type":eV.Ib.TEXT,"data-tooltip":L}},[L,p,b,C]);return(0,n.jsxs)(ec.E,{className:b?l()("asset_panel_responsive_set_tile--tileList--1KLeU asset_panel_responsive_set_tile--_tileBase--4y5XH asset_panel_tile--button--ja3D6",e0.iE):l()("asset_panel_responsive_set_tile--tileGrid--hABDG asset_panel_responsive_set_tile--_tileBase--4y5XH asset_panel_tile--button--ja3D6",e4({isFirstTile:c,isInLibraryFlyout:j,isCmsBlock:C})),ref:N,onClick:z,"aria-label":L,...P,children:[(0,n.jsx)("div",{className:l()(b?e0.u2:e0.QX,h.s.relative.$),children:(0,n.jsx)(eX.lX,{alwaysShowBorder:!1,cmsCollectionMappings:t,displayType:b?"list-no-padding":"grid",draggable:M,height:b?O.thumbHeight:u,item:e,sectionPosition:r,shouldHideTooltip:!0,showName:b,thumbPaddingGrid:e1,thumbWrapperClassName:"asset_panel_responsive_set_tile--thumbWrapper--OYot8 asset_panel_tile--thumbWrapper--SGU3x",useBaseTile:!0,width:b?O.thumbWidth:x})}),!p&&!b&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:e0.Bm,style:{width:x-2},children:(0,n.jsx)(eG.G,{text:L})}),m&&(0,n.jsx)("div",{style:{width:x-2},children:(0,n.jsx)(eG.G,{text:m,className:l()(e0.Md,e0.Rm)})})]})]})}function e3({item:e,sectionNameForTracking:t,sectionPosition:s,sourceForTracking:n,isList:i}){let r=(0,eJ.Nv)(!0),l=(0,f.tS)(),c=(0,T._m)(),d=(0,eK.Ew)({assetKey:(0,eB.u2)(e),assetLibraryKey:e.sourceLibraryKey,assetType:e.type,isList:i,sectionNameforTracking:t,sectionPosition:s,sourceForTracking:n??eY.mZ,isExample:!1,partnerType:void 0}),u=(0,eQ.r6)([e]),x=(0,P.CK)(),m=!!d.searchSessionId,p=a.useCallback(t=>{let{type:s,sectionPosition:n,searchQuery:a,searchSessionId:i,...l}=d;o.az.trackDefinedEvent("asset_search.result_inserted",{...l,aiResultsEnabled:r,assetType:s,position:n,reciprocalRank:1/(1+n),query:a,sessionId:i,entryPoint:eY.mZ,componentSuggestionSessionId:x}),o.az.trackDefinedEvent("assets_panel.site_kit_inserted",{assetName:(0,eW.NR)((0,eH.kH)(e.name)),type:"responsive set",group:u(e),isFullPage:e.fullPage,fileKey:d.fileKey,fileTeamId:d.fileTeamId,fileOrgId:d.fileOrgId,sectionPosition:n,searchQuery:d.searchQuery,searchSessionId:d.searchSessionId,searchType:m?c?"site kit":"all":void 0,viewMode:d.viewMode?.toLocaleLowerCase(),queryId:d.queryId,action:t})},[d,r,x,e,u,m,c]),h=a.useCallback(()=>{o.az.trackDefinedEvent("assets_panel.keyboard_insert",{...d,aiResultsEnabled:r,assetsPanelVersion:3,fileKey:l??void 0})},[d,r,l]);return a.useMemo(()=>({logInsert:p,logKeyboardInsert:h}),[p,h])}let e4=({isFirstTile:e,isInLibraryFlyout:t,isCmsBlock:s})=>s?eq.Ay.classNames(e6.cmsGridWrapper):t?e?"asset_panel_responsive_set_tile--gridWrapperForBlocksRedesignFirstTile--xx9ml asset_panel_responsive_set_tile--gridWrapperForBlocksRedesign--9lou- asset_panel_tile--gridWrapper--GdfPx asset_panel_tile--wrapper--KXz0O asset_panel_tile--_wrapperBase---sbFt library_item_tile--_variantHover--FYwBc":"asset_panel_responsive_set_tile--gridWrapperForBlocksRedesign--9lou- asset_panel_tile--gridWrapper--GdfPx asset_panel_tile--wrapper--KXz0O asset_panel_tile--_wrapperBase---sbFt library_item_tile--_variantHover--FYwBc":e0.K2,e6={cmsGridWrapper:{kaIpWk:"x19y5rnk",krdFHd:null,kfmiAY:null,kVL7Gh:null,kT0f0o:null,kIxVMA:null,ksF3WI:null,kqGeR4:null,kYm2EN:null,kWkggS:"x12tve8b",$$css:!0}};var e7=s(41652),e8=s(581275);let e9=(0,ei.jz)(e_.HE),te=(0,ei.jz)(e_._q),tt=(0,ei.jz)(e_.RQ),ts=(0,ei.jz)(e_.$c),tn=(0,ei.jz)(e_.d5);function ta({page:e,libraryKey:t,hideScrollbar:s}){let{assetsScrollTop:i,handleScrollAssets:r}=eL({libraryKey:t,pageId:e.id}),[l]=(0,eC.MA)(),{width:o}=(0,eD.G)(),c=a.useMemo(()=>(0,eT.rJ)(e.assets),[e.assets]),{tileHeight:d,tileWidth:u,numColumns:x}=(0,eF.AA)(o,c),m=a.useMemo(()=>{let e=[];return e.push(...to(c,x,u,d,l,"assets","Site kit",[et.tM.COMPONENTS],{includesFirstTile:!0,hideName:!0})),e},[c,l,x,d,u]);return(0,n.jsx)(eS.wl,{elements:m,hideScrollbar:s,initialScrollTop:i,onScroll:r,anchorScroll:!0,role:l})}function ti({subtree:e,currentFolderPath:t,hideScrollbar:s,onScroll:a,initialScrollTop:i,role:r}){let l=tr({subtree:e,currentFolderPath:t});return(0,n.jsx)(eS.wl,{elements:l,hideScrollbar:s,onScroll:a,initialScrollTop:i,role:r})}let tr=({subtree:e,currentFolderPath:t})=>{let{folderPath:s}=(0,T.wV)(),[i]=(0,eC.MA)(),{width:r}=(0,eD.G)(),{tileHeight:l,tileWidth:o,numColumns:c}=(0,eF.AA)(r,e?.items),d=t.join("/"),u=t.length,x=s?.length??0,m=a.useCallback(({subtree:e,elements:t})=>{let s=e.items.length>0;if(s){let s=[et.tM.COMPONENTS];t.push(...to(e.items,c,o,l,i,e.key,"Site kit",s,{includesFirstTile:u===x,keyboardPanelDepth:u,depth:u,hideName:!0}))}let a=Array.from(e.subtrees.values());s&&a.length>0&&t.push({element:(0,n.jsx)(eN.cG,{}),key:"divider",height:tt}),a.forEach((s,a)=>{t.push({element:(0,n.jsx)(ew,{subtree:s,index:a+e.items.length,keyPrefix:d,depth:u}),key:s.key,height:"list"===i?e9:te})})},[c,o,l,u,x,d,i]);return a.useMemo(()=>{let t=[];return e&&m({subtree:e,elements:t}),t},[m,e])};function tl(e){return e.type===eR.PW.RESPONSIVE_SET}function to(e,t,s,a,i,r,l,o,c={}){let d=[];for(let u=0;u<e.length;u+=t){let x=e.slice(u,u+t),m=[];x.forEach((e,i)=>{let d=u+i;tl(e)?m.push((0,n.jsx)(e5,{asset:e,hideName:c.hideName,isFirstTile:c?.includesFirstTile&&0===d,keyboardPanelDepth:c?.keyboardPanelDepth,keyboardPosition:(0,ej.pg)(o,d,t),libraryName:c.libraryNameForAsset?.(e),sectionDepth:c?.depth,sectionNameForTracking:l,sectionPosition:u+i,thumbHeight:a,thumbWidth:s},`${r}-${(0,eP.V)(e)}`)):m.push((0,n.jsx)(e7.pd,{embed:e,sectionNameForTracking:l,sectionPosition:u+i,keyboardPosition:(0,ej.pg)(o,d,t),isFirstTile:c?.includesFirstTile&&0===d,thumbHeight:a,thumbWidth:s,libraryName:c.libraryNameForAsset?.(e)},e.name))}),d.push({element:(0,n.jsx)("div",{className:"list"===i?e8.OS:0===u?e8.c:e8.wt,role:"row",children:m}),key:`${r}:row-${u/t}`,keys:x.map(e=>tl(e)?(0,eP.V)(e):e.name),height:(0,eS.Hw)(a,i,{showFileName:!!c.libraryNameForAsset,hasTopPadding:0!==u,showAiDebugScores:!!(0,ex.kc)().api_asset_search_with_scores,hideAssetName:!!c.hideName})})}return d.length>0&&(d.unshift({element:(0,n.jsx)(eN.hK,{height:ts}),key:`${r}:spacer-top`,height:ts}),d.push({element:(0,n.jsx)(eN.hK,{height:tn}),key:`${r}:spacer-bottom`,height:tn})),d}var tc=s(345481);let td=(0,ei.jz)(e_.HE),tu=(0,ei.jz)(e_._q),tx=(0,ei.jz)(e_.ce),tm=(0,ei.jz)(e_.RQ);function tp({page:e,width:t}){let{libraryKey:s,currentView:i}=(0,T.wV)(),{getPage:r}=(0,eE.G)(),{previousPageId:l}=(0,T.RR)(),o=a.useMemo(()=>i===T.S5.Pages?r(s,l):e,[i,r,s,e,l]);return s&&o?(0,n.jsx)(th,{libraryKey:s,page:o,width:t}):(0,n.jsx)("div",{style:{width:t}})}function th({libraryKey:e,page:t,width:s,hideScrollbar:a}){let[i]=(0,eC.ye)();if((0,et.AZ)(t))return(0,n.jsx)(tv,{page:t});if(i)return(0,n.jsx)(tf,{page:t,libraryKey:e,width:s,hideScrollbar:a});switch(t.type){case et.yW.DESIGN:return(0,n.jsx)(tg,{page:t,libraryKey:e});case et.yW.SITE:return(0,n.jsx)(ta,{page:t,libraryKey:e,hideScrollbar:a})}}function tg({page:e,libraryKey:t}){let{assetsScrollTop:s,handleScrollAssets:r}=eL({libraryKey:t,pageId:e.id}),[l]=(0,eC.MA)(),o=(0,eO.O)(),{componentSectionNameForTracking:c,templateSectionNameForTracking:d}=(0,eb.zf)(),u=a.useMemo(()=>{let t=[];if(e.templates){let s=(0,eT.rJ)(e.templates),{props:a,numColumns:r}=(0,eO.Z)(o,l,el.rp.NORMAL,!0);t.push({element:(0,n.jsx)(eN.X3,{title:(0,i.t)("design_systems.assets_panel.templates")}),key:"templates:header",height:tx}),t.push(...(0,eS.Ij)(s,r,"templates",a,d,[et.tM.TEMPLATES],{includesFirstTile:!0}))}if(e.examples){let s=(0,eT.rJ)(e.examples),{props:n,numColumns:a}=(0,eO.Z)(o,l,el.rp.NORMAL,!0);t.push(...(0,eS.Ij)(s,a,"examples",n,c,[et.tM.EXAMPLES],{includesFirstTile:!0,isExample:!0}))}if(e.components){e.templates&&t.push({element:(0,n.jsx)(eN.X3,{title:(0,i.t)("design_systems.assets_panel.components")}),key:"components:header",height:tx});let s=(0,eT.rJ)(e.components),a=(0,el.PI)(s,!0),{props:r,numColumns:d}=(0,eO.Z)(o,l,a);t.push(...(0,eS.Ij)(s,d,"components",r,c,[et.tM.COMPONENTS],{includesFirstTile:!e.templates&&!e.examples}))}return t},[e.templates,e.examples,e.components,o,l,d,c]);return(0,n.jsx)(eS.wl,{elements:u,initialScrollTop:s,onScroll:r,anchorScroll:!0,role:l})}function tf({page:e,width:t,libraryKey:s,hideScrollbar:i}){let{folderPath:r}=(0,T.wV)(),{getFolder:l}=(0,eE.G)(),{previousFolderPath:o,previousPageId:c}=(0,T.RR)(),d=e.id,[u,x]=a.useMemo(()=>{let t=[],a=o??r??[],u=0;for(let o=-1;o<a.length;o++){let x=a.slice(0,o+1),m=l(s,d??c,x);if(m){if((0,T.xc)(m))continue;t.push((0,n.jsx)(ty,{page:e,libraryKey:s,currentFolderPath:x,hideScrollbar:i},`components-${x?x.join("/"):"root"}`)),o===(r??[]).length-1&&(u=t.length-1)}}return[t,u]},[r,l,i,s,e,d,o,c]);return(0,n.jsx)(tc.A,{index:x,width:t,children:u})}function t_(e,t){let s=e;for(let e of t){let t=s.subtrees.get(e);if(!t)return null;s=t}return s}function ty({page:e,libraryKey:t,currentFolderPath:s,hideScrollbar:i}){let[r]=(0,eC.MA)(),l=a.useMemo(()=>e.type===et.yW.DESIGN?t_(e.assets,s):null,[s,e.assets,e.type]),o=a.useMemo(()=>e.type===et.yW.SITE?t_(e.assets,s):null,[s,e.assets,e.type]),{folderPath:c}=(0,T.wV)(),d=(0,Q.fd)(t),u=e.id,x=s.length,m=c?.length??0,{assetsScrollTop:p,handleScrollAssets:h}=eL({libraryKey:t,pageId:u,folderPath:s});switch(e.type){case et.yW.DESIGN:return(0,n.jsx)(tk,{subtree:l,currentFolderPath:s,hideScrollbar:i||x<m,onScroll:h,initialScrollTop:p,role:r,isPreset:d});case et.yW.SITE:return(0,n.jsx)(ti,{subtree:o,currentFolderPath:s,hideScrollbar:i||x<m,onScroll:h,initialScrollTop:p,role:r})}}function tk({subtree:e,currentFolderPath:t,isPreset:s,hideScrollbar:a,onScroll:i,initialScrollTop:r,role:l}){let o=tb({subtree:e,currentFolderPath:t,isPreset:s});return(0,n.jsx)(eS.wl,{elements:o,hideScrollbar:a,onScroll:i,initialScrollTop:r,role:l})}function tv({page:e}){let[t]=(0,eC.MA)();return(0,n.jsx)(eN.xU,{children:(0,n.jsx)("div",{className:"grid"===t?"asset_panel_assets--embeds--T-Zm7":h.s.flex.flexColumn.itemsCenter.$,children:(0,n.jsx)(e7.$4,{embeds:e.embeds})})})}let tb=({subtree:e,currentFolderPath:t,isPreset:s})=>{let i=(0,eO.O)(),{componentSectionNameForTracking:r}=(0,eb.zf)(),{folderPath:l}=(0,T.wV)(),[o]=(0,eC.MA)(),c=t.join("/"),d=t.length,u=l?.length??0,x=a.useMemo(()=>!!(s&&e?.items)&&e?.items.every(e=>er.Nz(e,{isPreset:s})),[s,e?.items]),m=a.useCallback(e=>{let t=e.subtrees.values().next().value;return t&&(0,er.dS)(t.name,{isPreset:s})},[s]),p=a.useCallback(({subtree:e,elements:t})=>{let s=e.items.length>0,a=m(e);if(s){let s=[et.tM.COMPONENTS],n=(0,el.PI)(e.items,!0),{props:a,numColumns:l}=(0,eO.Z)(i,o,n,x);t.push(...(0,eS.Ij)(e.items,l,e.key,a,r,s,{hasHeader:!1,includesFirstTile:d===u,keyboardPanelDepth:d,isExample:x}))}let l=Array.from(e.subtrees.values());s&&l.length>0&&!a&&t.push({element:(0,n.jsx)(eN.cG,{}),key:"divider",height:tm,ariaHidden:!0}),l.forEach((s,i)=>{t.push({element:(0,n.jsx)(ew,{subtree:s,index:i+e.items.length,keyPrefix:c,depth:d}),key:s.key,height:"list"===o?td:tu}),0===i&&a&&l.length>1&&t.push({element:(0,n.jsx)(eN.cG,{}),key:"examples_divider",height:tm,ariaHidden:!0})})},[m,i,o,x,r,d,u,c]);return a.useMemo(()=>{let t=[];return e&&p({subtree:e,elements:t}),t},[p,e])};var tj=s(315588),tC=s(598713),tw=s(204229),tE=s(590490),tN=s(805242),tS=s(449979),tT=s(391596),tI=s(499735),tA=s(620030),tM=s(770785),tz=s(450207),tL=s(617852),tO=s(934650),tP=s(31201),tR=s(994142),tD=s(551417),tF=s(655674);let tq="asset-panel-library-context-menu",tG=tI.Pt("assetsLibrary","contextMenu"),tU=tA.ms,tK=tA.c$,tH=a.memo(({dropdownShown:e,usePortal:t})=>{let[{data:s}]=(0,tT.IT)((0,Q.Re)(e?.data?.partnerType));if(!e||e.type!==tq)return null;let{data:a}=e;if(!a)return null;let{libraryHref:r,position:l,isLocalLibrary:o,hideUnsubscribe:c=!1,onGoToLibrary:d,onPublish:u,onUnsubscribe:x,onSendFeedback:m}=a,p=o?(0,n.jsx)(tK,{onClick:u,recordingKey:tI.Pt(tG,"publishLibrary"),children:(0,i.tx)("design_systems.assets_panel.publish_library")}):null,h=[p,c||o?null:(0,n.jsx)(tK,{onClick:x,recordingKey:tI.Pt(tG,"unsubscribe"),children:(0,i.tx)("design_systems.assets_panel.remove_library_from_file")}),o||!r?null:(0,n.jsx)(tK,{href:r,target:"_blank",recordingKey:tI.Pt(tG,"goToLibrary"),onClick:d,children:(0,i.tx)("design_systems.assets_panel.go_to_library")}),!o&&s?(0,n.jsx)(tK,{href:s,target:"_blank",recordingKey:tI.Pt(tG,"sendFeedback"),onClick:m,children:(0,i.tx)("design_systems.assets_panel.send_feedback_to_creator")}):null].filter(tS.Vq);if(!l||!h.length)return null;let g=(0,n.jsxs)(tU,{style:tM.sx.add({top:`${l.top}px`,right:`${l.right}px`,bottom:`${l.bottom}px`,left:`${l.left}px`}).add(tM.sx.fixed).$,children:[...h]});return t?tN.createPortal(g,document.body):g});var tB=s(466082);let tV="asset-panel-page-context-menu",t$=tI.Pt("assetsLibrary","contextMenu"),tW=tA.ms,tY=tA.c$,tX=a.memo(({dropdownShown:e,usePortal:t})=>{if(!e||e.type!==tV)return null;let{data:s}=e;if(!s)return null;let{libraryPageHref:a,position:r,isLocalLibrary:l,onClickLocalPage:o,onClickSubscribedPage:c}=s;if(!r)return null;let d=l?(0,n.jsx)(tY,{recordingKey:tI.Pt(t$,"goToLibrary"),onClick:o,children:(0,i.tx)("design_systems.assets_panel.go_to_page")}):a?(0,n.jsx)(tY,{href:a,target:"_blank",recordingKey:tI.Pt(t$,"goToLibrary"),onClick:c,children:(0,i.tx)("design_systems.assets_panel.go_to_page")}):null;if(!d)return null;let u=(0,n.jsx)(tW,{style:tM.sx.add({top:`${r.top}px`,right:`${r.right}px`,bottom:`${r.bottom}px`,left:`${r.left}px`}).add(tM.sx.fixed).$,children:d});return t?tN.createPortal(u,document.body):u});function tZ(){let e=(0,F.d4)(e=>e.dropdownShown),t=(0,F.d4)(tj.h),s=e?.type===tE.K.ASSETS_PANEL&&!!e?.data?.component,i=e?.type===tV&&!!e?.data?.pageId,r=e?.type===tq&&!!e?.data,l=(0,tw.K)(!0),o=a.useContext(tC.U);return(0,n.jsxs)(n.Fragment,{children:[s&&(0,n.jsx)(tE.h,{selectedView:t,dropdownShown:e,onJumpToLocalComponent:l,onOpenFlyout:o?.onOpenFlyout,usePortal:!0}),i&&(0,n.jsx)(tX,{dropdownShown:e,usePortal:!0}),r&&(0,n.jsx)(tH,{dropdownShown:e,usePortal:!0})]})}var tJ=s(942356),tQ=s(322901),t0=s(634261),t1=s(308251),t5=s(840589),t2=s(50133),t3=s(267447),t4=s(767584),t6=s(116695),t7=s(75962);s(985836);var t8=s(245937),t9=s(758440),se=s(566697),st=s(784395),ss=s(933870),sn=s(955104),sa=s(684986),si=s(854225),sr=s(340681),sl=s(544392);function so(){let e=(0,eI.Xr)(sl.lx),t=a.useCallback(()=>{e(si.Nfd.DAKOTA)},[e]);return(0,n.jsx)("div",{...eq.Ay.props(sr.A.p16),children:(0,n.jsxs)("div",{...eq.Ay.props(sr.A.flex,sr.A.flexColumn,sr.A.itemsCenter,sr.A.textCenter,sr.A.gap8),children:[(0,n.jsx)(sa.s,{className:"x1aue78i"}),(0,n.jsx)("div",{...eq.Ay.props(sr.A.textBodyMediumStrong,sr.A.colorText),children:(0,i.tx)("dakota.site_blocks.create_cms_collection")}),(0,n.jsx)("div",{...eq.Ay.props(sr.A.textBodyMedium,sr.A.colorTextSecondary),children:(0,i.tx)("dakota.site_blocks.dynamically_connect_and_update")}),(0,n.jsx)(tJ.IK,{onClick:t,children:(0,i.tx)("dakota.site_blocks.create_collection_button")})]})})}var sc=s(12949),sd=s(235676),su=s(957609),sx=s(322750),sm=s(46295);function sp(e){let{data:t}=(0,sn.gL)(e);return(0,a.useMemo)(()=>t?function(e){let t=e.sort((e,t)=>(0,sc.Ez)(t.position,e.position)),s=t.filter(e=>!(0,sd.B4)(e)&&(e.fieldType===sx._j.PLAIN_TEXT||e.fieldType===sx._j.DATE)),n=s.find(e=>"title"===e.name.toLowerCase())||s[0],a=s.find(e=>e.id!==n?.id),i=t.find(e=>e.fieldType===sx._j.RICH_TEXT),r=t.find(e=>e.fieldType===sx._j.IMAGE);return{primaryTextFieldId:n?.id??null,secondaryTextFieldId:a?.id??null,richTextFieldId:i?.id??null,imageFieldId:r?.id??null}}(t.fieldSchemas||[]):{primaryTextFieldId:null,secondaryTextFieldId:null,richTextFieldId:null,imageFieldId:null},[t])}function sh(e){let t=(0,eQ.t0)();return(0,a.useMemo)(()=>t?Object.fromEntries([[t.primaryTextFieldId,e.primaryTextFieldId],[t.secondaryTextFieldId,e.secondaryTextFieldId],[t.imageFieldId,e.imageFieldId],[t.richTextFieldId,e.richTextFieldId]].filter(e=>null!=e[0]&&null!=e[1])):{},[t,e])}function sg(e,t,{isPageBlock:s}={}){let n=(0,eQ.t0)(),i=n?.assetNames;return(0,a.useMemo)(()=>{if(!i)return null;let n=s?function(e,t){let{primaryTextFieldId:s,secondaryTextFieldId:n,richTextFieldId:a,imageFieldId:i}=e,r=null!==s,l=null!==n,o=null!==a,c=null!==i;return(l&&!r&&(0,sm.AK)("Unexpected CMS block fields",{primaryTextFieldId:s,secondaryTextFieldId:n,imageFieldId:i}),c)?r&&l&&o?t.textImageRichPage??null:r&&o?t.imageRichPage??null:r&&l?t.textImagePage??null:t.imagePage??null:r&&l&&o?t.textRichPage??null:r&&o?t.richPage??null:r||l?t.textPage??null:null}(e,i):function(e,t){let{primaryTextFieldId:s,secondaryTextFieldId:n,richTextFieldId:a,imageFieldId:i}=e,r=null!==s,l=null!==n,o=r||l,c=null!==i;return(l&&!r&&(0,sm.AK)("Unexpected CMS block fields",{primaryTextFieldId:s,secondaryTextFieldId:n,imageFieldId:i}),c)?r&&!l?t.imageSingleTextList:o?t.textImageList:t.imageOnlyList:r&&null!==a?t.richTextList??t.textOnlyList:o?t.textOnlyList:null}(e,i);return n?t.find(e=>e.name===n)??null:null},[e,t,i,s])}function sf({collections:e,assets:t,renderFlyoutListItem:s,renderFlyoutPageItem:a}){return(0,n.jsx)(x.u9,{label:"CmsFlyoutItems",children:e.map((i,r)=>{let l=r===e.length-1;return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{...eq.xk(sr.A.flex,sr.A.itemsCenter,sr.A.gap4,sr.A.px8,sr.A.my4),children:[(0,n.jsx)(sa.s,{}),(0,n.jsx)("span",{...eq.xk(sr.A.textBodyMediumStrong,sr.A.colorText),children:i.name})]}),(0,n.jsx)(sy,{assets:t,collectionId:i.id,collectionName:i.name,children:e=>s({...e,index:r})}),(0,n.jsx)(sk,{assets:t,collectionId:i.id,collectionName:i.name,children:e=>a({...e,index:r})}),!l&&(0,n.jsx)("hr",{...eq.xk(s_.divider,sr.A.m8)})]},i.id)})})}let s_={divider:{kMzoRj:"xc342km",kjGldf:null,k2ei4v:null,kZ1KPB:null,ke9TFa:null,kWqL5O:null,kLoX6v:null,kt9PQ7:null,kEafiO:"x178xt8z",kPef9Z:"x13fuv20",kVAM5u:"x7z60cl",kzOINU:null,kGJrpR:null,kaZRDh:null,kBCPoo:null,k26BEO:null,k5QoK5:null,kLZC3w:null,kL6WhQ:null,$$css:!0}};function sy({collectionId:e,collectionName:t,assets:s,children:n}){let a=sp(e),i=sh(a);return n({asset:sg(a,s),cmsCollectionMappings:{blockType:"list",collectionId:e,collectionName:t,fieldSchemaMappings:i}})}function sk({collectionId:e,collectionName:t,assets:s,children:n}){let a=sp(e),i=function(e){let{data:t}=(0,su.Vp)(e);if(!t||0===t.length)return null;let[s]=t;return s.id}(e),r=sh(a);return n({asset:sg(a,s,{isPageBlock:!0}),cmsCollectionMappings:{blockType:"page",collectionId:e,itemId:i,collectionName:t,fieldSchemaMappings:r}})}var sv=s(585066);function sb(){return(0,n.jsx)("div",{...eq.Ay.props(sr.A.p16),children:(0,n.jsx)(sv.k,{})})}var sj=s(359547),sC=s(371591);let sw=(0,a.createContext)(void 0);function sE(){let e=(0,a.useContext)(sw);if(void 0===e)throw Error("useFlyoutContext must be used within a FlyoutProvider");return e}function sN({page:e,libraryKey:t,onDragStart:s,children:i}){let r=(0,a.useMemo)(()=>(0,eT.rJ)(e.assets),[e.assets]),l=function(){let{windowInnerWidth:e}=(0,sC.l)();return(0,a.useMemo)(()=>Math.min(Math.max(Math.floor(15*e/64),144),220),[e])}(),o=(0,a.useMemo)(()=>l-8,[l]),c=(0,a.useMemo)(()=>l-2*eX.$A-8,[l]),d=(0,a.useMemo)(()=>({page:e,libraryKey:t,assets:r,panelWidth:l,embedThumbWidth:o,thumbWidth:c,onDragStart:s}),[e,t,r,l,o,c,s]);return(0,n.jsx)(sw.Provider,{value:d,children:i})}let sS=a.forwardRef(({hide:e,libraryKey:t,onMouseEnter:s,onMouseLeave:i,onDragStart:r},l)=>{let{getLibrary:o}=(0,eE.G)(),c=(0,st.B)(),{isLeftPanelCollapsed:d}=(0,a.useContext)(sj.t),u=(0,p.b)();if(d)return null;let x=o(t);if(!x)return null;let m=(0,T.Cg)(x);return m&&m.type===et.yW.SITE?tN.createPortal((0,n.jsx)("div",{ref:l,...eq.Ay.props(sP.flyout,sP.flyoutPosition(u,c),e&&sP.hidden),onMouseEnter:s,onMouseLeave:i,"data-fullscreen-prevent-event-capture":!0,"data-testid":"asset-panel-library-flyout","aria-hidden":e,children:(0,n.jsx)(sN,{libraryKey:t,page:m,onDragStart:r,children:(0,n.jsx)(sI,{})})}),document.body):null}),sT="Site kit";function sI(){let{page:e,libraryKey:t,assets:s,embedThumbWidth:a,thumbWidth:i,onDragStart:r}=sE();return(0,eQ.VF)()(t)?(0,n.jsx)(sA,{}):(0,et.AZ)(e)?(0,n.jsx)(sM,{children:(0,n.jsx)(sz,{styleXStyle:sP.gap16,children:e.embeds.map((e,t)=>(0,n.jsx)(eZ.Ay.Provider,{value:eZ.W7.Embed,children:(0,n.jsx)(e7.pd,{embed:e,sectionPosition:t,keyboardPosition:{path:[et.ON.CONTENTS,et.lM.ASSETS,t],column:null},thumbHeight:Math.floor(a/2),thumbWidth:a,isFirstTile:0===t,onDragStart:r},e.name)},e.name))})}):(0,n.jsx)(sM,{children:(0,n.jsx)(sz,{styleXStyle:sP.gap16,children:s.map((e,t)=>(0,n.jsx)(eZ.Ay.Provider,{value:e.fullPage?eZ.W7.Webpage:eZ.W7.Block,children:(0,n.jsx)(e5,{asset:e,sectionPosition:t,thumbWidth:i,isFirstTile:0===t,sectionNameForTracking:sT,keyboardPosition:(0,ej.pg)([et.tM.COMPONENTS],t,1),hideName:!0,onDragStart:r},e.name)},e.name))})})}function sA(){let e=(0,f.tS)(),{data:t,status:s}=(0,sn.c$)(e),{libraryKey:i,assets:r,thumbWidth:l,onDragStart:o}=sE(),c=(0,a.useMemo)(()=>r.filter(e=>e.type===eR.PW.RESPONSIVE_SET),[r]),d=(0,a.useCallback)(({asset:e,cmsCollectionMappings:t,index:s})=>e?(0,n.jsx)(e5,{asset:e,cmsCollectionMappings:t,hideName:!0,keyboardPosition:(0,ej.pg)([et.tM.COMPONENTS],s,1),onDragStart:o,sectionNameForTracking:sT,sectionPosition:s,thumbWidth:l},e.name):null,[o,l]);return"loading"===s||null==t?(0,n.jsx)(sz,{styleXStyle:sP.justifyCenter,children:(0,n.jsx)(sb,{})}):0===t.length?(0,n.jsx)(sz,{styleXStyle:sP.justifyCenter,children:(0,n.jsx)(so,{})}):(0,n.jsx)(sM,{children:(0,n.jsx)(sz,{styleXStyle:sP.my4,children:(0,n.jsx)(eZ.Ay.Provider,{value:eZ.W7.Block,children:(0,n.jsx)(sf,{collections:t,assets:c,renderFlyoutListItem:d,renderFlyoutPageItem:d})},i)})})}function sM({children:e}){let{libraryKey:t,page:s}=sE(),{assetsScrollTop:a,handleScrollAssets:i}=eL({libraryKey:t,pageId:s.id});return(0,n.jsx)(ss.P,{hideScrollbar:!0,onScroll:i,initialScrollTop:a,children:e})}function sz({styleXStyle:e,children:t}){let{thumbWidth:s}=sE();return(0,n.jsx)("div",{...eq.Ay.props(e,sP.flyoutWrapper,sP.flyoutWrapperWidth(s)),children:t})}let sL={kbCHJM:"xgq9j65",kLqNvP:"",kt4wiu:"",$$css:!0},sO={kzqmXN:"x5lhr3w",$$css:!0},sP={flyout:{kVAEAm:"x10l6tqk",kjj79g:"xl56j7k",k87sOh:"x13vifvy",krVfgx:"x1ey2m1c",k1xSpc:"x78zum5",kWkggS:"x1yjdb4r",kWqL5O:"xs1s249",k2ei4v:null,ke9TFa:null,kSWEuD:"x32b0ac",kVhnKS:null,k8ry5P:null,k26BEO:"x1lpqudl",kGJrpR:null,kBCPoo:null,kMv6JI:"x1v78wtz",kmVPX3:"x9dr4nv",kg3NbH:null,kuDDbn:null,kE3dHu:null,kP0aTx:null,kpe85a:null,k8WAf4:null,kLKAdn:null,kGO01o:null,kY2c9j:"xybi4ul",$$css:!0},flyoutPosition:(e,t)=>[sL,{"--x-left":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(`calc(var(--left-panel-width) + ${e?t+1:0}px)`)}],hidden:{k1xSpc:"x1s85apg",$$css:!0},flyoutWrapper:{k1xSpc:"x78zum5",kXwgrk:"xdt5ytf",kGNEyG:"x6s0dn4",$$css:!0},my4:{keoZOQ:"x15r87gk",k1K539:"x1ah0xmj",$$css:!0},gap16:{kOIVth:"x1r05qx8",khm7nJ:null,k1C7PZ:null,$$css:!0},justifyCenter:{kjj79g:"xl56j7k",$$css:!0},flyoutWrapperWidth:e=>[sO,{"--x-width":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(e+2*eX.$A+8)}]};var sR=s(794887);let sD=(0,eI.eU)(null);var sF=s(393463),sq=s(811804);let sG={width:"unset"},sU=[{name:"pages",url:(0,sF.ck)("99bf5f7ad969ea1167c7b09340ffc4486185e71a"),background:{light:"--ramp-blue-300",dark:"--ramp-pale-blue-600"},style:{...sG,filter:"drop-shadow(0px 2px 8px rgba(0, 49, 124, 0.10))"}},{name:"navigation",url:(0,sF.ck)("a84d6d275dd4af825b41cf6a782d8950a38ccf28"),background:{light:"--ramp-persimmon-300",dark:"--ramp-pale-persimmon-600"},style:{...sG,filter:"drop-shadow(0px 2px 6px rgba(185, 42, 0, 0.10))"}},{name:"heroes",url:(0,sF.ck)("2314584dee6e81eb3a90596302b184d88f6b00f3"),background:{light:"--ramp-pink-300",dark:"--ramp-pale-pink-600"},style:{...sG,filter:"drop-shadow(0px 2px 6px rgba(165, 0, 117, 0.10))"}},{name:"features",url:(0,sF.ck)("c9c8ec535fe73557c9729a00cebbffbdf6e3bd00"),background:{light:"--ramp-yellow-400",dark:"--ramp-pale-yellow-600"},style:{...sG,filter:"drop-shadow(0px 2px 6px rgba(197, 92, 0, 0.10))"}},{name:"cms",url:(0,sF.ck)("f0a8fe62447d4ae8ab8b02a3184bd1efcae2eed4"),background:{light:"--ramp-teal-400",dark:"--ramp-pale-teal-600"},style:{...sG,filter:"drop-shadow(0px 2px 6px rgba(0, 135, 168, 0.10))"}},{name:"embeds",url:(0,sF.ck)("b6ff5202c5344702953b4d618f6d06a362b63e1b"),background:{light:"--ramp-violet-400",dark:"--ramp-pale-violet-600"},style:{...sG,filter:"drop-shadow(0px 2px 8px rgba(51, 19, 179, 0.10))"}}],sK=(0,ei.jz)(e_.Sx),sH=(0,ei.jz)(e_.T5);function sB(e){return(0,n.jsx)(x.u9,{label:"AssetPanelLibrary",children:(0,n.jsx)(sV,{...e})})}function sV({library:e,previewHeight:t,cardWidth:s,keyboardSection:r,rowIndex:l,columnIndex:c=0,hideUnsubscribe:d,flyoutHandlers:u,isFolderView:x,folderVariant:m="preview"}){let{focusFirstItem:p,focusSearchBar:h}=(0,ej.rl)(),{navigateToLibrary:g}=(0,T.wV)(),_=(0,f.q5)(),y=(0,eI.md)(sD),k=(0,t9.H)(e.libraryKey),[b]=(0,eC.MA)(),j=((0,v.GM)()()?eC.$H.LIST:b)===eC.$H.LIST,C=(0,eb.sN)(),w=a.useCallback(()=>{C("libraryCard",g(e.libraryKey))},[e.libraryKey,C,g]),{currentView:E}=(0,T.wV)(),N=E!==T.S5.Libraries,{setKeyboardNavigationElement:S}=(0,eo.M3)({path:[et.ON.CONTENTS,et.lM.LIBRARIES,r,l],column:c,id:e.libraryKey,disabled:N}),I=(0,ej.MB)({onBoth:w,onKeyDown:p,onClick:h}),A=a.useCallback(t=>{u?u.onClick(e.libraryKey):I(t)},[u,I,e.libraryKey]),M=a.useCallback(t=>u?.onMouseEnter?.(t,e.libraryKey),[u,e.libraryKey]),z=a.useCallback(t=>u?.onMouseLeave(t,e.libraryKey),[u,e.libraryKey]),L=a.useCallback(t=>u?.onMouseMove(t,e.libraryKey),[u,e.libraryKey]),O=a.useMemo(()=>{let t=e.libraryKey===_?.libraryKey?"localLibrary":e.libraryKey;return tI.Pt("assetsLibrary",t)},[e.libraryKey,_?.libraryKey]),P=function(e,t=!1){let s=(0,f.q5)(),n=(0,F.wA)(),i=e.libraryKey===s?.libraryKey,r=(0,eY._9)(e.libraryKey,"assets_panel_library_context_menu"),l=a.useCallback(()=>r(!1),[r]),c=function(){let e=(0,F.wA)(),t=(0,f.q5)(),s=(0,F.d4)(e=>e.teams),n=(0,F.d4)(tP.fA),i=a.useCallback(()=>{e(B.to({type:tR.dD,data:{entrypoint:tD.RR.ASSET_PANEL_LIBRARY_CONTEXT_MENU}}))},[e]),r=t?.teamId&&s[t.teamId],l=a.useCallback(()=>{e(B.to({type:tF.$3,data:{afterFileMove:i,team:r||null}}))},[e,i,r]);return a.useCallback(()=>{n?i():l()},[n,i,l])}(),d=(0,tO.X)(e.libraryKey),u=(0,tL.b)({libraryKey:e.libraryKey}),x=u.data?.link,m=a.useCallback(()=>{o.az.trackDefinedEvent("assets_panel.go_to_library",{libraryKey:e.libraryKey,fileKey:s?.key,fileTeamId:s?.teamId??void 0,fileOrgId:s?.parentOrgId??void 0,entryPoint:"library_context_menu"})},[e.libraryKey,s]),p=a.useCallback(()=>{o.az.trackDefinedEvent("assets_panel.send_feedback_to_creator",{libraryKey:e.libraryKey,fileKey:s?.key,fileTeamId:s?.teamId??void 0,fileOrgId:s?.parentOrgId??void 0,entryPoint:"library_context_menu",partnerType:d})},[e.libraryKey,s,d]),h=a.useCallback(()=>{o.az.trackDefinedEvent("assets_panel.open_library_context_menu",{libraryKey:e.libraryKey,fileKey:s?.key,fileTeamId:s?.teamId??void 0,fileOrgId:s?.parentOrgId??void 0})},[e.libraryKey,s]);return a.useCallback(s=>{e.type!==et.yW.SITE&&(s.preventDefault(),s.stopPropagation(),n((0,tz.j7)({type:tq,data:{libraryHref:x,isLocalLibrary:i,partnerType:d,hideUnsubscribe:t,onGoToLibrary:m,onPublish:c,onUnsubscribe:l,onSendFeedback:p,position:{top:s.clientY,left:s.clientX}}})),h())},[e.type,n,x,i,d,t,m,c,l,p,h])}(e,d),R=!!(0,eQ.dj)(e.libraryKey),D=function(e,t){let s="dark"===(0,sq.DP)()?"dark":"light";return a.useMemo(()=>{if(!t)return;let n=sU.find(t=>t.name===e.toLowerCase()||e===(0,i.t)("design_systems.assets_panel.site_embeds")&&"embeds"===t.name);if(n)return{url:n.url,backgroundToken:`var(${n.background[s]})`,style:n.style}},[t,e,s])}(e.name,R||e.libraryKey===sR.Yl);return x?(0,n.jsx)(ev,{ref:S,customThumbnailData:D,keyPrefix:e.libraryKey,name:e.name,onClick:A,onContextMenu:P,onMouseEnter:M,onMouseLeave:z,onMouseMove:L,previewAssetOrUrl:D?.url??(e.thumbnailUrl||void 0),recordingKey:O||"assetsLibraryFolder",selected:y?.persisted&&y?.key===e.libraryKey,variant:m}):(0,n.jsxs)(t6.bL,{className:"asset_panel_library--library--LoLt9",style:{width:j?"100%":s},"data-testid":"asset-panel-library",children:[(0,n.jsx)(t6.O6,{ref:S,onClick:A,onContextMenu:P,onMouseEnter:M,onMouseLeave:z,onMouseMove:L,recordingKey:O,tabIndex:N?-1:0,className:"asset_panel_library--libraryMainButton--qajKk"}),(0,n.jsx)(s$,{library:e,previewHeight:t,isList:j,showAuthor:k})]})}function s$({library:e,previewHeight:t,isList:s,showAuthor:i}){let{thumbnailUrl:r}=e,[l,o]=a.useState(r),c=a.useMemo(()=>{if(l)return`url(${l})`},[l]),d=a.useCallback(()=>{o(r)},[r]),u=a.useMemo(()=>s?{height:sK,width:sH}:{height:t},[s,t]);return(0,n.jsxs)("div",{className:s?"asset_panel_library--libraryCardList--8Fsty asset_panel_library--libraryCard--BHtLy":"asset_panel_library--libraryCard--BHtLy",children:[(0,n.jsxs)("div",{className:"asset_panel_library--libraryPreviewSection--j4wwD",children:[(0,n.jsx)("div",{style:{backgroundImage:c,...u},className:e.thumbnailShouldCover?"asset_panel_library--libraryPreviewCover--NlWa8 asset_panel_library--libraryPreview--vY1-t":"asset_panel_library--libraryPreview--vY1-t"}),r&&(0,n.jsx)(t7.oW,{src:r,onLoad:d,className:"asset_panel_library--hiddenImage--1No3m",alt:""})]}),(0,n.jsx)(t6.hE,{children:(0,n.jsx)(sW,{library:e,isList:s,showAuthor:i})})]})}function sW({library:e,isList:t,showAuthor:s}){let r=(0,eI.md)(t9.Rs),l=e.type!==et.yW.SITE,o=a.useMemo(()=>e.type===et.yW.SITE?"":e.numComponents>0?(0,i.t)("design_systems.assets_panel.num_components",{numComponents:e.numComponents}):"",[e]),c=r?.[e.libraryKey]?.author_name||e.authorName;return(0,n.jsx)("div",{className:t?"asset_panel_library--libraryFooterList--Upe5- asset_panel_library--libraryFooter--mok2o":l?"asset_panel_library--libraryFooter--mok2o":"asset_panel_library--libraryFooterWithoutLibraryStats--vv-Tq asset_panel_library--libraryFooter--mok2o",children:(0,n.jsxs)("div",{className:"asset_panel_library--libraryNameAndStats--9AfhK",children:[(0,n.jsxs)("div",{className:"asset_panel_library--nameAndIconForList--kobw7",children:[(0,n.jsx)("h3",{className:"asset_panel_library--libraryName--xjkHa ellipsis--ellipsis--70pHK",children:e.name}),(0,n.jsx)("div",{className:"asset_panel_library--libraryIcon--2VM07",children:(0,n.jsx)(t6.HG,{children:(0,n.jsx)(t8.P,{libraryKey:e.libraryKey,compact:!0,showPresetTooltip:!0,colorPrimaryOnHover:!0,tooltipDelay:500,tooltipLocation:"below"})})})]}),l&&(0,n.jsx)("div",{className:"asset_panel_library--libraryStats--kYDXZ ellipsis--ellipsis--70pHK",children:s?(0,i.tx)("community.by_publisher",{publisher:c}):o})]})})}function sY(){return(0,n.jsxs)("svg",{width:"74px",height:"45px",viewBox:"0 0 76 46",fill:"none",children:[(0,n.jsx)("rect",{width:"66",height:"36.2738",rx:"3",transform:"matrix(0.998629 -0.052336 -0.052336 -0.998629 1.90015 39.6787)",fill:"url(#pattern0_4378_11285)"}),(0,n.jsx)("rect",{width:"66",height:"36.2738",rx:"3",transform:"matrix(0.998629 -0.052336 -0.052336 -0.998629 1.90015 39.6787)",fill:"url(#pattern1_4378_11285)"}),(0,n.jsx)("rect",{width:"66",height:"36.2738",rx:"3",transform:"matrix(0.998629 -0.052336 -0.052336 -0.998629 1.90015 39.6787)",fill:"#85C9E4"}),(0,n.jsxs)("g",{filter:"url(#filter0_dd_4378_11285)",children:[(0,n.jsx)("rect",{width:"66",height:"36",rx:"3",transform:"matrix(-1 0 0 1 73 6)",fill:"url(#pattern2_4378_11285)"}),(0,n.jsx)("rect",{width:"66",height:"36",rx:"3",transform:"matrix(-1 0 0 1 73 6)",fill:"url(#pattern3_4378_11285)"}),(0,n.jsx)("rect",{width:"66",height:"36",rx:"3",transform:"matrix(-1 0 0 1 73 6)",fill:"#E5F4FF"}),(0,n.jsx)("g",{clipPath:"url(#clip0_4378_11285)",children:(0,n.jsxs)("g",{filter:"url(#filter1_d_4378_11285)",children:[(0,n.jsx)("rect",{x:"40.7627",y:"24.7129",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"#E6E6E6",fillOpacity:"0.11"}),(0,n.jsx)("rect",{x:"40.8477",y:"24.7979",width:"13.3245",height:"13.3245",rx:"2.51011",stroke:"#CFE4F3",strokeWidth:"0.169989"}),(0,n.jsx)("path",{d:"M38.7913 22.7412L56.2288 40.1787M56.2288 22.7412L38.7913 40.1787M44.6973 22.46V40.46M47.5097 22.46V40.46M50.3225 22.46V40.46M56.51 28.6475L38.51 28.6475M56.51 31.4599L38.51 31.4599M56.51 34.2726L38.51 34.2726M53.135 31.46C53.135 34.5666 50.6166 37.085 47.51 37.085C44.4034 37.085 41.885 34.5666 41.885 31.46C41.885 28.3534 44.4034 25.835 47.51 25.835C50.6166 25.835 53.135 28.3534 53.135 31.46ZM50.3225 31.46C50.3225 33.0133 49.0633 34.2725 47.51 34.2725C45.9567 34.2725 44.6975 33.0133 44.6975 31.46C44.6975 29.9067 45.9567 28.6475 47.51 28.6475C49.0633 28.6475 50.3225 29.9067 50.3225 31.46Z",stroke:"white",strokeOpacity:"0.6",strokeWidth:"0.113372"}),(0,n.jsx)("path",{d:"M46.8393 29.3914H46.3369C46.0243 29.3914 45.8679 29.3914 45.7485 29.4522C45.6435 29.5057 45.5582 29.591 45.5047 29.6961C45.4438 29.8155 45.4438 29.9719 45.4438 30.2845V32.4054C45.4438 32.718 45.4438 32.8742 45.5047 32.9936C45.5582 33.0986 45.6435 33.1841 45.7485 33.2376C45.8678 33.2984 46.024 33.2984 46.336 33.2984H48.4587C48.7706 33.2984 48.9266 33.2984 49.0459 33.2376C49.1509 33.1841 49.2365 33.0985 49.2901 32.9935C49.3508 32.8742 49.3508 32.7182 49.3508 32.4062V31.903M49.6299 30.5077V29.1123M49.6299 29.1123H48.2345M49.6299 29.1123L47.6764 31.0658",stroke:"#007BE5",strokeWidth:"0.558837",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,n.jsx)("g",{clipPath:"url(#clip1_4378_11285)",children:(0,n.jsxs)("g",{filter:"url(#filter2_d_4378_11285)",children:[(0,n.jsx)("rect",{x:"55.6597",y:"24.7129",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"#E6E6E6",fillOpacity:"0.11"}),(0,n.jsx)("rect",{x:"55.7447",y:"24.7979",width:"13.3245",height:"13.3245",rx:"2.51011",stroke:"#CFE4F3",strokeWidth:"0.169989"}),(0,n.jsx)("path",{d:"M53.6882 22.7412L71.1257 40.1787M71.1257 22.7412L53.6882 40.1787M59.5943 22.46V40.46M62.4066 22.46V40.46M65.2194 22.46V40.46M71.407 28.6475L53.407 28.6475M71.407 31.4599L53.407 31.4599M71.407 34.2726L53.407 34.2726M68.032 31.46C68.032 34.5666 65.5136 37.085 62.407 37.085C59.3004 37.085 56.782 34.5666 56.782 31.46C56.782 28.3534 59.3004 25.835 62.407 25.835C65.5136 25.835 68.032 28.3534 68.032 31.46ZM65.2195 31.46C65.2195 33.0133 63.9603 34.2725 62.407 34.2725C60.8537 34.2725 59.5945 33.0133 59.5945 31.46C59.5945 29.9067 60.8537 28.6475 62.407 28.6475C63.9603 28.6475 65.2195 29.9067 65.2195 31.46Z",stroke:"white",strokeOpacity:"0.6",strokeWidth:"0.113372"}),(0,n.jsx)("path",{d:"M64.911 33.9649L63.704 32.758M63.704 32.758C64.1063 32.3557 64.3552 31.7999 64.3552 31.186C64.3552 29.9582 63.3599 28.9629 62.1321 28.9629C60.9043 28.9629 59.9089 29.9582 59.9089 31.186C59.9089 32.4138 60.9043 33.4091 62.1321 33.4091C62.746 33.4091 63.3017 33.1603 63.704 32.758Z",stroke:"#007BE5",strokeWidth:"0.555781",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,n.jsx)("g",{clipPath:"url(#clip2_4378_11285)",children:(0,n.jsxs)("g",{filter:"url(#filter3_d_4378_11285)",children:[(0,n.jsx)("rect",{x:"25.7114",y:"9.66113",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"#E6E6E6",fillOpacity:"0.11"}),(0,n.jsx)("rect",{x:"25.7964",y:"9.74613",width:"13.3245",height:"13.3245",rx:"2.51011",stroke:"#CFE4F3",strokeWidth:"0.169989"}),(0,n.jsx)("path",{d:"M23.7397 7.68945L41.1772 25.127M41.1772 7.68945L23.7397 25.127M29.6458 7.4082V25.4082M32.4582 7.4082V25.4082M35.2709 7.4082V25.4082M41.4585 13.5957L23.4585 13.5957M41.4585 16.4081L23.4585 16.4081M41.4585 19.2209L23.4585 19.2209M38.0835 16.4082C38.0835 19.5148 35.5651 22.0332 32.4585 22.0332C29.3519 22.0332 26.8335 19.5148 26.8335 16.4082C26.8335 13.3016 29.3519 10.7832 32.4585 10.7832C35.5651 10.7832 38.0835 13.3016 38.0835 16.4082ZM35.271 16.4082C35.271 17.9615 34.0118 19.2207 32.4585 19.2207C30.9052 19.2207 29.646 17.9615 29.646 16.4082C29.646 14.8549 30.9052 13.5957 32.4585 13.5957C34.0118 13.5957 35.271 14.8549 35.271 16.4082Z",stroke:"white",strokeOpacity:"0.6",strokeWidth:"0.113372"}),(0,n.jsx)("path",{d:"M31.0159 13.8096C30.3787 13.8096 29.8621 14.3262 29.8621 14.9634V17.5596V17.848C29.8621 18.4852 30.3787 19.0019 31.0159 19.0019H33.9005C34.5377 19.0019 35.0544 18.4852 35.0544 17.848V17.5596V14.9634C35.0544 14.3262 34.5377 13.8096 33.9005 13.8096H31.0159ZM31.0159 14.3865H33.9005C34.2193 14.3865 34.4774 14.6447 34.4774 14.9634L34.4786 16.7507C34.2542 16.5424 34.0254 16.4121 33.7742 16.4057C33.7652 16.4054 33.7655 16.4057 33.7563 16.4057C33.4283 16.4057 33.0637 16.6578 32.8188 16.9737C32.7562 16.8324 32.693 16.6927 32.6203 16.5589C32.2799 15.9303 31.9081 15.5412 31.4486 15.5403C31.058 15.5395 30.7228 15.8588 30.4367 16.2961L30.439 14.9634C30.439 14.6447 30.6972 14.3865 31.0159 14.3865ZM33.6121 14.9634C33.4528 14.9634 33.3236 15.0926 33.3236 15.2519C33.3236 15.4111 33.4528 15.5403 33.6121 15.5403C33.7713 15.5403 33.9005 15.4111 33.9005 15.2519C33.9005 15.0926 33.7713 14.9634 33.6121 14.9634ZM31.4486 16.1173C31.6165 16.1175 31.8715 16.3789 32.1155 16.8295C32.2124 17.0077 32.2993 17.2042 32.3772 17.3974C32.4239 17.5128 32.4599 17.6011 32.4761 17.6496C32.5548 17.8852 32.8745 17.9187 32.9991 17.7038C33.0115 17.6824 33.034 17.6415 33.0712 17.5867C33.1335 17.4944 33.2045 17.4009 33.2786 17.3161C33.4638 17.1038 33.6423 16.9826 33.7563 16.9826C33.8714 16.9855 34.0491 17.1064 34.234 17.3161C34.309 17.4012 34.3782 17.4944 34.4414 17.5867C34.4613 17.6155 34.4642 17.6291 34.4774 17.6496V17.848C34.4774 18.1668 34.2193 18.4249 33.9005 18.4249H31.0159C30.6972 18.4249 30.439 18.1668 30.439 17.848V17.6046C30.4572 17.5532 30.4814 17.4924 30.52 17.3974C30.5988 17.2042 30.6842 17.008 30.7817 16.8295C31.0277 16.378 31.281 16.117 31.4486 16.1173Z",fill:"#007BE5"})]})}),(0,n.jsx)("g",{clipPath:"url(#clip3_4378_11285)",children:(0,n.jsxs)("g",{filter:"url(#filter4_d_4378_11285)",children:[(0,n.jsx)("rect",{x:"40.7627",y:"9.66113",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"#E6E6E6",fillOpacity:"0.11"}),(0,n.jsx)("rect",{x:"40.8477",y:"9.74613",width:"13.3245",height:"13.3245",rx:"2.51011",stroke:"#CFE4F3",strokeWidth:"0.169989"}),(0,n.jsx)("path",{d:"M38.7915 7.68945L56.229 25.127M56.229 7.68945L38.7915 25.127M44.6975 7.4082V25.4082M47.5099 7.4082V25.4082M50.3227 7.4082V25.4082M56.5103 13.5957L38.5103 13.5957M56.5103 16.4081L38.5103 16.4081M56.5103 19.2209L38.5103 19.2209M53.1353 16.4082C53.1353 19.5148 50.6169 22.0332 47.5103 22.0332C44.4037 22.0332 41.8853 19.5148 41.8853 16.4082C41.8853 13.3016 44.4037 10.7832 47.5103 10.7832C50.6169 10.7832 53.1353 13.3016 53.1353 16.4082ZM50.3228 16.4082C50.3228 17.9615 49.0636 19.2207 47.5103 19.2207C45.957 19.2207 44.6978 17.9615 44.6978 16.4082C44.6978 14.8549 45.957 13.5957 47.5103 13.5957C49.0636 13.5957 50.3228 14.8549 50.3228 16.4082Z",stroke:"white",strokeOpacity:"0.6",strokeWidth:"0.113372"}),(0,n.jsx)("g",{clipPath:"url(#clip4_4378_11285)",children:(0,n.jsx)("path",{d:"M47.6765 15.2739C47.0718 13.8547 44.9556 14.0058 44.9556 15.8198C44.9556 17.6338 47.6765 19.1454 47.6765 19.1454C47.6765 19.1454 50.3974 17.6338 50.3974 15.8198C50.3974 14.0058 48.2811 13.8547 47.6765 15.2739Z",stroke:"#007BE5",strokeWidth:"0.605407",strokeLinecap:"round",strokeLinejoin:"round"})})]})}),(0,n.jsx)("g",{clipPath:"url(#clip5_4378_11285)",children:(0,n.jsxs)("g",{filter:"url(#filter5_d_4378_11285)",children:[(0,n.jsx)("rect",{x:"55.6597",y:"9.66113",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"#E6E6E6",fillOpacity:"0.11"}),(0,n.jsx)("rect",{x:"55.7447",y:"9.74613",width:"13.3245",height:"13.3245",rx:"2.51011",stroke:"#CFE4F3",strokeWidth:"0.169989"}),(0,n.jsx)("path",{d:"M53.6885 7.68945L71.126 25.127M71.126 7.68945L53.6885 25.127M59.5945 7.4082V25.4082M62.4069 7.4082V25.4082M65.2197 7.4082V25.4082M71.4072 13.5957L53.4072 13.5957M71.4072 16.4081L53.4072 16.4081M71.4072 19.2209L53.4072 19.2209M68.0322 16.4082C68.0322 19.5148 65.5138 22.0332 62.4072 22.0332C59.3006 22.0332 56.7822 19.5148 56.7822 16.4082C56.7822 13.3016 59.3006 10.7832 62.4072 10.7832C65.5138 10.7832 68.0322 13.3016 68.0322 16.4082ZM65.2197 16.4082C65.2197 17.9615 63.9605 19.2207 62.4072 19.2207C60.8539 19.2207 59.5947 17.9615 59.5947 16.4082C59.5947 14.8549 60.8539 13.5957 62.4072 13.5957C63.9605 13.5957 65.2197 14.8549 65.2197 16.4082Z",stroke:"white",strokeOpacity:"0.6",strokeWidth:"0.113372"}),(0,n.jsx)("path",{d:"M60.2761 16.3467V18.4809C60.2761 18.7755 60.515 19.0144 60.8097 19.0144H64.011C64.3056 19.0144 64.5445 18.7755 64.5445 18.4809V16.3467",stroke:"#007BE5",strokeWidth:"0.533549",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M60.8088 14.6122C60.8088 14.2439 61.1074 13.9453 61.4758 13.9453V13.9453C61.9914 13.9453 62.4095 14.3633 62.4095 14.879V15.2792H61.4758C61.1074 15.2792 60.8088 14.9806 60.8088 14.6122V14.6122Z",stroke:"#007BE5",strokeWidth:"0.533549",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M64.0107 14.6122C64.0107 14.2439 63.7121 13.9453 63.3438 13.9453V13.9453C62.8281 13.9453 62.4101 14.3633 62.4101 14.879V15.2792H63.3438C63.7121 15.2792 64.0107 14.9806 64.0107 14.6122V14.6122Z",stroke:"#007BE5",strokeWidth:"0.533549",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M60.009 15.2803H64.811V16.3474H60.009V15.2803Z",stroke:"#007BE5",strokeWidth:"0.533549",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M62.4099 16.3467V19.0144",stroke:"#007BE5",strokeWidth:"0.533549",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,n.jsx)("g",{clipPath:"url(#clip6_4378_11285)",children:(0,n.jsxs)("g",{filter:"url(#filter6_d_4378_11285)",children:[(0,n.jsx)("rect",{x:"25.7114",y:"24.7129",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"#E6E6E6",fillOpacity:"0.11"}),(0,n.jsx)("rect",{x:"25.7964",y:"24.7979",width:"13.3245",height:"13.3245",rx:"2.51011",stroke:"#CFE4F3",strokeWidth:"0.169989"}),(0,n.jsx)("path",{d:"M23.74 22.7412L41.1775 40.1787M41.1775 22.7412L23.74 40.1787M29.646 22.46V40.46M32.4584 22.46V40.46M35.2712 22.46V40.46M41.4587 28.6475L23.4587 28.6475M41.4587 31.4599L23.4587 31.4599M41.4587 34.2726L23.4587 34.2726M38.0837 31.46C38.0837 34.5666 35.5653 37.085 32.4587 37.085C29.3521 37.085 26.8337 34.5666 26.8337 31.46C26.8337 28.3534 29.3521 25.835 32.4587 25.835C35.5653 25.835 38.0837 28.3534 38.0837 31.46ZM35.2712 31.46C35.2712 33.0133 34.012 34.2725 32.4587 34.2725C30.9054 34.2725 29.6462 33.0133 29.6462 31.46C29.6462 29.9067 30.9054 28.6475 32.4587 28.6475C34.012 28.6475 35.2712 29.9067 35.2712 31.46Z",stroke:"white",strokeOpacity:"0.6",strokeWidth:"0.113372"}),(0,n.jsx)("path",{d:"M32.3423 28.5566C31.3514 28.5566 30.6687 29.2395 30.6687 30.2303C30.6687 30.3656 30.6687 30.7798 30.6687 30.7882C30.6687 30.878 30.6233 30.9391 30.4682 31.0671C30.4506 31.0816 30.3768 31.145 30.3549 31.1631C30.0019 31.4549 29.8282 31.7282 29.8318 32.1829C29.8356 32.6426 30.2103 33.0144 30.6687 33.0197H31.5546C31.5546 33.0197 31.5055 33.1902 31.5055 33.2987C31.5055 33.7609 31.8801 34.1355 32.3423 34.1355C32.8045 34.1355 33.1792 33.7609 33.1792 33.2987C33.1792 33.1902 33.1323 33.0197 33.1323 33.0197H34.016C34.4734 33.0214 34.8534 32.6446 34.8528 32.1829C34.8523 31.7316 34.6782 31.4535 34.3298 31.1631C34.3069 31.1438 34.226 31.0822 34.2076 31.0671C34.0559 30.9405 34.016 30.8769 34.016 30.7882C34.016 30.4395 34.016 30.2303 34.016 30.2303C34.016 29.2395 33.3331 28.5566 32.3423 28.5566ZM32.3423 29.1145C33.0252 29.1145 33.4581 29.5474 33.4581 30.2303C33.4581 30.2303 33.4581 30.4395 33.4581 30.7882C33.4581 31.0844 33.5831 31.2713 33.8503 31.4942C33.8715 31.5118 33.961 31.5821 33.9811 31.5988C34.2149 31.7938 34.2946 31.9257 34.2949 32.1829C34.2952 32.3346 34.1652 32.4624 34.016 32.4618C33.9633 32.4616 33.1513 32.4616 32.3423 32.4618C31.5335 32.4621 30.7279 32.4624 30.6687 32.4618C30.513 32.4599 30.391 32.3377 30.3897 32.1829C30.3877 31.9263 30.4674 31.7941 30.7035 31.5988C30.7228 31.5829 30.8053 31.5109 30.8256 31.4942C31.097 31.2699 31.2266 31.0872 31.2266 30.7882C31.2266 30.7798 31.2266 30.3656 31.2266 30.2303C31.2266 29.5474 31.6596 29.1145 32.3423 29.1145ZM32.3423 33.0197C32.4963 33.0197 32.6213 33.1447 32.6213 33.2987C32.6213 33.4527 32.4963 33.5776 32.3423 33.5776C32.1884 33.5776 32.0634 33.4527 32.0634 33.2987C32.0634 33.1447 32.1884 33.0197 32.3423 33.0197Z",fill:"#007BE5"})]})}),(0,n.jsx)("g",{clipPath:"url(#clip7_4378_11285)",children:(0,n.jsxs)("g",{filter:"url(#filter7_d_4378_11285)",children:[(0,n.jsx)("rect",{x:"10.6597",y:"9.66113",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"#E6E6E6",fillOpacity:"0.11"}),(0,n.jsx)("rect",{x:"10.7447",y:"9.74613",width:"13.3245",height:"13.3245",rx:"2.51011",stroke:"#CFE4F3",strokeWidth:"0.169989"}),(0,n.jsx)("path",{d:"M8.68848 7.68945L26.126 25.127M26.126 7.68945L8.68848 25.127M14.5945 7.4082V25.4082M17.4069 7.4082V25.4082M20.2197 7.4082V25.4082M26.4072 13.5957L8.40723 13.5957M26.4072 16.4081L8.40723 16.4081M26.4072 19.2209L8.40723 19.2209M23.0322 16.4082C23.0322 19.5148 20.5138 22.0332 17.4072 22.0332C14.3006 22.0332 11.7822 19.5148 11.7822 16.4082C11.7822 13.3016 14.3006 10.7832 17.4072 10.7832C20.5138 10.7832 23.0322 13.3016 23.0322 16.4082ZM20.2197 16.4082C20.2197 17.9615 18.9605 19.2207 17.4072 19.2207C15.8539 19.2207 14.5947 17.9615 14.5947 16.4082C14.5947 14.8549 15.8539 13.5957 17.4072 13.5957C18.9605 13.5957 20.2197 14.8549 20.2197 16.4082Z",stroke:"white",strokeOpacity:"0.6",strokeWidth:"0.113372"}),(0,n.jsx)("path",{d:"M18.1308 16.0168L17.0145 17.1331L16.4564 16.5749M15.061 17.6354V16.143C15.061 15.9939 15.061 15.9193 15.0792 15.8499C15.0952 15.7884 15.1218 15.7302 15.1575 15.6776C15.1978 15.6183 15.2538 15.5691 15.366 15.4709L16.706 14.2984C16.914 14.1164 17.018 14.0253 17.1352 13.9907C17.2385 13.9601 17.3486 13.9601 17.4519 13.9907C17.5692 14.0254 17.6734 14.1165 17.8817 14.2988L19.2212 15.4709C19.3335 15.5691 19.3895 15.6183 19.4298 15.6776C19.4654 15.7302 19.4918 15.7884 19.5079 15.8499C19.526 15.9193 19.5262 15.9939 19.5262 16.143V17.6364C19.5262 17.9484 19.5262 18.1045 19.4654 18.2238C19.4119 18.3288 19.3263 18.4141 19.2212 18.4677C19.102 18.5284 18.946 18.5284 18.634 18.5284H15.9532C15.6412 18.5284 15.485 18.5284 15.3657 18.4677C15.2607 18.4141 15.1754 18.3288 15.1219 18.2238C15.061 18.1044 15.061 17.948 15.061 17.6354Z",stroke:"#007BE5",strokeWidth:"0.558837",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,n.jsx)("g",{clipPath:"url(#clip8_4378_11285)",children:(0,n.jsxs)("g",{filter:"url(#filter8_d_4378_11285)",children:[(0,n.jsx)("rect",{x:"10.6597",y:"24.7129",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"#E6E6E6",fillOpacity:"0.11"}),(0,n.jsx)("rect",{x:"10.7447",y:"24.7979",width:"13.3245",height:"13.3245",rx:"2.51011",stroke:"#CFE4F3",strokeWidth:"0.169989"}),(0,n.jsx)("path",{d:"M8.68823 22.7412L26.1257 40.1787M26.1257 22.7412L8.68823 40.1787M14.5943 22.46V40.46M17.4066 22.46V40.46M20.2194 22.46V40.46M26.407 28.6475L8.40698 28.6475M26.407 31.4599L8.40698 31.4599M26.407 34.2726L8.40698 34.2726M23.032 31.46C23.032 34.5666 20.5136 37.085 17.407 37.085C14.3004 37.085 11.782 34.5666 11.782 31.46C11.782 28.3534 14.3004 25.835 17.407 25.835C20.5136 25.835 23.032 28.3534 23.032 31.46ZM20.2195 31.46C20.2195 33.0133 18.9603 34.2725 17.407 34.2725C15.8537 34.2725 14.5945 33.0133 14.5945 31.46C14.5945 29.9067 15.8537 28.6475 17.407 28.6475C18.9603 28.6475 20.2195 29.9067 20.2195 31.46Z",stroke:"white",strokeOpacity:"0.6",strokeWidth:"0.113372"}),(0,n.jsx)("path",{d:"M17.2926 28.5586C15.752 28.5586 14.5032 29.8074 14.5032 31.348C14.5032 32.8886 15.752 34.1374 17.2926 34.1374C18.8332 34.1374 20.082 32.8886 20.082 31.348C20.082 29.8074 18.8332 28.5586 17.2926 28.5586ZM17.2926 29.1165C17.6608 29.1165 18.0653 29.9622 18.1269 31.0682L16.4616 31.0716C16.523 29.9656 16.9244 29.1165 17.2926 29.1165ZM16.3076 29.3405C16.0678 29.8071 15.9394 30.4258 15.9085 31.0696L15.0772 31.0671C15.1604 30.307 15.6722 29.6693 16.3076 29.3405ZM18.2789 29.3419C18.9144 29.6707 19.4131 30.2905 19.5093 31.0716L18.6784 31.0691C18.6522 30.3996 18.504 29.811 18.2789 29.3419ZM15.0789 31.6281L15.9099 31.6211C15.9408 32.2649 16.07 32.8942 16.3088 33.3558C15.6415 33.0214 15.1749 32.3667 15.0789 31.6281ZM16.4572 31.6303L18.1224 31.6267C18.0611 32.7324 17.6608 33.5795 17.2926 33.5795C16.9244 33.5795 16.5185 32.7363 16.4572 31.6303ZM18.6798 31.6275L19.5071 31.625C19.4112 32.3639 18.9448 33.0239 18.2778 33.3528C18.5255 32.8406 18.6488 32.2713 18.6798 31.6275Z",fill:"#007BE5"})]})})]}),(0,n.jsxs)("defs",{children:[(0,n.jsx)("pattern",{id:"pattern0_4378_11285",patternContentUnits:"objectBoundingBox",width:"1",height:"1",children:(0,n.jsx)("use",{xlinkHref:"#image0_4378_11285",transform:"matrix(0.00083331 0 0 0.00145829 0 -0.000923572)"})}),(0,n.jsx)("pattern",{id:"pattern1_4378_11285",patternContentUnits:"objectBoundingBox",width:"1",height:"1",children:(0,n.jsx)("use",{xlinkHref:"#image1_4378_11285",transform:"matrix(0.000916004 0 0 0.00166667 -0.0496025 0)"})}),(0,n.jsxs)("filter",{id:"filter0_dd_4378_11285",x:"4",y:"4",width:"72",height:"42",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"1"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"1.5"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"0.25"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"effect1_dropShadow_4378_11285",result:"effect2_dropShadow_4378_11285"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect2_dropShadow_4378_11285",result:"shape"})]}),(0,n.jsx)("pattern",{id:"pattern2_4378_11285",patternContentUnits:"objectBoundingBox",width:"1",height:"1",children:(0,n.jsx)("use",{xlinkHref:"#image0_4378_11285",transform:"matrix(0.00083331 0 0 0.00145829 0 -0.000923572)"})}),(0,n.jsx)("pattern",{id:"pattern3_4378_11285",patternContentUnits:"objectBoundingBox",width:"1",height:"1",children:(0,n.jsx)("use",{xlinkHref:"#image1_4378_11285",transform:"matrix(0.000909091 0 0 0.00166667 -0.0454545 0)"})}),(0,n.jsxs)("filter",{id:"filter1_d_4378_11285",x:"4.51214",y:"-11.5379",width:"85.9957",height:"85.9957",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feMorphology",{radius:"6.79957",operator:"dilate",in:"SourceAlpha",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feOffset",{}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"13.5991"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.488656 0 0 0 0 0.788409 0 0 0 0 1 0 0 0 1 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4378_11285",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter2_d_4378_11285",x:"19.4091",y:"-11.5379",width:"85.9957",height:"85.9957",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feMorphology",{radius:"6.79957",operator:"dilate",in:"SourceAlpha",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feOffset",{}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"13.5991"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.488656 0 0 0 0 0.788409 0 0 0 0 1 0 0 0 1 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4378_11285",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter3_d_4378_11285",x:"-10.5394",y:"-26.5897",width:"85.9957",height:"85.9957",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feMorphology",{radius:"6.79957",operator:"dilate",in:"SourceAlpha",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feOffset",{}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"13.5991"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.488656 0 0 0 0 0.788409 0 0 0 0 1 0 0 0 1 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4378_11285",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter4_d_4378_11285",x:"4.51239",y:"-26.5897",width:"85.9957",height:"85.9957",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feMorphology",{radius:"6.79957",operator:"dilate",in:"SourceAlpha",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feOffset",{}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"13.5991"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.488656 0 0 0 0 0.788409 0 0 0 0 1 0 0 0 1 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4378_11285",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter5_d_4378_11285",x:"19.4094",y:"-26.5897",width:"85.9957",height:"85.9957",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feMorphology",{radius:"6.79957",operator:"dilate",in:"SourceAlpha",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feOffset",{}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"13.5991"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.488656 0 0 0 0 0.788409 0 0 0 0 1 0 0 0 1 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4378_11285",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter6_d_4378_11285",x:"-10.5391",y:"-11.5379",width:"85.9957",height:"85.9957",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feMorphology",{radius:"6.79957",operator:"dilate",in:"SourceAlpha",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feOffset",{}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"13.5991"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.488656 0 0 0 0 0.788409 0 0 0 0 1 0 0 0 1 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4378_11285",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter7_d_4378_11285",x:"-25.5906",y:"-26.5897",width:"85.9957",height:"85.9957",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feMorphology",{radius:"6.79957",operator:"dilate",in:"SourceAlpha",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feOffset",{}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"13.5991"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.488656 0 0 0 0 0.788409 0 0 0 0 1 0 0 0 1 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4378_11285",result:"shape"})]}),(0,n.jsxs)("filter",{id:"filter8_d_4378_11285",x:"-25.5909",y:"-11.5379",width:"85.9957",height:"85.9957",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feMorphology",{radius:"6.79957",operator:"dilate",in:"SourceAlpha",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feOffset",{}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"13.5991"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.488656 0 0 0 0 0.788409 0 0 0 0 1 0 0 0 1 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4378_11285"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4378_11285",result:"shape"})]}),(0,n.jsx)("clipPath",{id:"clip0_4378_11285",children:(0,n.jsx)("rect",{x:"40.7627",y:"24.7129",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"white"})}),(0,n.jsx)("clipPath",{id:"clip1_4378_11285",children:(0,n.jsx)("rect",{x:"55.6597",y:"24.7129",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"white"})}),(0,n.jsx)("clipPath",{id:"clip2_4378_11285",children:(0,n.jsx)("rect",{x:"25.7114",y:"9.66113",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"white"})}),(0,n.jsx)("clipPath",{id:"clip3_4378_11285",children:(0,n.jsx)("rect",{x:"40.7627",y:"9.66113",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"white"})}),(0,n.jsx)("clipPath",{id:"clip4_4378_11285",children:(0,n.jsx)("rect",{width:"7.25582",height:"7.25582",fill:"white",transform:"translate(44.0486 12.9473)"})}),(0,n.jsx)("clipPath",{id:"clip5_4378_11285",children:(0,n.jsx)("rect",{x:"55.6597",y:"9.66113",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"white"})}),(0,n.jsx)("clipPath",{id:"clip6_4378_11285",children:(0,n.jsx)("rect",{x:"25.7114",y:"24.7129",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"white"})}),(0,n.jsx)("clipPath",{id:"clip7_4378_11285",children:(0,n.jsx)("rect",{x:"10.6597",y:"9.66113",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"white"})}),(0,n.jsx)("clipPath",{id:"clip8_4378_11285",children:(0,n.jsx)("rect",{x:"10.6597",y:"24.7129",width:"13.4945",height:"13.4945",rx:"2.5951",fill:"white"})})]})]})}function sX(){return(0,n.jsxs)("svg",{width:"74px",height:"45px",viewBox:"0 0 76 46",fill:"none",children:[(0,n.jsx)("rect",{width:"66",height:"36.2738",rx:"3",transform:"matrix(0.998629 -0.052336 -0.052336 -0.998629 1.89844 39.6787)",fill:"url(#pattern0_4378_11342)"}),(0,n.jsx)("rect",{width:"66",height:"36.2738",rx:"3",transform:"matrix(0.998629 -0.052336 -0.052336 -0.998629 1.89844 39.6787)",fill:"url(#pattern1_4378_11342)"}),(0,n.jsx)("rect",{width:"66",height:"36.2738",rx:"3",transform:"matrix(0.998629 -0.052336 -0.052336 -0.998629 1.89844 39.6787)",fill:"#F8D4C4"}),(0,n.jsx)("g",{filter:"url(#filter0_dd_4378_11342)",children:(0,n.jsxs)("g",{clipPath:"url(#clip0_4378_11342)",children:[(0,n.jsx)("rect",{width:"66",height:"36",rx:"3",transform:"matrix(-1 0 0 1 72.9983 6)",fill:"url(#pattern2_4378_11342)"}),(0,n.jsx)("rect",{width:"66",height:"36",rx:"3",transform:"matrix(-1 0 0 1 72.9983 6)",fill:"url(#pattern3_4378_11342)"}),(0,n.jsx)("rect",{width:"66",height:"36",rx:"3",transform:"matrix(-1 0 0 1 72.9983 6)",fill:"#FFFBEB"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M23.9114 27.9895C23.8542 28.1061 23.6358 28.1415 23.4926 28.1662C22.3258 28.3713 17.2683 28.4774 16.7815 28.0637C16.3556 27.7102 16.5918 21.933 17.007 21.6996C17.5439 21.385 23.3996 21.3249 23.8076 21.6466C24.1047 21.8906 24.2908 27.1727 23.9114 27.9895ZM23.7181 21.7208C23.3924 21.4521 17.6728 21.6537 17.1573 21.9012C16.8817 22.6295 16.7028 27.2046 16.9712 27.8551C17.4079 28.1521 22.7589 28.1415 23.6931 27.8551C24.0582 26.9889 23.9222 21.8906 23.7181 21.7208ZM38.1462 21.1021C38.2881 21.342 38.4798 21.5495 38.7086 21.7109C38.9375 21.8724 39.1984 21.9842 39.4741 22.0391C39.4825 22.0369 39.4914 22.0367 39.4999 22.0385C39.5085 22.0402 39.5165 22.0439 39.5234 22.0492C39.5303 22.0545 39.5359 22.0612 39.5397 22.069C39.5436 22.0767 39.5456 22.0852 39.5456 22.0939C39.5456 22.1025 39.5436 22.111 39.5397 22.1187C39.5359 22.1265 39.5303 22.1333 39.5234 22.1385C39.5165 22.1438 39.5085 22.1475 39.4999 22.1492C39.4914 22.151 39.4825 22.1508 39.4741 22.1487C38.8441 22.3113 38.0245 21.7456 38.0245 21.1233C38.0216 21.1074 38.0253 21.091 38.0347 21.0777C38.0441 21.0645 38.0585 21.0554 38.0746 21.0526C38.0907 21.0498 38.1073 21.0534 38.1208 21.0627C38.1342 21.072 38.1433 21.0862 38.1462 21.1021ZM41.0704 17.9378V18.2913C41.0704 18.3382 41.0516 18.3832 41.018 18.4163C40.9845 18.4495 40.9389 18.4681 40.8915 18.4681C40.8443 18.4672 40.7993 18.4483 40.7659 18.4153C40.7326 18.3824 40.7134 18.3379 40.7125 18.2913V17.9378C40.7125 17.8909 40.7314 17.8459 40.7649 17.8128C40.7985 17.7796 40.844 17.761 40.8915 17.761C40.9389 17.761 40.9845 17.7796 41.018 17.8128C41.0516 17.8459 41.0704 17.8909 41.0704 17.9378ZM37.5019 18.2736C37.5019 18.3205 37.4831 18.3655 37.4495 18.3986C37.4159 18.4318 37.3704 18.4504 37.3229 18.4504C37.2755 18.4504 37.23 18.4318 37.1964 18.3986C37.1628 18.3655 37.144 18.3205 37.144 18.2736V17.8352C37.144 17.7883 37.1628 17.7434 37.1964 17.7102C37.23 17.6771 37.2755 17.6584 37.3229 17.6584C37.3704 17.6584 37.4159 17.6771 37.4495 17.7102C37.4831 17.7434 37.5019 17.7883 37.5019 17.8352C37.5162 17.9873 37.5019 18.164 37.5019 18.2736Z",fill:"black"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.7486 43.8508C16.7721 43.8114 16.8054 43.7785 16.8453 43.7553C17.1531 43.6068 18.8282 43.6811 19.1754 43.6952C19.1145 34.4214 24.0611 28.6371 31.2411 26.9789C32.5583 26.6749 32.5619 26.6536 32.5976 26.6749L32.841 26.0137C32.1538 25.9925 31.5919 25.4692 30.9619 25.5753C30.4859 25.6531 30.2461 26.0703 29.7772 26.2471C28.9826 26.544 27.5688 26.0879 27.1357 25.3419C26.9138 24.953 27.1106 24.55 26.971 24.2813C26.7205 24.0656 26.0082 23.7191 25.8042 23.4681C25.3854 22.9519 25.3675 21.7957 25.5572 21.1699C25.8997 20.4618 26.3662 19.819 26.9352 19.2713C27.5543 18.6821 28.1031 18.025 28.571 17.3126C29.1472 16.1777 29.1687 14.6079 29.6447 13.4234C30.1694 12.354 30.9817 11.4477 31.9928 10.8036C32.9802 10.1146 34.1708 9.76773 35.3787 9.81713C36.5062 9.88784 36.9465 10.3616 37.4726 10.5243C37.9988 10.6869 38.1097 10.5243 38.9652 10.8955C39.3048 11.0999 39.6073 11.3593 39.86 11.6627C39.9674 11.7759 39.9602 11.7829 40.1427 11.79C40.3393 11.7754 40.5367 11.7754 40.7333 11.79C41.0685 11.8635 41.389 11.9913 41.6818 12.1683C43.6755 13.3492 43.1386 15.7251 43.8902 17.4717C44.4021 18.6597 45.8266 19.8017 45.9483 21.0427C45.9914 21.6133 45.8672 22.1841 45.5904 22.6867C44.7206 24.1964 43.4715 23.012 42.8236 23.9348C42.6196 24.2247 42.4657 24.5075 42.0863 24.5641C41.6031 24.6277 40.9445 24.2494 40.5508 23.9701C40.4681 24.0654 40.3744 24.1508 40.2716 24.2247C39.9227 24.457 39.548 24.6492 39.1549 24.7975L40.064 26.0526C41.7677 25.8617 44.3842 26.4062 46.07 26.9188C46.1309 26.4945 46.6606 22.9908 47.0615 22.8211C47.6163 22.5806 53.4397 23.2489 53.7941 23.6272C54.0554 23.903 53.5865 29.1533 53.0782 29.9382C53.0031 30.0584 52.7454 30.062 52.6022 30.0655C53.4397 30.6312 54.2487 31.204 54.5386 31.4126C54.7641 30.6418 55.9488 26.5653 56.3855 25.897C56.5108 25.7026 56.6253 25.7061 57.2016 25.897C57.53 24.2782 57.9458 22.6778 58.4471 21.1028C58.2592 20.7975 58.109 20.4711 57.9997 20.1305C57.8663 19.591 57.8468 19.0301 57.9425 18.4829C57.5058 18.6278 54.8965 19.335 54.4741 19.1299C54.3607 19.0499 54.2766 18.9358 54.2343 18.8046C53.7726 17.8076 52.9816 14.4028 52.9207 13.3244C52.8957 13.1864 52.9197 13.044 52.9888 12.9214C53.4075 12.49 59.0413 10.8884 59.5173 11.1006C59.8073 11.2314 60.5911 13.7735 60.6734 14.074C61.3571 16.3403 61.0099 15.8418 61.3893 15.9726C61.826 16.1246 62.2018 17.0333 62.3557 17.454C62.5096 17.8748 62.6707 18.4405 62.4881 18.7728C62.5623 18.908 62.5921 19.0625 62.5735 19.2152C62.5549 19.3678 62.4888 19.5109 62.3843 19.6249C62.4982 19.7502 62.5724 19.9057 62.5978 20.0722C62.6232 20.2387 62.5988 20.4089 62.5275 20.5618C62.4237 20.8836 61.7759 21.0957 61.4537 21.1876C61.7081 21.8646 61.9196 22.5566 62.0873 23.2595C62.3728 24.3502 62.601 25.4548 62.7709 26.5688C62.8768 27.1101 62.9117 27.6627 62.8747 28.2128L63.4617 28.4745C63.4843 28.4847 63.5034 28.5012 63.5167 28.5219C63.5301 28.5426 63.5371 28.5666 63.5369 28.5912C63.5369 28.5912 63.4259 32.8763 61.9978 36.4366C60.2726 40.7465 57.4342 42.1891 53.114 40.5768C53.0751 40.9151 52.9908 41.2469 52.8635 41.5633C52.799 41.6764 52.5807 41.6976 52.434 41.7118C51.1633 41.7529 49.8913 41.7139 48.6256 41.5951L47.5518 48.3127C47.8418 49.14 51.1311 58.5659 51.0846 59.4428C51.0846 59.5347 51.0488 59.6054 50.8949 59.6761C49.9464 60.111 40.9588 61.2707 40.6188 60.3019C40.5329 60.065 40.3253 58.5553 40.2859 58.269L35.2284 57.7174L30.4071 58.0321C30.3552 58.5089 30.2691 58.9815 30.1494 59.4463C30.1065 59.5524 30.0564 59.609 29.9311 59.5983C29.455 59.5524 26.9173 59.0998 26.2158 58.969C23.5242 58.467 23.585 58.4245 23.6638 58.1629C23.8535 57.5442 25.6145 52.7181 26.3017 50.4659C25.2964 50.5719 24.2825 50.5719 23.2772 50.4659C23.2663 50.5042 23.2459 50.5391 23.2178 50.5676C23.1896 50.596 23.1547 50.617 23.1162 50.6285C22.4612 50.8654 16.609 50.5366 16.1294 50.0628C15.6963 49.6845 16.4229 44.3882 16.7486 43.8508ZM59.5102 11.2526C59.4708 11.1925 59.4851 11.1677 59.1702 11.2137C57.8566 11.3975 53.5614 12.7658 53.1892 13.0876C53.1176 13.8972 54.1806 18.3415 54.5994 18.8789C54.9037 18.9814 56.9224 18.4723 57.2338 18.391C59.6032 17.7793 59.5102 17.6838 60.0507 17.5601C60.3298 17.4646 60.3585 17.4611 60.3513 17.4222C60.3504 17.4135 60.3463 17.4053 60.3396 17.3995C60.333 17.3936 60.3244 17.3903 60.3155 17.3904C59.9934 17.3904 59.1308 17.3656 58.9196 17.1181C58.873 17.0678 58.8382 17.0079 58.8177 16.9428C58.7973 16.8776 58.7916 16.8088 58.8012 16.7413C58.8108 16.6737 58.8353 16.6091 58.8731 16.552C58.9109 16.4949 58.961 16.4468 59.0198 16.411C59.4798 16.229 59.9606 16.1031 60.4515 16.0362C60.5983 16.008 60.7772 15.9585 60.9562 15.9373C60.7092 14.8341 59.8932 11.8395 59.5102 11.2526ZM62.5848 28.0962V27.5482C62.5526 26.8764 62.2268 25.1121 62.1302 24.6277C61.9727 23.8428 61.9369 23.6661 61.4788 21.9619C61.4788 21.9159 61.2032 21.1558 61.2032 21.1558C61.1982 21.1426 61.1962 21.1285 61.1972 21.1145C61.1982 21.1004 61.2022 21.0868 61.209 21.0744C61.2158 21.062 61.2252 21.0512 61.2365 21.0427C61.2478 21.0342 61.2609 21.0281 61.2748 21.025C61.3141 21.025 62.2447 20.7987 62.3485 20.5052C62.4523 20.2118 62.4738 19.8582 62.2125 19.7027C62.2029 19.6958 62.1951 19.6867 62.1897 19.6763C62.1843 19.6658 62.1815 19.6543 62.1815 19.6426C62.1815 19.6308 62.1843 19.6193 62.1897 19.6088C62.1951 19.5984 62.2029 19.5893 62.2125 19.5825C62.3269 19.4897 62.4039 19.3595 62.4295 19.2155C62.4551 19.0716 62.4277 18.9233 62.3521 18.7976C62.2698 18.6314 62.7101 18.7127 62.1875 17.5212C62.055 17.2277 61.6076 16.3262 61.3034 16.2272C61.034 16.2012 60.7621 16.2313 60.5052 16.3156C60.0566 16.3854 59.6156 16.4966 59.188 16.6479C59.1609 16.6623 59.1374 16.6828 59.1195 16.7076C59.1016 16.7325 59.0898 16.7611 59.085 16.7912C59.0801 16.8213 59.0824 16.8521 59.0916 16.8813C59.1008 16.9104 59.1166 16.937 59.1379 16.959C59.2952 17.0471 59.4675 17.1058 59.6462 17.1323C60.7737 17.3515 60.5732 17.1075 60.72 17.4858C61.1507 17.4609 61.5813 17.5372 61.9763 17.7086C62.1302 17.7404 62.0658 17.8394 61.9548 17.8217C61.4753 17.6665 60.9624 17.6409 60.4694 17.7475C60.1834 17.7991 59.9038 17.8809 59.6355 17.9914C59.3921 18.0891 59.176 18.2431 59.0055 18.4405C58.9751 18.5153 58.9637 18.5963 58.9724 18.6765C58.9812 18.7566 59.0097 18.8334 59.0556 18.9001C59.1415 19.0309 59.5567 18.9425 59.7142 18.9001C59.929 18.8364 60.1545 18.7834 60.3656 18.7162C60.6627 18.6243 60.6305 18.5996 60.7236 18.6066C61.0518 18.6526 61.3729 18.7393 61.6792 18.8647C61.6879 18.8657 61.6962 18.8686 61.7036 18.8733C61.7109 18.8779 61.7171 18.8841 61.7216 18.8915C61.7262 18.8989 61.7289 18.9071 61.7297 18.9157C61.7305 18.9243 61.7293 18.9329 61.7263 18.941C61.7232 18.949 61.7183 18.9563 61.7119 18.9622C61.7055 18.9681 61.6979 18.9725 61.6896 18.975C61.6812 18.9775 61.6724 18.9781 61.6638 18.9768C61.6552 18.9755 61.647 18.9722 61.6398 18.9673C61.3657 18.8909 61.0855 18.8377 60.8023 18.8082C60.6412 18.8082 60.745 18.8082 60.3406 18.9673C60.158 19.0344 59.9826 19.0875 59.7894 19.1511C59.665 19.1932 59.5367 19.2228 59.4064 19.2395C59.1773 19.4516 59.0127 19.9466 59.3205 20.035C59.4414 20.0556 59.5658 20.0409 59.6784 19.9926C60.4981 19.7274 59.9433 19.5365 61.7222 19.8971C61.7367 19.8989 61.75 19.9061 61.7594 19.9173C61.7687 19.9285 61.7733 19.9428 61.7723 19.9572C61.7723 20.0492 61.7114 19.9926 60.7271 19.9572C60.6081 19.9454 60.4882 19.9454 60.3692 19.9572C60.0614 20.1128 59.6032 20.378 59.2489 20.2754C58.8158 20.1375 58.8301 19.6638 59.1093 19.3173C59.2095 19.1971 59.2203 19.2324 59.1344 19.2183C59.0715 19.2116 59.0108 19.1921 58.956 19.161C58.9012 19.13 58.8534 19.0881 58.8158 19.038C58.731 18.9225 58.6836 18.7843 58.6798 18.6417C58.676 18.4991 58.7159 18.3587 58.7943 18.2389L58.193 18.4157C58.074 18.9633 58.0838 19.5306 58.2216 20.0739C58.26 20.2065 58.3103 20.3355 58.372 20.4593C58.6333 21.0038 58.7299 21.0214 58.6977 21.124C58.2003 22.7215 57.7905 24.3443 57.47 25.9854C58.8194 26.4521 61.2927 27.5269 62.5848 28.0962ZM34.262 52.665C32.7301 52.7287 29.4371 52.8454 27.9267 52.7994C28.0305 53.2449 28.0949 53.5277 28.1128 53.5914C28.8323 53.5914 33.4817 52.7959 34.262 52.665ZM27.3469 52.4847C28.3061 52.7075 40.7584 52.2266 41.825 51.7776C41.714 50.9856 40.6689 46.5343 40.4577 45.6257C39.5183 45.9097 38.541 46.0528 37.5585 46.0499C37.2006 46.2338 36.61 46.552 36.2557 46.7182C36.295 47.0187 36.3917 47.7293 36.1769 47.9415C35.9622 48.1536 31.0192 49.9462 26.6847 50.4482C26.8595 51.1408 27.0808 51.8211 27.3469 52.4847ZM40.5723 43.9745C40.7371 43.9251 40.8895 43.842 41.0197 43.7306C41.1127 43.6316 41.0805 43.3311 41.0197 43.1896C40.9864 43.1209 40.9273 43.0676 40.855 43.0411C40.7676 43.0036 40.6745 42.9809 40.5794 42.974C40.551 42.9733 40.5234 42.9641 40.5005 42.9476C40.4775 42.931 40.4602 42.9079 40.4508 42.8814C40.4415 42.8549 40.4406 42.8262 40.4482 42.7991C40.4558 42.7721 40.4716 42.7479 40.4935 42.73C40.7029 42.5558 40.8487 42.3186 40.9087 42.0547C40.9087 41.8603 40.8335 41.6587 40.5186 41.4819C40.1606 41.5102 39.0869 42.3871 38.5893 41.8815C38.0918 41.3759 38.6788 40.1915 38.124 40.0925C37.5693 39.9935 37.2901 41.641 37.1934 41.8214C36.8713 42.4401 36.0051 42.882 35.5112 43.3912C35.8095 44.445 36.0484 45.5144 36.227 46.5944C36.9429 46.2161 37.4726 45.8873 37.5263 45.8873C38.2744 45.8625 40.2823 45.6575 40.8049 45.1307C40.8978 45.0598 40.9615 44.9578 40.9839 44.844C41.0063 44.7301 40.9859 44.6121 40.9266 44.512C40.8885 44.4455 40.8372 44.3874 40.7756 44.3412C40.7141 44.295 40.6437 44.2617 40.5687 44.2432C40.538 44.2358 40.5108 44.2184 40.4915 44.1937C40.4721 44.1691 40.4618 44.1387 40.4622 44.1075C40.4627 44.0763 40.4738 44.0462 40.4937 44.022C40.5137 43.9979 40.5414 43.9811 40.5723 43.9745ZM36.585 32.201C37.2499 32.1382 37.9179 32.1122 38.5858 32.1232C38.6717 32.1232 38.7433 32.1656 38.7683 32.247C38.8292 32.4732 39.8421 39.8273 39.8922 40.1879C40.107 36.6523 40.3289 32.9293 40.4935 30.1999C39.2479 32.1621 39.1406 32.3566 38.9437 32.2187C38.28 31.6795 37.6523 31.0985 37.0646 30.4792C36.9572 30.8716 36.7854 31.5116 36.585 32.201ZM33.3099 30.96C33.5533 30.6064 33.7931 30.2529 33.8826 30.1221L32.7265 27.2476L33.3099 30.96ZM32.476 26.9011C31.1222 27.1769 29.8022 27.5953 28.5388 28.1492C28.5924 28.3154 29.2832 30.4014 30.1101 32.8904C30.4895 32.8445 32.6621 32.5828 33.3314 32.5121L32.476 26.9011ZM33.9399 30.5145L33.3743 31.356L33.5533 32.4874L34.1081 32.4167C34.0258 31.6494 33.9685 30.9211 33.9399 30.5145ZM24.0575 34.2446C24.062 34.7049 24.1075 35.1639 24.1935 35.6164C25.4212 35.3053 36.1304 32.7031 37.2185 33.3147C37.7625 33.6258 39.5522 40.8809 39.724 41.535L39.8528 41.4713C39.2873 37.5433 38.5357 32.3919 38.5357 32.3778C37.3151 32.2399 25.5572 33.5551 24.0575 34.2446ZM30.3033 41.6375C31.1051 41.5845 34.2871 41.4289 34.9564 41.8673C35.0602 41.938 35.1031 41.9522 35.4718 43.2603C35.9478 42.7618 36.746 42.2916 37.0145 41.7365C37.1362 41.4925 37.333 39.7106 38.167 39.8485C39.2909 40.0359 37.8556 42.3234 39.5164 41.6163C39.409 41.1673 37.648 33.6789 37.1576 33.4031C36.1196 32.8197 24.7984 35.6659 23.3667 36.0654C23.449 36.9281 24.5013 41.5314 24.6946 42.3729C26.5483 42.0211 28.421 41.7755 30.3033 41.6375ZM35.8154 16.906C35.615 17.0404 35.6221 17.3621 35.6579 17.5954C35.9085 19.1759 37.512 20.134 38.6251 18.6208C38.8793 18.2672 39.0761 17.1429 38.9043 16.8954C38.7898 16.7504 37.8663 16.7434 37.6802 16.7434C37.3366 16.7469 35.9944 16.7999 35.8297 16.906H35.8154ZM40.0783 17.1606C40.0783 17.8253 40.3038 18.9284 40.9016 19.2466C41.8644 19.7416 42.8415 18.9567 42.8666 17.9349C42.9033 17.5618 42.8852 17.1855 42.8129 16.8176L42.7771 16.7999C42.8344 16.7009 40.3181 16.6691 40.0926 16.8919C40.085 16.9813 40.085 17.0712 40.0926 17.1606H40.0783ZM38.8327 24.8576C38.2135 25.0343 37.2149 24.9495 36.7353 24.4651C36.7252 24.4546 36.7196 24.4407 36.7196 24.4262C36.7196 24.4118 36.7252 24.3978 36.7353 24.3873C36.8176 24.2883 36.7353 24.4793 37.6659 24.6171C38.5965 24.755 39.1585 24.6171 40.0998 24.0126C40.5325 23.6199 40.8565 23.1246 41.0411 22.5736C41.4265 21.641 41.6679 20.6566 41.757 19.6532C41.4201 19.7077 41.0744 19.6518 40.7727 19.4941C40.4798 19.3249 40.2529 19.0634 40.1284 18.7516C40.2492 19.1252 40.3484 19.5053 40.4255 19.89C40.4423 19.9393 40.4448 19.9922 40.4328 20.0428C40.4208 20.0934 40.3947 20.1397 40.3575 20.1764C40.11 20.3259 39.8186 20.3882 39.5307 20.3532C39.5222 20.3554 39.5134 20.3556 39.5048 20.3538C39.4963 20.352 39.4883 20.3484 39.4814 20.3431C39.4745 20.3378 39.4689 20.331 39.4651 20.3233C39.4612 20.3155 39.4592 20.307 39.4592 20.2984C39.4592 20.2898 39.4612 20.2813 39.4651 20.2735C39.4689 20.2658 39.4745 20.259 39.4814 20.2537C39.4883 20.2484 39.4963 20.2448 39.5048 20.243C39.5134 20.2413 39.5222 20.2415 39.5307 20.2436C39.743 20.2203 39.948 20.1528 40.132 20.0456C40.2143 19.989 40.1785 20.0244 40.1535 19.9077C40.1284 19.7911 39.6631 18.1046 39.6381 17.9985C39.5271 17.9985 39.1048 17.9419 39.1048 17.8394C39.1048 17.7369 39.4412 17.7086 39.5665 17.7157C39.5665 17.6697 39.545 17.6308 39.5343 17.5954C39.5286 17.5814 39.5288 17.5657 39.5348 17.5517C39.5409 17.5378 39.5522 17.5268 39.5665 17.5212C39.5807 17.5156 39.5966 17.5158 39.6107 17.5217C39.6248 17.5277 39.636 17.539 39.6416 17.553C39.7669 17.7934 39.681 17.705 39.8492 17.7475C39.7847 17.4206 39.7847 17.0844 39.8492 16.7575C40.0533 16.4464 41.281 16.5171 41.6818 16.5418C41.4778 15.3574 40.6832 14.774 40.1964 13.8265C40.0601 13.6066 39.8783 13.4174 39.6631 13.2714C39.5557 13.2431 39.3446 13.5083 39.2157 13.5719C39.0869 13.6356 38.9652 13.9856 38.8578 14.1058C38.5202 14.4855 38.1311 14.8175 37.7017 15.0922C37.3438 15.3433 36.7854 15.3822 36.542 15.7039C36.4392 15.9775 36.3894 16.2677 36.3953 16.5595C36.857 16.5312 38.7826 16.5029 39.0117 16.8282C39.2193 17.0899 39.1298 18.2849 38.8256 18.7445C38.0596 19.89 36.882 19.9608 35.9622 18.9284C35.8633 18.8065 35.7792 18.6736 35.7116 18.5324C35.0244 19.5931 34.4839 20.2259 34.4589 21.4705C34.4302 23.0473 34.8812 25.6601 33.1524 25.989L32.8554 26.7986C34.2871 30.3554 34.2119 30.1327 34.2119 30.168C34.2119 30.2034 34.2799 31.2287 34.4052 32.4025C35.0924 32.3318 35.7331 32.2717 36.3022 32.2257C36.3451 32.0808 36.8785 30.2069 36.8677 30.168C36.814 29.9913 37.0825 29.6448 37.2901 29.3372C38.0686 28.2238 38.9186 27.1609 39.8349 26.1551L38.8327 24.8576ZM40.0926 26.2506C40.0318 26.3425 37.4547 29.1427 37.1397 30.1716C37.7188 30.8056 38.3445 31.3965 39.0117 31.9394C39.2515 31.6282 39.8994 30.6029 40.515 29.6448C40.6259 27.7956 40.7011 26.5087 40.719 26.24C40.5186 26.2258 40.2931 26.2364 40.107 26.2506H40.0926ZM52.8742 29.7862C53.2823 29.0791 53.8478 24.4828 53.7153 23.7757C53.7153 23.712 53.7153 23.6908 53.4147 23.6095C52.1333 23.2807 47.6377 22.9024 47.1653 23.0615C46.8074 23.7509 46.0235 28.2517 46.2096 28.9447C46.5747 29.2346 51.8219 29.9665 52.8885 29.7862H52.8742ZM52.6237 41.4183C53.0353 40.6193 53.3395 35.4962 53.1355 35.3017C52.8313 35.0118 47.1187 34.7643 46.5783 34.9729C46.2204 35.7154 45.7121 40.2763 45.9233 40.895C46.4101 41.2557 51.779 41.6092 52.638 41.4183H52.6237ZM44.4522 35.4926C44.1945 35.4255 42.3977 34.9729 42.1829 34.8456C42.029 34.7572 41.8536 35.0436 44.8638 26.8835C44.5059 26.5582 41.3776 26.141 40.8837 26.293C40.8837 26.4875 40.4148 34.7396 40.0461 41.3617C40.2215 41.2769 40.4756 41.1461 40.6367 41.2345C41.3096 41.588 41.3525 42.1749 40.855 42.7477C40.9479 42.7702 41.0342 42.8139 41.107 42.8753C41.1797 42.9367 41.2368 43.0141 41.2738 43.1012C41.3312 43.234 41.3556 43.3783 41.345 43.5222C41.3344 43.6661 41.2891 43.8055 41.2129 43.9286C41.1295 44.0075 41.0341 44.0731 40.9302 44.123C41.0371 44.1938 41.1215 44.2931 41.1736 44.4094C41.2205 44.5096 41.2484 44.6175 41.2559 44.7276L44.4522 35.4926ZM35.5434 57.4947L40.2179 58.0073C40.1964 57.8376 39.6703 53.7399 39.5021 52.3504C38.5285 52.4352 37.3545 52.5095 36.0982 52.5766C35.8906 55.1258 35.5255 56.8865 35.5577 57.4947H35.5434ZM35.2964 57.4664C35.2463 56.6603 35.9192 52.6191 35.9228 52.5837L35.5649 52.6014C34.3479 52.8241 31.2125 53.3722 30.8724 53.4287C30.7579 54.5672 30.4716 57.2189 30.4036 57.7634C35.7402 57.424 35.164 57.4522 35.3143 57.4664H35.2964ZM16.3048 49.9002C16.6627 50.183 21.9207 50.6568 23.0052 50.4235C23.424 49.6209 23.7211 44.5013 23.517 44.3069C23.2092 44.0134 17.4967 43.773 16.9634 43.9781C16.6269 44.717 16.1079 49.2956 16.3191 49.9002H16.3048Z",fill:"black"})]})}),(0,n.jsxs)("defs",{children:[(0,n.jsx)("pattern",{id:"pattern0_4378_11342",patternContentUnits:"objectBoundingBox",width:"1",height:"1",children:(0,n.jsx)("use",{xlinkHref:"#image0_4378_11342",transform:"matrix(0.00083331 0 0 0.00145829 0 -0.000923572)"})}),(0,n.jsx)("pattern",{id:"pattern1_4378_11342",patternContentUnits:"objectBoundingBox",width:"1",height:"1",children:(0,n.jsx)("use",{xlinkHref:"#image1_4378_11342",transform:"matrix(0.000916004 0 0 0.00166667 -0.0496025 0)"})}),(0,n.jsxs)("filter",{id:"filter0_dd_4378_11342",x:"3.99829",y:"4",width:"72",height:"42",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{dy:"1"}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"1.5"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4378_11342"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{}),(0,n.jsx)("feGaussianBlur",{stdDeviation:"0.25"}),(0,n.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0"}),(0,n.jsx)("feBlend",{mode:"normal",in2:"effect1_dropShadow_4378_11342",result:"effect2_dropShadow_4378_11342"}),(0,n.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect2_dropShadow_4378_11342",result:"shape"})]}),(0,n.jsx)("pattern",{id:"pattern2_4378_11342",patternContentUnits:"objectBoundingBox",width:"1",height:"1",children:(0,n.jsx)("use",{xlinkHref:"#image0_4378_11342",transform:"matrix(0.00083331 0 0 0.00145829 0 -0.000923572)"})}),(0,n.jsx)("pattern",{id:"pattern3_4378_11342",patternContentUnits:"objectBoundingBox",width:"1",height:"1",children:(0,n.jsx)("use",{xlinkHref:"#image1_4378_11342",transform:"matrix(0.000909091 0 0 0.00166667 -0.0454545 0)"})}),(0,n.jsx)("clipPath",{id:"clip0_4378_11342",children:(0,n.jsx)("rect",{width:"66",height:"36",rx:"3",transform:"matrix(-1 0 0 1 72.9983 6)",fill:"white"})}),(0,n.jsx)("image",{id:"image0_4378_11342",width:"1200",height:"687"}),(0,n.jsx)("image",{id:"image1_4378_11342",width:"1200",height:"600"})]})]})}function sZ({type:e}){let{navigateToVisualAssets:t}=(0,T.wV)(),s=(0,eb.sN)(),i=a.useCallback(e=>{s("visualAssetPacks",e)},[s]),r=a.useCallback(()=>{i(t(e))},[t,i,e]);return(0,n.jsx)("div",{className:"asset_panel_visual_asset_packs--assetPanelRow--QnOU0",children:(0,n.jsx)("button",{onClick:r,className:"asset_panel_visual_asset_packs--assetPackContainer--5RWXs",children:(0,n.jsx)(sJ,{type:e})})})}function sJ({type:e}){let t=e===T.G3.IconSets?(0,n.jsx)(sY,{}):(0,n.jsx)(sX,{}),s=e===T.G3.IconSets?(0,i.t)("design_systems.assets_panel.icon_sets"):(0,i.t)("design_systems.assets_panel.illustrations");return(0,n.jsxs)("div",{className:"asset_panel_visual_asset_packs--assetPack--kn6dk",children:[t,(0,n.jsx)("h3",{className:"asset_panel_visual_asset_packs--title--0xiOh ellipsis--ellipsis--70pHK",children:s})]})}var sQ=s(209554);let s0=(0,ei.jz)(e_.RU)+1,s1=(0,ei.jz)(e_.nT),s5=16/9;function s2({sidebarWidth:e,minCardWidth:t=180,previewPadding:s=s0,widthToHeightRatio:n=s5,rowPadding:i=s1}){let r=e-2*i,l=a.useMemo(()=>(0,sQ.BE)({elementMinSize:t,spaceAvailable:r,gap:0}),[t,r]),o=a.useMemo(()=>(0,sQ.y5)({numElements:l,spaceAvailable:r,gap:0}),[l,r]),c=a.useMemo(()=>o-2*s,[o,s]),d=a.useMemo(()=>(0,sQ.hg)({width:c,widthToHeightRatio:n}),[c,n]);return a.useMemo(()=>({cardWidth:o,previewWidth:c,previewHeight:d,numColumns:l}),[o,c,d,l])}var s3=s(240766),s4=s(65235);let s6="asset_panel_libraries--row--l-jAB",s7="asset_panel_libraries--libraryPrimaryButton--w01eA",s8=(0,ei.jz)(e_.YJ),s9=(0,ei.jz)(e_.RQ),ne=(0,ei.jz)(e_.ce),nt=(0,ei.jz)(e_.Kv),ns=(0,ei.jz)(e_.PK),nn=(0,ei.jz)(e_.vr),na=(0,ei.jz)(e_.CT)+16;function ni({width:e,hideScrollbar:t,localAssets:s}){let{libraries:a,presets:i,siteLibraries:r,librariesForConnectedProject:l}=(0,s4.g)(),o=(0,s3.I)(),c=(0,eI.md)(T.aK)===T.t6.Blocks;return o?(0,n.jsx)("div",{style:{width:e},children:(0,n.jsx)(t2.od,{})}):c?(0,n.jsx)(nc,{siteLibraries:r,hideScrollbar:t,width:e}):(0,n.jsx)(nr,{localAssets:s,subscribedLibraries:a,librariesForConnectedProject:l,presetLibraries:i,hideScrollbar:t,width:e})}function nr({localAssets:e,subscribedLibraries:t,presetLibraries:s,librariesForConnectedProject:r,width:l,hideScrollbar:o}){let{librariesScrollTop:c,handleScrollLibraries:d}=eL(),u=!!(0,v.GM)()(),{currentView:x}=(0,T.wV)(),[m]=(0,eC.MA)(),p=(0,eI.md)(t5.Jc),h=(0,t5.Y1)(),g=u?eC.$H.LIST:m,{cardWidth:f,previewHeight:_,numColumns:y}=s2({sidebarWidth:l}),b=g===eC.$H.GRID?y:1,j="grid"===g?s8+_+2:nt,C=t.length>0,w=e.numComponents+e.numTemplates>0,E=s.length>0,N=r.length>0,S=N&&(C||w),I=E&&(N||C||w),A=a.useMemo(()=>{let a=[];h&&(a.push({element:(0,n.jsx)(t5.WC,{}),key:"asset_suggestions",height:p}),a.push({element:(0,n.jsx)(t4.Q,{page:void 0}),key:"breadcrumb",height:ne}));let l=[];w&&l.push(e),C&&l.push(...t);for(let e=0;e<l.length;e+=b){let t=l.slice(e,e+b);a.push({element:(0,n.jsx)("div",{className:s6,children:t.map((t,s)=>(0,n.jsx)(sB,{library:t,keyboardSection:et.gP.LOCAL_AND_SUBSCRIBED,rowIndex:e,columnIndex:s,cardWidth:f,previewHeight:_},t.libraryKey))}),key:t.map(e=>e.libraryKey).join("-"),keys:t.map(e=>e.libraryKey),height:j})}S&&(a.push({element:(0,n.jsx)(eN.cG,{}),key:"connected_project_divider",height:s9}),a.push({element:(0,n.jsx)(eN.X3,{title:(0,i.t)("design_systems.libraries_modal.connected_project_libraries")}),key:"connected_project_header",height:ne}));for(let e=0;e<r.length;e+=b){let t=r.slice(e,e+b);a.push({element:(0,n.jsx)("div",{className:s6,children:t.map((t,s)=>(0,n.jsx)(sB,{library:t,keyboardSection:et.gP.LOCAL_AND_SUBSCRIBED,rowIndex:e,columnIndex:s,cardWidth:f,previewHeight:_},t.libraryKey))}),key:t.map(e=>e.libraryKey).join("-"),keys:t.map(e=>e.libraryKey),height:j})}I&&(a.push({element:(0,n.jsx)(eN.cG,{}),key:"presets_divider",height:s9}),a.push({element:(0,n.jsx)(eN.X3,{title:(0,i.t)("design_systems.assets_panel.ui_kits")}),key:"preset_libraries_header",height:ne}));for(let e=0;e<s.length;e+=b){let t=s.slice(e,e+b);a.push({element:(0,n.jsx)("div",{className:s6,children:t.map((t,s)=>(0,n.jsx)(sB,{library:t,keyboardSection:et.gP.PRESETS,rowIndex:e,columnIndex:s,cardWidth:f,previewHeight:_},t.libraryKey))}),key:t.map(e=>e.libraryKey).join("-"),keys:t.map(e=>e.libraryKey),height:j})}return u&&(a.push({element:(0,n.jsx)(eN.cG,{}),key:"va_packs_divider",height:s9}),a.push({element:(0,n.jsx)(eN.X3,{title:(0,i.t)("design_systems.assets_panel.assets_from_community"),onboardingKey:k.Bs}),key:"visual_assets_header",height:ne}),a.push({element:(0,n.jsx)(sZ,{type:T.G3.IconSets}),key:"visual_assets_icon_sets",height:nn}),a.push({element:(0,n.jsx)(sZ,{type:T.G3.Illustrations}),key:"visual_assets_illustrations",height:nn})),a.push(u?{element:(0,n.jsx)(no,{}),key:"browse_more_assets_button",height:ns}:{element:(0,n.jsx)(nl,{}),key:"add_more_libraries_button",height:ns}),a},[h,w,C,I,u,p,j,b,_,f,e,t,S,r,s]);return(0,n.jsx)(eS.wl,{elements:A,hideScrollbar:o,initialScrollTop:c,onScroll:d,anchorScroll:x===T.S5.Libraries})}function nl(){let{onToggleLibraryModal:e}=(0,t1.u)({entrypoint:t3.r6.ASSETS_PANEL_ADD_MORE_LIBRARIES,modalType:"editor",initialTab:eR.Wv.RECOMMENDED});return(0,n.jsx)("div",{className:s7,children:(0,n.jsx)(tJ.IK,{variant:"secondary",onClick:e,recordingKey:"assetsLibrary.addMoreLibraries",children:(0,i.tx)("design_systems.assets_panel.add_more_libraries")})})}function no(){return(0,n.jsx)($.o3,{trackingEventName:"cmty_category",trackingProperties:{name:"visual_assets_browse_more_assets_clicked",text:"Browse more assets"},to:new t0.$E({categorySlug:tQ.LJ.icons}).to,className:s7,target:"_blank",children:(0,n.jsx)(tJ.$n,{variant:"secondary",recordingKey:"assetsLibrary.browseMoreAssets",children:(0,i.tx)("design_systems.assets_panel.browse_more_assets")})})}function nc({siteLibraries:e,width:t,hideScrollbar:s}){let{librariesScrollTop:i,handleScrollLibraries:r}=eL(),l=a.useRef(null),{cardWidth:o,previewHeight:c}=s2({sidebarWidth:t}),{libraryKeys:d}=(0,eI.md)(eQ.AS),u=d.length+1,{flyout:x,...m}=function(e,t){let s=(0,a.useRef)(new Map),i=(0,a.useRef)(null),r=(0,a.useRef)(null),[l,o]=(0,eI.fp)(sD),c=l?.key,[d,u]=(0,a.useState)(!1),{setSafePolygon:x,isInSafePolygon:m,cursorXSpeedRef:p}=function(){let e=(0,a.useRef)(null),t=(0,a.useCallback)(t=>{e.current=t},[]),s=function(){let e=(0,a.useRef)(0),t=(0,a.useRef)(null),s=(0,a.useRef)(null),n=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let a=a=>{let i=a.clientX,r=a.timeStamp;if(t.current&&s.current){let n=t.current,a=r-s.current;a>0&&(e.current=(i-n)/a)}t.current=i,s.current=r,n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{e.current=0},50)};return document.addEventListener("mousemove",a),()=>{document.removeEventListener("mousemove",a),n.current&&clearTimeout(n.current)}},[]),e}();return{setSafePolygon:t,isInSafePolygon:(0,a.useCallback)(t=>!!e.current&&function(e,t){let[s,n]=e,a=!1,i=t.length;for(let e=0,r=i-1;e<i;r=e++){let[i,l]=t[e]||[0,0],[o,c]=t[r]||[0,0];l>=n!=c>=n&&s<=(o-i)*(n-l)/(c-l)+i&&(a=!a)}return a}(t,e.current)&&s.current>.1,[s]),cursorXSpeedRef:s}}(),h=(0,a.useRef)(null),g=a.useCallback(()=>{o(null),u(!1),x(null),i.current&&(clearTimeout(i.current),i.current=null)},[o,x]);(0,a.useEffect)(()=>{let t=t=>{let n=t.target;c&&s.current.get(c)?.contains(n)||e?.current?.contains(n)||g()};return document.addEventListener("pointerdown",t),()=>{document.removeEventListener("pointerdown",t)}},[e,g,c]);let f=(0,a.useCallback)((e,t)=>{if(h.current&&(clearTimeout(h.current),h.current=null),r.current=null,c===t){let n=s.current.get(t)?.getBoundingClientRect();n&&x([[e.clientX-1,e.clientY],[n.left,n.top],[n.left,n.bottom]])}else i.current&&(clearTimeout(i.current),i.current=null)},[c,x]),_=(0,a.useCallback)(()=>{i.current&&(clearTimeout(i.current),i.current=null)},[]),y=a.useCallback(()=>x(null),[x]),k=a.useCallback(()=>null!==l&&(g(),!0),[l,g]);(0,se.O1)(k,se.KD.OVERLAY);let[v,b]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=[...t,sR.Yl];b((0,n.jsx)(n.Fragment,{children:e.map(e=>(0,n.jsx)(sS,{hide:c!==e,onMouseEnter:y,onMouseLeave:_,libraryKey:e,ref:t=>s.current.set(e,t),onDragStart:d?void 0:g},e))}))},[t,c,f,g,y,_,d]),{flyout:v,onMouseEnter:(e,t)=>{if(r.current=t,!d&&!i.current){i.current=setTimeout(()=>{o({key:t,persisted:d})},200);return}if(!d){if(m([e.clientX,e.clientY]))return;o({key:t,persisted:d})}},onMouseLeave:f,onClick:e=>{if(e===c&&d){g();return}o({key:e,persisted:!0}),u(!0),x(null),i.current&&clearTimeout(i.current)},onMouseMove:(e,t)=>{h.current&&(clearTimeout(h.current),h.current=null),!d&&c&&c!==t&&(m([e.clientX,e.clientY])?(h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{0===p.current&&o({key:t,persisted:d})},100)):o({key:t,persisted:d}))}}}(l,d),p=a.useMemo(()=>{if("disabled"!==e.status){let t=e.data??[];return 0===t.length?Array.from({length:u},(e,t)=>({element:(0,n.jsx)(ev,{keyPrefix:"blocks",name:"",recordingKey:"assetsLibrary.siteKitLoading",disabled:!1,variant:"preview-no-padding"}),key:`site kit loading-${t}`,keys:[`site kit loading-${t}`],height:na})):t.map((e,t)=>({element:(0,n.jsx)(sB,{cardWidth:o,columnIndex:1,flyoutHandlers:m,folderVariant:"preview-no-padding",isFolderView:!0,keyboardSection:et.gP.SITE_KIT,library:e,previewHeight:c,rowIndex:t},e.libraryKey),key:e.libraryKey,keys:[e.libraryKey],height:na}))}return[]},[e.status,e.data,u,c,o,m]);return(0,n.jsxs)("div",{ref:l,children:[(0,n.jsx)(eS.wl,{elements:p,hideScrollbar:s,initialScrollTop:i,onScroll:r,anchorScroll:!0}),x]})}function nd({page:e,index:t}){let s=(0,eb.sN)(),[i]=(0,eC.MA)(),{navigateToPage:r,libraryKey:l,currentView:c}=(0,T.wV)(),d=a.useCallback(()=>{s("pageRow",r(e.id))},[s,r,e.id]),u=e.id,x=c!==T.S5.Pages,{keyboardNavigationItem:m,setKeyboardNavigationElement:p}=(0,eo.M3)({path:[et.ON.CONTENTS,et.lM.PAGES,t],id:e.id,disabled:x}),{focusFirstItem:h,focusSearchBar:g}=(0,ej.rl)();(0,ej.C0)(m,c===T.S5.Pages&&0===t);let _=(0,ej.MB)({onBoth:d,onKeyDown:h,onClick:g}),y=function(e,t){let s=(0,f.q5)(),n=(0,F.wA)(),i=e===s?.libraryKey,r=e&&!!t,l=(0,tL.b)({libraryKey:e,nodeId:t}),c=a.useMemo(()=>{if(l.data?.type==="team")return l.data.link},[l]),d=a.useCallback(()=>(0,tB.UN)().setCurrentPageAsync(t??""),[t]),u=a.useCallback(()=>{o.az.trackDefinedEvent("assets_panel.go_to_page",{libraryKey:e??"",pageId:t,fileKey:s?.key,fileTeamId:s?.teamId??void 0,fileOrgId:s?.parentOrgId??void 0,isLocal:i})},[i,e,s?.key,s?.parentOrgId,s?.teamId,t]),x=a.useCallback(()=>{d(),u()},[d,u]),m=a.useCallback(()=>{o.az.trackDefinedEvent("assets_panel.open_page_context_menu",{libraryKey:e??"",pageId:t,fileKey:s?.key,fileTeamId:s?.teamId??void 0,fileOrgId:s?.parentOrgId??void 0})},[e,s?.key,s?.parentOrgId,s?.teamId,t]),p=(0,Q.fd)(e);return a.useCallback(e=>{r&&!p&&(e.preventDefault(),e.stopPropagation(),n((0,tz.j7)({type:tV,data:{libraryPageHref:c,pageId:t,isLocalLibrary:i,onClickLocalPage:x,onClickSubscribedPage:u,position:{top:e.clientY,left:e.clientX}}})),m())},[r,p,n,c,t,i,x,u,m])}(l,e.id),k=a.useMemo(()=>"list"===i?"icon":"preview",[i]),v={pageId:e.id,libraryKey:l||""};return(0,n.jsx)(ev,{ref:p,disabled:x,keyPrefix:u,name:e.name,onClick:_,onContextMenu:y,pageInfo:v,previewAssetOrUrl:e.previewAsset,recordingKey:`assetsPage.${e.id}`,variant:k})}var nu=s(943866),nx=s(3219);let nm="performance.ds_eco.asset_panel_pages_view_loading",np=new nx.jk(nm,{});function nh({didFinishLoading:e}){let t=np.stop();(0,o.sx)(nm,{elapsedMs:t,isNewAssetPanelFetch:!0,didFinishLoading:e},{forwardToDatadog:!0})}var ng=s(402731);let nf=(0,ei.jz)(e_.Mj),n_=(0,ei.jz)(e_.$c),ny=(0,ei.jz)(e_.d5),nk=2*nf,nv=(0,ei.jz)(e_.Kd),nb=(0,ei.jz)(e_.y4),nj=(0,ei.jz)(e_.Gd),nC=(0,ei.jz)(e_.xP);function nw({page:e,thumbWidth:t,thumbHeight:s,row:i,column:r}){let l=(0,eb.sN)(),{navigateToPage:o,currentView:c}=(0,T.wV)(),d=a.useCallback(()=>{l("pageRow",o(e.id))},[l,o,e.id]),u=c!==T.S5.Pages,{keyboardNavigationItem:x,setKeyboardNavigationElement:m}=(0,eo.M3)({path:[et.ON.CONTENTS,et.lM.PAGES,i],column:r,id:e.id,disabled:u}),{focusFirstItem:p,focusSearchBar:g}=(0,ej.rl)();(0,ej.C0)(x,c===T.S5.Pages&&0===i&&0===r);let f=(0,ej.MB)({onBoth:d,onKeyDown:p,onClick:g}),{widthForCentering:_,textRef:y,iconRef:k}=function(e){let[t,s]=a.useState(void 0),n=a.useCallback(e=>s(e?.scrollWidth),[]),[i,r]=a.useState(void 0);return{textRef:n,iconRef:a.useCallback(e=>r(e?.scrollWidth),[]),widthForCentering:a.useMemo(()=>t&&i?Math.max(Math.min(e-(t+i)-1,i),0):-1,[i,t,e])}}(t),v=(0,et.AZ)(e)?e.embeds[0]?.thumbnail_url:e.previewAsset;return(0,n.jsxs)(ec.E,{className:"site_kit_pages--tile--YjVeG",onClick:f,ref:m,"aria-label":e.name,disabled:u,children:[v?(0,n.jsx)(ep.V,{previewAssetOrUrl:v,type:"no-padding",height:s,width:t,keyPrefix:e.id}):(0,n.jsx)("div",{className:ef,style:{height:s,width:t}}),(0,n.jsx)("div",{className:h.s.flex.flexColumn.itemsCenter.wFull.$,style:{width:t},children:(0,n.jsxs)("span",{className:"site_kit_pages--pageName--uqTDV site_kit_pages--text--5gqFg",children:[_>0&&(0,n.jsx)("div",{className:h.s.flexShrink0.$,style:{width:_}}),(0,n.jsx)(eG.G,{text:e.name,ref:y}),(0,n.jsx)("div",{className:"site_kit_pages--chevron--ne3-x",ref:k,children:(0,n.jsx)(ng.k,{})})]})})]})}let nE=(0,ei.jz)(e_.RQ),nN=(0,ei.jz)(e_._q),nS=(0,ei.jz)(e_.HE);function nT({library:e,width:t,hideScrollbar:s,isLoading:i}){!function({isLoading:e}){let{currentView:t}=(0,T.wV)(),s=(0,nu.ZC)(t);a.useEffect(()=>(s===T.S5.Libraries&&t===T.S5.Pages&&np.start(),t===T.S5.Pages&&!e&&np.isRunning&&nh({didFinishLoading:!0}),()=>{s===T.S5.Pages&&t!==T.S5.Pages&&np.isRunning&&nh({didFinishLoading:!1})}),[e,t,s])}({isLoading:i});let[r]=(0,eC.MA)(),{pagesScrollTop:l,handleScrollPages:o}=eL({libraryKey:e?.libraryKey}),c=a.useMemo(()=>e?Array.from(e.pages):[],[e]),d=(0,Q.fd)(e?.libraryKey),{thumbWidth:u,thumbHeight:x,numColumns:m}=function(){let{width:e}=(0,eD.G)(),t=a.useMemo(()=>e-nk,[e]),s=Math.max(Math.min(3,(0,sQ.BE)({elementMinSize:98,gap:nv,spaceAvailable:t})),2),n=(0,sQ.y5)({numElements:s,gap:nv,spaceAvailable:t})-2*nj;return{thumbWidth:n,thumbHeight:n,numColumns:s}}(),p=a.useMemo(()=>{if(e?.type===et.yW.SITE&&"grid"===r)return function(e,t,s,a){let i=Array.from(e.pages),r=[],l=s+2*nj+nb+nC;for(let e=0;e<i.length;e+=a){let o=0===e?"site_kit_pages--virtualRowFirst--MRbGF site_kit_pages--virtualRow--zmJuQ":"site_kit_pages--virtualRow--zmJuQ",c=i.slice(e,e+a),d=[],u=c.map(([e])=>e);c.forEach(([a,i],r)=>{i&&d.push((0,n.jsx)(nw,{page:i,row:e,column:r,thumbWidth:t,thumbHeight:s},a))}),r.push({element:(0,n.jsx)("div",{className:o,style:{gap:nv},role:"row",children:d}),key:u.join("-"),keys:u,height:l+(0===e?0:nf)})}return r.length>0&&(r.unshift({element:(0,n.jsx)(eN.hK,{height:n_}),key:"spacer-top",height:n_}),r.push({element:(0,n.jsx)(eN.hK,{height:ny}),key:"spacer-bottom",height:ny})),r}(e,u,x,m);let t=[];return c.forEach(([e,s],a)=>{t.push({element:(0,n.jsx)(nd,{page:s,index:a}),height:"list"===r?nS:nN,key:e}),0===a&&(0,er.dS)(s.name,{isPreset:d})&&t.push({element:(0,n.jsx)(eN.cG,{}),key:"examples_divider",height:nE})}),t},[e,r,c,u,x,m,d]);return i?(0,n.jsx)("div",{className:"asset_panel_pages--loadingContainer--Twtag",style:{width:t},"data-testid":"asset-panel-pages-spinner",children:(0,n.jsx)(sv.k,{})}):0===c.length?(0,n.jsx)("div",{style:{width:t}}):(0,n.jsx)(eS.wl,{elements:p,hideScrollbar:s,initialScrollTop:l,onScroll:o})}var nI=s(591791),nA=s(835585),nM=s(420434),nz=s(373191),nL=s(151126);function nO(){let{productComponents:e}=(0,nI.g5)(nA.$A.Design),t=(0,nz.T)(),{getLibrary:s}=(0,eE.G)(),[r]=(0,eC.MA)(),l="list"===r,o=a.useCallback(e=>{let t=s(e);return t?.name||""},[s]),c=(0,eO.O)(),{props:d,numColumns:u}=a.useMemo(()=>(0,eO.Z)(c,r,el.rp.NORMAL),[c,r]),{componentSectionNameForTracking:x}=(0,eb.zf)(),m=e.length>0,p=t.length>0;return(0,n.jsxs)(eN.xU,{children:[p&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eN.X3,{title:(0,i.t)("design_systems.assets_panel.site_blocks")}),(0,n.jsx)("div",{className:l?nL.e:nL.WA,children:t.map((e,t)=>"embed"===e.type?(0,n.jsx)(e7.pd,{embed:e,sectionNameForTracking:"Recently used site kit assets",sectionPosition:t,keyboardPosition:(0,ej.pg)([et.tM.SITE_KIT],t,u),thumbHeight:d.thumbHeight,thumbWidth:d.thumbWidth,libraryName:(0,i.t)("design_systems.assets_panel.site_blocks.embeds")},e.name):(0,n.jsx)(e5,{asset:e,sectionNameForTracking:"Recently used site kit assets",sectionPosition:t,keyboardPosition:(0,ej.pg)([et.tM.SITE_KIT],t,u),thumbHeight:d.thumbHeight,thumbWidth:d.thumbWidth,libraryName:o(e.sourceLibraryKey)},`assetPanelRecents:siteKit:${(0,eP.V)(e)}`))})]}),p&&m&&(0,n.jsx)("div",{className:nL.r}),m&&(0,n.jsxs)(n.Fragment,{children:[p&&(0,n.jsx)(eN.X3,{title:(0,i.t)("design_systems.assets_panel.dropdown_type_all_libraries")}),(0,n.jsx)("div",{className:l?nL.e:nL.WA,children:e.map((e,t)=>(0,n.jsx)(nM.z,{asset:e,fileName:o(e.library_key),sectionNameForTracking:x,sectionPosition:t,keyboardPosition:(0,ej.pg)([et.tM.COMPONENTS],t,u),...d},`assetPanelRecents:component:${(0,eP.V)(e)}`))})]}),(0,n.jsx)("div",{className:nL.F3})]})}var nP=s(865702),nR=s(269751),nD=s(687994),nF=s(270351),nq=s(627346),nG=s(338371),nU=s(605985),nK=s(890030),nH=s(985791),nB=s(269083),nV=s(431422),n$=s(118296);let nW=function({isLoading:e,children:t}){return e?(0,n.jsx)("div",{className:"maybe_loading--loadingContainer--b4J-r",children:(0,n.jsx)(sv.k,{})}):(0,n.jsx)(n.Fragment,{children:t})};var nY=s(19047),nX=s(562418),nZ=s(920675),nJ=s(996399),nQ=s(63938);let n0=new nJ.KH({keys:[{name:"name",weight:.6},{name:"containingFrame.name",weight:.1},{name:"containingFrame.pageName",weight:.1},{name:"description",weight:.05}],threshold:.3,tokenize:!0,shouldSort:!0});function n1(){var e;let t=(0,nX.lg)()===nZ._Y.SITES,s=(0,eQ.ce)(),n=s.data?.assetsByLibraryKey,i=a.useMemo(()=>(0,nQ.u)(),[]),r=a.useMemo(()=>{let e=n?[...n?.values()].flat():[];return e?[...e,...i]:void 0},[n,i]),{query:l,searchOption:o}=(0,nB.I)(nV.Cn.AssetsPanel),c=t&&o&&[eR.IS.SITE_KIT,eR.IS.ALL].includes(o?.type),d=(0,X.$)(r),x=(0,nu.ZC)(l),[m,p]=a.useState([]),[h,g]=a.useState(!1);return a.useLayoutEffect(()=>{(async function(){if(d&&n0.set(r??[]),!l||0===n0.list().length){p([]);return}x||g(!0);let e=[];try{e=(await n0.search(l)).map(e=>e.item)}catch(e){(0,nY.x1)(q.e.DESIGN_SYSTEMS_ECOSYSTEM,"error in site kit search",{message:e.message},{reportAsSentryError:!0})}p(e),g(!1)})()},[r,x,l,d]),e=m.length,a.useEffect(()=>{(0,eB.hw)(e)},[e]),(0,u.h)(()=>()=>(0,eB.hw)(0)),{results:c?m:[],loading:h,query:l}}let n5="asset_panel_search_results--empty--ryPy0",n2=(0,ei.jz)(e_.ce),n3=(0,ei.jz)(e_.GH),n4=(0,ei.jz)(e_.RX),n6="Search keywords and filter results by specific libraries, templates, and components.",n7=({moreResults:e,query:t,showMoreDefault:s})=>{let r=!!(0,v.GM)()(),[l,o]=a.useState(!1),c=s||l||r,d=a.useCallback(()=>o(!0),[]);a.useEffect(()=>o(!1),[t]);let{visualAssetsType:u}=(0,T.wV)(),x=r&&!!u,m=a.useMemo(()=>e.map(e=>e.library_key),[e]),{data:p}=(0,nH.U)(m),h=a.useCallback(e=>p?.[e.library_key]??"",[p]),[g]=(0,eC.MA)(),f=(0,eO.O)(),{props:_,numColumns:y}=a.useMemo(()=>(0,eO.Z)(f,g,el.rp.NORMAL),[f,g]),{componentSectionNameForTracking:k}=(0,eb.zf)({moreSearchResults:!0}),b=a.useMemo(()=>(0,eS.Ij)(e,y,"components:moreResults",_,k,[et.tM.COMPONENTS,1],{getFileName:h}),[e,y,_,k,h]);return a.useMemo(()=>{if(0===e.length)return[];let t=[];return x||t.push({element:(0,n.jsxs)("div",{className:r?"asset_panel_search_results--visualAssetsShowMoreText--QIQva asset_panel_search_results--visualAssetsShowMore--z-MG3":"asset_panel_search_results--showMoreText--27cy0 asset_panel_search_results--showMore--NyKaM",children:[c&&(0,i.tx)("design_systems.assets_panel.showing_results_from_all_libraries"),!c&&(0,n.jsx)("button",{className:"asset_panel_search_results--showMoreLink--4GhqG asset_panel_search_results--showMore--NyKaM blue_link--blueLink--4ER8T",onClick:d,children:(0,i.tx)("design_systems.assets_panel.more_results_in_all_libraries",{results:e.length})})]}),key:"components:showMoreText",height:r?n4:n3}),c&&t.push(...b),t},[e.length,c,d,b,x,r])};function n8({components:e,moreComponents:t,siteKitAssets:s,query:r,getLibraryNameFromKey:l}){let o=aa(e),c=aa(t),d=o.length+c.length>0,u=s.length>0,x=a.useCallback(e=>l(e.library_key),[l]),[m]=(0,eC.MA)(),p=(0,eO.O)(),{props:h,numColumns:g}=a.useMemo(()=>(0,eO.Z)(p,m,el.rp.NORMAL),[p,m]),{componentSectionNameForTracking:f}=(0,eb.zf)(),_=a.useMemo(()=>(0,eS.Ij)(o,g,"components",h,f,[et.tM.COMPONENTS,0],{getFileName:x}),[o,g,h,f,x]),y=n7({moreResults:c,query:r,showMoreDefault:0===o.length&&c.length>0}),[k,v]=(0,a.useState)(!1),[b,j]=(0,a.useState)(!1),C=(0,eQ.r6)(s),w=a.useMemo(()=>to(s,g,h.thumbWidth,h.thumbHeight,m,"assets","Site kit search results",[et.tM.SITE_KIT],{libraryNameForAsset:C}),[m,g,h.thumbHeight,h.thumbWidth,C,s]),E=a.useMemo(()=>{let e=[];return u&&(e.push({element:(0,n.jsx)(eN.X3,{title:(0,i.t)("design_systems.assets_panel.site_blocks"),numResults:s.length,toggleExpanded:()=>v(e=>!e),isExpanded:!k,collapsible:!0}),key:"sitesHeader",height:n2}),k||e.push(...w)),d&&(u&&e.push({element:(0,n.jsx)(eN.X3,{title:(0,i.t)("design_systems.assets_panel.dropdown_type_all_libraries"),numResults:o.length,toggleExpanded:()=>j(e=>!e),isExpanded:!b,collapsible:!0}),key:"componentsHeader",height:n2}),b||(e.push(..._),e.push(...y))),e},[u,d,s.length,k,w,b,o.length,_,y]);return(0,n.jsx)(eS.wl,{elements:E,anchorScroll:!0})}function n9(){return(0,T._m)()?(0,n.jsx)(at,{}):(0,n.jsx)(ae,{})}function ae(){let{query:e,results:t,isLoading:s}=(0,nB.I)(nV.Cn.AssetsPanel),{normalizedSearchResults:r,unsubscribedSearchResults:l}=t,o=n1(),c=(0,n$.U)(),{libraryKey:d}=(0,T.wV)(),{getLibrary:u}=(0,eE.G)(),x=a.useMemo(()=>r.map(e=>e.library_key),[r]),{data:m,status:p}=(0,nH.U)(x),h=as(e),g="loading"===p,f=g&&h,_=a.useCallback(e=>m?.[e]??u(e)?.name??"",[m,u]),y=a.useMemo(()=>d?u(d)?.name:void 0,[u,d]),[,k]=a.useMemo(()=>(0,eB._2)(r.filter(e=>_(e.library_key))),[r,_]),[,v]=a.useMemo(()=>(0,eB._2)(l),[l]),b=k.length+v.length>0,j=o.results.length>0,C=f||s||c||o.loading;return an({query:e,isLoading:C,isLoadingBreakdown:{isLibraryNamesLoadingWithTimeout:f,isSearchLoading:s,isSubscribedComponentsLoading:c},additionalLogData:{isLibraryNamesLoading:g,isLibraryNamesLoadingTimerActive:h}}),e?(0,n.jsx)(nW,{isLoading:C,children:b||j?(0,n.jsx)(n8,{components:k,moreComponents:v,siteKitAssets:o.results,query:e,getLibraryNameFromKey:_}):(0,n.jsx)(nR.T,{role:"alert",className:n5,children:y?(0,i.tx)("design_systems.assets_panel.no_results_for_query_in_library",{searchQuery:e,libraryName:y}):(0,i.tx)("design_systems.assets_panel.no_results_for_query",{searchQuery:e})})}):(0,n.jsx)("div",{className:n5,children:n6})}function at(){let{results:e,loading:t,query:s}=n1(),{libraryKey:r}=(0,T.wV)(),[l]=(0,eC.MA)(),{getLibrary:o}=(0,eE.G)(),c=a.useMemo(()=>r?o(r)?.name:void 0,[o,r]),{width:d}=(0,eD.G)(),{tileHeight:u,tileWidth:x,numColumns:m}=(0,eF.Ef)(d),p=a.useMemo(()=>to(e,m,x,u,l,"assets","Site kit search results",[et.tM.COMPONENTS],{includesFirstTile:!0}),[l,m,e,u,x]);return s?(0,n.jsx)(nW,{isLoading:t,children:e.length>0?(0,n.jsx)(eS.wl,{elements:p,anchorScroll:!0}):(0,n.jsx)(nR.T,{role:"alert",className:n5,children:(0,i.tx)("design_systems.assets_panel.no_results_for_query_in_library",{searchQuery:s,libraryName:c})})}):(0,n.jsx)("div",{className:n5,children:n6})}let as=e=>{let t=(0,nu.ZC)(e),{isActive:s,start:n}=(0,nG.Z)(nP.lQ);return a.useEffect(()=>{e!==t&&n(1e4)},[e,t,n]),s},an=({isLoading:e,isLoadingBreakdown:t,additionalLogData:s,query:n})=>{let i=(0,nu.ZC)(e),r=(0,nu.ZC)(n),[l,c]=a.useState(null),d=(0,nU.iZ)(),u=(0,nD.DP)().version,x=(0,eK.tM)("assets-panel"),m=(0,nu.ZC)(x),p=(0,_.je)(),h=(0,F.d4)(e=>e.fileVersion),g=(0,F.d4)(e=>e.loadingState),y=(0,f.q5)(),k=y?.key,v=(0,ee.oh)(nq.fi),b=a.useCallback(n=>{if(!l)return;let a=Date.now()-l;if(a<5e3)return;let i=p.data?.map(e=>{let t=nK.Mb(e.libraryKey);return{libraryKey:e.libraryKey,isLoading:!ee.D2(g,t)}}),r=y&&null!=h&&(0,es.yD)(y.key)||null,c=!(null!=r&&(0,ee.D2)(g,r));o.az.trackDefinedEvent("assets_panel.search_long_loading",{...t,...s,fileKey:k,userId:d?.id,uiThemeVersion:u,queryId:x??m??void 0,loadingTimeMS:a,isLoading:e,queryCancelled:n,isLoadingSubscribedComponentsAndStateGroups:c,isLoadingRecentlyUsedItems:v,subscribedLibariesLoading:JSON.stringify(i)})},[p,h,g,y,l,e,t,v,k,s,d?.id,u,x,m]),j=(0,nF.A)(b,100,{leading:!0,trailing:!1}),C=a.useRef(b);a.useEffect(()=>{C.current=b},[b]);let{start:w,cancel:E}=(0,nG.Z)(()=>j(!1)),N=a.useCallback(()=>{b(!0),c(Date.now()),w(5e3)},[b,w]);a.useEffect(()=>{e&&!i?N():!e&&i&&(E(),b(!1),c(null))},[e,i,N,b,E]),a.useEffect(()=>{n!==r&&N()},[n,r,N]),a.useEffect(()=>()=>{C.current(!0)},[])};function aa(e){let{visualAssetsType:t}=(0,T.wV)(),s=!!(0,v.GM)()(),n=(0,eI.md)(t9.QN),i=(0,eI.md)(t9.r9),r=s&&!!t;return a.useMemo(()=>r?e.filter(e=>e.hub_file_id&&(t===T.G3.IconSets?n.includes(e.library_key):i.includes(e.library_key))):e,[r,e,t,n,i])}var ai=s(986465);function ar({libraryKey:e,numComponents:t,size:s}){let{focusSearchBar:i}=(0,ej.rl)(),{navigateToLibrary:r}=(0,T.wV)(),l=(0,eb.sN)(),o=a.useCallback(()=>{l("visualAssetMoreTile",r(e))},[e,l,r]),c=a.useCallback(e=>{e.stopPropagation(),o(),i()},[i,o]),d=t-11,u=d>=1e3?(d/1e3).toFixed(1)+"k":d.toString();return(0,n.jsx)("button",{onClick:c,className:"asset_panel_visual_asset_more_tile--tile--H2HnV",style:{width:s,height:s},children:(0,n.jsxs)("div",{className:"asset_panel_visual_asset_more_tile--moreText--S-ziz text--fontPos13--5OfL8 text--_fontBase--VaHfk",children:["+",u]})})}function al({libraryKey:e,sectionIndex:t}){let{width:s}=(0,eD.G)(),i=(0,eI.md)(t9.Rs),{getLibrary:r}=(0,eE.G)(),l=r(e),o=l?.type===et.yW.DESIGN?l.numComponents:0,c=a.useMemo(()=>{if(l?.type===et.yW.DESIGN)return Array.from(l.pages.values())},[l]),d=[];if(c?.[0]?.components&&l?.libraryKey){let e=i?.[l?.libraryKey]?.asset_panel_component_ids||[];if(e.length>=11){let t=[];c.forEach(s=>{if(s.components){let n=(0,eT.rJ)(s.components).filter(t=>"component_key"in t&&e.includes(t.component_key||""));t.push(...n)}});let s=t.reduce((e,t)=>("component_key"in t&&t.component_key&&(e[t.component_key||""]=t),e),{});d=e.map(e=>s[e]).filter(e=>!!e)}else d=(0,eT.rJ)(c[0].components).slice(0,11)}let u=(0,el.PI)(d,!0),x=(s-24-24)/4,m={showName:!1,noBackground:!0};return d.length?(0,n.jsx)("div",{className:"asset_panel_visual_asset_components--container--uX8QJ",children:[0,1,2].map(s=>(0,n.jsxs)("div",{className:"asset_panel_visual_asset_components--row--KLH-U",children:[d.slice(4*s,(s+1)*4).map((e,a)=>(0,n.jsx)(nM.z,{asset:e,disableClickPropagation:!0,displayType:"grid",fileName:void 0,hideInlineName:!0,isFirstTile:!1,isVisualAsset:!0,keyboardPosition:{path:[t,s],column:a},libraryItemTileProps:m,sectionDepth:a,sectionNameForTracking:"Visual assets panel",sectionPosition:s*a,sourceForTracking:"visual-assets-panel",thumbHeight:x,thumbLayout:u,thumbWidth:x,viewMode:eY.Bk.Grid},`$visualAssetsPanel:component:${(0,eP.V)(e)}`)),2===s&&(0,n.jsx)(ar,{libraryKey:e,numComponents:o,size:x})]},s))}):null}function ao({library:e,sectionIndex:t}){let{navigateToLibrary:s}=(0,T.wV)(),i=(0,f.q5)(),[r,o]=a.useState(!1),c=(0,eb.sN)(),d=a.useCallback(()=>{c("visualAssetLibraryCard",s(e.libraryKey))},[e,c,s]),u=a.useMemo(()=>{let t=e.libraryKey===i?.libraryKey?"localLibrary":e.libraryKey;return tI.Pt("assetsLibrary",t)},[e.libraryKey,i?.libraryKey]);return(0,n.jsx)(em.GG,{className:l()("asset_panel_visual_asset_library--library--MiXiO",{"asset_panel_visual_asset_library--hovered--N-kdY":r}),"aria-label":e.name,onClick:d,style:{width:"100%"},recordingKey:u,children:(0,n.jsxs)("div",{className:"asset_panel_visual_asset_library--libraryCard--nfYYV",children:[(0,n.jsx)(al,{libraryKey:e.libraryKey,sectionIndex:t}),(0,n.jsx)(ac,{library:e,setHovered:o})]})})}function ac({library:e,setHovered:t}){let s=(0,eI.md)(t9.Rs),a=s?.[e.libraryKey]?.author_name||e.authorName;return(0,n.jsx)("div",{className:"asset_panel_visual_asset_library--libraryFooter--uMM9G",onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1),children:(0,n.jsxs)("div",{className:"asset_panel_visual_asset_library--libraryNameAndAuthor--AHmiH",children:[(0,n.jsxs)("div",{className:"asset_panel_visual_asset_library--nameAndIconForList--BLv6X",children:[(0,n.jsx)("h3",{className:"asset_panel_visual_asset_library--libraryName--JT3Ge ellipsis--ellipsis--70pHK",children:e.name}),(0,n.jsx)("div",{className:"asset_panel_visual_asset_library--libraryIcon--vTXaI",children:(0,n.jsx)(t8.P,{libraryKey:e.libraryKey,compact:!0,showPresetTooltip:!0,colorPrimaryOnHover:!0,tooltipDelay:500,tooltipLocation:"below"})})]}),a&&(0,n.jsx)("div",{className:"asset_panel_visual_asset_library--libraryStats--hEv1P ellipsis--ellipsis--70pHK",children:(0,i.tx)("community.by_publisher",{publisher:a})})]})})}var ad=s(10266);let au=(0,x._d)(function({width:e}){let{visualAssetsType:t}=(0,T.wV)(),s=(0,nu.qd)(t),a=t??s,[i]=(0,eC.MA)(),r="list"===i,o=(0,ai.lY)(),c=o.length>0,d=(0,eI.md)(t9.QN),u=(0,eI.md)(t9.r9),{cardWidth:x,previewHeight:m}=s2({sidebarWidth:e}),p=o.filter(e=>a===T.G3.IconSets?d.includes(e.library_key):u.includes(e.library_key));return(0,n.jsxs)(eN.xU,{children:[c&&(0,n.jsx)("div",{className:l()("asset_panel_visual_assets--list--1K-cB",{"asset_panel_visual_assets--gridGap--2e5Qi":!r}),children:p.map((e,t)=>{let s=(0,ad.x)(e);return r?(0,n.jsx)(sB,{library:s,keyboardSection:et.gP.VISUAL_ASSETS,rowIndex:t,columnIndex:0,cardWidth:x,previewHeight:m,hideUnsubscribe:!0},e.library_file_key):(0,n.jsx)(ao,{library:s,sectionIndex:t},e.library_file_key)})}),(0,n.jsx)("div",{className:"asset_panel_visual_assets--bottomPadding--VWVzZ"})]})},"AssetPanelVisualAssets");var ax=s(60601);let am=(e,t,s)=>e===T.S5.Libraries?0:s?e===T.S5.VisualAssets?1:e===T.S5.Pages||t?2:3:e===T.S5.Pages||t?1:2;function ap({assetPanelItemsByLibraryKey:e,width:t}){let{libraryKey:s,pageId:i,currentView:r,isNavigatingVisualAssets:l}=(0,T.wV)(),{previousLibraryKey:c}=(0,T.RR)(),d=ah(),u=!!(0,v.GM)()(),{getPage:x,getLibrary:m}=(0,eE.G)(),p=(0,n$.q)()(s);(function(e){let t=(0,F.d4)(e=>e.loadingState),s=(0,F.d4)(e=>e.fileVersion),n=(0,f.q5)(),i=(0,en.k)(),r=n&&null!=s&&(0,es.yD)(n.key)||null,l=!(null!=r&&(0,ee.D2)(t,r));a.useEffect(()=>{l||function(e,t,s){if(ea)return;let{numLibraries:n,numComponents:a,numComponentsWithLimit:i}=e();(0,o.sx)("Assets Panel Initial Load",{numLibraries:n,numComponents:a,numComponentsWithLimit:i,assetsPanelVersion:t,fileKey:s?.key,fileTeamId:s?.teamId??void 0,fileOrgId:s?.parentOrgId??void 0}),ea=!0}(e,i,n)},[e,l,n,i])})(a.useCallback(()=>{let t=0,s=0,n=0,{allLibrariesUnsorted:a}=e;for(let[i,r]of a)if(r.type===et.yW.DESIGN){if(e.localAssets.libraryKey===i){r.numComponents>=0&&(t+=1);continue}t+=1,s+=r.numComponents,n+=Math.min(r.numComponents,20)}return{numLibraries:t,numComponents:s,numComponentsWithLimit:n}},[e])),ag(),(0,Z.Sq)();let h=a.useMemo(()=>m(s??c),[m,s,c]),g=a.useMemo(()=>x(s,i),[x,s,i]),_=am(r,d,u&&l),{libraries:y,presets:k,librariesForConnectedProject:b}=(0,s4.g)(),{localAssets:j}=e;return!function(e,t,s,n){let i=(0,f.q5)(),[r,l]=(0,eI.fp)(ax.GT),c=t.length+s.length+n.length;e.numComponents+e.numTemplates>0&&(c+=1),a.useEffect(()=>{if(!r){l(!0);let e=ax._o.stop();e&&(0,o.sx)(ax.YS,{elapsedMs:e,fileKey:i?.key,teamId:i?.teamId,orgId:i?.parentOrgId,isUi3RedesignedAssetPanel:!0,numLibraries:c,numComponents:0,numComponentsShown:0,numSectionsShown:c},{forwardToDatadog:!0})}},[r,l,c,i])}(j,y,k,b),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tZ,{}),r===T.S5.Search?(0,n.jsx)(n9,{}):r===T.S5.Recents?(0,n.jsx)(nO,{}):(0,n.jsxs)(tc.A,{index:_,width:t,children:[(0,n.jsx)(ni,{width:t,hideScrollbar:0!==_,localAssets:j}),u&&l&&(0,n.jsx)(au,{width:t}),!d&&(0,n.jsx)(nT,{library:h,width:t,isLoading:p,hideScrollbar:1!==_}),(0,n.jsx)(tp,{page:g,width:t})]})]})}let ah=()=>{let{getLibrary:e}=(0,eE.G)(),{libraryKey:t}=(0,T.wV)(),s=(0,n$.q)()(t),n=e(t);return!!n&&!s&&!!(0,T.Cg)(n)},ag=()=>{let{libraryKey:e}=(0,T.wV)(),t=(0,J.R)(),s=(0,X.$)(e),n=(0,Q.fd)(e);a.useEffect(()=>{n&&s&&t({updateSource:"ui3_library_expand"})},[s,n,t])};var af=s(540892),a_=s(941634);let ay=e=>a.useCallback(t=>{t()||e()},[e]);var ak=s(719749),av=s(249487),ab=s(610604),aj=s(907490),aC=s(329076),aw=s(475272),aE=s(380219),aN=s(211735);function aS(e){return(0,n.jsx)(x.u9,{label:"AssetPanel",children:(0,n.jsx)(aT,{...e})})}function aT({width:e}){let t=(0,aE.z)(),s=function(e){let t=(0,nU.iZ)(),s=(0,f.q5)(),n=(0,aj.jO)(),i=(0,E.f)("has_dismissed_component_sidebar_library_upsell_banner"),r=(0,F.d4)(e=>e.isFreeUser),l=(0,F.d4)(aw.P),o=s?.teamId?l[s.teamId]:null,c=(0,ak.bc)(ab.kQI,{id:s?.teamId??""},{enabled:!!s?.teamId}),d=s?.canEdit??!1,u=c.data?.team?.hasPermission??!1,x=e.numComponents>0||e.numTemplates>0;return a.useMemo(()=>!i&&r&&(!o||!(0,aC.w5)(o)&&u)&&d&&n&&x&&(0,av.Hz)(t?.id),[i,r,o,u,d,n,x,t])}(t.localAssets),i="loading"===(0,_.je)().status,r=a.useRef(null),l=d.wY(r)?.width||e,[c]=(0,eC.MA)(),x=(0,f.q5)();(0,u.h)(()=>{(0,o.sx)("Component Sidebar Viewed",{viewMode:c,assetsPanelVersion:3,fileKey:x?.key,fileTeamId:x?.teamId??void 0,fileOrgId:x?.parentOrgId??void 0,componentSuggestionSessionId:(0,P.r6)()})});let{isFlyoutOpen:m,closeFlyout:p,flyoutProps:h}=(0,D.JA)(),y=a.useCallback(e=>{let t=document.getElementById(D.Ev);m||!t||!r.current||!e.relatedTarget||r.current.contains(e.relatedTarget)||t.contains(e.relatedTarget)||p()},[m,p]);return(0,n.jsxs)(aI,{assetPanelItemsByLibraryKey:t,width:l,children:[(0,n.jsx)("div",{className:aN.kL,"data-testid":"component-sidebar",translate:"no",ref:r,onBlur:y,children:(0,n.jsxs)("div",{className:aN.kL,style:{width:l},children:[(0,n.jsx)(af.E,{}),(0,n.jsx)(nW,{isLoading:i,children:(0,n.jsx)(ap,{assetPanelItemsByLibraryKey:t,width:l})}),s&&(0,n.jsx)(Y,{}),(0,n.jsx)("div",{style:{left:`${l}px`,top:"240px"},className:aN.b3,"data-onboarding-key":g.RJ}),(0,n.jsx)(O,{width:l})]})}),h&&(0,n.jsx)(R.w,{...h})]})}function aI({children:e,width:t,assetPanelItemsByLibraryKey:s}){let a=(0,p.b)();return(0,n.jsx)(eM.P3,{children:(0,n.jsx)(eE.K,{assetPanelItemsByLibraryKey:s,children:(0,n.jsx)(ej.tM,{className:l()(aN.kL,a&&aN.Nb),children:(0,n.jsx)(aA,{children:(0,n.jsx)(eD.L,{width:t,children:e})})})})})}function aA({children:e}){return!function(){let{libraryKey:e,pageId:t,folderPath:s,navigateToTop:n,navigateToPage:i,navigateToPath:r,navigateToLibrary:l,currentView:o,onBack:c}=(0,T.wV)(),d=(0,n$.q)(),u=d(e),{getLibrary:x,getFolder:m}=(0,eE.G)(),{setLastNavAction:p}=(0,eM.ZX)(),h=ay(n),g=(0,s4.g)().allLibrariesByLibraryKey,[f,_]=(0,eI.fp)(a_.dL);a.useEffect(()=>{f&&g.size>0&&((0,eb.hB)(()=>l(f)),_(null))},[l,g.size,f,_]),(0,T.sH)(),a.useEffect(function(){if(o!==T.S5.Assets&&o!==T.S5.Pages)return;let a=x(e),l=g.get(e);if(!a){if(d(e)&&l&&o!==T.S5.Assets)return;h(n);return}if(t){if(!a?.pages.get(t)){let e=(0,T.Cg)(a);e?h(()=>i(e.id)):h(c);return}if(s&&!m(e,t,s)){let n=s.slice(0,-1),a=m(e,t,n);for(;!a&&n.length>0;)a=m(e,t,n=n.slice(0,-1));if(!a)return h(()=>i(t));let l=parent?(0,T.xc)(a):void 0;return void(l?h(()=>r([...n,l.name])):(h(()=>r(n)),p(eM.r6.Back)))}}},[c,u,o,t,s,n,i,x,m,r,p,h,d,g,e]),a.useEffect(function(){let n=x(e);if(!n||u)return;let a=(0,T.Cg)(n);if(o===T.S5.Pages&&a)i(a.id);else if(o===T.S5.Assets){let n=m(e,t,s);if(!n)return;let a=(0,T.xc)(n);a&&r([...s??[],a.name])}},[u,o,s,m,x,i,r,c,t,e])}(),(0,n.jsx)(n.Fragment,{children:e})}function aM(){return(0,n.jsx)("div",{className:h.s.colorTextSecondary.my8.mx16.$,children:(0,i.tx)("design_systems.assets_panel.error")})}function az({width:e}){return(0,n.jsx)(c.k,{id:"AssetPanelUI3",children:(0,n.jsx)(x.u9,{label:"AssetPanelUI3",children:(0,n.jsx)(m.tH,{boundaryKey:"AssetPanelUI3",fallback:(0,n.jsx)(aM,{}),children:(0,n.jsx)(aS,{width:e})})})})}},767584:(e,t,s)=>{s.d(t,{Q:()=>W});var n=s(239976),a=s(105652),i=s(378721),r=s(64939),l=s(379141),o=s(7857),c=s(407186),d=s(805242),u=s(20002),x=s(22291),m=s(224542),p=s.n(m),h=s(86930),g=s.n(h),f=s(620030),_=s(564669),y=s(901962),k=s(154963),v=s(770785),b=s(450207),j=s(324880),C=s(964731),w=s(223487),E=s(236410),N=s(332748),S=s(675341),T=s(365841),I=s(332477),A=s(209067),M=s(377801),z=s(584441),L=s(380219),O=s(65235);let P="asset_panel_collapsible_breadcrumb--buttonStub--aO4eI asset_panel_collapsible_breadcrumb--_buttonStubBase--UI4co",R="asset_panel_collapsible_breadcrumb--libraryStubStatic--j3fge asset_panel_collapsible_breadcrumb--_buttonStubBase--UI4co asset_panel_collapsible_breadcrumb--_libraryStubBase--1-i2Q";function D({stubs:e}){let{collapsibleStubs:t,lastStub:s,numHiddenStubs:i,breadcrumbRef:r,ellipsisRef:l,stubRefs:o}=F(e),c=a.useCallback(()=>l.current?{top:l.current.getBoundingClientRect().bottom,left:l.current.getBoundingClientRect().left}:{top:0,left:0},[l]),d=i===t.length;return(0,n.jsxs)("div",{className:k.s.flex.itemsCenter.overflowHidden.flexShrink1.flexGrow1.$,style:v.sx.add({flexBasis:"content"}).$,ref:r,role:"navigation","data-onboarding-key":N.we,children:[(0,n.jsx)(U,{shouldEllipsize:d}),i>0&&(0,n.jsx)(G,{allStubs:t,numHiddenStubs:i,getDropdownTarget:c,ref:l}),t.map((e,t)=>t<i?null:(0,n.jsx)(K,{i:t,name:e,ref:e=>o.current[t]=e},t)),e.length>0?(0,n.jsx)(H,{name:s,firstSlash:0===t.length,shouldEllipsize:d}):null]})}let F=e=>{let[t,s]=a.useMemo(()=>0===e.length?[[],void 0]:[e.slice(0,-1),e[e.length-1]],[e]),[n,i]=a.useState([]),r=a.useRef([]);a.useEffect(function(){r.current.length>t.length&&(r.current=r.current.slice(0,t.length)),n.length>t.length&&i(e=>e.slice(0,t.length))},[t,n.length,e.length]);let l=a.useRef(null),o=a.useRef(null),{width:c}=(0,T.G)();return a.useLayoutEffect(function(){let e=l.current;if(!e)return;let t=e.children,s=e.offsetWidth-g()(Array.from(t).map(e=>e.scrollWidth));if(s<0){let e=r.current[n.length];e&&i(t=>[...t,e.scrollWidth])}else if(0===s)return;else if(n.length>0){let e=n.length-1;s>n[e]-(o.current&&1===n.length?o.current.scrollWidth:0)&&i(e=>e.slice(0,-1))}},[n,r,e,c]),{collapsibleStubs:t,lastStub:s,numHiddenStubs:n.length,breadcrumbRef:l,ellipsisRef:o,stubRefs:r}},q="asset-panel-ellipsis-menu",G=a.forwardRef(({numHiddenStubs:e,allStubs:t,getDropdownTarget:s},i)=>{let r=(0,I.sN)(),l=(0,C.Um)(),o=l?.type===q,c=(0,u.wA)(),x=a.useCallback(()=>c((0,b.oB)()),[c]),m=a.useCallback(()=>c((0,b.j7)({type:q,data:{position:s()}})),[c,s]),{isCurrentlySkippingPage:h,isCurrentlySkippingFirstFolder:g,navigateBackToPathIndex:_}=(0,z.wV)(),v=a.useMemo(()=>t.slice(0,e),[t,e]),w=a.useMemo(()=>v.join(" / "),[v]),N=a.useMemo(()=>{if(o)return l.data?.position},[l?.data?.position,o]),T=a.useCallback(e=>{r("breadcrumb",_(V(e,h,g)))},[g,h,r,_]),{focusBackButton:M,focusSearchBar:L}=(0,A.rl)(),O=(0,A.NR)({onBoth:e=>()=>{T(e)},onKeyDown:()=>()=>{setTimeout(()=>M(),0)},onClick:()=>L}),{setKeyboardNavigationElement:R}=(0,y.M3)({path:[S.ON.BREADCRUMB],column:S.Yv.ELLIPSIS}),D=p()(P,{"asset_panel_collapsible_breadcrumb--dropdownOpen--MASNJ":o});return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{ref:i,className:k.s.flex.itemsCenter.$,children:[(0,n.jsx)(B,{}),(0,n.jsx)("button",{ref:R,className:D,onClick:m,"data-tooltip-type":E.Ib.TEXT,"data-tooltip":w,"aria-label":w,"aria-haspopup":"listbox","aria-expanded":o,children:"\u2026"})]}),o&&d.createPortal((0,n.jsx)(f.X3,{className:j.Dm,positionAbsolute:!0,style:N,id:"asset-panel-ellipsis-menu",hideDropdown:x,autofocusPrevElementOnEsc:!0,children:v.map((e,t)=>(0,n.jsx)(f.c$,{onClick:O(t),children:e},e))}),document.body)]})});function U({shouldEllipsize:e}){let t=(0,w._G)(),{allLibrariesByLibraryKey:s}=(0,O.g)(),{currentView:i,libraryKey:r,visualAssetsType:o,navigateToLibrary:c,isCurrentlySkippingPage:d,isCurrentlySkippingFirstFolder:u,folderPath:m}=(0,z.wV)(),{setLastNavAction:h}=(0,M.ZX)(),{focusBackButton:g,focusSearchBar:f}=(0,A.rl)(),_=function(){let{libraries:e,siteLibraries:t,librariesForConnectedProject:s}=(0,O.g)(),n=(0,L.z)().localAssets,i=s.length>0,r=a.useMemo(()=>{let s=e.length>0,a=n.numComponents+n.numTemplates>0;return s||a||"disabled"!==t.status},[e,t.status,n]);return i&&!r}(),v=a.useMemo(()=>r?r===t?(0,l.t)("design_systems.assets_panel.created_in_this_file"):s.get(r)?.name:void 0,[r,t,s]),b=(0,I.sN)(),j=i===z.S5.Libraries,C=i===z.S5.Pages,E=i===z.S5.Recents,N=i===z.S5.VisualAssets,T=a.useMemo(()=>!!C||!!d&&(!m||!!u&&1===m.length),[m,u,d,C]),P=a.useCallback(e=>{let t=c(e);h(M.r6.Back),b("breadcrumb",t)},[b,c,h]),D=(0,A.MB)({onBoth:()=>P(r??(0,x.l)("")),onKeyDown:g,onClick:f}),{setKeyboardNavigationElement:F}=(0,y.M3)({path:[S.ON.BREADCRUMB],column:S.Yv.LIBRARY}),q=p()(C?R:"asset_panel_collapsible_breadcrumb--libraryStub--6TKdw asset_panel_collapsible_breadcrumb--buttonStub--aO4eI asset_panel_collapsible_breadcrumb--_buttonStubBase--UI4co asset_panel_collapsible_breadcrumb--_libraryStubBase--1-i2Q",{"asset_panel_collapsible_breadcrumb--ellipsized---artx ellipsis--ellipsis--70pHK":e});return j?(0,n.jsx)("div",{className:"asset_panel_collapsible_breadcrumb--allLibraries--m0UCh asset_panel_collapsible_breadcrumb--libraryStubStatic--j3fge asset_panel_collapsible_breadcrumb--_buttonStubBase--UI4co asset_panel_collapsible_breadcrumb--_libraryStubBase--1-i2Q",children:_?(0,l.tx)("design_systems.libraries_modal.connected_project_libraries"):(0,l.tx)("design_systems.assets_panel.dropdown_type_all_libraries")}):E?(0,n.jsx)("div",{className:R,children:(0,l.tx)("design_systems.assets_panel.dropdown_type_recents")}):N?(0,n.jsx)("div",{className:R,children:o===z.G3.IconSets?(0,l.tx)("design_systems.assets_panel.icon_sets"):(0,l.tx)("design_systems.assets_panel.illustrations")}):(0,n.jsx)("div",{className:k.s.flex.overflowHidden.$,children:(0,n.jsx)("button",{onClick:D,className:q,disabled:T,ref:F,type:"button",children:v})})}let K=a.forwardRef(({name:e,i:t},s)=>{let{isCurrentlySkippingPage:i,isCurrentlySkippingFirstFolder:r,navigateBackToPathIndex:l}=(0,z.wV)(),o=(0,I.sN)(),c=a.useCallback(e=>{o("breadcrumb",l(e))},[o,l]),d=a.useMemo(()=>V(t,i,r),[t,r,i]),{setKeyboardNavigationElement:u}=(0,y.M3)({path:[S.ON.BREADCRUMB],column:S.Yv.STUBS+t}),{focusBackButton:x,focusSearchBar:m}=(0,A.rl)(),p=(0,A.MB)({onBoth:()=>c(d),onKeyDown:x,onClick:m});return e?(0,n.jsxs)("div",{ref:s,className:k.s.flex.itemsCenter.$,children:[(0,n.jsx)(B,{}),(0,n.jsx)("button",{ref:u,onClick:p,className:P,children:e})]}):null});function H({name:e,shouldEllipsize:t}){let s=a.useRef(null),{pageId:i,folderPath:r}=(0,z.wV)(),{width:l}=(0,T.G)(),[o,c]=a.useState(!1);return(a.useEffect(()=>{c(!!(0,_._C)({text:e??"",textRef:s}))},[e,l]),a.useEffect(()=>{setTimeout(()=>c(!!(0,_._C)({text:"",textRef:s})),0)},[i,r]),e)?(0,n.jsxs)("div",{className:k.s.noWrap.flex.itemsCenter.if(t,k.s.overflowHidden).$,children:[(0,n.jsx)(B,{}),(0,n.jsx)("div",{"data-tooltip-type":E.Ib.TEXT,"data-tooltip":o?e:void 0,ref:s,className:k.s.mx4.px2.if(t,k.s.overflowHidden.pre.ellipsis).$,"aria-current":"location",children:e})]}):null}function B(){return(0,n.jsx)("div",{className:"asset_panel_collapsible_breadcrumb--breadcrumbSlash--xBj4Z","aria-hidden":!0,children:" / "})}let V=(e,t,s)=>{let n=e;return t&&n++,s&&n++,n-1};var $=s(240766);function W(e){return(0,n.jsx)(o.u9,{label:"Breadcrumb",children:(0,n.jsx)(Y,{...e})})}function Y({page:e}){let{currentView:t,folderPath:s,onBack:o,libraryKey:d,isCurrentlySkippingPage:u,isCurrentlySkippingFirstFolder:x}=(0,z.wV)(),m=(0,I.sN)(),{closeFlyout:p}=(0,c.JA)(),{setBackButtonKeyboardItem:h,focusSearchBar:g}=(0,A.rl)(),f=a.useCallback(()=>{m("backButton",o()),p()},[o,m,p]),_=a.useCallback(()=>{t===z.S5.Recents?d||g():t===z.S5.Pages?g():t===z.S5.Assets&&u&&!s&&g()},[t,g,s,u,d]),y=(0,A.MB)({onBoth:f,onKeyDown:_,onClick:g}),k=a.useMemo(()=>{if(t===z.S5.Search||t===z.S5.Recents)return[];let n=e?.name&&!u?[e.name]:[],a=s??[];return[...n,...x?a.slice(1):a]},[t,s,u,x,e?.name]),v=(0,$.I)(),b=t!==z.S5.Libraries&&t!==z.S5.Search;return v?null:(0,n.jsx)(n.Fragment,{children:t!==z.S5.Search&&(0,n.jsxs)("div",{className:"asset_panel_header--breadcrumbWrapper--PmWHU asset_panel_header--horizontalFlex--mnHNu",children:[b&&(0,n.jsx)(i.K,{"aria-label":(0,l.t)("design_systems.assets_panel.back"),onClick:y,ref:h,recordingKey:"assetsPanelBack",children:(0,n.jsx)(r.C,{})}),(0,n.jsx)(D,{stubs:k})]})})}},365841:(e,t,s)=>{s.d(t,{G:()=>h,L:()=>g});var n=s(239976),a=s(105652),i=s(20002),r=s(270450),l=s(901962),o=s(536378),c=s(835427),d=s(597345),u=s(598713),x=s(527898),m=s(407186),p=s(332477);function h(){let e=a.useContext(u.U);return e?.isUi3?e:{...e,width:0}}function g({width:e,children:t}){let s=function(e){let t=(0,i.wA)(),{query:s,searchSessionId:n}=(0,c.Gq)(),u=(0,p.ht)(),h=(0,l.q_)(),g=(0,d.LR)(),f=(0,i.d4)(e=>e.universalInsertModal.showing),_=a.useCallback(()=>{f&&g()},[g,f]),{setFlyoutProps:y}=(0,m.JA)(),k=a.useCallback((a,i,l,c,d)=>{_();let m={asset:a,searchSessionId:n??void 0,query:s??void 0,sectionPosition:i,sectionNameForTracking:l,assetTypeDropdownSelection:u,containerWidth:e,onGetKeyboardNavigationItemById:h,sectionDepth:c,sourceForTracking:d};(0,r.kc)().dse_fpl_wave_2?y(m):t((0,o.to)({type:x.m,data:m}))},[_,n,s,u,e,h,y,t]);return a.useMemo(()=>({onOpenFlyout:k,assetTypeDropdownSelection:u,isUi3:!0,width:e}),[k,u,e])}(e);return(0,n.jsx)(u.U.Provider,{value:s,children:t})}},540892:(e,t,s)=>{s.d(t,{E:()=>eG,g:()=>eK});var n=s(239976),a=s(105652),i=s(727640),r=s(733200),l=s(379141),o=s(445019);s(323264);var c=s(348149),d=s(282746),u=s(840589),x=s(579263),m=s(916446),p=s(584441),h=s(267447),g=s(316157),f=s(363198),_=s(767584),y=s(332477),k=s(718286),v=s(20002),b=s(865702),j=s(103922),C=s(943360),w=s(321204),E=s(382367),N=s(854225),S=s(270450),T=s(522568),I=s(184743),A=s(29161),M=s(901962),z=s(562418),L=s(772293),O=s(223487),P=s(269083),R=s(431422),D=s(421564),F=s(321092),q=s(675341),G=s(209067);function U({libraryName:e}){let t=(0,v.wA)(),{currentView:s,startSearch:i,onBack:r,libraryKey:o,visualAssetsType:c}=(0,p.wV)(),u=s===p.S5.Search,x=(0,p._m)(),m=(0,z.cJ)(),{inputRef:h,focusSearchBar:f}=(0,G.rl)(),_=(0,d.b)(),y=(0,v.d4)(e=>e.leftPanel.shouldFocusSearchBar)||_,{query:k,setQuery:j,setSearchOption:C}=(0,P.I)(R.Cn.AssetsPanel),E=(0,O._G)(),M=a.useCallback(()=>{u&&r()},[u,r]),U=a.useMemo(()=>o?o===E?{type:D.IS.LOCAL}:x?{type:D.IS.SITE_KIT}:{type:D.IS.FILE,libraryKey:o}:{type:D.IS.ALL},[x,o,E]),K=a.useCallback(e=>{j(e),C(U),""===e?M():u||i()},[j,C,U,M,u,i]),H=a.useRef(void 0),B=(0,g.Nv)(!0);a.useEffect(()=>{u&&(k&&H.current!==o&&(T.az.trackDefinedEvent("asset_search.misc_feature_usage",{aiResultsEnabled:B,entryPoint:"asset-panel",featureSlug:"library-filter-usage"}),C(U)),H.current=o)},[t,u,k,U,B,C,o]);let V=a.useCallback(()=>{""===k&&M()},[M,k]),$=a.useCallback(()=>{K(""),f(),M()},[K,f,M]),W=(0,v.d4)(e=>e.mirror.appModel.activeCanvasEditModeType);a.useEffect(()=>{if((0,S.kc)().accessible_keyboard_shortcuts)return;let e=e=>{(A.Ay.chromeos?e.altKey&&e.shiftKey&&e.keyCode===I.Uz.KEY_2:e.altKey&&e.keyCode===I.Uz.KEY_2)&&W!==N.m1T.TEXT&&(f(),e.preventDefault())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[W,f]),a.useEffect(()=>{if((0,S.kc)().accessible_keyboard_shortcuts&&L.Y5.isReady())return L.Y5.assetsPanelKeyboardEvents.subscribe(f)},[f]);let Y=a.useMemo(()=>e?(0,l.t)("design_systems.assets_panel.search_library"):m?(0,l.t)("design_systems.assets_panel.search_all_sites_inserts"):c?c===p.G3.IconSets?(0,l.t)("design_systems.assets_panel.search_all_icon_sets"):(0,l.t)("design_systems.assets_panel.search_all_illustrations"):(0,l.t)("design_systems.assets_panel.search_all_libraries"),[e,c,m]);return(0,n.jsxs)("div",{className:"asset_panel_search--container--EhCdk asset_panel_search--horizontalFlex--nzaKH",children:[(0,n.jsx)("div",{children:(0,n.jsx)(w.W,{})}),(0,n.jsx)(F.E1,{autofocus:y,column:q.Wy.SEARCH,entryPointForTracking:"editor:assets_panel",forwardedRef:h,isNewAssetsPanel:!0,isVisible:!0,onBlur:V,onChange:K,onClearSearch:$,onFocus:b.lQ,path:[q.ON.HEADER,q.my.SEARCH_AND_FILTER],placeholder:Y,query:k,recordingKey:"componentsLibrarySearch",selectOnFocus:!0})]})}function K({library:e}){let{navigateToTop:t}=(0,p.wV)(),{focusSearchBar:s}=(0,G.rl)(),i=(0,y.sN)(),r=a.useCallback(()=>{i("searchFilterChip",t()),s()},[s,i,t]),{setKeyboardNavigationElement:o}=(0,M.M3)({path:[q.ON.HEADER,q.my.LIBRARY_SEARCH_CHIP]});return e?(0,n.jsx)(j.v,{"aria-label":(0,l.t)("design_systems.assets_panel.search_chip_label"),hasCloseButton:!0,onClose:r,recordingKey:"asset-panel-search-chip",ref:o,"data-testid":"asset-panel-search-chip",children:e.name}):null}function H({visualAssetsType:e}){let{navigateToTop:t}=(0,p.wV)(),{focusSearchBar:s}=(0,G.rl)(),i=(0,y.sN)(),r=a.useCallback(()=>{i("visualAssetsSearchFilterChip",t()),s()},[s,i,t]),{setKeyboardNavigationElement:o}=(0,M.M3)({path:[q.ON.HEADER,q.my.LIBRARY_SEARCH_CHIP]});return e?(0,n.jsxs)("div",{className:"asset_panel_search--libraryChip--WAJII asset_panel_search--horizontalFlex--nzaKH","data-testid":"asset-panel-visual-assets-search-chip",children:[(0,n.jsx)("span",{className:"asset_panel_search--libraryChipText--VphVX ellipsis--ellipsis--70pHK",children:e===p.G3.IconSets?(0,l.tx)("design_systems.assets_panel.icon_sets"):(0,l.tx)("design_systems.assets_panel.illustrations")}),(0,n.jsx)(C.E,{className:"asset_panel_search--libraryChipRemove--t9Izo",onClick:r,recordingKey:"asset-panel-visual-assets-search-chip",ref:o,children:(0,n.jsx)(E.f,{})})]}):null}var B=s(735786),V=s(796557),$=s(415839),W=s(751543),Y=s(533472),X=s(644404),Z=s(580664),J=s(22291),Q=s(424128),ee=s(154963),et=s(488051),es=s(975182),en=s(574463),ea=s(680940),ei=s(591791),er=s(835585),el=s(377801),eo=s(65235),ec=s(575987),ed=s(373191),eu=(e=>(e.RECENTS="recents",e.ALL_LIBRARIES="all_libraries",e))(eu||{});function ex({includeFolderSetting:e=!0}){let{setKeyboardNavigationElement:t}=(0,M.M3)({path:[q.ON.HEADER,q.my.SEARCH_AND_FILTER],column:q.Wy.SETTINGS}),s=(0,O.tS)(),{productComponents:i}=(0,ei.g5)(er.$A.Design),r=(0,ed.T)(),[c]=(0,ec.ye)(),{currentView:d,libraryKey:u}=(0,p.wV)(),{getLibrary:x}=(0,k.G)(),m=(0,O._G)(),[h]=(0,ec.MA)(),g=!!(0,et.GM)()()&&d===p.S5.Libraries,f=g?ec.$H.LIST:h,_=(0,z.cJ)()||g,v=a.useMemo(()=>d!==p.S5.Search&&(i.length>0||r.length>0),[d,i.length,r.length]),b=a.useMemo(()=>s&&m?x(m):void 0,[x,s,m]),j=b?.type===q.yW.DESIGN&&(b.numComponents>0||b.numTemplates>0),{libraries:C,presets:w,librariesForConnectedProject:E}=(0,eo.g)(),{goToLibrary:N,goToAll:S,goToRecents:I,changeAssetsView:A,toggleShowFolders:L}=function(){let e=(0,O.q5)(),t=(0,y.sN)(),{navigateToLibrary:s,navigateToTop:n,navigateToRecents:i}=(0,p.wV)(),{setLastNavAction:r}=(0,el.ZX)(),[,l]=(0,ec.MA)(),[,c]=(0,ec.ye)(),{focusSearchBar:d}=(0,G.rl)(),u=(0,o.Xr)(p.aK),x=a.useCallback(e=>{t("settingsMenu",e)},[t]),m=a.useCallback(e=>{x(s(e)),d(),u(p.t6.Libraries)},[d,s,u,x]),h=a.useCallback(()=>{x(n()),d()},[d,n,x]);return{goToLibrary:m,goToAll:h,goToRecents:a.useCallback(()=>{x(i()),d()},[d,i,x]),changeAssetsView:a.useCallback(t=>{T.az.trackDefinedEvent("assets_panel.view_mode_changed",{viewMode:t,fileKey:e?.key,fileTeamId:e?.teamId??void 0,fileOrgId:e?.parentOrgId??void 0}),l(t),r(el.r6.ToggleView)},[e?.key,e?.parentOrgId,e?.teamId,l,r]),toggleShowFolders:a.useCallback(t=>{T.az.trackDefinedEvent("assets_panel.folder_toggle",{showFolders:t,fileKey:e?.key,fileTeamId:e?.teamId??void 0,fileOrgId:e?.parentOrgId??void 0}),c(t)},[e?.key,e?.parentOrgId,e?.teamId,c])}}(),P=a.useMemo(()=>{switch(d){case p.S5.Libraries:return"all_libraries";case p.S5.Recents:return"recents";case p.S5.Search:return u??"all_libraries"}return u},[d,u]),R=a.useCallback(e=>{"all_libraries"===e?S():"recents"===e?I():N((0,J.l)(e))},[S,I,N]),{getTriggerProps:D,manager:F}=B.b(),U=D(),K=(0,Q.SV)(t,U.ref);return(0,n.jsxs)(B.bL,{manager:F,children:[(0,n.jsx)(V.d,{...U,"aria-label":(0,l.t)("design_systems.assets_panel.settings_label"),"data-testid":"asset-panel-settings-button",ref:K,children:(0,n.jsx)(W.P,{})}),(0,n.jsxs)(B.mc,{children:[(0,n.jsxs)($.z6,{title:(0,n.jsx)(B.r1,{children:(0,l.t)("design_systems.assets_panel.dropdown_libraries")}),onChange:R,value:P,children:[(0,n.jsx)($.CU,{value:"all_libraries",children:(0,n.jsx)(em,{text:(0,l.t)("design_systems.assets_panel.dropdown_type_all_libraries")})}),(0,n.jsxs)(B.YJ,{children:[v&&(0,n.jsx)($.CU,{value:"recents",children:(0,n.jsx)(em,{text:(0,l.t)("design_systems.assets_panel.dropdown_type_recents")})}),j&&(0,n.jsx)($.CU,{value:b.libraryKey,children:(0,n.jsx)(em,{text:b.name})})]}),(C.length>0||w.length>0)&&(0,n.jsxs)(B.YJ,{children:[C.map(({name:e,libraryKey:t})=>(0,n.jsx)($.CU,{value:t,children:(0,n.jsx)(em,{text:e,isApproved:(0,en.sF)(t)})},t)),w.map(({name:e,libraryKey:t})=>(0,n.jsx)($.CU,{value:t,children:(0,n.jsx)(em,{text:e,isPreset:!0,isApproved:(0,en.sF)(t)})},t))]}),E.length>0&&(0,n.jsx)(B.YJ,{title:(0,n.jsx)(B.hE,{children:(0,l.t)("design_systems.libraries_modal.connected_project_libraries")}),children:E.map(({name:e,libraryKey:t})=>(0,n.jsx)($.CU,{value:t,children:(0,n.jsx)(em,{text:e,isApproved:(0,en.sF)(t)})},t))})]}),!_&&(0,n.jsxs)($.z6,{title:(0,n.jsx)(B.r1,{children:(0,l.t)("design_systems.assets_panel.toggle_view")}),onChange:A,value:f,children:[(0,n.jsx)($.CU,{value:ec.$H.GRID,children:(0,n.jsx)(em,{text:(0,l.t)("design_systems.assets_panel.view_toggle_grid"),icon:(0,n.jsx)(Y.t,{})})}),(0,n.jsx)($.CU,{value:ec.$H.LIST,children:(0,n.jsx)(em,{text:(0,l.t)("design_systems.assets_panel.view_toggle_list"),icon:(0,n.jsx)(X.Z,{})})})]}),e&&(0,n.jsx)($.H_,{checked:c,onChange:L,children:(0,n.jsx)(em,{text:(0,l.t)("design_systems.assets_panel.view_toggle_show_folders"),icon:(0,n.jsx)(Z.e,{})})})]})]})}function em({text:e,isApproved:t,isPreset:s,icon:a}){return(0,n.jsxs)(n.Fragment,{children:[a&&(0,n.jsx)(B.Q$,{children:a}),(0,n.jsx)("span",{children:e}),(0,n.jsx)("div",{className:"asset_panel_settings--optionRightIcon--xEKOJ",children:t?(0,n.jsx)(es.FX,{}):s?(0,n.jsx)("div",{className:ee.s.ml2.$,children:(0,n.jsx)(ea.E,{libraryKey:void 0})}):null})]})}var ep=s(240766),eh=s(942356),eg=s(429921),ef=s(256065),e_=s(244917),ey=s(546597),ek=s(466082),ev=s(239620),eb=s(210823),ej=s(835204),eC=s(566697),ew=s(456556),eE=s(576116),eN=s(508902),eS=s(109965),eT=s(359962),eI=s(410274),eA=s(588526),eM=s(110578),ez=s(720995),eL=s(355441),eO=s(951633),eP=s(365841);let eR="visual_search_assets_panel";function eD({onDismiss:e}){let[t,s]=a.useState(!1),{width:i}=(0,eP.G)(),r=Math.min(.7*i,240),o=(0,v.d4)(eE.vD),d=(0,ew.Fk)((e,t)=>{let s=e.get(t);return s?.name},o),{getConfig:u}=(0,c.I7)("assets_panel_visual_search"),x="component_filter"===u().get("variant","control"),m=a.useCallback(()=>{o&&((0,eI.$I)({moduleToOpen:{type:"custom",module:(0,g.P5)()?(0,n.jsx)(eA.z6,{initialSearchTagType:x?eM.qG.COMPONENTS:void 0,isVisualSearch:!0,closeOnEscape:!0}):(0,n.jsx)(ez.WS,{}),beforeModuleOpen:()=>(0,ez.jp)(ej.G4.ASSETS_PANEL_VISUAL_SEARCH),name:eT.Sn.VISUAL_SEARCH},trackingData:{source:ej.G4.ASSETS_PANEL_VISUAL_SEARCH}}),e())},[o,e,x]),p=a.useCallback(t=>{(0,eI.$I)({moduleToOpen:{type:"custom",module:(0,g.P5)()?(0,n.jsx)(eA.z6,{initialSearchTagType:x?eM.qG.COMPONENTS:void 0,isVisualSearch:!0,closeOnEscape:!0}):(0,n.jsx)(ez.WS,{}),beforeModuleOpen:()=>(0,ez.qF)(ej.G4.ASSETS_PANEL_VISUAL_SEARCH,t),name:eT.Sn.VISUAL_SEARCH},trackingData:{source:ej.G4.ASSETS_PANEL_VISUAL_SEARCH}}),e()},[e,x]),h=a.useMemo(()=>{if(!o)return null;let e=(0,ek.UN)().get(o);if(!e)return null;let t=(0,ej.T1)(e);return t?t.startsWith("data:image")?t:`data:image/png;base64,${t}`:null},[o]),f=a.useCallback(e=>{e.preventDefault(),e.stopPropagation();let t=e.clipboardData?.files;t?.length===1&&t[0]?.type.startsWith("image/")&&p(t[0])},[p]);a.useEffect(()=>{if(t)return document.addEventListener("paste",f),()=>document.removeEventListener("paste",f)},[f,t]);let _=a.useCallback(e=>(!!e.metaKey||!!e.ctrlKey)&&"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),m(),!0),[m]),y=(0,ev.fo)(void 0,"keydown",e=>{_(e.event)&&e.accept()});a.useEffect(()=>(document.addEventListener("keydown",_),()=>{document.removeEventListener("keydown",_)}),[_]),a.useEffect(()=>{let t=t=>{let s=t.target;s.closest(".modalContainer")||s.closest("canvas")||e()};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[e]);let k=a.useMemo(()=>d||(0,l.tx)("design_systems.assets_panel.visual_search.select_layer"),[d]),b=a.useMemo(()=>o?(0,n.jsx)("div",{className:"xl010v5",children:(0,n.jsx)(eS.Bf,{guid:o})}):(0,n.jsx)(ef.H,{}),[o]);return(0,eC.O1)(()=>(e(),!0),eC.KD.MODAL),(0,n.jsx)(eN.vL,{name:"visual_search_modal",handleKeyDown:y,focusOnMount:!0,children:(0,n.jsx)(eO.NJ,{className:"visual_search_button--modalContainer--ZBIi- pointer_modal--walkThroughModal--8YJl8 pointer_modal--pointerModal--VrJy4",dismissModal:e,width:r,targetKey:eR,arrowPosition:eL.F_.TOP,backgroundColor:"var(--color-bg, $figmaFGWhite)",shouldNotWrapInParagraphTag:!0,noAnimation:!0,pointerOffsetOverride:r-12,children:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x6s0dn4",children:[(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np xl56j7k x6s0dn4 xod5an3 x1s2d0ae xxk0z11",children:[b,(0,n.jsx)(eb.E,{fontWeight:"medium",truncate:!0,children:k})]}),h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"xh8yej3 xekxv85 x19y5rnk x1v8gsql x78zum5 xdt5ytf x6s0dn4 xl56j7k",children:(0,n.jsx)("img",{src:h||"",alt:"Preview",className:"xeu0yli x14r61f x1tamke2 x19kjcj4"})}),(0,n.jsx)("div",{className:"x78zum5 x13a6bvl xh8yej3 x14vqqas",children:(0,n.jsxs)(eh.$n,{variant:"secondary",onClick:m,children:[(0,n.jsx)(eb.E,{children:(0,l.tx)("design_systems.assets_panel.visual_search.search")}),(0,n.jsx)(eh.$n.Shortcut,{children:"\u2318\u23CE"})]})})]}):(0,n.jsxs)("div",{className:"xmkeg23 xbsl7fq x7z60cl xdnk06y x192jxwq x2b8uid x1ypdohk xzlr0fm xh8yej3",children:[(0,n.jsx)("input",{type:"file",accept:"image/*",className:"x1s85apg",id:"visual-search-file-input",onChange:e=>{let t=e.target.files?.[0];t&&p(t)}}),(0,n.jsx)("button",{className:"xh8yej3",onClick:e=>{e.preventDefault(),e.stopPropagation(),document.getElementById("visual-search-file-input")?.click()},children:(0,n.jsx)("div",{className:"xggk2y7",onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{e.preventDefault(),e.stopPropagation();let t=e.dataTransfer.files?.[0];t&&p(t)},onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x6s0dn4 xl56j7k x1jnr06f",children:[(0,n.jsx)(e_.Z,{}),(0,n.jsx)(eb.E,{children:(0,l.tx)("design_systems.assets_panel.visual_search.drag_or_upload")})]})})})]})]})})})}function eF(){let[e,t]=a.useState(!1),{setKeyboardNavigationElement:s}=(0,M.M3)({path:[q.ON.HEADER,q.my.SEARCH_AND_FILTER],column:q.Wy.VISUAL_SEARCH_BUTTON});return(0,n.jsxs)(eg.o,{eventListeners:e?["onMouseDown"]:[],children:[(0,n.jsx)(V.d,{"data-onboarding-key":eR,ref:s,onClick:()=>{t(!e),T.az.trackDefinedEvent("fragment_search.assets_panel_visual_search_button_clicked",{})},"aria-expanded":e,"aria-label":(0,l.t)("design_systems.assets_panel.visual_search.label"),children:(0,n.jsx)(ey.A,{})}),e&&(0,n.jsx)(eD,{onDismiss:()=>t(!1)})]})}let eq=new class{constructor(){this.format=e=>{switch(e){case p.t6.Blocks:return(0,l.t)("design_systems.assets_panel.blocks");case p.t6.Libraries:return(0,l.t)("design_systems.assets_panel.dropdown_libraries")}}}};function eG(){let{getPage:e,getLibrary:t}=(0,k.G)(),{currentView:s,libraryKey:r,pageId:c}=(0,p.wV)(),d=a.useMemo(()=>e(r,c),[e,r,c]),x=a.useMemo(()=>t(r),[t,r]),m=!(0,u.Y1)()&&s!==p.S5.Search,[h,g]=(0,o.fp)(p.aK),_=(0,f.cJ)()&&s!==p.S5.Search&&s!==p.S5.Recents?[p.t6.Blocks,p.t6.Libraries]:void 0;return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xw6ie8e",children:[(0,n.jsx)(eH,{library:x}),!!_&&(0,n.jsx)(eB,{legend:(0,l.tx)("design_systems.assets_panel.assets"),value:h,onChange:e=>{(0,y.hB)(()=>g(e))},children:_.map(e=>(0,n.jsx)(i.RT,{value:e,label:eq.format(e)},e))}),m&&(0,n.jsx)(eU,{page:d})]})}function eU({page:e}){let{currentView:t}=(0,p.wV)(),s=(0,f.cJ)(),[a]=(0,o.fp)(p.aK),i=(0,ep.I)(),r=s&&t===p.S5.Libraries&&a===p.t6.Libraries;return s&&(a===p.t6.Blocks&&t!==p.S5.Recents||a===p.t6.Libraries&&i)?null:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4",children:[(0,n.jsx)(_.Q,{page:e}),r&&(0,n.jsx)("div",{className:"x15bdqvn xt970qd x1kxq6ma",children:(0,n.jsx)(m.b,{entrypoint:h.r6.ASSETS_PANEL_BUTTON,hideIfNoUpdates:!1})})]})}function eK(){return(0,n.jsx)(m.b,{entrypoint:h.r6.ASSETS_PANEL_BUTTON,hideIfNoUpdates:!1,recordingKey:"assetPanelHeader"})}function eH({library:e}){let{currentView:t,visualAssetsType:s}=(0,p.wV)(),a=(0,g.Ko)(),{getConfig:i}=(0,c.I7)("assets_panel_visual_search"),r=(0,d.b)(),l=(0,x.HY)(),o=r||l,u=!(0,f.cJ)()&&a&&"control"!==i().get("variant","control");return(0,n.jsxs)("div",{...{0:{className:"xrvj5dj x52fmzj x1eavx82 x1on1db2 x1jnr06f x6s0dn4 xet2fuk x21xpn4 xt970qd xbfr8j9"},1:{className:"xrvj5dj x52fmzj x1eavx82 x1on1db2 x1jnr06f x6s0dn4 xet2fuk x21xpn4 xt970qd xbfr8j9 xexx8yu xnuq7ks x18d9i69 x163pfp x1o1pmfc"}}[!!o<<0],children:[(0,n.jsx)("div",{...{0:{className:"x1ms6mhf xgkxs2y"},1:{className:"x1ms6mhf xgkxs2y x5jayri"}}[!!o<<0],children:(0,n.jsx)(U,{libraryName:e?.name})}),u&&(0,n.jsx)("div",{className:"x1ms6mhf x1npkx4u",children:(0,n.jsx)(eF,{})}),(0,n.jsx)("div",{...{0:{className:"x78zum5 x6s0dn4 x1ms6mhf x1npkx4u"},1:{className:"x78zum5 x6s0dn4 x1ms6mhf x1k3v4rp"}}[!!u<<0],children:(0,n.jsx)(ex,{includeFolderSetting:[p.S5.Libraries,p.S5.Pages,p.S5.Assets].includes(t)})}),t===p.S5.Search&&e&&(0,n.jsx)("div",{className:"x78zum5 xeuugli x7sv70a xgkxs2y",children:(0,n.jsx)(K,{library:e})}),t===p.S5.Search&&s&&(0,n.jsx)("div",{className:"x78zum5 xeuugli x7sv70a xgkxs2y",children:(0,n.jsx)(H,{visualAssetsType:s})})]})}function eB({legend:e,value:t,onChange:s,children:a}){return(0,n.jsx)("div",{className:"xz9dl7a xyfqnmn xwib8y2 xnm25rq x1xmf6yo x178xt8z x13fuv20 x16ufvko",children:(0,n.jsx)(i.bL,{legend:(0,n.jsx)(r.q,{children:e}),value:t,onChange:s,children:a})})}},209554:(e,t,s)=>{function n({elementMinSize:e,spaceAvailable:t,gap:s}){return Math.max(1,Math.floor((t+s)/(e+s)))}function a({numElements:e,spaceAvailable:t,gap:s}){return Math.floor((t-(e-1)*s)/e)}function i({width:e,widthToHeightRatio:t=1,maxHeight:s}){let n=Math.floor(e/t);return void 0===s?Math.max(0,n):Math.max(0,Math.min(s,n))}s.d(t,{BE:()=>n,hg:()=>i,y5:()=>a})},420434:(e,t,s)=>{s.d(t,{z:()=>es});var n=s(239976),a=s(105652),i=s(20002),r=s(943360),l=s(346524),o=s(997767),c=s(379141),d=s(270450),u=s(445019),x=s(575015),m=s(224542),p=s.n(m),h=s(943866),g=s(7857),f=s(499735),_=s(22852),y=s(564669),k=s(901962),v=s(227517),b=s(551492),j=s(368773),C=s(925270),w=s(245937),E=s(853921),N=s(81164),S=s(130764),T=s(223487),I=s(712022),A=s(269083),M=s(431422),z=s(31201),L=s(576116),O=s(421564),P=s(400982),R=s(960883),D=s(598713),F=s(909328),q=s(407186),G=s(673868),U=s(10212),K=s(549203),H=s(350669),B=s(314154),V=s(599345),$=s(590490),W=s(274412),Y=s(758440),X=s(763449),Z=s(675341),J=s(209067),Q=s(584441),ee=s(575987),et=s(175268);function es(e){return(0,n.jsx)(g.u9,{label:"AssetPanelTile",children:(0,n.jsx)(en,{...e})})}function en({asset:e,fileName:t,sourceForTracking:s,thumbLayout:o,thumbHeight:m,thumbWidth:h,displayType:g,viewMode:y,sectionNameForTracking:v,sectionPosition:b,sectionDepth:j,hideInlineName:w,keyboardPosition:I,isFirstTile:A=!1,isExample:M=!1,keyboardPanelDepth:z=0,disableClickPropagation:O=!1,libraryItemTileProps:P,isVisualAsset:F=!1,onSuccessfulAssetInsert:B}){let V=a.useContext(D.U),{isFlyoutOpen:Y}=(0,q.JA)(),es=(0,T.tS)(),en=(0,u.md)(W.TG),{currentView:ei}=(0,Q.wV)(),er=a.useMemo(()=>M??(0,E.Nz)(e,{isPreset:(0,N.lR)(e,en)}),[e,M,en]),el=(0,G.J)(e,b,v),eo=(0,K.n)(e),ec=(0,S.u)({canSwap:!er,openFileKey:es??"",sourceForTracking:"Asset Panel",insertAsChildOfCanvas:!0}),ed=a.useCallback(()=>{Y&&!eo&&el()},[Y,eo,el]),eu=a.useCallback(()=>{Y||V?.onOpenFlyout(e,b,v,j,s)},[Y,V,e,b,v,j,s]),ex=a.useCallback(e=>{O&&e.stopPropagation(),eu()},[O,eu]),em=`assetPanelTile.${b}`,ep=f.rf(em,"click",ex),eh=a.useMemo(()=>({...I,path:[Z.ON.CONTENTS,Z.lM.ASSETS+z,...I.path]}),[I,z]),{folderPath:eg}=(0,Q.wV)(),[ef]=(0,ee.ye)(),e_=ei===Q.S5.Assets&&eg&&ef&&(eg?.length??0)>z,{setKeyboardNavigationElement:ey,keyboardNavigationItem:ek}=(0,k.M3)({...eh,id:(0,C.V)(e),onFocus:ed,disabled:e_});(0,J.C0)(ek,A&&ei===Q.S5.Assets&&!e_);let[ev]=(0,ee.MA)(),eb=(0,_.N)({colIndex:eh.column,rowIndex:eh.path[eh.path.length-1],isList:"list"===ev,keyboardNavigationItem:ek,onComponentInsertSwap:ec,onOpenFlyout:eu,item:e,sectionNameForTracking:v,sectionPosition:b,shouldRefocusAfterKeyboardInsert:ei===Q.S5.Recents,sourceForTracking:s===R.tM?s:U.mZ}),ej=(0,H.F)(e,$.K.ASSETS_PANEL,b,v),eC=function(e,t){let s=(0,i.d4)(L.dK),n=e.isLocal&&(0,x.PN)()?(0,X.eT)(e.node_id,s).join("-"):e.node_id;return f.rf(`componentThumb.${n}`,"contextmenu",e=>{t(e)})}(e,ej);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.E,{onClick:ep,className:p()(et.QT,et.x6,{[et.Vw]:F}),ref:ey,onKeyDown:eb,onContextMenu:eC,"aria-describedby":"asset-panel-tile-hint",children:(0,n.jsx)(ea,{asset:e,disableClickPropagation:O,displayType:g,fileName:t,hideInlineName:w,isVisualAsset:F,libraryItemTileProps:P,onSuccessfulAssetInsert:B,sectionDepth:j,sectionNameForTracking:v,sectionPosition:b,sourceForTracking:s,thumbHeight:m,thumbLayout:o,thumbWidth:h,viewMode:y})}),(0,d.kc)().dse_fpl_wave_2&&(0,n.jsx)(l.E,{id:"asset-panel-tile-hint","aria-hidden":!0,children:(0,c.t)("design_systems.assets_panel.asset_tile_sr_hint")})]})}function ea({asset:e,fileName:t,sourceForTracking:s,thumbHeight:r,thumbWidth:l,sectionNameForTracking:c,sectionPosition:m,sectionDepth:g,hideInlineName:f,displayType:_,libraryItemTileProps:k,isVisualAsset:C,onSuccessfulAssetInsert:E}){let S=(0,i.wA)(),T=(0,A.I)(M.Cn.AssetsPanel),R=(0,i.d4)(L.dK),D=(0,i.d4)(z.F9),q=(0,u.md)(F.T),G=T.searchOption?.type===O.IS.ALL,H=(0,j.fV)(e.library_key),$=(0,N.fd)(e.library_key),W=(0,Y.H)(e.library_key),Z=(0,U._9)(e.library_key,"asset_panel_visual_assets"),J=G&&(H||$||W),Q=a.useRef(null),ee=(0,I.kH)(e.name),es=(0,y.NG)({text:ee,textRef:Q}),en=a.useRef(null),ea=(0,y.NG)({text:t??"",textRef:en}),ei=!!T.query,er=(0,K.n)(e),el=(0,h.ZC)(er);a.useEffect(()=>{er&&!el&&S(b.jD())},[er,S,el]);let eo=e.isLocal&&(0,x.PN)()?(0,X.eT)(e.node_id,R).join("-"):e.node_id,ec="Local components"===c||"Local private components"===c||e.isLocal,ed="grid"===_,eu=!f&&ed,ex=(0,d.kc)().api_asset_search_with_scores,em=(0,B.Y)(e),ep=a.useCallback(()=>{(0,P.$z)(),W&&Z(!0),E?.()},[Z,W,E]),eh={showName:!0,height:r,width:l,draggable:a.useMemo(()=>({sourceForTracking:s,clickToInsert:!1,afterSuccessfulInsert:ep,sectionNameForTracking:c,sectionDepth:g}),[ep,g,c,s]),shouldHideTooltip:!0,recordingNodePath:eo,isSearch:ei,useBaseTile:!0,hideNameOverlay:eu,numVariants:em,displayType:ed?"grid":"list-no-padding",sectionPosition:m,showTooltipImmediately:!1,fileName:es||ea?t:void 0,alwaysShowBorder:!1,thumbWrapperClassName:et.wi},eg=ec?(0,n.jsx)(V.MT,{item:e,isFilePublished:D,...eh}):(0,n.jsx)(V.lX,{item:e,...eh,...k});return(0,n.jsxs)("div",{className:C?et.NP:ed?et.K2:et.iE,children:[(0,n.jsx)("div",{className:p()(ed?et.QX:et.u2,{[et.Gr]:er,[et.HR]:er&&q}),children:eg}),eu&&(0,n.jsxs)("div",{className:et.Bm,style:{width:l-2},children:[(0,n.jsx)("span",{className:et.UU,ref:Q,children:ee}),(0,n.jsx)("div",{className:et.OW,children:(0,n.jsx)(o.e,{"aria-hidden":!0})})]}),eu&&!!t&&(0,n.jsxs)(v.Y,{spacing:0,direction:"horizontal",height:"hug-contents",children:[(0,n.jsx)("div",{className:p()(et.Md,et.Rm),ref:en,style:J?{maxWidth:l-w.J-2}:{width:l-2},children:t}),J&&(0,n.jsx)(w.P,{libraryKey:e.library_key,showPresetTooltip:!0,tooltipDelay:500,tooltipLocation:"below",compact:!0})]}),ex&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:p()(et.Md,et.Rm),style:J?{maxWidth:l-w.J-2}:{width:l-2},children:"Score: "+("score"in e?e.score?.toFixed(2)??"N/A":"N/A")}),(0,n.jsx)("div",{className:p()(et.Md,et.Rm),style:J?{maxWidth:l-w.J-2}:{width:l-2},children:"(L:"+(e.lexical_score?.toFixed(2)??"N/A")+", AI:"+(e.ai_score?.toFixed(2)??"N/A")+", F:"+(e.fuse_score?.toFixed(2)??"N/A")+")"})]})]})}},715243:(e,t,s)=>{s.d(t,{wl:()=>N,Hw:()=>w,Ij:()=>E});var n=s(239976),a=s(105652),i=s(951740),r=s(270450),l=s(445019),o=s(40297),c=s(925270),d=s(209067),u=s(999159),x=s(420434),m=s(943866),p=s(365841),h=s(151708),g=s(371347),f=s(581275);let _=(0,o.jz)(h.Nz),y=(0,o.jz)(h.cP),k=(0,o.jz)(h.FX),v=(0,o.jz)(g.$c),b=(0,o.jz)(g.d5),j=(0,o.jz)(h.ZI),C=(0,l.eU)(!1);function w(e,t,s={}){if("list"===t)return j;let n=e;return s.hideAssetName||(n+=_),s.showFileName&&(n+=y),s.hasTopPadding&&(n+=k),s.showAiDebugScores&&(n+=2*(0,o.jz)(h.uY)),n}function E(e,t,s,a,i,l,o){let m=[],p="list"===a.displayType?"listitem":"gridcell";for(let u=0;u<e.length;u+=t){let h=e.slice(u,u+t),g=[];h.forEach((e,r)=>{if(e){let m=u+r,h=o?.getFileName?.(e);g.push((0,n.jsx)("div",{role:p,children:(0,n.jsx)(x.z,{asset:e,fileName:h,isExample:o?.isExample,isFirstTile:o?.includesFirstTile&&0===m,keyboardPanelDepth:o?.keyboardPanelDepth,keyboardPosition:(0,d.pg)(l,m,t,o?.hasHeader),sectionDepth:o?.depth,sectionNameForTracking:i,sectionPosition:u+r,...a},`${s}-${(0,c.V)(e)}`)}))}}),m.push({element:(0,n.jsx)("div",{className:"list"===a.displayType?f.OS:0===u?f.c:f.wt,children:g}),key:`${s}:row-${u/t}`,keys:h.map(e=>(0,c.V)(e)),height:w(a.thumbHeight,a.displayType,{showFileName:!!o?.getFileName,hasTopPadding:0!==u,showAiDebugScores:!!(0,r.kc)().api_asset_search_with_scores})})}return m.length>0&&(m.unshift({element:(0,n.jsx)(u.hK,{height:v}),key:`${s}:spacer-top`,height:v,ariaHidden:!0}),m.push({element:(0,n.jsx)(u.hK,{height:b}),key:`${s}:spacer-bottom`,height:b,ariaHidden:!0})),m}function N({elements:e,hideScrollbar:t,initialScrollTop:s,onScroll:r,anchorScroll:o,role:c}){let d=a.useRef(null),x=(0,i.Te)({count:e.length,getScrollElement:()=>d.current,estimateSize:t=>e[t].height,getItemKey:t=>e[t].key,paddingEnd:8,overscan:6,initialOffset:s}),h=function({scrollContainerRef:e,initialScrollTop:t,onScroll:s,enabled:n,virtualizer:i,getKeys:r}){let[l,o]=a.useState(t??e.current?.scrollTop),[c,d]=a.useState(e.current?.scrollHeight),{width:u}=(0,p.G)(),x=(0,m.ZC)(u),h=a.useCallback((e,t)=>{if(!t)return{keys:[],offset:void 0};let s=e.getVirtualItems().find(e=>e.start>=t);return s?{keys:r(s),offset:s.start-t}:{keys:[],offset:void 0}},[r]),[g,f]=a.useState(()=>h(i,t??e.current?.scrollTop)),_=a.useCallback((e,t)=>{s?.(e,t),n&&(o(e),f(h(i,e)))},[n,h,s,i]);return a.useEffect(()=>{let t=x&&u&&x!==u,s=e.current?.scrollHeight&&c&&e.current?.scrollHeight!==c;if(t&&d(e.current?.scrollHeight),void 0!==l&&void 0!==g.offset&&n&&t&&s){let t=i.getVirtualItems().find(e=>r(e).some(e=>g.keys.includes(e)));if(t)i.scrollToOffset(t.start-g.offset);else{let t=l/c,s=e.current.scrollHeight*t;i.scrollToOffset(s)}}},[g.keys,g.offset,n,r,x,e,c,l,i,u]),_}({enabled:o,scrollContainerRef:d,initialScrollTop:s,onScroll:r,virtualizer:x,getKeys:a.useCallback(t=>{let s=e[t.index];return s?s.keys??[s.key]:[]},[e])}),[g,f]=(0,l.fp)(C);return a.useEffect(()=>{if(!g)return;let t=e.findIndex(e=>"preset_libraries_header"===e.key);-1!==t&&(x.scrollToIndex(t,{align:"start"}),f(!1))},[e,x,f,g]),(0,n.jsx)(u.xU,{scrollContainerRef:d,hideScrollbar:t,initialScrollTop:s,onScroll:h,children:(0,n.jsx)("div",{style:{height:`${x.getTotalSize()}px`,width:"100%",position:"relative"},role:c,children:x.getVirtualItems().map(t=>{let s=e[t.index];return s?(0,n.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${t.start}px)`},role:"grid"===c?"row":void 0,"aria-hidden":s.ariaHidden,children:s.element},t.key):null})})})}},757691:(e,t,s)=>{s.d(t,{F8:()=>b,Pc:()=>g,rJ:()=>v});var n=s(787049),a=s(22291),i=s(379141),r=s(323752),l=s(853921),o=s(712022),c=s(368041),d=s(421564),u=s(217670),x=s(675341),m=s(332477),p=s(794887),h=s(63938);function g(e){let t=(0,o.ke)(e.name),s=e.type===d.PW.RESPONSIVE_SET?e.containingFrame?.name:e.containing_frame?.name;return s?[s,...t]:t}function f(e,t="",{isPreset:s,sortingFn:n}={isPreset:!1,sortingFn:void 0}){let a=new Map,i=[];n?e.sort(n):(0,l.gO)(e,{sortFn:e=>g(e).join("/"),priorityFn:e=>(0,l.Nz)(e,{isPreset:s})});let o=Object.create(null);for(let s of e){let e=g(s),n="";for(let l=0;l<e.length;l++){let c=e[l],d=n,u=l<e.length-1;n+=c+(u?"/":"");let x=null;if(o[d]&&(x=o[d]),u){let s=o[n]??{name:c,key:`${t}-${e.slice(0,l+1).join("/")}`,items:[],subtrees:new Map,type:r.l$.NAME_GROUP,previewAsset:void 0};o[n]||(o[n]=s,x?x.subtrees.set(c,s):a.set(c,s))}u||(x?x.items.push(s):i.push(s))}}return a.forEach(e=>{(function e(t){t.previewAsset=j(t),t.subtrees.forEach(t=>e(t))})(e)}),{sortedItems:i,sortedSubtrees:a}}function _(e,t,{isPreset:s}){let n=new Map,{itemsByPageId:a,pageNamesByPageId:o,itemsWithoutPage:c}=(0,u.tz)(e,e=>e),{itemsByPageId:d,pageNamesByPageId:m,itemsWithoutPage:p}=(0,u.tz)(t,e=>e),h={...o,...m};(0,u.fM)(a,h,c),(0,u.fM)(d,h,p,!0);let g=Object.keys(h);for(let e of((0,l.gO)(g,{sortFn:e=>h[e],priorityFn:e=>(0,l.dS)(h[e],{isPreset:s})}),g)){let t=h[e],o=e in a?a[e]:void 0,c=o,u=[],m=null,p=null;if(o&&o.length>0){c=o.filter(e=>!(0,l.Nz)(e,{isPreset:s}));let{sortedItems:e,sortedSubtrees:t}=f(u=o.filter(e=>(0,l.Nz)(e,{isPreset:s})),"examples",{isPreset:s});u.length>0&&(p={name:(0,i.t)("design_systems.assets_panel.examples"),items:e,subtrees:t,key:x.nE,type:r.l$.COMPONENTS,previewAsset:void 0})}if(c&&c.length>0){let{sortedItems:e,sortedSubtrees:t}=f(c,"components",{isPreset:s});m={name:(0,i.t)("design_systems.assets_panel.components"),items:e,subtrees:t,key:x.c_,type:r.l$.COMPONENTS,previewAsset:void 0}}let g=null,_=d[e];if(_&&_.length>0){let{sortedItems:e,sortedSubtrees:t}=f(_,"templates",{isPreset:s});g={name:(0,i.t)("design_systems.assets_panel.templates"),items:e,subtrees:t,key:x.JS,type:r.l$.TEMPLATES,previewAsset:void 0}}let{sortedItems:y,sortedSubtrees:k}=f([...u??[],...c??[],..._??[]],"assets",{isPreset:s}),v={name:t,items:y,subtrees:k,key:x.Mk,type:r.l$.COMPONENTS,previewAsset:void 0},b={name:t,id:e,previewAsset:function({componentSubtree:e,exampleSubtree:t,templateSubtree:s}){let n=j(t),a=j(s),i=j(e);return n||a||i}({componentSubtree:m,exampleSubtree:p,templateSubtree:g}),components:m,examples:p,templates:g,assets:v,type:x.yW.DESIGN};n.set(e,b)}return n}function y(e,t,s,a){let l=new Map,{itemsByPageId:o,pageNamesByPageId:c,itemsWithoutPage:d}=(0,u.tz)(e,e=>({containing_frame:e.containingFrame??void 0}));(0,u.fM)(o,c,d);let m=Object.keys(c);for(let e of((0,n.v7)(m,e=>c[e]),m)){let n=c[e],a=o[e]??[];if(!n||0===a.length)continue;let{sortedItems:i,sortedSubtrees:d}=f(a,"assets",{sortingFn:s}),u={name:n,items:i,subtrees:d,key:x.Mk,type:r.l$.RESPONSIVE_SETS,previewAsset:void 0},m={name:n,id:e,previewAsset:t[e]??j(u),assets:u,type:x.yW.SITE,numAssets:function e(t){return t.items.length+Array.from(t.subtrees.values()).reduce((t,s)=>t+e(s),0)}(u)};l.set(e,m)}if(a){let e=(0,h.u)();if(e.length>0){let t={name:(0,i.t)("design_systems.assets_panel.site_blocks.embeds"),id:"embeds",embeds:e,previewAsset:void 0,assets:{name:"",items:[],subtrees:new Map,key:"EMPTY_ASSETS_NOT_USED",type:r.l$.COMPONENTS,previewAsset:void 0},type:x.yW.SITE,numAssets:e.length};l.set("embeds",t)}}return l}function k(e,t){let{allItems:s,publishedItems:n,privateItems:a,numPublished:i}=e;return i>0&&t&&a.length>0?n:s}function v(e){let t=Array.from(e.items.values());for(let[s,n]of e.subtrees.entries())t.push(...v(n));return t}function b({localComponentsInfo:e,localTemplatesInfo:t,localThumbnailUrl:s,localThumbnailShouldCover:n,subscribedComponentsInfo:l,subscribedCommunityComponentsInfo:o,canPublish:d,openFileKey:u,openFileLibraryKey:g,approvedLibraryKeysByResourceType:v,siteKitsAssetData:b,siteKitThumbnailComponents:j,siteKitSortingFn:C,presetLibraryKeys:w}){let{libraryKeyToSubscribedItems:E,subscribedFiles:N}=l,S=function({subscribedFiles:e,libraryKeyToSubscribedComponents:t,approvedLibraryKeysByResourceType:s}){let n=new Map;for(let i of(0,m.uo)(e,s)){if(!i.library_key)continue;let e=(0,a.l)(i.library_key),s=t[e]??[],r=_(s,[],{isPreset:!1}),l={name:i.name,libraryKey:(0,a.l)(i.library_key??""),pages:r,numComponents:s.length,numTemplates:0,thumbnailUrl:i.thumbnail_url_override??i.thumbnail_url,thumbnailShouldCover:!!i.thumbnail_guid,type:x.yW.DESIGN,libraryType:"team"};n.set(e,l)}return n}({subscribedFiles:[...N],libraryKeyToSubscribedComponents:E,approvedLibraryKeysByResourceType:v}),T=function(e,t){if(!e)return new Map;let{libraryKeyToSubscribedItems:s,subscribedHubFiles:n}=e??{hubFileIdToSubscribedItems:{},subscribedHubFiles:[]},i=new Map;for(let e of(0,m.LH)(n)){if(!e.library_key)continue;let n=(0,a.l)(e.library_key),r=s[n]??[],l=_(r,[],{isPreset:t.has(e.library_key)});if(r.length>0){let t={name:(0,c.oA)(e),libraryKey:(0,a.l)(e.library_key??""),pages:l,numComponents:r.length,numTemplates:0,thumbnailUrl:e.thumbnail_url,thumbnailShouldCover:!0,type:x.yW.DESIGN,libraryType:"community"};i.set(n,t)}}return i}(o,w),I=function(e,t,s,n,a,l,o,c){let{privateItems:d,numPublished:u}=e,{privateItems:m,numPublished:p}=t??{privateItems:[],numPublished:0},h=u+p>0&&a&&d.length+m.length>0,g=k(e,a),y=t?k(t,a):[],v=!!c?.has(o),b=_(g,y,{isPreset:v}),j={name:(0,i.t)("design_systems.assets_panel.created_in_this_file"),libraryKey:o,pages:b,numComponents:g.length,numTemplates:y.length,thumbnailUrl:s,thumbnailShouldCover:n,type:x.yW.DESIGN,libraryType:"team"};if(h){let e=null;if(d.length>0){let{sortedItems:t,sortedSubtrees:s}=f(d,"p_components",{isPreset:v});e={name:(0,i.t)("design_systems.assets_panel.components"),items:t,subtrees:s,key:x.c_,type:r.l$.COMPONENTS,previewAsset:void 0}}let t=null;if(m.length>0){let{sortedItems:e,sortedSubtrees:s}=f(m,"p_templates",{isPreset:v});t={name:(0,i.t)("design_systems.assets_panel.templates"),items:e,subtrees:s,key:x.JS,type:r.l$.TEMPLATES,previewAsset:void 0}}let{sortedItems:s,sortedSubtrees:n}=f([...d??[],...m??[]],"assets",{isPreset:v}),a={name:(0,i.t)("design_systems.assets_panel.assets"),items:s,subtrees:n,key:x.Mk,type:r.l$.COMPONENTS,previewAsset:void 0},l={name:(0,i.t)("design_systems.assets_panel.hidden"),id:x.o8,previewAsset:d[0]??m[0],components:e,examples:null,templates:t,assets:a,type:x.yW.DESIGN};j.pages.set(x.o8,l)}return j}(e,t,s,n,d,0,g,w),A=new Map([...S,...T]);A.set(I.libraryKey,I);let M=null;if(b){for(let e of(M=new Map,b)){let t=(0,p.Pv)(e);if(!t)continue;let s=t.library.libraryKey,n=y(t.assets,j[s]??{},C,s===p.Yl),a={...t.library,pages:n};M.set(s,a),A.set(s,a)}let e=(0,h.V)();if(e){let t=y([],{},C,!0),s={...e,pages:t};M.set((0,a.l)(p.Yl),s),A.set((0,a.l)(p.Yl),s)}}return{localAssets:I,libraries:S,presets:T,siteKits:M,allLibrariesUnsorted:A}}function j(e){let t=e?v(e):[];return t.length>0?t[0]:void 0}},299728:(e,t,s)=>{s.d(t,{AA:()=>_,Ef:()=>y,SQ:()=>f,oc:()=>c});var n=s(105652),a=s(40297),i=s(138709),r=s(209554),l=s(575987),o=s(371347);let c=40,d=(0,a.jz)(o.H0),u=2*(0,a.jz)(o.Mj),x={NORMAL:115,WIDE:void 0,SMALL:72},m={minColumns:2,maxColumns:3,aspectRatio:1,maxHeight:x.NORMAL},p={minColumns:1,maxColumns:1,aspectRatio:3.25,maxHeight:x.WIDE},h={minColumns:3,maxColumns:5,aspectRatio:1,maxHeight:x.SMALL},g=e=>{switch(e){case i.rp.WIDE:return p;case i.rp.SMALL:return h;default:return m}};function f({sidebarWidth:e}){let t=n.useMemo(()=>e-u,[e]),s=n.useMemo(()=>{let e={};for(let s of[i.rp.NORMAL,i.rp.WIDE,i.rp.SMALL]){let{minColumns:n,maxColumns:a,aspectRatio:i,maxHeight:l}=g(s),o=Math.max(Math.min(a,(0,r.BE)({elementMinSize:l??t,gap:d,spaceAvailable:t})),n),c=(0,r.y5)({numElements:o,gap:d,spaceAvailable:t}),u=(0,r.hg)({width:c,maxHeight:l,widthToHeightRatio:i});e[s]={width:c,height:u,columns:o}}return e},[t]),a=n.useMemo(()=>Math.max((0,r.BE)({elementMinSize:200,gap:d,spaceAvailable:t}),1),[t]),l=n.useMemo(()=>(0,r.y5)({numElements:a,gap:d,spaceAvailable:t}),[a,t]),o=n.useMemo(()=>(0,r.hg)({width:l,widthToHeightRatio:1.5,maxHeight:200}),[l]);return n.useMemo(()=>({componentLayouts:s,exampleLayout:{width:l,height:o,columns:a}}),[s,a,l,o])}function _(e,t){let[s]=(0,l.MA)(),a=n.useMemo(()=>t&&"grid"===s?t:[],[s,t]),i=n.useMemo(()=>a.every(e=>e.fullPage)?.85:Math.max(a.map(e=>e.mainThumbnailInfo.width/e.mainThumbnailInfo.height).reduce((e,t)=>Math.abs(t-1)<Math.abs(e-1)?t:e),.7),[a]),o=e-u,x=n.useMemo(()=>(0,r.BE)({elementMinSize:144,gap:d,spaceAvailable:o}),[o]),m=i>1?1:Math.min(2,x),p=n.useMemo(()=>(0,r.y5)({numElements:m,gap:d,spaceAvailable:o}),[m,o]),h=n.useMemo(()=>(0,r.hg)({width:p,widthToHeightRatio:i,maxHeight:void 0}),[i,p]);return"list"===s||0===a.length?{tileWidth:c,tileHeight:c,numColumns:1}:{tileWidth:p,tileHeight:h,numColumns:m}}function y(e){let[t]=(0,l.MA)(),s=e-u,a=Math.min(n.useMemo(()=>(0,r.BE)({elementMinSize:120,gap:d,spaceAvailable:s}),[s]),3),i=n.useMemo(()=>(0,r.y5)({numElements:a,gap:d,spaceAvailable:s}),[a,s]),o=n.useMemo(()=>(0,r.hg)({width:i,widthToHeightRatio:1,maxHeight:void 0}),[i]);return"list"===t?{tileWidth:c,tileHeight:c,numColumns:1}:{tileWidth:i,tileHeight:o,numColumns:a}}},922534:(e,t,s)=>{s.d(t,{O:()=>o,Z:()=>c});var n=s(105652),a=s(138709),i=s(10212),r=s(365841),l=s(299728);function o(){let{width:e}=(0,r.G)(),{componentLayouts:t,exampleLayout:s}=(0,l.SQ)({sidebarWidth:e}),[o,c]=n.useMemo(()=>{let e={},s={};for(let[n,a]of Object.entries(t))e[n]={thumbHeight:a.height,thumbWidth:a.width,viewMode:i.Bk.Grid,thumbLayout:n,sourceForTracking:i.mZ,displayType:"grid"},s[n]=a.columns;return[e,s]},[t]),d=n.useMemo(()=>({thumbHeight:s.height,thumbWidth:s.width,viewMode:i.Bk.Grid,thumbLayout:a.rp.NORMAL,sourceForTracking:i.mZ,displayType:"grid"}),[s.height,s.width]),u=n.useMemo(()=>({thumbHeight:l.oc,thumbWidth:l.oc,viewMode:i.Bk.List,thumbLayout:a.rp.NORMAL,sourceForTracking:i.mZ,displayType:"list"}),[]);return n.useMemo(()=>({componentTilePropsByLayout:o,numColumnsByLayout:c,listProps:u,exampleTileProps:d,numExampleColumns:s.columns}),[o,c,u,d,s.columns])}function c(e,t,s,n=!1){return"list"===t?{props:e.listProps,numColumns:1}:n?{props:e.exampleTileProps,numColumns:e.numExampleColumns}:{props:e.componentTilePropsByLayout[s],numColumns:e.numColumnsByLayout[s]}}},240766:(e,t,s)=>{s.d(t,{I:()=>u});var n=s(105652),a=s(445019),i=s(562418),r=s(223487),l=s(675341),o=s(718286),c=s(584441),d=s(65235);function u(){let e=(0,r._G)(),{getLibrary:t}=(0,o.G)(),{libraries:s,presets:u,siteLibraries:x,librariesForConnectedProject:m}=(0,d.g)(),p=n.useMemo(()=>t(e??void 0),[t,e]),h=n.useMemo(()=>!p||(p.type===l.yW.DESIGN?0===p.numComponents&&0===p.numTemplates:0===p.numResponsiveSets),[p]),g=0===s.length,f=0===u.length,_=0===m.length,y=(0,i.cJ)(),[k]=(0,a.fp)(c.aK);return n.useMemo(()=>y?"Blocks"!==k&&h&&g&&f&&_:h&&g&&f&&_&&"disabled"===x.status,[h,g,f,_,x,y,k])}},380219:(e,t,s)=>{s.d(t,{z:()=>v});var n=s(105652),a=s(20002),i=s(22291),r=s(445019),l=s(563134),o=s(368773),c=s(223487),d=s(329076),u=s(31201),x=s(475272),m=s(10212),p=s(757691),h=s(880867),g=s(274412),f=s(758440),_=s(363661),y=s(804094),k=s(534653);function v(){(0,_.K)();let{subscribedFileDataByLibraryKey:e,hubFilesByLibraryKey:t}=(0,y.N)(),s=(0,a.d4)(c.tB),v=(0,a.d4)(u.e_),b=(0,a.d4)(u.MH),j=(0,a.d4)(u.dM),C=(0,a.d4)(x.P),w=(0,l.n1)(),E=(0,o.Fl)(),N=(0,r.md)(f.lj),S=n.useMemo(()=>s?.teamId?C[s.teamId]:null,[s?.teamId,C]),T=n.useMemo(()=>!!S&&(0,d.w5)(S),[S]),I=n.useMemo(()=>(0,m.Sg)(b,j),[b,j]),A=(0,m.$1)({library:v,fileDataByLibraryKey:e}),M=(0,m.oV)({library:v,hubFilesByLibraryKey:t,visualAssetLibraryKeys:N}),z=n.useMemo(()=>w?M:null,[w,M]),{url:L,shouldCover:O}=(0,k.t)(),P=(0,h.Nn)(),R=n.useMemo(()=>{let e=[];for(let t of P)t.data&&e.push(t.data);return e},[P]),D=(0,h.fi)(),F=(0,h.Bv)(),q=(0,r.md)(g.TG);return n.useMemo(()=>(0,p.F8)({localComponentsInfo:I,localThumbnailUrl:L,localThumbnailShouldCover:O,subscribedComponentsInfo:A,subscribedCommunityComponentsInfo:z??void 0,canPublish:T,openFileKey:s?.key??"",openFileLibraryKey:(0,i.l)(s?.libraryKey??""),approvedLibraryKeysByResourceType:E,siteKitsAssetData:R.length>0?R:void 0,siteKitThumbnailComponents:D,siteKitSortingFn:F,presetLibraryKeys:q}),[I,L,O,T,s?.key,s?.libraryKey,E,R,D,F,A,z,q])}},41652:(e,t,s)=>{s.d(t,{$4:()=>B,pd:()=>V,mi:()=>W});var n=s(239976),a=s(105652),i=s(805242),r=s(943360),l=s(692376),o=s(798913),c=s(22291),d=s(445019),u=s(405228),x=s(224542),m=s.n(x),p=s(522568),h=s(40297),g=s(499735),f=s(875253),_=s(75962),y=s(901962),k=s(863412),v=s(154963),b=s(938892),j=s(835427),C=s(772293),w=s(884819),E=s(627283),N=s(684799),S=s(400982),T=s(410518),I=s(10212),A=s(675341),M=s(365841),z=s(209067),L=s(584441),O=s(922534),P=s(575987),R=s(768799),D=s(794887),F=s(400163),q=s(903084),G=s(371347),U=s(175268);let K=2*(0,h.jz)(G.Mj),H=(0,h.jz)("4px");function B({embeds:e}){let{thumbWidth:t,thumbHeight:s}=function(){let[e]=(0,P.MA)(),{width:t}=(0,M.G)(),{listProps:s}=(0,O.O)();if("list"===e)return{thumbWidth:s.thumbWidth,thumbHeight:s.thumbHeight};let n=Math.floor(t-K),a=Math.floor(n/2);return{thumbWidth:n,thumbHeight:a}}();return(0,n.jsx)(n.Fragment,{children:e.map((e,a)=>(0,n.jsx)(V,{embed:e,sectionPosition:a,keyboardPosition:{path:[A.ON.CONTENTS,A.lM.ASSETS,a],column:null},thumbHeight:s,thumbWidth:t,isFirstTile:0===a},e.name))})}function V({embed:e,sectionPosition:t,keyboardPosition:s,sectionNameForTracking:i="Site kit",isFirstTile:d=!1,thumbHeight:u,thumbWidth:x,libraryName:h,onDragStart:N}){var M;let[O]=(0,P.MA)(),F="list"===O,G=(0,R.jx)(),{currentView:K}=(0,L.wV)(),B=function(e,t,s){let[n]=(0,P.MA)(),i=(0,j.Ew)({assetKey:e.name,assetLibraryKey:(0,c.l)(D.Yl),assetType:"embed",isList:"list"===n,sectionNameforTracking:s,sectionPosition:t,sourceForTracking:I.mZ,isExample:!1,partnerType:void 0}),r=(0,L._m)(),l=(0,T.CK)();return a.useCallback(s=>{p.az.trackDefinedEvent("asset_search.result_inserted",{...i,entryPoint:I.mZ,componentSuggestionSessionId:l});let n=!!i.searchSessionId;p.az.trackDefinedEvent("assets_panel.site_kit_inserted",{assetName:e.name,type:"embed",group:"Embeds",fileKey:i.fileKey,fileTeamId:i.fileTeamId,fileOrgId:i.fileOrgId,sectionPosition:t,searchQuery:i.searchQuery,searchSessionId:i.searchSessionId,searchType:n?r?"site kit":"all":void 0,viewMode:i.viewMode?.toLocaleLowerCase(),queryId:i.queryId,action:s}),"keyboard"===s&&p.az.trackDefinedEvent("assets_panel.keyboard_insert",i)},[i,e.name,r,t,l])}(e,t,i),{onInsertableResourcePointerDown:V,dragState:$}=(M={resource:e,clickToInsert_DEPRECATED:!1,afterSuccessfulInsert:()=>{B("drag"),(0,S.$z)()},onDragStart:N},(0,w.t)({resource:M.resource,draggingThumbMaxDimensions:M.draggingThumbMaxDimensions,onDragStart:M.onDragStart,isDraggingDisabled:M.isDraggingDisabled,recomputeCancelRectsOnPointerUp:M.recomputeCancelRectsOnPointerUp,clickToInsert_DEPRECATED:M.clickToInsert_DEPRECATED,afterSuccessfulInsert:M.afterSuccessfulInsert},{insertAction:e=>{let t=e.pointerPercentageOffset||new f.Mi;return Y(M.resource,e.dropPosition,t),Promise.resolve()},dragPreviewPointerPosition:E.N.CENTERED,getDragPreviewSrc:()=>M.resource.preview_url,onPointerDownCallback:()=>{l.glU.setShowHTMLWidgetCanvasDragAndDropOutlines(!0,{x:M.resource.width,y:M.resource.height})},onPointerUpCallback:()=>{l.glU.setShowHTMLWidgetCanvasDragAndDropOutlines(!1,null)},recordingKey:g.Pt("html-widget",M.resource.name)})),W=o.nc.user("insert-embed",V),J=a.useMemo(()=>({...s,path:[A.ON.CONTENTS,A.lM.ASSETS,...s.path]}),[s]),{setKeyboardNavigationElement:Q,keyboardNavigationItem:ee}=(0,y.M3)({...J});(0,z.C0)(ee,d&&K===L.S5.Assets);let et=a.useCallback(t=>{let s=C.Y5.getViewportInfo();Y(e,new f.Mi(s.offsetX,s.offsetY),new f.Mi(.5,.5)),B(t),(0,S.$z)()},[e,B]),es=a.useCallback(()=>et("keyboard"),[et]),en=a.useCallback(()=>et("click"),[et]),ea=(0,z.MB)({onKeyDown:es,onClick:en}),ei=F?"site_kit_embeds--buttonList--mFyWC site_kit_embeds--_buttonBase--yxIbO asset_panel_tile--tileWrapperList--1SfmZ asset_panel_tile--_tileWrapperBase--BVobl library_item_tile--tileListLargeNoPadding--wn7SG library_item_tile--tile--SmMre library_item_tile--_variantHover--FYwBc library_item_tile--_tileListBase--9gped":Z(d),er=F?q.vZ:"site_kit_embeds--embedNameWrapper--kXCDZ asset_panel_tile--nameWrapper--wOdDS";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(X,{dragState:$,opacityOverride:.5}),(0,n.jsx)(b.n.div,{onPointerDown:W,className:v.s.flex.if(F,v.s.wFull).$,children:(0,n.jsxs)(r.E,{className:ei,ref:Q,onClick:ea,children:[(0,n.jsx)("div",{className:"site_kit_embeds--thumbContainer--kzYiW",style:{width:x,height:u},children:(0,n.jsx)(_.oW,{src:e.thumbnail_url,className:"site_kit_embeds--thumbnail--xOVto"})}),(0,n.jsx)("div",{className:m()(er,{"site_kit_embeds--leftPadding--eJuOg":G}),style:F?void 0:{width:x-2-H},children:(0,n.jsx)(k.G,{text:e.name})}),h&&!F&&(0,n.jsx)("div",{style:{width:x-2},children:(0,n.jsx)(k.G,{text:h,className:m()(U.Md,U.Rm)})})]})})]})}let $=(0,N.P)("recently-used-site-embeds","name",u.z.object({name:u.z.string()}),{transform:e=>({name:e.name})});function W(){return(0,d.md)($)}function Y(e,t,s){d.zl.set($,e),o.l7.user("insert-embed",()=>{l.glU?.insertEmbed(e.initial_url,{x:t.x,y:t.y,percentOffsetX:s.x,percentOffsetY:s.y},!1,{x:e.width,y:e.height}),C.Y5.triggerAction("commit")})}function X(e){let t=e.dragState;if(!t?.dragPosition||!t?.grabbedPointerPercentageOffset)return null;let s=function(e){let{draggingResource:t}=e,{zoomScale:s,x:n}=C.Y5.getViewportInfo(),a=e.dragPosition?.x;return(!a||a<n)&&e.draggingThumbSize?e.draggingThumbSize:new f.Mi(t.width,t.height).scale(s)}(t),a=t.dragPosition;return a=a.subtract(new f.Mi(t.grabbedPointerPercentageOffset.x*s.x,t.grabbedPointerPercentageOffset.y*s.y)),(0,i.createPortal)((0,n.jsx)("div",{className:m()(F.Wy,{[F.ce]:t.isDraggingOverCanvas}),style:{left:a.x,top:a.y,width:s?.x,height:s?.y,maxWidth:t.draggingThumbMaxDimensions?.x||void 0,maxHeight:t.draggingThumbMaxDimensions?.y||void 0,zIndex:e.zIndexOverride,opacity:e.opacityOverride?e.opacityOverride:1},children:(0,n.jsx)(_.oW,{src:t.draggingResource.preview_url,alt:""})}),document.getElementById("fullscreen-root"))}let Z=e=>e?"site_kit_embeds--buttonGridForFirstItem--2lIsJ site_kit_embeds--buttonGrid--W-xg2 asset_panel_responsive_set_tile--gridWrapperForBlocksRedesign--9lou- asset_panel_tile--gridWrapper--GdfPx asset_panel_tile--wrapper--KXz0O asset_panel_tile--_wrapperBase---sbFt library_item_tile--_variantHover--FYwBc site_kit_embeds--_buttonBase--yxIbO asset_panel_responsive_set_tile--gridWrapperForBlocksRedesignFirstTile--xx9ml asset_panel_responsive_set_tile--gridWrapperForBlocksRedesign--9lou- asset_panel_tile--gridWrapper--GdfPx asset_panel_tile--wrapper--KXz0O asset_panel_tile--_wrapperBase---sbFt library_item_tile--_variantHover--FYwBc":"site_kit_embeds--buttonGrid--W-xg2 asset_panel_responsive_set_tile--gridWrapperForBlocksRedesign--9lou- asset_panel_tile--gridWrapper--GdfPx asset_panel_tile--wrapper--KXz0O asset_panel_tile--_wrapperBase---sbFt library_item_tile--_variantHover--FYwBc site_kit_embeds--_buttonBase--yxIbO"},373191:(e,t,s)=>{s.d(t,{T:()=>p});var n=s(105652),a=s(787049),i=s(490643),r=s(954716),l=s.n(r),o=s(774926),c=s(605985),d=s(421564),u=s(41652),x=s(63938),m=s(880867);function p(){let e=m.ce().data?.assetsByLibraryKey,t=n.useMemo(()=>e?[...e.values()].flat():[],[e]),s=n.useMemo(()=>(0,x.u)(),[]),r=(0,o.o)(d.PW.RESPONSIVE_SET),p=(0,u.mi)(),h=(0,c.TA)(),g=n.useMemo(()=>{if(!h)return[];let e=[...r,...p].filter(e=>e.lastAddedAtUserId[h]);return(0,a.hR)(e,e=>-(e.lastAddedAtUserId[h]??0)),e},[r,p,h]);return n.useMemo(()=>{let e=l()(t??[],"key"),n=l()(s,"name");return g.map(t=>"key"in t?e[t.key]:n[t.name]).filter(i.Gh)},[g,t,s])}},345481:(e,t,s)=>{s.d(t,{A:()=>c});var n=s(239976),a=s(105652),i=s(445019),r=s(224542),l=s.n(r),o=s(332477);function c({children:e,index:t,width:s}){let r=(0,i.md)(o.h),c=a.useMemo(()=>e.flat().filter(e=>!!e),[e]),u=a.useMemo(()=>{let e=d(-Math.min(t,c.length-1)),s=`translateX(${e})`;return{transform:s,WebkitTransform:s}},[c.length,t]),x=l()("slide_carousel--container--Kq0Cw",{"slide_carousel--noTransition--ZoLKz":r});return(0,n.jsx)("div",{style:u,"data-testid":"slide-carousel",className:x,children:c.map((e,a)=>(0,n.jsx)("div",{className:"slide_carousel--item--E-J3w",style:{width:s},"data-testid":"slide-carousel-item","aria-hidden":a!==t,inert:a!==t?"":void 0,children:e},a))})}let d=e=>`${100*e}%`},776578:(e,t,s)=>{s.d(t,{C:()=>a,X:()=>i});var n=s(445019);let a=(0,s(640753).Wh)(()=>(0,n.eU)(0)),i=(0,n.eU)(!1)},955449:(e,t,s)=>{s.d(t,{vx:()=>eA,oo:()=>eP,OG:()=>eM});var n=s(239976),a=s(105652),i=s(20002),r=s(295870),l=s(245495),o=s(692376),c=s(582300),d=s(466082),u=s(379141),x=s(270450),m=s(445019),p=s(239620),h=s(224542),g=s.n(h),f=s(40297),_=s(916626),y=s(443389),k=s(184743),v=s(499735),b=s(129416),j=s(259714),C=s(154963),w=s(770785),E=s(799272),N=s(614717),S=s(814213),T=s(577355),I=s(341153),A=s(434183),M=s(1007),z=s(526465),L=s(805940),O=s(78320),P=s(456556),R=s(236410),D=s(939670),F=s(398518),q=s(763449),G=s(934470),U=s(690252),K=s(17147),H=s(871861);function B({modeNames:e}){if(0===e.length)return null;let t=1===e.length?e[0]:e[0]+" + "+(e.length-1);return(0,n.jsx)("div",{className:H.Io,"data-testid":"variable-mode-pill","data-tooltip-type":R.Ib.TEXT,"data-tooltip":(0,u.t)("variables.mode_pill.tooltip",{listOfModes:(0,K.Yx)(e)}),children:(0,n.jsx)("div",{className:H.XW,children:t})})}var V=s(564055),$=s(363198),W=s(17248),Y=s(943360),X=s(563225),Z=s(402731),J=s(610765),Q=s(965713),ee=s(422333),et=s(249080),es=s(845472),en=s(280782),ea=s(450662);function ei(){return(0,n.jsx)("div",{className:C.s.flex.itemsCenter.justifyCenter.$,children:(0,n.jsx)("div",{className:H.xE})})}class er extends a.PureComponent{constructor(){super(...arguments),this.expandMouseDown=e=>{this.props.expandMouseDown(this.props.guid,e)}}renderNodeIndents(){let e=[];for(let t=0;t<this.props.level+1;t++){let s=`[${t}]`,a=-1!==this.props.isLastMaskedAtLevels.indexOf(s),i=-1!==this.props.isMaskedAtLevels.indexOf(s),r=t===this.props.level&&this.props.mask,l=t===this.props.level&&this.props.hasChildren,o=g()(H.dK,H.co,{[H.TY]:this.props.displayOrder===J.k.DOM});e.push((0,n.jsx)("span",{className:H.pZ},t)),a?e.push((0,n.jsx)(j.B,{svg:l?en.A:ea.A,className:o},`${t}-mask`)):i?e.push((0,n.jsx)(j.B,{svg:l?es.A:et.A,className:o},`${t}-mask`)):r&&e.push((0,n.jsx)(j.B,{svg:l?ee.A:Q.A,className:o},`${t}-mask`)),this.props.hasBullet&&t===this.props.level?e.push((0,n.jsx)(Y.E,{recordingKey:v.Pt(this.props,"expandCaret"),className:H.OI,actionOnPointerDown:!0,onClick:this.expandMouseDown,"data-testid":this.props.isMeasurementNode?void 0:"new-frame-bullet",children:(0,n.jsx)(ei,{})},"expand-caret")):l&&e.push((0,n.jsx)(Y.E,{recordingKey:v.Pt(this.props,"expandCaret"),className:g()(H.GE,H.Fq),actionOnPointerDown:!0,onClick:this.expandMouseDown,children:this.props.isExpanded?(0,n.jsx)(X.O,{}):(0,n.jsx)(Z.k,{})},"expand-caret"))}return e}render(){return(0,n.jsx)("span",{ref:this.props.indentsRefCallback,className:H.Wm,children:this.renderNodeIndents()})}}er.displayName="Indents";var el=s(109965),eo=s(39899),ec=s(345123),ed=s(214708),eu=s(875833);let ex=a.memo(function(e){let{locked:t,isAncestorLocked:s,onMouseDown:i,recordingKey:r}=e,l=(0,a.useRef)(null),o=a.useCallback(e=>{e&&i(e)},[i]),c=v.rf(r,"mousedown",o),d=a.useMemo(()=>({onMouseDown:c,onKeyDownCapture:e=>{(e?.code==="Space"||e?.key==="Enter")&&c(new MouseEvent("mousedown",{altKey:e.altKey}))},onMouseLeave:()=>{l?.current&&document?.activeElement===l?.current&&l.current?.blur()},onDoubleClick:e=>e.stopPropagation()}),[c]),x=a.useMemo(()=>s&&!t?eu.Zy:(0,n.jsx)(ec.s,{"data-testid":"locked-icon"}),[s,t]),m=a.useMemo(()=>(0,n.jsx)(ed.r,{"data-testid":"unlocked-icon"}),[]);return(0,n.jsx)("span",{className:H.hz,children:(0,n.jsx)(eo.f,{ref:l,"aria-label":(0,u.t)("fullscreen.object_row.toggle_lock"),checked:t||s,onIcon:x,offIcon:m,htmlAttributes:d})})});var em=s(854225),ep=s(323264),eh=s(212198),eg=s(157750),ef=s(712515),e_=s(544392);let ey={semanticLabel:{kGuDYH:"x1k6wstc",kMv6JI:"xwjs1nl",k63SB2:"x1qxcl5b",kb6lSQ:"x1betce5",kLWn49:"xno9bf3",kMwMTN:"xtd9kr2",kpe85a:"x1jwbysl",kZCmMZ:null,kwRFfy:null,kmuXW:"x2lah0s",k9WMMc:"x1hr2gdg",kSGwAc:"xamitd3",$$css:!0},breakpointLabel:{kGuDYH:"x17akokd",k63SB2:"x1qxcl5b",kb6lSQ:"x1betce5",kLWn49:"xno9bf3",kMwMTN:"x1n0bwc9",kpe85a:"x1jwbysl",kZCmMZ:null,kwRFfy:null,kmuXW:"x2lah0s",k9WMMc:"x1hr2gdg",kSGwAc:"xamitd3",khDVqt:"xuxw1ft",$$css:!0}};function ek({guid:e,className:t,annotationRefCallback:s}){let a=(0,eg.J2)((0,eh.UK)().showSemanticTagsOnLayerRows),i=(0,P.Fk)((e,t)=>{let s=e.get(t);return s?.isAccessibilityAnnotatable??!1},e),r=(0,ef.Nf)(e),l=i&&a?r:null,o=(0,P.Fk)((e,t,s)=>{if(s)return null;let n=e.get(t);if(!n?.isResponsiveContainerBreakpoint||!n.breakpointFrameRange)return null;let a=n.breakpointFrameRange;return a.maxWidth?`${a.minWidth??"1"}-${a.maxWidth}`:`${a.minWidth??"1"}+`},e,!!l),c=null,d=null,u="";if(l?(c="semantic",d=l,u=`semantic-label-${e}`):o&&(c="breakpoint",d=o,u=`breakpoint-label-${e}`),!d||!c)return null;let x="semantic"===c?ey.semanticLabel:ey.breakpointLabel;return(0,n.jsx)("span",{className:g()(t,ep.xW(x)),ref:s,"data-testid":u,children:d})}let ev=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M8 3.5a.5.5 0 0 1 .5-.5h2a.5.5 0 1 1 0 1H10v8h.5a.5.5 0 1 1 0 1h-2a.5.5 0 0 1 0-1H9V4h-.5a.5.5 0 0 1-.5-.5m3 2a.5.5 0 0 1 .5-.5h1A1.5 1.5 0 0 1 14 6.5v3a1.5 1.5 0 0 1-1.5 1.5h-1a.5.5 0 0 1 0-1h1a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 1-.5-.5M2.5 7a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 .5.5h4a.5.5 0 1 1 0 1h-4A1.5 1.5 0 0 1 2 9.5v-2a.5.5 0 0 1 .5-.5m2.515-3.56L4.7 4.7l-1.26.315c-.505.126-.505.844 0 .97L4.7 6.3l.315 1.26c.126.505.844.505.97 0L6.3 6.3l1.26-.315c.505-.126.505-.844 0-.97L6.3 4.7l-.315-1.26c-.126-.505-.844-.505-.97 0",clipRule:"evenodd"})})});var eb=s(581121),ej=s(781962);function eC({disabled:e}){let t=(0,a.useMemo)(()=>({"data-tooltip-type":R.Ib.SPECIAL,"data-tooltip-show-above":!0,"data-tooltip-timeout-delay":50,"data-tooltip":ej.S,"data-tooltip-ai-beta-text":(0,u.t)("fullscreen.context_menu.auto_rename_layers"),"data-tooltip-ai-beta-action":eb.JT.AUTO_RENAME_LAYERS}),[]);return(0,n.jsx)(Y.E,{className:H.J0,onClick:()=>{(0,S.Br)({source:o.uQ6.LAYERS_PANEL_ACTION_ROW,trackingDataSource:"layers_panel_action_row"})},htmlAttributes:e?void 0:t,disabled:e,children:(0,n.jsx)(ev,{})})}var ew=s(191433),eE=s(340383);let eN=a.memo(function(e){let{visible:t,isAncestorHidden:s,onMouseDown:i,recordingKey:r}=e,l=(0,a.useRef)(null),o=a.useCallback(e=>{e&&i(e)},[i]),c=v.rf(r,"mousedown",o),d=a.useMemo(()=>({onMouseDown:c,onKeyDownCapture:e=>{(e?.code==="Space"||e?.key==="Enter")&&c(new MouseEvent("mousedown",{altKey:e.altKey}))},onMouseLeave:()=>{l?.current&&document?.activeElement===l?.current&&l.current?.blur()},onDoubleClick:e=>e.stopPropagation(),"data-testid":"object-row-toggle-visibility"}),[c]),x=a.useMemo(()=>s?eu.Zy:(0,n.jsx)(ew.l,{"data-testid":"visible-icon"}),[s]),m=a.useMemo(()=>(0,n.jsx)(eE.f,{"data-testid":"hidden-icon"}),[]);return(0,n.jsx)("span",{className:H.yk,children:(0,n.jsx)(eo.f,{ref:l,"aria-label":(0,u.t)("fullscreen.object_row.toggle_visibility"),checked:t,onIcon:x,offIcon:m,htmlAttributes:d})})});eN.displayName="VisibilityToggle";var eS=s(526865),eT=s(911470),eI=s(205917);let eA="layer-panel-onboarding-key";function eM(e){let t=(0,$.cJ)(),s=(0,W.sO)(),n=(e.abbreviatedStateName||e.name).replace(/\n/," ");if(t&&e.isWebpage&&e.isSiteHomepage?n=(0,u.t)("sites.panel.home"):s&&"SLIDE"===e.nodeType&&(n=(0,u.t)("slides.layers_panel.slide_number",{orderNum:e.name})),e.shouldShowGuids){let t=o.Egt.getOverridePathForNode(e.guid);return`${n} (${e.guid}): [${t}]`}return n}function ez({isPrimaryBreakpoint:e}){return(0,n.jsx)("div",{className:C.s.flex.$,children:e&&(0,n.jsx)("span",{className:C.s.colorTextBrand.pr8.$,children:(0,u.t)("sites.panel.primary")})})}function eL(e){let[t,s]=(0,a.useState)(null),[i,r]=(0,a.useState)(!1),l=(0,$.cJ)(),o=(0,m.md)((0,F.r8)(e.guid)),{showVisualLayerIcons:c}=a.useContext(L.y0);(0,a.useEffect)(()=>{s(e.isRenaming?e.name:null)},[e.name,e.isRenaming]);let d=eM({abbreviatedStateName:e.abbreviatedStateName,guid:e.guid,shouldShowGuids:e.shouldShowGuids,name:e.name,isSiteHomepage:e.isSiteHomepage,isWebpage:e.isWebpage,nodeType:e.nodeType}),p=v.rf(e.recordingKey,e.focusOnSingleClick?"click":"dblclick",()=>{O.F.trackFromFullscreen("action_rename_selection",{source:"click"}),e.startRenaming(e.guid)}),h=(0,a.useRef)(null),f=(0,a.useCallback)(e=>{e&&(h.current=e,h.current.select())},[]),_=v.AF(e.recordingKey,"change",e=>{s(e.currentTarget?.value)}),y=v.v_(e.recordingKey,"keydown",t=>{if(!i){if(t.keyCode===k.Uz.ESCAPE)e.stopRenaming(!1);else if(t.keyCode===k.Uz.ENTER)e.stopRenaming(!0,h.current?.value,d);else{if(t.keyCode!==k.Uz.TAB)return(0,T.jr)(t,T.W0.NO),v.aH;t.preventDefault(),e.stopRenaming(!0,h.current?.value,d),t.shiftKey?e.prevNodeGuid&&e.startRenaming(e.prevNodeGuid):e.nextNodeGuid&&e.startRenaming(e.nextNodeGuid)}}}),b=v.iQ(e.recordingKey,"blur",()=>{e.stopRenaming(!0,h.current?.value,d)}),w=!e.isFixedOnHScroll,E="SLIDE_ROW"===e.nodeType,N=c&&(0,x.kc)().ce_il_root;return(0,n.jsxs)(n.Fragment,{children:[E?null:N?(0,n.jsx)(V.N,{guid:e.guid,size:e.iconSize,navigateAndPanTo:e.navigateAndPanTo,isMeasurementNode:e.isMeasurementNode,rowSelected:e.isSelected}):(0,n.jsx)(el.Bf,{disabled:e.disabled,guid:e.guid,hovered:e.hovered,isSiteHomepage:e.isSiteHomepage,locked:e.locked,navigateAndPanTo:e.navigateAndPanTo,outOfView:e.outOfView,panelType:e.panelType,scrollLeft:e.scrollLeft}),(e.isThumbnail||e.isFavicon||e.isSocialImage)&&(0,n.jsx)(j.B,{"data-tooltip":e.isFavicon?(0,u.t)("fullscreen.object_row.favicon"):e.isSocialImage?(0,u.t)("fullscreen.object_row.social_image"):(0,u.t)("fullscreen.object_row.file_thumbnail"),"data-tooltip-show-above":!0,"data-tooltip-type":R.Ib.TEXT,className:H.V3,svg:eI.A}),e.isRenaming&&(0,n.jsx)(U.ks,{autoCapitalize:"off",autoCorrect:"off",className:g()(H.hF,e.inputTextOverridesClassName),innerRef:f,onBlur:b,onChange:_,onCompositionEnd:()=>r(!1),onCompositionStart:()=>r(!0),onKeyDown:y,spellCheck:!1,value:null!==t?t:e.name}),!e.isRenaming&&(0,n.jsxs)("span",{className:g()(H.qg,e.staticTextOverridesClassName,{[C.s.justifyBetween.$]:l,[C.s.eventsAuto.$]:e.isFixedOnHScroll}),onDoubleClick:e.focusOnSingleClick?void 0:p,onClick:e.focusOnSingleClick?p:void 0,dir:"auto",children:[(0,n.jsx)("div",{className:H.Xv,ref:e.layerNamePlaceholderRef,children:d}),(0,n.jsx)("div",{className:g()(H._k,{[H.r]:!w||e.isHovered||e.displayAnnotation}),ref:e.layerNameRef,children:o&&"pending"!==o.state?o.name:d}),e.explicitVariableModeNames&&e.explicitVariableModeNames.length>0&&(0,n.jsx)("div",{className:H.pS,children:(0,n.jsx)(B,{modeNames:e.explicitVariableModeNames})}),!e.isHovered&&l&&(0,n.jsx)(ez,{isPrimaryBreakpoint:e.isPrimaryBreakpoint})]})]})}let eO=a.memo(function(e){var t,s;t="object-row-inner-render-timer",y.sn.start(t),(0,a.useEffect)(()=>{let e=y.sn.get(t);e&&e.isRunning&&!e.isUnreliable&&y.sn.tryStop(t)});let{topLevelObjectRowHeight:i,nestedObjectRowHeight:u,rowSelectionGap:x,topLevelIconSize:h,nestedIconSize:_,boldLayerNames:k}=a.useContext(L.y0),j=(0,a.useRef)(null),[T,I]=(0,a.useState)(null),[A,M]=(0,a.useState)(null),[O,U]=(0,a.useState)(null),K=(0,a.useCallback)(e=>{I(e)},[]),B=(0,a.useCallback)(e=>{M(e)},[]),V=a.useCallback(e=>{U(e)},[]),W=(0,m.md)(N.eC),Y=(s=e.guid,(0,m.md)(N.Fj).has(s)),[X,Z]=(0,a.useState)(!1),[J,Q]=(0,a.useState)(!1),[ee,et]=(0,a.useState)(0),es=function({guid:e,hideLabel:t}){let s=(0,$.cJ)(),n=(0,m.md)(e_.s0),a=(0,eg.J2)((0,eh.UK)().showSemanticTagsOnLayerRows),i=(0,P.Fk)((e,t,s)=>{let n=e.get(t);return!!n&&(!!s&&!!n.isAccessibilityAnnotatable||!!n.isResponsiveContainerBreakpoint)},e,a);return!!s&&n===em.Nfd.FILE&&!t&&i}({hideLabel:!e.visible||e.isAncestorHidden||e.isRenaming||e.isDragging,guid:e.guid}),en=(0,P.Fk)((e,t)=>e.get(t)?.name??"",e.guid),ea=(0,P.Fk)((e,t)=>{let s=e.get(t);return s&&s.isState?s.stateAbbreviatedName:null},e.guid),ei=eM({abbreviatedStateName:ea,name:en,shouldShowGuids:e.shouldShowGuids,guid:e.guid,isSiteHomepage:e.isSiteHomepage,isWebpage:e.isWebpage,nodeType:e.nodeType}),el=(0,a.useCallback)(()=>{let e=j.current;return!!e&&e.scrollWidth>e.offsetWidth},[]),eo=(0,a.useCallback)(()=>{Z(el())},[Z,el]),{onContextMenu:ec}=e,ed=(0,p.rf)(e.recordingKey,"contextmenu",(0,a.useCallback)(t=>{ec&&ec(e.guid,t)},[ec,e.guid])),{onMouseEnter:ep}=e,ef=(0,p.rf)(e.recordingKey,"mouseenter",(0,a.useCallback)(t=>{eo(),Q(!0),ep&&ep(e.guid,t)},[ep,e.guid,eo])),ey=(0,a.useCallback)(()=>{Q(!1)},[]),{lockMouseDown:ev}=e,eb=(0,a.useCallback)(t=>{ev&&ev(e.guid,t)},[ev,e.guid]),{visibleMouseDown:ej}=e,ew=(0,a.useCallback)(t=>{ej&&ej(e.guid,t)},[ej,e.guid]),{onDragStartCallback:eE}=e,eI=(0,a.useCallback)(t=>{t.dataTransfer.effectAllowed="none",null!=eE&&eE(e.guid,t)},[eE,e.guid]),{onDragOverCallback:ez}=e,eO=(0,a.useCallback)(t=>{null!=ez&&ez(e.guid,t)},[ez,e.guid]),{onDragDropCallback:eP}=e,eR=(0,a.useCallback)(t=>{null!=eP&&eP(e.guid,t)},[eP,e.guid]),{onDragEnterCallback:eD}=e,eF=(0,a.useCallback)(t=>{null!=eD&&eD(e.guid,t)},[eD,e.guid]),{onDragLeaveCallback:eq}=e,eG=(0,a.useCallback)(t=>{null!=eq&&eq(e.guid,t)},[eq,e.guid]),eU=(0,a.useCallback)(()=>null!=e.nodeMemoryUsage&&null!=e.rootMemoryUsage?(0,z.pr)(e.nodeMemoryUsage,e.rootMemoryUsage,!0):((0,b.$D)(r.e.SCENEGRAPH_AND_SYNC,Error("node memory usage or root memory usage is null")),""),[e.nodeMemoryUsage,e.rootMemoryUsage]),eK=!e.visible||e.isAncestorHidden&&e.panelType!==q.g$.CodeComponent,eH=e.locked||e.isAncestorLocked,eB=(e.level+3)*(0,f.jz)(eT.indentWidthWithMargin),eV=(0,f.jz)(eT.scrollBarYWidth)+(0,f.jz)(eT.trackPadding),e$=void 0!==e.panelWidth&&eB+eV>e.panelWidth+e.scrollLeft,eW=0===e.level,eY=(0,S.A0)(o.uQ6.LAYERS_PANEL_ACTION_ROW),eX=void 0!==e.panelWidth&&eB+ee+(0,f.jz)(eT.rowActionsRightMargin)+eV>e.panelWidth+e.scrollLeft,eZ=(0,d.UN)().get(e.guid),eJ=eY&&eW&&J&&eZ&&(0,S.sq)(eZ),eQ="REACT_FIBER"!==e.nodeType&&"SLIDE"!==e.nodeType&&"SLIDE_ROW"!==e.nodeType,e0=m.md(F.r8(e.guid))?.state==="pending",e1=eW?i:u,e5=eW?h:_,e2={transform:`translate3d(0px, ${e.top}px, 0)`,height:e1,"--row-actions-width":eJ?eS.gdM:eS.yj4,"--object-row-height":`${e1}px`,"--selection-height":`${e1-2*x}px`},e3=e.fixed&&0!==e.panelWidth,e4="FRAME"===e.nodeType&&!e.isMakeEmbed,e6=g()({[H.nM]:!0,[H.M4]:eW,[H.Gt]:e4&&!(0,eu.Rt)(e)&&!e.resizeToFit&&!e.isStateGroup,[H.Os]:e4&&!(0,eu.Rt)(e)&&e.resizeToFit,[H.t$]:e4&&(0,eu.Rt)(e),[H.DT]:e.isStateGroup,[H.a6]:(0,c.MT)(e.nodeType),[H.uW]:"SECTION"===e.nodeType,[H.HR]:"SYMBOL"===e.nodeType,[H.rS]:"CODE_COMPONENT"===e.nodeType,[H.bY]:"CODE_INSTANCE"===e.nodeType,[H.$E]:e.componentLike,[H.qm]:e.layerLikeCodeNode||"REACT_FIBER"===e.nodeType,[H.xG]:"MODULE"===e.nodeType,[H.KJ]:"INSTANCE"===e.nodeType,[H.iE]:e.isStamp,[H.Zt]:"HIGHLIGHT"===e.nodeType,[H.HL]:"WIDGET"===e.nodeType||e.isWidgetSublayer||e.isMakeEmbed,[H.j3]:e.isDescendantOfSymbol,[H.cb]:e.isDescendantOfInstanceExcludingSlotSublayers,[H.NI]:(0,E.$)()&&e.isSlot,[H.vp]:e.isDescendantOfModule,[H.dK]:e.mask,[H.WO]:(0,q.qW)(e.panelType),[H.i9]:e.isWebpage,[H.Cr]:k,[H.Zu]:!!e3,[H.lh]:!!e.layerAbove,[H.yo]:e.isHovered,[H.wH]:e.isSelected,[H.ct]:e.isAncestorSelected,[H.r9]:eK,[H.xt]:eH,[H.sz]:e.hasChildren&&e.isExpanded,[H.uC]:e.isLayerAboveSelected&&e.isLayerBelowSelected,[H.ow]:e.isLayerAboveSelected&&!e.isLayerBelowSelected,[H.sc]:e.isLayerBelowSelected&&!e.isLayerAboveSelected}),e7=e.versionHistory?.activeId&&"current_version"===e.versionHistory.activeId,e8=e.showMemoryUsage&&e.showInFileMemoryPercentage&&!e.isRenaming&&e7,{registerWidth:e9}=(0,G.gz)(),te=!!e3,{observeWithResizeObserver:tt,unobserveWithResizeObserver:ts}=e;(0,a.useEffect)(()=>{if(T&&A){if(te)return;let t=()=>{let t=T.getBoundingClientRect().right-A.getBoundingClientRect().left+(0,f.jz)(eT.rowActionsWidth);e9(e.guid,t)};return t(),tt(T,t),tt(A,t),()=>{ts(T),ts(A)}}},[te,T,A,e.guid,e9,tt,ts]),(0,a.useEffect)(()=>{if(T&&A&&!te)return tt(O,e=>{e.contentRect.width>0&&et(e.contentRect.width)}),()=>{ts(O)}},[te,O,e.guid,tt,ts,T,A]);let tn=J||!e.visible||e.locked||e.isAncestorLocked||e.isAncestorHidden,ta=(0,n.jsxs)(n.Fragment,{children:[eJ&&(0,n.jsx)(eC,{disabled:e0}),eQ&&tn&&(0,n.jsx)(ex,{recordingKey:v.Pt(e,"lockIcon"),locked:e.locked,isAncestorLocked:e.isAncestorLocked,onMouseDown:eb}),eQ&&tn&&(0,n.jsx)(eN,{recordingKey:v.Pt(e,"visibleIcon"),visible:e.visible,isAncestorHidden:e.isAncestorHidden,onMouseDown:ew})]}),ti=!e.hideRowActions&&!e.isRenaming&&!e.isReadOnly&&!e.isDragging&&!e$,tr=es&&!eX,tl=(0,n.jsx)("div",{className:H.u4,"data-testid":`${e.guid}-layers-panel-row`,"data-tooltip":X?ei:null,"data-tooltip-hide-immediately":!0,"data-tooltip-max-lines":4,"data-tooltip-show-immediately":!0,"data-tooltip-show-right":!0,"data-tooltip-text-left":!0,"data-tooltip-type":R.Ib.TEXT,style:void 0===e.panelWidth?void 0:{width:te?`${e.panelWidth}px`:`${e.panelWidth+e.scrollLeft}px`},children:function(t=!1){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(er,{currentPage:e.currentPage,disabled:eK,dispatch:e.dispatch,displayOrder:e.displayOrder,expandMouseDown:e.expandMouseDown,guid:e.guid,hasBullet:Y,hasChildren:e.hasChildren,hovered:e.isHovered,indentsRefCallback:B,isExpanded:e.isExpanded,isLastMaskedAtLevels:e.isLastMaskedAtLevels,isMaskedAtLevels:e.isMaskedAtLevels,isMeasurementNode:t,level:e.level,locked:eH,mask:e.mask,outOfView:e$,recordingKey:t?void 0:v.Pt(e,"indents"),scrollLeft:e.scrollLeft}),(0,n.jsx)(eL,{...e,abbreviatedStateName:ea,disabled:eK,displayAnnotation:es,hovered:e.isHovered,iconSize:e5,isFixedOnHScroll:te,isMeasurementNode:t,layerNamePlaceholderRef:K,layerNameRef:j,locked:eH,name:en,outOfView:e$,recordingKey:t?void 0:e.recordingKey,scrollLeft:e.scrollLeft}),e.hasWarning&&(0,n.jsx)("div",{className:g()(C.s.flex.alignCenter.mr16.$,H.QW),"data-tooltip-type":R.Ib.TEXT,"data-tooltip":e.warningMessage,"data-tooltip-max-lines":4,"data-tooltip-show-immediately":!0,"data-tooltip-hide-immediately":!0,children:(0,n.jsx)(l.R,{})}),e8&&(0,n.jsx)("span",{className:H.HY,dir:"auto",children:eU()}),tr&&(0,n.jsx)("div",{style:{width:ee+(0,f.jz)(eT.rowActionsRightMargin)},className:H.Fm}),ti&&(0,n.jsx)("div",{className:H.cm})]})}()}),to=g()(H.w7,{[H.y8]:eX});return(0,n.jsxs)("div",{className:e6,"data-onboarding-key":e.guid===W&&e.isSelected&&(!e.isRowInView||e.isRowInView(e,A))?eA:void 0,"data-testid":e.hasChildren?"layer-row-with-children":"layer-row",draggable:!1,onContextMenu:ed,onDragEnter:eF,onDragLeave:eG,onDragOver:eO,onDragStart:eI,onDrop:eR,onMouseEnter:ef,onMouseLeave:ey,style:e2,children:[(ti||es)&&(0,n.jsxs)("div",{className:H.cm,style:w.sx.absolute.wFull.eventsNone.$,children:[(0,n.jsx)("div",{className:C.s.wFull.$}),(0,n.jsx)("div",{className:H.V0,children:(0,n.jsxs)("div",{className:H.Hz,children:[es&&(0,n.jsx)(ek,{guid:e.guid,annotationRefCallback:V,className:to}),ti&&ta]})})]}),(0,n.jsx)(D.e,{condition:te,wrapper:e=>(0,n.jsx)("div",{style:w.sx.absolute.wFull.eventsNone.$,children:(0,n.jsx)("div",{className:H.n4,children:(0,n.jsx)("div",{children:e})})}),children:tl})]})});eO.displayName="ObjectRow";let eP=(0,_.w)(a.memo(function(e){let t=(0,i.d4)(t=>t.mirror.appModel.hoveredNode===e.guid),s=e.hasRefToHoveredDef||t||e.isTemporarilyHovered,r=(0,I.Z)("prototype_sections_zoom"),l=a.useCallback(e=>{r((0,M.QZ)({nodeId:e,alwaysPan:!0}))},[r]),o=(0,A.o3)(e.guid);return(0,n.jsx)(eO,{...e,isHovered:s,explicitVariableModeNames:o,navigateAndPanTo:l})}),"ObjectRow")},754382:(e,t,s)=>{s.d(t,{X:()=>eQ});var n=s(239976),a=s(105652),i=s(20002),r=s(291061),l=s(363638),o=s(836848),c=s(864549),d=s(295870),u=s(692376),x=s(854225),m=s(798913),p=s(582300),h=s(466082),g=s(270450),f=s(445019),_=s(575015),y=s(224542),k=s.n(y),v=s(117298),b=s.n(v),j=s(270351),C=s(522568),w=s(443389),E=s(40297),N=s(520432),S=s(890498),T=s(184743),I=s(674851),A=s(7995),M=s(29161),z=s(861265),L=s(499735),O=s(129416),P=s(253983),R=s(875253),D=s(687934),F=s(933870),q=s(960210),G=s(450207),U=s(324880),K=s(573806),H=s(562418),B=s(772293),V=s(212198),$=s(34503),W=s(862390),Y=s(707470),X=s(323747),Z=s(394326),J=s(605985),Q=s(805940),ee=s(157750),et=s(456556);class es{constructor(e,t,s,n,a={}){this.component=e,this.onMouseDown=t,this.onMouseMove=s,this.onMouseUp=n,this.options=a,this.oldTouch=null,this.draggingID=null,this.deferredDragStart=null,this.onTouchStart=e=>{if(e.stopPropagation(),null===this.draggingID&&e.touches.length>0){let t=e.touches[0];if(this.draggingID=t.identifier,document.addEventListener("touchmove",this.onTouchMove,{passive:!1}),document.addEventListener("touchend",this.onTouchEndOrCancel),document.addEventListener("touchcancel",this.onTouchEndOrCancel),this.options.delayInMS){let s=!1;if(this.deferredDragStart=n=>{if(s)return!1;let a=n.clientX-t.clientX,i=n.clientY-t.clientY;return!(10>Math.sqrt(a*a+i*i))&&(s=!0,!this.options.delayInMS&&(this.onMouseDown(this.mouseEvent("mousedown",e,t)),!0))},this.options.delayInMS){let n=this.deferredDragStart;setTimeout(()=>{this.deferredDragStart!==n||s||(this.deferredDragStart=null,this.onMouseDown(this.mouseEvent("mousedown",e,t)))},this.options.delayInMS)}}else this.deferredDragStart=null,this.onMouseDown(this.mouseEvent("mousedown",e,t))}},this.onTouchMove=e=>{if(e.stopPropagation(),null!==this.draggingID){for(let t of e.touches)if(t.identifier===this.draggingID){if(this.deferredDragStart){if(!this.deferredDragStart(t))break;this.deferredDragStart=null}e.preventDefault(),this.onMouseMove(this.mouseEvent("mousemove",e,t));break}}},this.onTouchEndOrCancel=e=>{e.stopPropagation(),null!==this.draggingID&&(this.draggingID=null,document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEndOrCancel),document.removeEventListener("touchcancel",this.onTouchEndOrCancel),this.deferredDragStart?this.deferredDragStart=null:this.onMouseUp(this.mouseEvent("mouseup",e,this.oldTouch)))}}mouseEvent(e,t,s){this.oldTouch=s;let n=new MouseEvent(e,{altKey:t.altKey,metaKey:t.metaKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,screenX:s.screenX,screenY:s.screenY,clientX:s.clientX,clientY:s.clientY});return Object.defineProperty(n,"target",{value:t.target}),Object.defineProperty(n,"currentTarget",{value:t.currentTarget}),n}}var en=s(336719),ea=s(880197),ei=s(330116),er=s(379141),el=s(490096),eo=s(639184),ec=s(826151),ed=s(859100),eu=s(614717),ex=s(689966),em=s(215496),ep=s(527205),eh=s(955449),eg=s(890305),ef=s(271625);function e_(){let{show:e,isShowing:t,complete:s,uniqueId:i}=(0,ed.e)({overlay:ef.xtb,priority:em.N.SECONDARY_MODAL}),r=ex.y.isApple(),l=a.useMemo(()=>(0,n.jsx)(el.S,{shortcut:r?"\u2303\u21E7A":"Ctrl+Alt+Shift+A"}),[r]);return(0,ec.E)(i,eu.in,()=>{e({canShow:()=>!!(0,g.kc)().ce_al_show_msal_onboarding})}),(0,n.jsx)(ep.rq,{arrowPosition:eg.F_.LEFT_TITLE,description:(0,er.tx)("fullscreen.msal_onboarding.body"),disableHighlight:!0,emphasized:!0,isShowing:t,onClose:s,onTargetLost:s,primaryCta:{label:(0,er.tx)("general.got_it"),type:"button",onClick:s,variantOverride:"primary",ctaTrackingDescriptor:eo.c.GOT_IT},secondaryCta:{label:(0,er.tx)("general.learn_more"),type:"link",href:"https://help.figma.com/hc/articles/5731482952599#suggest",ctaTrackingDescriptor:eo.c.LEARN_MORE},targetKey:eh.vx,title:(0,n.jsx)("p",{"data-testid":"msal-onboarding-title",children:(0,er.tx)("fullscreen.msal_onboarding.header_with_shortcut",{msalShortcut:l})}),trackingContextName:"MSAL Onboarding Overlay"})}var ey=s(690149),ek=s(398518),ev=s(665933),eb=s(564055),ej=s(522755),eC=s.n(ej),ew=s(955394),eE=s(251799),eN=s(223487);function eS({ids:e,thumbnailEdits:t,focusedNodeId:s,width:i,height:r}){let l=(0,eN.tS)(),[o,c]=(0,a.useState)([]),[d]=(0,ew.A)(o,100,{equalityFn:eM});(0,a.useEffect)(()=>{if(d.length){let e=[...d];s&&e.includes(s)&&(e=[s,...e.filter(e=>e!==s)]),eC()(e,5).forEach((e,t)=>{e.forEach(e=>{let n=e===s;setTimeout(()=>(0,eE.I6)(e,n,l||"",i,r),40*t)})}),c(t=>t.filter(t=>!e.includes(t)))}},[d,s,l,i,r]);let u=(0,a.useCallback)(e=>{c(t=>t.includes(e)?t:[...t,e])},[]);return(0,n.jsx)(n.Fragment,{children:e.map(e=>(0,n.jsx)(eA,{guid:e,editCount:t.get(e)||0,requestThumbnailGeneration:u},e))})}let eT=(0,s(640753).Wh)(()=>(0,f.eU)({})),eI=(0,f.Iz)(e=>(0,f.eU)(t=>t(eT)[e]??null,(t,s,n)=>{let a=t(eT);s(eT,{...a,[e]:n})}));function eA({guid:e,editCount:t,requestThumbnailGeneration:s}){let[i,r]=(0,f.fp)(eI(e)),[l]=(0,ew.A)(t,400);return(0,a.useEffect)(()=>()=>{r(l)},[l,r]),(0,a.useEffect)(()=>{l===i&&(0,eE.lp)(e)||s(e)},[e,l,s,i]),(0,n.jsx)(n.Fragment,{})}function eM(e,t){return e.length===t.length&&e.every((e,s)=>e===t[s])}function ez(e){let{topLevelIconSize:t}=a.useContext(Q.y0),s=(0,et.wA)((e,t)=>t.filter(t=>{let s=e.get(t)?.type;return!!s&&!eb.w.includes(s)}),e.ids),i=(0,et.$y)((e,t)=>u.glU?u.glU.getLastEditTimes(t).reduce((e,s,n)=>(e.set(t[n],s),e),new Map):new Map,e.ids);return(0,n.jsx)(eS,{ids:s,thumbnailEdits:i,focusedNodeId:e.focusedNodeId,width:2*t,height:2*t})}var eL=s(776578),eO=s(154963),eP=s(934470),eR=s(871861);function eD({guid:e,objectRow:t,setRowWidth:s}){let i=(0,a.useRef)(null),[r,l]=(0,a.useState)(),{rowWidthsCache:o}=(0,eP.gz)();return(0,a.useEffect)(()=>{if(!i.current||!e)return;let t=o[e];void 0!==t&&(t!==r?.width||e!==r?.guid)&&l({width:t,guid:e})}),(0,a.useEffect)(()=>{r?.guid===e&&s({guid:e,width:r.width})},[r,e,s]),(0,n.jsx)("div",{ref:i,className:k()(eO.s.absolute.invisible.$,eR.Qr),"data-testid":"autoscroll-measurement-node",children:t})}var eF=s(259714),eq=s(763449),eG=s(570547);function eU(e){let{top:t,width:s,guid:i,level:r,onMouseEnter:l,recordingKey:o}=e,{nestedObjectRowHeight:c}=a.useContext(Q.y0),d=L.rf(o,"click",e=>{W.bd([i])}),u={transform:`translate3d(0px, ${t}px, 0)`,width:s,height:c},x={width:eq.iy*r*2,marginRight:1===r?eq.iy/2:0};return(0,n.jsxs)("div",{className:"layer_expansion_row--layerExpansionRow--Mwh1X object_row--row--RUzis",style:u,onMouseDown:e=>e.stopPropagation(),onClick:d,onMouseEnter:l,role:"button",tabIndex:0,children:[(0,n.jsx)("span",{className:"layer_expansion_row--layerExpansionIndent--0jjBH object_row--indent--aWa0t",style:x}),(0,n.jsx)("span",{className:"layer_expansion_row--iconWrapper--W2uQT object_row--iconWrapper--pkwhY",children:(0,n.jsx)(eF.B,{svg:eG.A})}),(0,n.jsx)("span",{className:"layer_expansion_row--rowText--jZvwm object_row--rowText--sye-W ellipsis--ellipsis--70pHK",children:(0,er.tx)("design_systems.component_properties.see_all_layers")})]})}var eK=s(648211);class eH extends L.o6{renderPlainIndents(e){let t=[];for(let s=0;s<e+1;s++)t.push((0,n.jsx)("span",{className:eR.pZ},s));return(0,n.jsx)("span",{className:eR.Wm,children:t})}render(){let e={transform:`translate3d(0px, ${this.props.top}px, 0)`,width:this.props.width,height:eK.n,"--selection-height":`${eK.n}px`,"--row-gap":"0px"},t=k()(eR.nM,eR.bV,{[eR.ct]:this.props.isParentSelected,[eR.j3]:this.props.isDescendantOfSymbol,[eR.cb]:this.props.isDescendantOfInstanceExcludingSlotSublayers,[eR.sc]:this.props.isParentSelected&&this.props.sectionHasChildren});return(0,n.jsxs)("div",{className:t,style:e,children:[this.renderPlainIndents(this.props.level),this.props.sectionType===u.KjJ.FIXED?(0,er.t)("fullscreen.properties_panel.constraints_resizing_panel.fixed"):(0,er.t)("fullscreen.properties_panel.scrolls")]})}}eH.displayName="SectionRow";var eB=s(62683),eV=s(215299),e$=s(911470);let eW="objects_panel--dropTargetBox--cAg3Y",eY=new I.V;function eX(e){return"object"===e.rowType?e.guid:"layer-expansion"===e.rowType?`expand-${e.containingPrimaryInstanceGUID}`:e.sectionId}class eZ extends L.o6{constructor(e){super(e),this.state={scrollTop:0,scrollLeft:0,mouseDown:null,dropTarget:null,needsScrollLine:!1,rowToScrollToData:null},this.cachedAllRowData=[],this.topByGuid=Object.create(null),this.leftByGuid=Object.create(null),this.heightByGuid=Object.create(null),this.totalHeight=0,this.cachedAllObjectRowDataMap={},this.setNeedsScrollLine=e=>{this.setState({needsScrollLine:e>0})},this.rangeSelectAnchorNodeId=null,this.getScene=()=>this.props.sceneGraph||(0,h.UN)(),this.initializeRows=e=>{let t=this.getScene(),s=e.customRowBuilder?e.customRowBuilder():(0,eB.Sk)({sceneGraph:t,rootNodeGuids:e.topNodeProperties?.children??[],showImmutableFrameSublayers:e.showImmutableFrameSublayers,temporarilyExpandedInstanceLayers:e.temporarilyExpandedInstanceLayers,topLevelObjectRowHeight:e.topLevelObjectRowHeight,nestedObjectRowHeight:e.nestedObjectRowHeight,focusedNodes:e.focusedNodes});this.topByGuid=s.topByGuid,this.leftByGuid=s.leftByGuid,this.heightByGuid=s.heightByGuid,this.sectionById=s.sectionById,this.totalHeight=s.totalHeight,this.cachedAllRowData=s.rowData,f.zl.set(eL.X,s.rowData.filter(eq.N1).some(e=>e.isExpanded&&e.hasChildren)),this.cachedAllObjectRowDataMap=s.rowData.filter(eq.N1).reduce((e,t)=>(e[t.guid]=t,e),{})},this.updateAllVisibleRowGuids=()=>{let e=[];for(let t of this.cachedAllRowData)(0,eq.N1)(t)&&e.push(t.guid);this.context.registerGuids(e)},this.justToggledExpandedGuid=null,this.anchorNodeId=null,this.topNodeDelta=0,this.cancelExpandMeasurement=null,this.lastCollapsedScrollPosition=null,this.scrollAfterNodeExpanded=!1,this.lastCollapsedGuid=null,this.hasCrossedDragThreshold=!1,this.onLeftPanelCollapsedChange=e=>{if(!e){let e=this.getTopSelectedNodeId();e&&this.scrollToNode({nodeId:e})}},this.scrollToNodeIdAfterUpdate=null,this.scrollToNode=({nodeId:e,forStackInsertion:t})=>{let s=this.topByGuid[e],n=void 0!==s,a=this.state.rowToScrollToData?.guid===e;if(!n||!a){let t=this.getScene().get(e);t&&t.parentGuid&&W.hq(t.parentGuid),this.scrollToNodeIdAfterUpdate=e;return}let i=this.heightByGuid[e],r=!this.isVerticallyVisible(s,s+i),l=this.shouldHorizontallyAutoscroll(e);(r||l)&&this.scrollNodeIntoView(e,{forStackInsertion:t})},this.recalculateLayout=()=>{this.windowInnerHeight=window.innerHeight,this.recalculateRequested=!1},this.recalculateRequested=!1,this.requestRecalculateLayout=()=>{this.recalculateRequested||requestAnimationFrame(this.recalculateLayout)},this.isScrolling=!1,this.scrollingTimeout=null,this.handleMouseEnterAfterScroll=null,this.hasTrackedHScrollEvent=!1,this.trackScroll=l.v.getFeatureGate("track_layers_panel_scrolling_frame_rate"),this.scrollingVital=null,this.onScroll=e=>{this.isScrolling=!0,this.nextScrollTop=e,null==this.frameRequestY&&(this.frameRequestY=requestAnimationFrame(this.setScrollTopState)),null!=this.scrollingTimeout&&clearTimeout(this.scrollingTimeout),this.scrollingTimeout=setTimeout(this.doneScrolling,50),this.props.onScroll(e),this.setNeedsScrollLine(e),f.zl.set(ek.uK,{autoScroll:!1}),this.trackScroll&&null===this.scrollingVital&&(this.scrollingVital=A.J.createVital("critical-interactions.layers-panel-scroll",{level:r.$b.INFO,trackFps:!0}),this.scrollingVital.start())},this.onScrollLeftChanged=(e,t)=>{t||this.props.stopRenaming(!1),this.nextScrollLeft=e,null==this.frameRequestX&&(this.frameRequestX=requestAnimationFrame(this.setScrollLeftState)),this.hasTrackedHScrollEvent||((0,C.sx)("layers_horizontal_scroll"),this.hasTrackedHScrollEvent=!0)},this.doneScrolling=()=>{this.isScrolling=!1,this.scrollingTimeout=null,this.handleMouseEnterAfterScroll&&(this.handleMouseEnterAfterScroll(),this.handleMouseEnterAfterScroll=null),this.scrollingVital?.stop(),this.scrollingVital=null},this.frameRequestY=null,this.frameRequestX=null,this.nextScrollTop=0,this.nextScrollLeft=0,this.setScrollTopState=()=>{this.setState({scrollTop:this.nextScrollTop}),this.frameRequestY=null},this.setScrollLeftState=()=>{this.setState({scrollLeft:this.nextScrollLeft}),this.frameRequestX=null},this.isNodeSticky=e=>((0,O.xO)(d.e.FIGJAM,this.props),e.parentGuid===this.props.currentPage&&("SYMBOL"===e.type||"FRAME"===e.type&&!e.resizeToFit)),this.isAncestorSticky=e=>{let t=this.getScene(),s=e.parentGuid?t.get(e.parentGuid):null;for(;s&&s.guid!==this.props.currentPage;){if(this.isNodeSticky(s))return!0;s=s.parentGuid?t.get(s.parentGuid):null}return!1},this.stickyHeaderGuid=null,this.lastStickyHeaderGuid=null,this.lastExpansionTarget=null,this.findStickyHeaderRowAndReplaceInVisibleRows=e=>{if(this.stickyHeaderGuid=null,(this.state.scrollTop>0||this.scrollAfterNodeExpanded)&&e.length>0){let t;let s=this.state.scrollTop,n=(e,t,s)=>{if("object"!==e.rowType)return!1;let n=this.findStickyHeader(e,t,s);if(n){let t=this.renderedVisibleRowProps.indexOf(e);t>=0?this.renderedVisibleRowProps[t]=n:this.renderedVisibleRowProps.push(n)}return!!n},a=null;for(let i=0;i<e.length;i++)if(0===(t=e[i]).level){if(a&&n(a,a.top,t.top)||t.top>s)return;a=t}(0,o.KF)(!!a,"has at least one top level section"),n(a,a.top,Number.POSITIVE_INFINITY)}},this.scrollNodeIntoView=(e,t)=>{let s=t&&t.fromAIRename||!1,n=t&&t.forStackInsertion||!1;if(null==this.topByGuid[e]||this.shouldHorizontallyAutoscroll(e)&&this.state.rowToScrollToData?.guid!==e||!this.scrollContainerEl||!this.scrollContainer)return;let a=this.topByGuid[e],i=this.heightByGuid[e],r=this.state.scrollTop,l=this.scrollContainerHeight();if(this.stickyHeaderGuid===e){n&&this.scrollContainer.scrollTo(a-1);return}let o=this.getScene().get(e);if(!o)return;s||f.zl.set(ek.uK,{autoScroll:!1});let c=this.isAncestorSticky(o);if(c&&a<r+i?this.scrollContainer.scrollTo(a-i):!c&&a<r?this.scrollContainer.scrollTo(a):a+i>r+l&&this.scrollContainer.scrollTo(a-l/2),this.shouldHorizontallyAutoscroll(e)&&this.state.rowToScrollToData?.guid===e&&this.state.rowToScrollToData?.width){let t=this.getNewHorizontalAutoscrollPosition(e,this.state.rowToScrollToData?.width);void 0!==t&&this.scrollContainer.scrollToLeft(t)}},this.measureCriticalInteractionRightClick=!!(l.v.getFeatureGate("critical_interaction_layers_panel_right_click")&&!(0,_.PN)()&&window?.performance?.mark),this.measureCriticalInteractionRowToggle=!!(l.v.getFeatureGate("critical_interaction_layers_panel_row_toggle")&&!(0,_.PN)()&&window?.performance?.mark),this.runAfterFramePaintCancel=null,this.rowContextMenu=(e,t)=>{if(this.props.onRowContextMenu){this.props.onRowContextMenu(e,t);return}let s=this.getScene().get(e);if(!s)return;(0,en.sp)(this.getScene(),this.props.sceneGraphSelection,s.guid)||this.updateSelection(s.guid);let{clientX:n,clientY:a}=t;this.props.dispatch(G.j7({type:U.Rb,data:{clientX:n,clientY:a}})),this.measureCriticalInteractionRightClick&&(this.runAfterFramePaintCancel=(0,z.Z)(()=>{try{let e=window.performance.measure("critical-interactions:layers-panel-right-click-duration","critical-interactions:layers-panel-right-click-start");A.J.logVital("critical-interactions.layers-panel-right-click",{level:r.$b.INFO,startTime:window.performance.timeOrigin+e.startTime,duration:e.duration})}catch(e){(0,O.$D)(d.e.FRONTEND_PLATFORM,e)}}))},this.rowContainerMouseDown=L.cZ(this,"mousedown",e=>{let t=this.guidAtMousePosition(e.clientY);if(!t||(e.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&!this.props.renamingGuid&&document.activeElement.blur(),this.props.ignoreRightClickForSelection&&2===e.button))return;let s=2===e.button||0===e.button&&e.ctrlKey;if(this.measureCriticalInteractionRightClick&&s&&(this.runAfterFramePaintCancel&&this.runAfterFramePaintCancel(),window.performance.mark("critical-interactions:layers-panel-right-click-start")),this.props.onSelectNodesFromLayersPanel?.(),(this.props.allowToggleSelection??!0)&&(0,T.Fo)(e)){this.toggleSelected(t);return}(0,g.kc)().version_diffing&&this.props.editModeType===x.m1T.COMPARE_CHANGES&&u.glU.setActiveChange(t)&&this.props.showViewChangesNotification(t);let n=(0,c.IL)(this.props.sceneGraphSelection),a=null;if(n?a=n:this.rangeSelectAnchorNodeId&&(0,en.K3)(this.props.sceneGraphSelection,this.rangeSelectAnchorNodeId)&&(a=this.rangeSelectAnchorNodeId),(this.props.allowSelectRange??!0)&&e.shiftKey&&a){W.GL(a,t),B.Y5.commit();return}(0,en.sp)(this.getScene(),this.props.sceneGraphSelection,t)||(this.updateSelection(t),this.rangeSelectAnchorNodeId=t),(0,K.i)(e)||this.setState({mouseDown:new R.Mi(e.clientX,e.clientY)})},{recordMetadata:e=>{let t=this.guidAtMousePosition(e.clientY);return(0,o.KF)(!!t,"interaction test does not support rare case of no guid under mouse (empty layers panel?)"),{path:(0,eq.eT)(t,this.getScene()),clientX:e.clientX}},playbackMetadata:e=>{let t=(0,eq.g2)(e.path,this.getScene(),this.props.currentPage),s=this.topByGuid[t]+this.heightByGuid[t]/2;return{clientY:this.clientY(s),clientX:e.clientX}}}),this.onMouseMove=e=>{if(this.scrollContainer&&this.scrollContainerEl&&this.state.mouseDown&&!this.props.renamingGuid){this.state.mouseDown.distanceTo({x:e.clientX,y:e.clientY})>3&&(this.hasCrossedDragThreshold=!0);let t=this.relativeY(e.clientY),s=this.state.scrollTop,n=this.scrollContainerHeight();if(n>0){if(t<s){this.scrollContainer.scrollTo(s-(0,eq.bm)(s-t,this.props.topLevelObjectRowHeight));return}if(t>s+n){this.scrollContainer.scrollTo(s+(0,eq.bm)(t-s-n,this.props.topLevelObjectRowHeight));return}}let a=(0,eq.OL)(this.getScene(),this.props.sceneGraphSelection,this.topByGuid,this.heightByGuid,this.sectionById,e.clientX-this.state.mouseDown.x,t,this.mouseOverStickyHeaderGuid(e.clientY),this.props.panelType??eq.g$.Object,this.props.topNodeProperties,this.props.insertionLineBoxOffset);this.state.dropTarget&&a&&this.state.dropTarget.index!==a.index&&N.H.trigger(u.JA.SNAP),(this.hasCrossedDragThreshold||!a)&&(this.expandDropTargetIfNeeded(a,t),this.setState({dropTarget:a}))}},this.onMouseUp=L.cZ(this,"mouseup",e=>{let t=this.getScene(),s=!1;if(this.hasCrossedDragThreshold=!1,this.state.mouseDown&&!this.props.renamingGuid){if(s=!0,3>=this.state.mouseDown.distanceTo(new R.Mi(e.clientX,e.clientY))){if(!(0,K.i)(e)){let t=this.guidAtMousePosition(e.clientY);t?this.updateSelection(t):s=!1}}else if(!this.props.isReadOnly){let s=(0,eq.OL)(t,this.props.sceneGraphSelection,this.topByGuid,this.heightByGuid,this.sectionById,e.clientX-this.state.mouseDown.x,this.relativeY(e.clientY),this.mouseOverStickyHeaderGuid(e.clientY),this.props.panelType??eq.g$.Object,this.props.topNodeProperties,this.props.insertionLineBoxOffset);if(!s)return;let{parentGuid:n,index:a,section:i}=s,r=t.get(n);if(!r||void 0===a)return;let l=e.altKey,o=(0,eq.Lc)(r,a);l?(this.props.onSelectNodesFromLayersPanel?.(),m.l7.user("duplicate-selection",()=>W.kH(r.guid,o,i))):(this.props.onSelectNodesFromLayersPanel?.(),m.l7.user("reparent-selection",()=>W.Yu(r.guid,o,i))),W.hq(r.guid),u.Egt.clearTemporarilyExpanded(),B.Y5.commit()}}if(this.setState({mouseDown:null,dropTarget:null}),this.isDraggingToToggle&&(s=!0,this.isDraggingToToggle=null,B.Y5.commit()),!s)return L.aH},{recordMetadata:e=>{let t=this.getScene(),s=this.guidAtMousePosition(e.clientY),n=this.relativeY(e.clientY);(0,o.KF)(!!s,"interaction test does not support rare case of no guid under mouse (empty layers panel?)");let a=this.topByGuid[s],i=this.heightByGuid[s];return{path:(0,eq.eT)(s,t),treatAsEndOfClick:!!(this.state.mouseDown&&5>this.state.mouseDown.distanceTo(new R.Mi(e.clientX,e.clientY))),belowAll:n>a+i,clientX:e.clientX,aboveAll:n<a}},playbackMetadata:e=>{if(e.treatAsEndOfClick)return{clientX:this.state.mouseDown.x,clientY:this.state.mouseDown.y};{let t=(0,eq.g2)(e.path,this.getScene(),this.props.currentPage),s=this.topByGuid[t]+this.heightByGuid[t]/2;return e.belowAll&&(s+=this.heightByGuid[t]),e.aboveAll&&(s-=this.heightByGuid[t]),{clientY:this.clientY(s),clientX:e.clientX}}}}),this.setRowToScrollToData=e=>{this.setState({rowToScrollToData:e})},this.getNewHorizontalAutoscrollPosition=(e,t)=>{let s=this.leftByGuid[e];if(void 0===s)return;let n=s-16;return this.isOutOfViewLeft(e)?Math.max(0,n):this.isOutOfViewRight(e)&&t?t-s>(this.props.width??0)?n:t-(this.props.width??0):void 0},this.onScrollContainerMouseDown=()=>{W.wr(),B.Y5.commit()},this.cachedScrollContainerHeight=0,this.scrollContainerRef=e=>{this.scrollContainer=e,this.scrollContainerEl=e?.getClipContainer(),this.scrollContainerEl&&(0,g.kc)().obj_panel_caching&&(this.setupScrollContainerResizeObserver(this.scrollContainerEl),this.cachedScrollContainerHeight=this.scrollContainerEl.clientHeight)},this.containerMouseLeave=e=>{W.Uc(""),null!=this.hoverToExpandGroupTimeout&&clearTimeout(this.hoverToExpandGroupTimeout)},this.executeExpand=(e,t)=>{let s=this.getScene().get(e);if(!s)return;t.stopPropagation(),(0,C.sx)("objects_panel_expand",{nonInteraction:0});let n=!s.isExpanded;t.altKey?W.sK(s.guid,n):(0,T.Fo)(t)&&!(0,c.Im)(this.props.sceneGraphSelection)?W.yF(s.guid,n):W.sq(s.guid,n),this.justToggledExpandedGuid=s.guid},this.expandMouseDown=(e,t)=>{this.measureCriticalInteractionRowToggle?(this.cancelExpandMeasurement&&(this.cancelExpandMeasurement(),this.cancelExpandMeasurement=null),this.cancelExpandMeasurement=(0,S.E)("layers-panel-row-toggle",()=>this.executeExpand(e,t))):this.executeExpand(e,t)},this.isDraggingToToggle=null,this.lockMouseDown=(e,t)=>{let s=this.getScene().get(e);if(!s||this.props.isReadOnly)return;t.stopPropagation();let n=!s.locked;this.isDraggingToToggle={locked:n},m.l7.user("set-locked",()=>{W.tU(s.guid,n,t.altKey)})},this.visibleMouseDown=(e,t)=>{let s=this.getScene().get(e);if(!s||this.props.isReadOnly)return;t.stopPropagation();let n=!s.visible;this.isDraggingToToggle={visible:n},m.l7.user("set-visible",()=>{W.pr(s.guid,n,t.altKey)})},this.hoverToExpandGroupTimeout=null,this.rowMouseEnter=(e,t)=>{let s=this.getScene().get(e);if(!s)return;let n=()=>{if(this.isDraggingToToggle){let{locked:e,visible:t}=this.isDraggingToToggle;null!=e&&m.l7.user("set-locked",()=>(function(e,t,s){e&&e0(e,s,e=>{e.locked=t})})(s,e,!1)),null!=t&&m.l7.user("set-visible",()=>(function(e,t,s){e&&e0(e,s,e=>{e.visible=t})})(s,t,!1))}this.state.mouseDown||W.Uc(s.guid)};M.Ay.firefox&&this.isScrolling?this.handleMouseEnterAfterScroll=n:n()},this.onDragDrop=(e,t)=>{this.onMouseUp(t.nativeEvent)},this.onDragOver=(e,t)=>{this.onMouseMove(t.nativeEvent)},this.onDragEnter=(e,t)=>{this.onMouseMove(t.nativeEvent),this.rowMouseEnter(e,t)},this.onDragLeave=(e,t)=>{this.onMouseMove(t.nativeEvent)},this.renderedVisibleRowProps=[],this.touchAdapter=new es(this,this.rowContainerMouseDown,this.onMouseMove,this.onMouseUp,{delayInMS:500}),this.getIsRowInView=(e,t)=>{if(!this.scrollContainer)return!0;let s=this.scrollContainer.getClipContainer().getBoundingClientRect();if(!t)return!0;let n=t.getBoundingClientRect();return e.fixed&&(this.props.width??0)!==0||n.top>=s.top&&n.bottom<=s.bottom},this.recalculateLayout(),this.initializeRows(this.props),this.scrollContainerInnerRef=a.createRef()}componentDidMount(){super.componentDidMount(),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),window.addEventListener("resize",this.requestRecalculateLayout),B.Y5.fromFullscreen.on("scrollToNode",this.scrollToNode);let e=u.glU&&u.glU.getFirstSelectedNodeIdForCurrentPage();e&&this.scrollToNode({nodeId:e}),this.updateAllVisibleRowGuids(),this.props.scrollContainerInnerRef?.(this.scrollContainerInnerRef);let t="objects-panel-inner-render-timer",s=w.sn.get(t);s&&s.isRunning&&!s.isUnreliable&&w.sn.tryStop(t)}componentWillUnmount(){super.componentWillUnmount(),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("resize",this.requestRecalculateLayout),B.Y5.fromFullscreen.removeListener("scrollToNode",this.scrollToNode),this.cancelExpandMeasurement&&(this.cancelExpandMeasurement(),this.cancelExpandMeasurement=null),this.scrollContainerResizeObserver&&(this.scrollContainerResizeObserver.disconnect(),this.scrollContainerResizeObserver=void 0),l.v.getFeatureGate("critical_interaction_layers_panel_right_click")&&this.runAfterFramePaintCancel&&this.runAfterFramePaintCancel()}updateSelection(e){this.props.onSelectionUpdated?this.props.onSelectionUpdated(e):((0,Z.S)("panel"),W.tJ([e]),B.Y5.commit())}UNSAFE_componentWillUpdate(e){if(e.renamingGuid&&e.renamingGuid!==this.props.renamingGuid)this.scrollToNodeIdAfterUpdate=e.renamingGuid;else if(e.currentPage&&e.currentPage!==this.props.currentPage){let e=u.glU&&u.glU.getFirstSelectedNodeIdForCurrentPage();e&&(this.scrollToNodeIdAfterUpdate=e)}let t=this.props.focusedNodes!==e.focusedNodes,s=this.props.objectsPanelRowRebuildCounter!==e.objectsPanelRowRebuildCounter,n=this.props.customRowBuilder!==e.customRowBuilder;if((s||n||this.props.currentPage!==e.currentPage||this.props.showImmutableFrameSublayers!==e.showImmutableFrameSublayers||!b()(this.props.temporarilyExpandedInstanceLayers,e.temporarilyExpandedInstanceLayers)||!b()(this.props.temporarilyHoveredNodes,e.temporarilyHoveredNodes)||t&&(0,g.kc)().ce_il_layer_focus||!b()(this.props.topNodeProperties?.children,e.topNodeProperties?.children))&&this.initializeRows(e),this.anchorNodeId=null,this.topNodeDelta=0,s){if(null!==this.justToggledExpandedGuid)this.justToggledExpandedGuid===this.stickyHeaderGuid?(this.lastCollapsedScrollPosition=this.state.scrollTop,this.lastCollapsedGuid=this.justToggledExpandedGuid,this.scrollToNodeIdAfterUpdate=this.stickyHeaderGuid):this.justToggledExpandedGuid===this.lastCollapsedGuid&&this.justToggledExpandedGuid===this.lastStickyHeaderGuid&&this.topByGuid[this.lastStickyHeaderGuid]===this.state.scrollTop&&(this.scrollAfterNodeExpanded=!0),this.justToggledExpandedGuid=null;else{let e=!1;for(let t of this.renderedVisibleRowProps)if("object"===t.rowType&&this.scrollContainer&&(0,eq.U$)(t,0,this.scrollContainer.getTrackHeight(),this.state.scrollTop)&&this.props.sceneGraphSelection[t.guid]){e=!0;break}let t=null,s=null;for(let n of this.renderedVisibleRowProps)"object"===n.rowType&&this.scrollContainer&&(0,eq.U$)(n,0,this.scrollContainer.getTrackHeight(),this.state.scrollTop)&&((!e||this.props.sceneGraphSelection[n.guid])&&(null===t||t>n.top)&&(t=n.top,this.anchorNodeId=n.guid),(null===s||s>n.top)&&(s=n.top,this.topNodeDelta=this.topByGuid[n.guid]-n.top))}}}componentDidUpdate(e,t){if(super.componentDidUpdate(e,t),!this.scrollContainer)return;if(this.updateAllVisibleRowGuids(),this.scrollToNodeIdAfterUpdate){this.scrollNodeIntoView(this.scrollToNodeIdAfterUpdate);let e=void 0!==this.topByGuid[this.scrollToNodeIdAfterUpdate],t=this.state.rowToScrollToData?.guid===this.scrollToNodeIdAfterUpdate;e&&t&&(this.scrollToNodeIdAfterUpdate=null)}else if(this.scrollAfterNodeExpanded)null!=this.lastCollapsedScrollPosition&&this.scrollContainer.scrollTo(this.lastCollapsedScrollPosition),this.scrollAfterNodeExpanded=!1,this.lastCollapsedScrollPosition=null,this.lastCollapsedGuid=null;else{let e=this.scrollContainer.getScrollTop()+this.topNodeDelta,t=!1;for(let s of this.renderedVisibleRowProps)if("object"===s.rowType&&s.guid===this.anchorNodeId){t=(0,eq.U$)(s,0,this.scrollContainer.getTrackHeight(),e);break}t?this.scrollContainer.scrollTo(e):this.anchorNodeId&&this.scrollNodeIntoView(this.anchorNodeId)}let s="objects-panel-inner-render-timer",n=w.sn.get(s);n&&n.isRunning&&!n.isUnreliable&&w.sn.tryStop(s)}getTopSelectedNodeId(){let e;let t=Object.keys(this.props.sceneGraphSelection),s=1/0;for(let n of t){let t=this.topByGuid[n];t<s&&(s=t,e=n)}return e}findStickyHeader(e,t,s){let n=this.state.scrollTop,a=this.getScene().get(e.guid);if(!a||!e.hasChildren||!(e.isExpanded||e.isTemporarilyExpanded))return null;let i=t<=n&&s>n+e.height,r=s>n&&s<=n+e.height;return(this.scrollAfterNodeExpanded||i||r)&&this.isNodeSticky(a)?i?(this.stickyHeaderGuid=e.guid,this.lastStickyHeaderGuid=this.stickyHeaderGuid,{...e,fixed:!0}):r?{...e,top:s-e.height,layerAbove:!0}:this.scrollAfterNodeExpanded&&e.guid===this.lastStickyHeaderGuid?(this.stickyHeaderGuid=e.guid,this.lastStickyHeaderGuid=this.stickyHeaderGuid,{...e,fixed:!0}):null:null}expandDropTargetIfNeeded(e,t){let s=null;if(e&&"sticky"!==e.parentTop){let n=this.getScene().get(e.parentGuid);(0,o.KF)(!!n,"parentGuid should point to a valid node");let a=this.heightByGuid[e.parentGuid],i=t>e.parentTop+a/3&&t<e.parentTop+2*a/3;n.uiOrderedChildren.length&&i&&(s=n.guid)}this.lastExpansionTarget!==s&&(this.lastExpansionTarget&&null!=this.hoverToExpandGroupTimeout&&clearTimeout(this.hoverToExpandGroupTimeout),s&&(this.hoverToExpandGroupTimeout=setTimeout(()=>{this.state.mouseDown&&W.Ir(s,!0)},1e3)),this.lastExpansionTarget=s)}toggleSelected(e){this.props.sceneGraphSelection[e]?W.D$([e]):(W.Dh([e]),this.rangeSelectAnchorNodeId=e),B.Y5.commit()}relativeY(e){let t=(0,P.bG)();return this.scrollContainerEl&&(t=this.scrollContainerEl.getBoundingClientRect().top),e-t+this.state.scrollTop}clientY(e){let t=(0,P.bG)();return this.scrollContainerEl&&(t=this.scrollContainerEl.getBoundingClientRect().top),e+t-this.state.scrollTop}isVerticallyVisible(e,t){if(!this.scrollContainerEl)return!0;let s=this.state.scrollTop,n=this.scrollContainerEl.getBoundingClientRect().height+this.state.scrollTop;return s<e&&t<n}isOutOfViewLeft(e){let t=this.leftByGuid[e];return void 0!==t&&t<this.state.scrollLeft-50}isOutOfViewRight(e){let t=this.leftByGuid[e];return void 0!==t&&t+(0,E.jz)(e$.indentWidth)>this.state.scrollLeft+(this.props.width??0)-50}shouldHorizontallyAutoscroll(e){return this.props.renamingGuid!==e&&(this.isOutOfViewLeft(e)||this.isOutOfViewRight(e))}guidAtMousePosition(e){return this.mouseOverStickyHeaderGuid(e)||(0,eq.GN)(this.getScene(),this.props.sceneGraphSelection,this.topByGuid,this.heightByGuid,this.relativeY(e))}mouseOverStickyHeaderGuid(e){return this.scrollContainerEl&&e-this.scrollContainerEl.getBoundingClientRect().top<this.props.topLevelObjectRowHeight?this.stickyHeaderGuid:null}computeStackOutlineHeight(e,t,s,n){return"sticky"===e?Math.min(t-s,n):Math.min(t-e,n-(e-s))}scrollContainerHeight(){return(0,g.kc)().obj_panel_caching&&this.cachedScrollContainerHeight?this.cachedScrollContainerHeight:this.scrollContainerEl?.clientHeight??0}renderDropTarget(e){let t=null;if(null!=e.parentTop){let s=this.scrollContainerHeight(),a=e.bottomForCanvasStackReparenting,i=this.heightByGuid[e.parentGuid],r="sticky"===e.parentTop||this.stickyHeaderGuid===e.parentGuid;a&&s&&(i=this.computeStackOutlineHeight(r?"sticky":e.parentTop,a,this.state.scrollTop,s)),t=r?(0,n.jsx)("div",{"data-testid":"drop-target-box",className:eW,style:{position:"sticky",width:this.props.width??0,height:i,zIndex:eV.Wb}},"drop-target-box"):(0,n.jsx)("div",{"data-testid":"drop-target-box",className:eW,style:{transform:`translate3d(0px, ${e.parentTop}px, 0)`,height:i}},"drop-target-box")}let s=null;return null!=e.lineTop&&(s=(0,n.jsx)("div",{"data-testid":"drop-target-line",className:"objects_panel--dropTargetLine--KTB5V",style:{marginLeft:`${e.lineIndent?e.lineIndent:0}px`,transform:`translate3d(0px, ${0===e.lineTop?0:e.lineTop-1}px, 0)`,transition:"margin-left 150ms 0ms"}},"drop-target-line")),[t,s]}setupScrollContainerResizeObserver(e){(0,g.kc)().obj_panel_caching&&this.observedScrollContainerEl!==e&&(this.scrollContainerResizeObserver&&this.scrollContainerResizeObserver.disconnect(),this.scrollContainerResizeObserver=new ResizeObserver(t=>{for(let s of t)if(s.target===e){let e=s.contentRect.height;e!==this.cachedScrollContainerHeight&&(this.cachedScrollContainerHeight=e);return}}),this.scrollContainerResizeObserver.observe(e),this.observedScrollContainerEl=e)}onContextMenu(e){e.stopPropagation(),e.preventDefault()}hasAtLeastOneRefToHoveredDefId(e){if(!this.props.hoveredPropDef||!this.props.hoveredPropDef.nodeIDs?.length||!this.props.hoveredPropDef.defID)return!1;let t=e.containingSymbolId;if(!t||!this.props.hoveredPropDef.nodeIDs.includes(t))return!1;for(let t of Object.values(e.propRefs))if(t.isLinked&&t.explicitDefID===this.props.hoveredPropDef.defID)return!0;return!1}renderObjectRow(e,t,s,a){let i=t.getNode(e.guid);if(!i||!i.parentGuid)return null;let r=t.getAncestorInfo(i.parentGuid),l=t.getMaskInfo(e.guid),o=null!=e.isSelected?e.isSelected:(0,en.K3)(this.props.sceneGraphSelection,e.guid);if(!r||!l)return null;let c=(r.isAncestorSelected||o)&&!r.isAncestorHidden&&this.hasAtLeastOneRefToHoveredDefId(i),d=!!e.prevNodeGuid&&t.getAncestorInfo(e.prevNodeGuid).isAncestorSelected,u=(!!e.prevNodeGuid&&(0,en.K3)(this.props.sceneGraphSelection,e.prevNodeGuid)||d)&&eB.OZ(this.cachedAllRowData)?.guid!==e.guid,x=!!e.nextNodeGuid&&t.getAncestorInfo(e.nextNodeGuid).isAncestorSelected,m=("FIXED_WHEN_CHILD_OF_SCROLLING_FRAME"===i.scrollBehavior||r.isAncestorFixed)&&r.isAncestorSelected,h=(!!e.nextNodeGuid&&(0,en.K3)(this.props.sceneGraphSelection,e.nextNodeGuid)||x)&&eB.w6(this.cachedAllRowData)?.guid!==e.guid,g=i.isLayerLikeCodeNode&&!i.isInstanceSublayer&&!i.isSymbolSublayer,f=(i.isCodeInstance||i.isCodeFile||i.isCodeComponent)&&!g,_=i.isMakeEmbed;return(0,n.jsx)(eh.oo,{isReadOnly:this.props.isReadOnly,...e,booleanOperation:i.booleanOperation,componentLike:f,cornerRadius:i.cornerRadius,currentPage:this.props.currentPage,dispatch:this.props.dispatch,displayOrder:r.childrenDisplayOrder,expandMouseDown:this.expandMouseDown,hasChildren:i.isExpandable||e.hasChildren||(0,ea.vo)(i,this.getScene()),hasRefToHoveredDef:c,hideRowActions:this.props.hideRowActions,isAncestorHidden:r.isAncestorHidden,isAncestorLocked:r.isAncestorLocked,isAncestorSelected:!e.ignoreAncestorSelection&&r.isAncestorSelected,isDragging:!!this.state.dropTarget,isExpanded:e.isExpanded||e.isTemporarilyExpanded,isFavicon:this.props.faviconGuid===e.guid,isGIF:i.hasEnabledAnimatedPaint,isLastMaskedAtLevels:l.isLastMaskedAtLevels,isLayerAboveSelected:u,isLayerBelowSelected:h||m,isMakeEmbed:_,isMaskedAtLevels:l.isMaskedAtLevels,isPrimaryBreakpoint:i.isPrimaryBreakpointFrame,isRenaming:this.props.renamingGuid===e.guid,isRowInView:s,isSelected:o,isSiteHomepage:this.props.topNodeProperties?.siteHomepageId===e.guid,isSlot:e.isSlot,isSocialImage:this.props.socialImageGuids?.split(",").includes(e.guid),isStamp:(0,p.GI)(i),isState:i.isState,isStateGroup:i.isStateGroup,isStaticImage:i.hasEnabledStaticImagePaint,isTemporarilyHovered:this.props.temporarilyHoveredNodes.includes(e.guid),isThumbnail:this.props.thumbnailGuid===e.guid,isWebpage:i.isResponsiveSetOrWebpage,isWidgetSublayer:!!i.isInWidget,layerLikeCodeNode:g,lockMouseDown:this.lockMouseDown,locked:i.locked,mask:i.mask,nodeMemoryUsage:this.props.showInFileMemoryPercentage?i.nodeMemoryUsage:null,nodeType:i.type,objectsPanelThumbnailId:i.objectsPanelThumbnailId,observeWithResizeObserver:this.props.observeWithResizeObserver,onContextMenu:this.rowContextMenu,onDragDropCallback:this.onDragDrop,onDragEnterCallback:this.onDragEnter,onDragLeaveCallback:this.onDragLeave,onDragOverCallback:this.onDragOver,onMouseEnter:this.rowMouseEnter,panelType:this.props.panelType??eq.g$.Object,panelWidth:this.props.width,recordingKey:a?void 0:e.recordingKey,renderResourceUse:this.props.renderResourceUse,resizeToFit:i.resizeToFit,rootMemoryUsage:this.props.showInFileMemoryPercentage?i.rootMemoryUsage:null,scrollDirection:i.scrollDirection,scrollLeft:this.state.scrollLeft,shouldShowGuids:this.props.shouldShowGuids,showInFileMemoryPercentage:this.props.showInFileMemoryPercentage,showMemoryUsage:this.props.showMemoryUsage,stackMode:i.stackMode,startRenaming:this.props.startRenaming,stopRenaming:this.props.stopRenaming,unobserveWithResizeObserver:this.props.unobserveWithResizeObserver,userId:this.props.userId,versionHistory:this.props.versionHistory,visible:i.visible,visibleMouseDown:this.visibleMouseDown},eY.getKeyForId(e.guid))}renderLayerExpansionRow(e){let t=eY.getKeyForId(eX(e)),s=void 0===this.props.width?"100%":this.props.width+this.state.scrollLeft;return(0,n.jsx)(eU,{top:e.top,width:s,guid:e.containingPrimaryInstanceGUID,level:e.level,onMouseEnter:()=>W.Uc(""),dispatch:this.props.dispatch,recordingKey:L.Pt(this.props,"layerExpansion",e.containingPrimaryInstanceGUID)},t)}renderSectionHeader(e){let t=this.sectionById[e.sectionId],s=t&&(0,en.sp)(this.getScene(),this.props.sceneGraphSelection,t.parentGuid),a=!0;if(t?.parentGuid&&t?.type!==u.KjJ.FIXED){let e=this.props.sceneGraph.get(t?.parentGuid);e&&e.fixedChildrenCount===e.uiOrderedChildren.length&&(a=!1)}let i=Math.max(this.props.scrollWidth,this.props.width??0);return(0,n.jsx)(eH,{...e,width:i,isParentSelected:s,sectionHasChildren:a,dispatch:this.props.dispatch},eY.getKeyForId(e.sectionId))}render(){w.sn.start("objects-panel-inner-render-timer");let e=this.renderedVisibleRowProps,t=this.cachedAllRowData||[];for(let s of(this.renderedVisibleRowProps=(0,eq.Uw)(t,this.windowInnerHeight,this.state.scrollTop),this.findStickyHeaderRowAndReplaceInVisibleRows(t),e))(0,eq.Mq)(s,this.windowInnerHeight,this.state.scrollTop)||eY.freeKeyForId(eX(s));this.renderedVisibleRowProps.sort((e,t)=>eY.getKeyForId(eX(e))-eY.getKeyForId(eX(t)));let s=this.props.nodeInfoCache,a=[];for(let e of this.renderedVisibleRowProps)"object"===e.rowType?a.push(this.renderObjectRow(e,s,this.getIsRowInView)):"layer-expansion"===e.rowType?a.push(this.renderLayerExpansionRow(e)):a.push(this.renderSectionHeader(e));var i=null;if(this.scrollToNodeIdAfterUpdate){let e=this.cachedAllObjectRowDataMap[this.scrollToNodeIdAfterUpdate];void 0!==e&&(0,eq.N1)(e)&&(i=this.renderObjectRow(e,s,this.getIsRowInView,!0))}if(!this.props.hideCanvasDropTargets&&this.props.reparentIntoStackInfo&&this.props.sceneGraph){let e=this.props.reparentIntoStackInfo.indexInParent,t=this.props.reparentIntoStackInfo.parentGuid,s=this.props.sceneGraph.get(t);s&&a.push(...this.renderDropTarget((0,eq.Gs)(s,this.topByGuid,this.heightByGuid,this.props.sceneGraph,this.totalHeight,this.props.insertionLineBoxOffset,e)))}else!this.props.isReadOnly&&this.state.dropTarget&&a.push(...this.renderDropTarget(this.state.dropTarget));let r=this.stickyHeaderGuid||!this.state.needsScrollLine?"objects_panel--scrollContainer--uCLpi":"objects_panel--scrollContainerWithBorder--x1qWz objects_panel--scrollContainer--uCLpi",l={width:`max(${this.props.scrollWidth??0}px, 100%)`,height:this.totalHeight,"--row-gap":`${this.props.rowSelectionGap}px`};return(0,n.jsxs)(n.Fragment,{children:[this.props.showVisualLayerIcons&&(0,g.kc)().ce_il_root&&(0,n.jsx)(ez,{ids:this.renderedVisibleRowProps.filter(e=>"object"===e.rowType).map(e=>e.guid),focusedNodeId:this.getTopSelectedNodeId()}),(0,n.jsx)(eD,{objectRow:i,setRowWidth:this.setRowToScrollToData,guid:this.scrollToNodeIdAfterUpdate}),(0,n.jsx)(eq.M3,{selection:this.props.sceneGraphSelection,getNode:function(e){return s.getNode(e)??null}}),(0,n.jsxs)(F.P,{ref:this.scrollContainerRef,className:k()(r,{"objects_panel--hasPending--9Mt-c":this.props.hasPending}),dataOnboardingKey:this.props.isUI3?void 0:ey.m4,enableOverscroll:!0,horizontalScrollBarEnabled:!0,initialScrollTop:this.props.initialScrollTop,innerClassName:k()({"objects_panel--reserveBottomHeight--ddeAw":this.props.reserveBottomHeight}),minContentWidth:this.props.width,onContextMenu:this.onContextMenu,onMouseDown:this.onScrollContainerMouseDown,onScroll:this.onScroll,onScrollLeftChanged:this.onScrollLeftChanged,recordingKey:L.Pt(this.props,"scrollContainer"),scrollContainerRef:this.scrollContainerInnerRef,width:this.props.width,children:[(0,n.jsx)(ev.jq,{onLeftPanelCollapsedChange:this.onLeftPanelCollapsedChange}),(0,n.jsx)(D.V,{children:(0,n.jsx)("div",{className:k()("objects_panel--rowContainer--Y1-LY","objects_panel--horizontalScrollBarPadding--zvLj4"),style:l,onMouseDown:this.rowContainerMouseDown,onTouchStart:this.touchAdapter.onTouchStart,onMouseLeave:this.containerMouseLeave,"data-testid":"objects-panel",children:a})})]})]})}}function eJ(e){let t=(0,i.wA)(),s=(0,ee.J2)((0,V.UK)().showImmutableFrameSublayers),r=(0,ee.ut)(u.Ez5?.uiState().reparentIntoStackInfo,null),l=(0,Y.NF)(),o=(0,Y.Ht)(),c=(0,ee.J2)(u.Ez5.uiState().hoveredComponentPropDef),d=(0,Y.no)(),x=(0,ee.J2)(u.Ez5.canvasViewState().temporarilyHoveredNodes),m=(0,J.TA)(),p=(0,i.d4)(e=>e.mirror.sceneGraphSelection),g=(0,i.d4)(e=>e.mirror.objectsPanelRowRebuildCounter),_=(0,i.d4)(e=>e.mirror.appModel.temporarilyExpandedInstanceLayers),y=(0,i.d4)(e=>e.mirror.appModel.activeCanvasEditModeType),k=(0,H.m0)(),v=(0,q._I)(),b=(0,$.E)(),C=(0,h.UN)(),w=(0,et.wA)((e,t)=>{let s=e.get(t);return s?{guid:s.guid,children:s.uiOrderedChildren,siteHomepageId:s.siteHomepageId}:null},e.currentPage),E=(0,eP.el)(),{topLevelObjectRowHeight:N,nestedObjectRowHeight:S,rowSelectionGap:T,insertionLineBoxOffset:I,showVisualLayerIcons:A}=a.useContext(Q.y0);(0,eq.SV)();let[M,z]=(0,f.fp)(eL.C),L=(0,j.A)(z,200),O=(0,et.Fk)(e=>e.getCurrentPage()?.webMetadata?.faviconID),P=(0,et.Fk)(e=>{let t=e.getCurrentPage();return(t?t.socialImageGuidsOnPage:[]).join(",")}),R=(0,ee.J2)((0,V.UK)().showGuids),D=(0,X._Z)().isLoading,F=(0,a.useMemo)(()=>new eB.nV(C,p),[C,g,p]),G=a.useRef(null),U=a.useRef(new Map);a.useEffect(()=>{let e=U.current;return G.current=new ResizeObserver(t=>{for(let s of t){let t=e.get(s.target);t?.(s)}}),()=>{G.current?.disconnect(),e.clear()}},[]);let K=a.useCallback((e,t)=>{!e||U.current.has(e)||(U.current.set(e,t),G.current?.observe(e))},[]),B=a.useCallback(e=>{e&&(G.current?.unobserve(e),U.current.delete(e))},[]);if(k&&!v)return null;let W=null===e.topNodeProperties?w:e.topNodeProperties;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eZ,{...e,currentPage:e.currentPage,dispatch:t,editModeType:y,faviconGuid:O,focusedNodes:e.focusedNodes,hasPending:D,hoveredPropDef:c,initialScrollTop:M,insertionLineBoxOffset:I,nestedObjectRowHeight:S,nodeInfoCache:F,objectsPanelRowRebuildCounter:g,observeWithResizeObserver:K,onScroll:L,onSelectNodesFromLayersPanel:e.onSelectNodesFromLayersPanel,recordingKey:e.recordingKey??"objectsPanel",renderResourceUse:l,reparentIntoStackInfo:r,reserveBottomHeight:e.reserveBottomHeight,rowSelectionGap:T,sceneGraph:C,sceneGraphSelection:p,scrollWidth:E,shouldShowGuids:R,showImmutableFrameSublayers:s,showInFileMemoryPercentage:d,showMemoryUsage:o,showViewChangesNotification:b,showVisualLayerIcons:A,socialImageGuids:P,temporarilyExpandedInstanceLayers:_,temporarilyHoveredNodes:x,topLevelObjectRowHeight:N,topNodeProperties:W,unobserveWithResizeObserver:B,userId:m??void 0}),(0,n.jsx)(ei.p,{featureFlag:"auto_auto_layout",children:(0,n.jsx)(e_,{})})]})}function eQ(e){return(0,n.jsx)(eP.Rp,{children:(0,n.jsx)(eJ,{...e})})}function e0(e,t,s){if(s(e),t)for(let t of e.uiOrderedChildren)e0((0,h.UN)().get(t),!0,s)}eZ.displayName="ObjectsPanelView",eZ.contextType=eP.$V},358445:(e,t,s)=>{s.d(t,{B:()=>l});var n=s(239976),a=s(224542),i=s.n(a),r=s(99711);function l({children:e,hasScrollLine:t,onClick:s}){return(0,n.jsx)("div",{className:i()(r.kL,{[r.to]:t}),onClick:s,children:e})}},542531:(e,t,s)=>{s.d(t,{H:()=>i});var n=s(239976),a=s(257556);function i({children:e,dataOnboardingKey:t}){return(0,n.jsx)("div",{className:"header_text--headerText--NiX3a",onContextMenu:a.jo,"data-onboarding-key":t,children:e})}},53151:(e,t,s)=>{s.d(t,{m:()=>a});var n=s(239976);function a({children:e}){return(0,n.jsx)("div",{className:"objects_panel_container--container--UxrNI",children:e})}},887555:(e,t,s)=>{s.d(t,{g:()=>r});var n=s(239976),a=s(563225),i=s(402731);function r(e){return(0,n.jsx)("div",{className:"pages_panel_chevron--chevron---LWKq","data-show-on-hover":e.isExpanded||void 0,children:e.isExpanded?(0,n.jsx)(a.O,{}):(0,n.jsx)(i.k,{})})}},208876:(e,t,s)=>{s.d(t,{o:()=>M});var n=s(239976),a=s(20002),i=s(75340),r=s(943360),l=s(378721),o=s(382008),c=s(728902),d=s(907594),u=s(692376),x=s(379141),m=s(445019);s(323264);var p=s(916626),h=s(499735),g=s(33433),f=s(257556),_=s(814213),y=s(223487),k=s(236410),v=s(910496),b=s(690149),j=s(776578),C=s(754382),w=s(796557),E=s(4245),N=s(535651);function S(e){let{Dropdown:t,toggleDropdown:s,dropdownTargetRef:a,isDropdownShown:i}=(0,N.B)("LAYERS_PANEL_DROPDOWN");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{ref:a,children:(0,n.jsx)(w.d,{"aria-label":(0,x.t)("dev_handoff.code.options"),recordingKey:e.recordingKey,"aria-expanded":i,onClick:function(e){e.stopPropagation(),s()},"data-tooltip":(0,x.t)("dev_handoff.code.options"),"data-tooltip-type":k.Ib.TEXT,children:(0,n.jsx)(E.J,{})})}),(0,n.jsx)(t,{items:e.dropdownItems,showPoint:!0,lean:e.lean,recordingKey:h.Pt(e.recordingKey,"dropdown")})]})}var T=s(581121),I=s(581774),A=s(892691);let M=(0,p.w)(function({isLayersOpen:e,onToggleLayers:t,recordingKey:s,...a}){let l=(0,y.q5)(),c=l?.thumbnailGuid||null;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i.bL,{isOpen:e,toggle:t,height:"fill",children:[(0,n.jsxs)(i.Y9,{variant:"leftPanel",size:"lg","data-onboarding-key":b.BZ,children:[(0,n.jsx)(i.JU,{recordingKey:h.Pt(s,"layersCollapsedRow"),onContextMenu:f.jo,children:(0,x.tx)("fullscreen.pages_panel.layers_tab")}),e&&(0,n.jsx)(i.X0,{children:(0,n.jsx)(z,{recordingKey:h.Pt(s,"layersOptionMenu")})})]}),(0,n.jsx)(i.UC,{children:(0,n.jsx)(C.X,{...a,thumbnailGuid:c})})]}),a.reserveBottomHeight&&a.showAllLayers&&(0,n.jsx)("div",{className:"x78zum5 xl56j7k x10l6tqk x1ey2m1c xu96u03 x3m8u43 xsdox4t x1yjdb4r xoegz02",children:(0,n.jsxs)(r.E,{onClick:a.showAllLayers,className:"x1hlb6i2 x1db2dqx x78zum5 x6s0dn4 x1rjybxy x19y5rnk xxk0z11 xh8yej3 xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x10e2c7l xv2f06h x1n0bwc9 x1c5oinq",children:[(0,n.jsx)(o.f,{}),(0,x.tx)("sites.layer_view.show_all_layers")]})})]})},"Ui3ObjectsPanel");function z(e){let t=(0,a.d4)(e=>e.mirror.appModel.keyboardShortcuts),s=(0,m.md)(j.X),i="collapse-layers",r=()=>{u.glU?.triggerActionEnumInUserEditScope(u.rcl.COLLAPSE_LAYERS,{})};if((0,_.A0)(u.uQ6.LAYERS_PANEL_OVERFLOW_MENU)){let s=[{displayText:(0,g.A)(i),callback:r,sideText:(0,v.c1)(t,i),rightJustifySideText:!0,icon:(0,n.jsx)(c.X,{"data-testid":"collapse-layers-button"}),recordingKey:i},{displayText:(0,g.A)("auto-rename-layers"),callback:()=>{(0,_.Br)({source:u.uQ6.LAYERS_PANEL_OVERFLOW_MENU,trackingDataSource:"layers_panel_overflow_menu"})},icon:(0,n.jsx)(d.d,{}),rightIcon:(0,n.jsx)(A.yi,{variant:I.x.ON_MENU,helpUrlVariant:T.JT.AUTO_RENAME_LAYERS}),recordingKey:"auto-rename-layers"}];return(0,n.jsx)(S,{dropdownItems:s,lean:"left",recordingKey:e.recordingKey})}return s?(0,n.jsx)(l.K,{"aria-label":(0,g.A)(i),"data-testid":"collapse-layers-button",onClick:r,recordingKey:h.Pt(e.recordingKey,i),"data-tooltip-type":k.Ib.TEXT,"data-tooltip":(0,g.A)(i),children:(0,n.jsx)(c.X,{})}):(0,n.jsx)(n.Fragment,{})}},157081:(e,t,s)=>{s.d(t,{I:()=>x});var n=s(239976),a=s(692376),i=s(7857),r=s(562418),l=s(471380),o=s(916446),c=s(267447),d=s(309092),u=s(341637);function x(e){return(0,n.jsx)(i.u9,{label:"Ui3TabsRow",children:(0,n.jsx)(m,{...e})})}function m({activeTab:e,onCanvasSearch:t,recordingKey:s,...i}){let x=(0,r.Em)(),m=(0,r.cJ)(),p=e===a.xae.LAYERS,h=(x||m)&&(e===a.xae.ASSETS||p);return(0,n.jsxs)(d.y,{withBorder:!0,children:[(0,n.jsx)(u.eG,{...i}),(0,n.jsxs)("div",{className:"ui3_tabs_row--iconContainer--A1dC9",children:[p&&(0,n.jsx)(l._,{onClick:t}),h&&(0,n.jsx)(o.b,{recordingKey:s,entrypoint:e===a.xae.ASSETS?c.r6.ASSETS_PANEL_BUTTON:c.r6.LAYERS_TAB_BUTTON,hideIfNoUpdates:e===a.xae.LAYERS})]})]})}},615714:(e,t,s)=>{s.d(t,{Q:()=>R});var n=s(239976),a=s(105652),i=s(297860),r=s(692376),l=s(798913),o=s(379141),c=s(224542),d=s.n(c),u=s(610265),x=s(499735),m=s(122313),p=s(346942),h=s(501438),g=s(154963),f=s(842582),_=s(402342),y=s(732730),k=s(338630),v=s(112335),b=s(425519),j=s(789379),C=s(231305),w=s(591600),E=s(362844),N=s(702746),S=s(236410),T=s(778046),I=s(862750),A=s(775667),M=s(677743),z=s(690252),L=s(564208),O=s(650539);let P=class e extends a.PureComponent{constructor(){super(...arguments),this.onRemoveRelaunchData=e=>{l.l7.user("remove-plugin-relaunch-data",()=>r.NfO.removeRelaunchDataFromSelection(e))},this.onRelaunch=async e=>{let t=this.props.openFileKey;if(!t)return;if(!(0,T.Fr)()){C.R0.instance.handleUpgrade(y.Q7.RUN_PLUGIN);return}let{canRun:s}=(0,b.JT)({plugin:e.plugin,editorType:this.props.editorType??E.nT.Design});if(s)return await C.R0.instance.enqueue({mode:"run-forever",runPluginArgs:{plugin:e.plugin,openFileKey:t,command:e.relaunchButton.command,queryMode:!1,runMode:"default",triggeredFrom:this.props.editorType===E.nT.DevHandoff?"handoff-relaunch":"relaunch",ignoreForRunLastPlugin:!0,isWidget:!1}})},this.fetchPlugin=e=>{this.props.dispatch(_.af({id:e,resourceType:w.bD.PLUGIN}))},this.renderRelaunchRows=e=>{let t="";return e.map(e=>{let s=e.plugin.plugin_id,a=`${e.pluginTypeAndID}-${e.relaunchButton.command}`,i=(0,n.jsx)(D,{relaunchData:e,recordingKey:x.Pt(this.props,"relaunch",a),onRelaunch:this.onRelaunch,onRemoveRelaunchData:this.onRemoveRelaunchData,firstButtonForPlugin:s!==t,collapsibleStyling:this.props.isDevHandoff&&this.props.collapsible},a);return t=s,i})}}render(){let t=(0,b.vA)(this.props.pluginRelaunchData,this.props.publishedPlugins,this.props.localPlugins,this.props.currentOrgId,this.props.numSelected,(t,s)=>e.refreshCache.debounceRefresh(t,this.fetchPlugin.bind(this),s),N.FW.FIGMA);if(0===t.length)return null;let s=this.props.title??(0,o.t)("properties_panel.plugin.title");return this.props.isDevHandoff?(0,n.jsx)(m.k,{name:"inspection_panel",children:(0,n.jsx)(A.VZ,{title:s,collapsiblePanelKey:this.props.collapsible?"plugin-relaunch":void 0,recordingKey:"plugin",children:this.renderRelaunchRows(t)})}):(0,n.jsx)(m.k,{name:"plugin_panel",children:(0,n.jsxs)(z.Zk,{children:[(0,n.jsx)(z.fI,{children:(0,n.jsx)(M.xw,{children:s})}),this.renderRelaunchRows(t)]})})}};P.displayName="PluginPanel",P.refreshCache=new j.O(u.A.duration(1,"day"));let R=P;class D extends x.o6{constructor(){super(...arguments),this.onRelaunch=x.cZ(this,"click",()=>{this.props.onRelaunch(this.props.relaunchData)})}render(){return(0,n.jsx)(F,{...{...this.props,onRelaunch:this.onRelaunch,recordingKey:x.Pt(this.props,"removeButton")}})}}function F(e){let{plugin:t,relaunchButton:s}=e.relaunchData,a=(0,N.ZQ)(t)?(0,n.jsx)("div",{className:"plugin_panel--pluginIconLocal--Miw9i",children:(0,n.jsx)(h.t,{svg:L.A,fallbackSvg:O.A})}):(0,n.jsx)("div",{className:"plugin_panel--pluginIcon--qz61d plugin--pluginIconBase--y3Ro5",children:(0,n.jsx)(I.V,{plugin:t})});return(0,n.jsxs)(k.fu,{name:"PluginRelaunchRow",properties:{pluginId:t.plugin_id},trackingTargets:v.K.RCS,children:[(0,n.jsx)(z.fI,{className:e.collapsibleStyling?"plugin_panel--rowButtonCollapsible--rt1HV button_row--rowButton--WjZOY raw_components--singleRow--QDrBw raw_components--_singleRow--haOPc raw_components--singleRowHeight--r92RH raw_components--_row--6Yz0U raw_components--row--UhGzp button_row--_rowButton--oekTK":"plugin_panel--rowButton--GK8ZY button_row--rowButton--WjZOY raw_components--singleRow--QDrBw raw_components--_singleRow--haOPc raw_components--singleRowHeight--r92RH raw_components--_row--6Yz0U raw_components--row--UhGzp button_row--_rowButton--oekTK",children:(0,n.jsxs)("div",{className:"plugin_panel--relaunchContainer--N6ZNF",children:[(0,n.jsx)(p.Yo,{className:"plugin_panel--relaunchButton--VVfaC",onClick:()=>e.onRelaunch(e.relaunchData),"data-tooltip-type":S.Ib.TEXT,"data-tooltip":t.name,children:(0,n.jsxs)("div",{className:g.s.flex.itemsCenter.$,children:[(0,n.jsx)("div",{className:"plugin_panel--pluginIconContainer--tCW-I",children:a}),(0,n.jsx)("div",{className:"plugin_panel--relaunchButtonName--GUGOl",children:(0,n.jsx)("div",{className:g.s.ellipsis.overflowHidden.noWrap.fontMedium.$,children:s.name})})]})}),(0,n.jsx)("div",{className:"plugin_panel--iconContainer--c8SVK",children:(0,n.jsx)(f.Me,{recordingKey:e.recordingKey,trackingProperties:{action:"minus"},"aria-label":(0,o.t)("properties_panel.plugin.remove_tooltip"),onClick:()=>e.onRemoveRelaunchData(e.relaunchData.plugin.plugin_id),"data-tooltip-type":S.Ib.TEXT,"data-tooltip":(0,o.t)("properties_panel.plugin.remove_tooltip"),children:(0,n.jsx)(i.r,{})})})]})}),!!s.description&&(0,n.jsx)("div",{className:d()("plugin_panel--relaunchDescription--cQzxX",e.collapsibleStyling&&"plugin_panel--relaunchDescriptionPadded--1LXQC"),children:(0,n.jsx)("pre",{className:"plugin_panel--relaunchDescriptionText--a6vtT ellipsis--ellipsisAfter3Lines--eBD0M ellipsis--_ellipsisAfterNLines--5f-ox",children:s.description===N.Q7?(0,o.tx)("properties_panel.plugin.mixed_descriptions"):s.description})})]})}D.displayName="PluginRelaunchRow"},560697:(e,t,s)=>{s.d(t,{v2:()=>eT,Ds:()=>eN});var n=s(239976),a=s(105652),i=s(20002),r=s(378721),l=s(942356),o=s(27412),c=s(563225),d=s(692376),u=s(379141),x=s(270450),m=s(445019),p=s(916626),h=s(7857),g=s(499735),f=s(125776),_=s(328452),y=s(154963),k=s(363337),v=s(819530),b=s(39171),j=s(943360);let C=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M16.5 7h-9a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h1a.5.5 0 0 1 0 1h-1A1.5 1.5 0 0 1 6 16.5v-9A1.5 1.5 0 0 1 7.5 6h9A1.5 1.5 0 0 1 18 7.5v4a.5.5 0 0 1-1 0v-4a.5.5 0 0 0-.5-.5m-5.509 9.087.001-.003zm.037-.087q.04-.085.13-.22a4 4 0 0 1 .743-.79c.668-.55 1.576-.99 2.599-.99s1.93.44 2.599.99c.332.274.583.557.742.79q.091.135.131.22-.04.085-.13.22a4 4 0 0 1-.743.79c-.669.55-1.576.99-2.599.99s-1.93-.44-2.599-.99a4 4 0 0 1-.742-.79 2 2 0 0 1-.132-.22m6.98.087v-.003zm0-.17v-.004zm-7.016 0v-.004zM14.5 13c-2.625 0-4.5 2.25-4.5 3s1.875 3 4.5 3 4.5-2.25 4.5-3-1.875-3-4.5-3m1 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0",clipRule:"evenodd"})})});s(323264);var w=s(428217),E=s(264629),N=s(959800),S=s(178380),T=s(236410);function I(){let{togglePanel:e,activePanel:t}=(0,N.oj)(),s=(0,m.Xr)(w.gl),a=t?.panel===S.A.APPROVALS,i=(0,E.oA)(),r="Approvals";return(0,n.jsx)("div",{className:"x1057jvv","data-tooltip-type":T.Ib.TEXT,"data-tooltip":r,children:(0,n.jsx)(j.E,{...{0:{className:"x78zum5 x6s0dn4 xl56j7k x19y5rnk x1td3qas x10w6t97 x1yjdb4r xv2f06h"},1:{className:"x78zum5 x6s0dn4 xl56j7k x19y5rnk x1td3qas x10w6t97 xcr9a89 x1aue78i"}}[!!a<<0],onClick:()=>{s(i),e(S.A.APPROVALS)},"aria-label":r,children:(0,n.jsx)(C,{})})})}var A=s(218892),M=s(124782),z=s(536378),L=s(223487),O=s(910175),P=s(345936);function R(){let e=(0,i.wA)(),t=(0,L.q5)(),s=(0,m.md)(A.o),a=!!t&&(0,O.Pe)(t);return(0,n.jsx)("div",{className:"x1057jvv xnfn54o",children:(0,n.jsx)(l.WW,{variant:"secondary",disabled:a||s.isExporting,onClick:()=>e(z.to({type:P.p})),"data-onboarding-key":M.N5,children:(0,u.t)("fullscreen.toolbar.buzz.export")})})}var D=s(92184),F=s(960210),q=s(562418),G=s(783868),U=s(720410),K=s(715307),H=s(207436),B=s(605985),V=s(359547),$=s(439259),W=s(982147),Y=s(76354),X=s(84454),Z=s(335556),J=s(370116),Q=s(363198),ee=s(751642),et=s(17248),es=s(497503),en=s(362744),ea=s(224542),ei=s.n(ea),er=s(393463),el=s(490096),eo=s(888903),ec=s(682406),ed=s(643444),eu=s(819805),ex=s(576116),em=s(910496),ep=s(252891),eh=s(944826),eg=s(963208);let ef={"present-slides-audience-view":"set-slides-audience-view","present-slides-presenter-view":"set-slides-presenter-view"};function e_(){let[e,t]=a.useState(!1),{getTriggerProps:s,getContainerProps:i,getArrowProps:r}=es.fP({isOpen:e,onOpenChange:t,type:"tooltip",placement:"bottom-end",softDismiss:!0}),l=!(0,eu.Zr)("present-slides-audience-view");return(0,n.jsxs)("div",{className:ei()(eg.qL,{"slides_present_popover--popoverButtonActive--wy04v":e,[eg.yj]:l}),"data-tooltip-type":T.Ib.LOOKUP,"data-tooltip":"present-slides-audience-view","data-onboarding-key":ep.J5,"data-testid":"present-slides-audience-view",children:[(0,n.jsx)(j.E,{actionOnPointerDown:!0,htmlAttributes:{"data-testid":"slides-presentation-flyout-button"},className:ei()(eg.cE,"slides_present_popover--popoverButton--U-F3c",{"slides_present_popover--popoverButtonDisabled--M3y-N":l}),"aria-label":(0,u.t)("fullscreen.flyout.slides_presentation"),recordingKey:"slidesPresentationFlyout",...s(),children:(0,n.jsx)(o.X,{})}),(0,n.jsxs)(es.mc,{...i({className:"slides_present_popover--popoverContainer--5eWNB"}),children:[(0,n.jsx)(es.i3,{...r()}),(0,n.jsx)(ey,{})]})]})}function ey(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"slides_present_popover--optionsContainer--1L7IJ",children:[(0,n.jsx)(ek,{}),(0,n.jsx)(ev,{})]}),(0,n.jsx)(ej,{})]})}function ek(){return(0,n.jsx)(eb,{action:"present-slides-audience-view",icon:(0,n.jsx)(ec.V,{}),description:(0,u.t)("fullscreen_actions.present-slides-description"),recordingKey:"audienceViewPresent"})}function ev(){return(0,n.jsx)(eb,{action:"present-slides-presenter-view",icon:(0,n.jsx)(ec.y,{}),description:(0,u.t)("fullscreen_actions.present-slides-presenter-view-description"),recordingKey:"presenterViewPresent"})}function eb({action:e,icon:t,description:s,recordingKey:a}){let r=(0,i.d4)(ex.nj),l=(0,eu.Zr)(e),o=(0,eh.J)(e),c=(0,em.c1)(r.keyboardShortcuts,e);return(0,n.jsx)(j.E,{className:"slides_present_popover--presentOptionButton--c0N3m",onClick:t=>{ed.VU.get(ef[e],"toolbar")(t)},disabled:!l,recordingKey:a,children:(0,n.jsxs)("div",{className:"slides_present_popover--presentOptionButtonContent--KEOQe",children:[(0,n.jsx)("h3",{className:"slides_present_popover--presentOptionName--VkcKb slides_present_popover--text---NA9C",children:o}),(0,n.jsx)(el.S,{shortcut:c,className:"slides_present_popover--shortcut--Tbfst"}),(0,n.jsx)("div",{className:"slides_present_popover--presentOptionButtonIcon--rxZ-F",children:t}),(0,n.jsx)("p",{className:"slides_present_popover--presentOptionDescription--Zm3NH",children:s})]})})}function ej(){let e=(0,L.tS)(),t=(0,i.wA)(),s=a.useCallback(()=>{let s=`${(0,er.Ay)().figma_url}/deck/${e}`;navigator.clipboard.writeText(s),t(eo.F.enqueue({type:"copy-presentation-link-success",message:(0,u.t)("fullscreen_actions.copy-presentation-link-success")}))},[e,t]);return(0,n.jsxs)(j.E,{onClick:s,htmlAttributes:{"data-onboarding-key":ep.FM},className:"slides_present_popover--copyPresentationLinkButton--BaYln",children:[(0,n.jsx)(en.W,{}),(0,u.tx)("fullscreen_actions.copy-presentation-link")]})}var eC=s(347283),ew=s(882503),eE=s(65635);let eN=(0,m.eU)(0);function eS(e){let{isRightPanelCollapsed:t}=a.useContext(V.t),s=(0,i.wA)(),p=(0,et.sO)(),h=(0,Q.cJ)(),j=(0,b.to)()&&(0,b.HH)(),C=(0,q.HW)(),w=(0,H.dR)(),E=(0,i.d4)(e=>e.multiplayer),N=a.useMemo(()=>E.allUsers.find(e=>e.sessionID===E.sessionID)||null,[E.allUsers,E.sessionID]),S=(0,f.B4)(),T=(0,v.WU)(),A=C?null:e.openFile,M=(0,G.DG)(A?.key||"").enabled,z=(0,K.ck)(),L=a.useRef(null),O=(0,m.Xr)(eN),P=(0,U.k)(),es=(0,D.eZ)(),en=(0,ee.G)(),ea=(0,F.xo)(),ei=(0,B.iZ)(),er=(0,_.Om)();a.useEffect(()=>{L.current&&t&&O(L.current.clientWidth)},[t,L,O,E.allUsers]);let el=a.useCallback(e=>{(0,W.Lx)(e,N?.sessionID,s,C,E,w,S)},[N?.sessionID,s,C,E,w,S]);return(0,n.jsx)("div",{ref:L,children:null===A?(0,n.jsx)("div",{className:eE.tU,children:(0,n.jsx)($.YJ,{})}):(0,n.jsxs)("div",{className:eE.Yg,children:[(0,n.jsxs)("div",{className:eE.kb,children:[(0,n.jsx)(Y.sK,{isUI3:!0}),ea&&ei&&(0,n.jsx)(k.H8,{user:{...ei,id:ei.id}}),E&&e.openFile&&N&&!ea&&(0,n.jsx)(W.v7,{thresholdUsesContainerWidth:!0,multiplayer:E,currentUser:N,onUserClick:P?()=>er(d.rcl.FOLLOW_PRESENTER):el})]}),(t||P||es)&&!j&&(0,n.jsx)("div",{className:eE.wR,children:(0,n.jsx)(J.H,{recordingKey:g.Pt("header","zoomMenu")})}),(0,n.jsx)("div",{className:eE.Oh,children:(0,n.jsxs)("div",{className:y.s.flex.itemsCenter.$,children:[!z&&!j&&(!(0,x.kc)().slides_a11y_present_button||!p)&&(es||!en)&&!P&&(0,n.jsx)(ew.QE,{item:h?eC.Ax:p&&!(0,x.kc)().slides_a11y_present_button?Z.IS:eC.Fz,recordingKey:e.recordingKey}),P&&!j&&!en&&(0,n.jsxs)("div",{className:y.s.flex.flexRow.$,children:[(0,n.jsx)(r.K,{"aria-label":(0,u.t)("fullscreen_actions.present-as-prototype"),onClick:()=>er(d.rcl.PRESENT_AS_PROTOTYPE),children:(0,n.jsx)(o.X,{})}),(0,n.jsx)(r.K,{"aria-label":(0,u.t)("fullscreen.flyout.prototype_view"),onClick:()=>er(d.rcl.PRESENT_AS_PROTOTYPE),children:(0,n.jsx)(c.O,{})})]}),j&&T&&(0,n.jsx)(I,{}),j&&(0,n.jsx)(R,{}),p&&(0,x.kc)().slides_a11y_present_button&&(0,n.jsx)(e_,{}),P&&(0,n.jsx)("div",{style:{marginLeft:8,marginRight:8},children:(0,n.jsx)(l.WW,{variant:"secondary",onClick:()=>er("SHARE_BUTTON"),children:(0,u.t)("fullscreen.toolbar.multiplayer.share")})}),A&&!P&&(0,n.jsx)(X.ShareButton,{user:e.user,editingFile:A,isFileInWorkshop:M,appendedClassname:eE.OI})]})})]})})}function eT(e){return(0,n.jsx)(p.k,{id:"RightPanelHeaderNoProps",children:(0,n.jsx)(h.u9,{label:"RightPanelHeaderNoProps",children:(0,n.jsx)(eI,{...e})})})}function eI({recordingKey:e}){let t=(0,L.q5)(),s=(0,i.d4)(e=>e.user);return(0,n.jsx)(eS,{recordingKey:e,openFile:t,user:s,isIntegration:(0,K.ck)()})}},641808:(e,t,s)=>{s.d(t,{Y:()=>p});var n=s(239976),a=s(105652),i=s(379141),r=s(323264),l=s(69375),o=s(19856),c=s(724183),d=s(236410),u=s(65635);function x({nodeTypeString:e}){let t=a.useRef(null),[s,i]=a.useState(!1),r=a.useCallback(()=>{t.current&&i(t.current.offsetWidth<t.current.scrollWidth)},[]);return a.useLayoutEffect(()=>{r();let e=new ResizeObserver(r);return t.current&&e.observe(t.current),()=>{e.disconnect()}},[e,r]),(0,n.jsx)("h1",{ref:t,className:u.aj,"data-tooltip-type":s?d.Ib.TEXT:void 0,"data-tooltip":s?e:void 0,"data-testid":"node-type-display",children:e})}var m=s(683124);let p=a.memo(e=>{let{nodeCount:t,nodeType:s,nodeTypeString:a}=e,d=(0,c.g)();return s?(0,n.jsx)("div",{ref:d,...r.xk(m.R.selectionName),children:(()=>{switch(s){case"MIXED":return(0,n.jsx)("div",{className:u.Zp,children:(0,n.jsx)("h1",{children:(0,i.t)("fullscreen.properties_panel.layer_header.node_type_multiple_selected",{count:t})})});case"SYMBOL":return(0,n.jsx)(l.R,{alwaysShowParentComponent:!0,shouldHideComponentIcon:!0,unfocusedInputOverridesClassName:u.XS,focusedInputOverridesClassName:u.sE});case"INSTANCE":return(0,n.jsx)(o.W,{isInSelectionActionsPanel:!0});default:return(0,n.jsx)(x,{nodeTypeString:a})}})()}):null});p.displayName="SelectionName"},303219:(e,t,s)=>{s.d(t,{i7:()=>m});var n=s(239976),a=s(105652),i=s(348149),r=s(859100),l=s(914750),o=s(748181),c=s(215496),d=s(951633),u=s(271625);function x({dismissModal:e,targetKey:t}){let s=(0,i.bY)("make_edits_1p_description").getDynamicConfig();return s.value.description&&"string"==typeof s.value.description&&s.value.title&&"string"==typeof s.value.title?(0,n.jsxs)(d.NJ,{targetKey:t,dismissModal:e,width:300,topPadding:8,children:[(0,n.jsx)("div",{style:{marginBottom:"8px",fontWeight:600},children:s.value.title}),(0,n.jsx)("div",{style:{whiteSpace:"pre-line"},children:s.value.description})]}):null}function m(e,t){let s=(0,o.f)("seen_first_party_model_explanation"),[d]=(0,l.BZ)(),{show:m,isShowing:p,complete:h}=(0,r.e)({overlay:u.u36,priority:c.N.SECONDARY_MODAL});return a.useEffect(()=>{if(d){"first-party"===d.configurationKey&&!s&&e&&m();return}"first-party"===(0,i.gP)("make_edits_configuration").value.configurationKey&&!s&&e&&m()},[s,m,e,d]),{isShowingFirstPartyExplanation:p,completeFirstPartyExplanation:h,FirstPartyExplanationPointer:()=>p?(0,n.jsx)(x,{dismissModal:h,targetKey:t}):null}}},255812:(e,t,s)=>{s.d(t,{H:()=>z});var n=s(239976),a=s(105652),i=s(895807),r=s(607696),l=s(692376),o=s(854225),c=s(798913),d=s(466082),u=s(270450),x=s(445019),m=s(522568),p=s(384203),h=s(223487),g=s(605985),f=s(157750),_=s(788995),y=s(395823),k=s(183290),v=s(807461),b=s(360485),j=s(390796),C=s(160849),w=s(368417),E=s(934985),N=s(580763),S=s(820198),T=s(351572),I=s(997129),A=s(786164),M=s(96955);function z({codeInstanceNodeGuid:e,codeInstanceNode:t,entryPointCodeFileGuid:s,entryPointCodeFile:z,previewState:L,isResizingPanel:O,newCodeLayerState:P,setCodeInstanceNode:R,setEntryPointCodeFile:D,forceReadOnly:F,hideChatBox:q,onChatInputBlur:G,onChatInputFocus:U,featureType:K}){let H=(0,g.iZ)(),B=(0,h.tS)();(0,I.zA)();let V=(0,w.di)({codeFileNode:z});(0,A.m)({chatController:V});let $=(0,a.useMemo)(()=>(0,n.jsx)(j.d,{nodeGuid:s}),[s]),W=(0,x.Xr)((0,k.mC)(s)),Y=(0,y.Xu)(),X=(0,S.GM)(),Z=(0,x.md)(v.LR),{changedFiles:J}=(0,E.E)(z??null,V,K),Q=(0,i.og)(z?.codeFileFullPath),ee=Q?.replace(/^\//,""),et=(0,a.useMemo)(()=>(0,_.qE)(B||null,s),[B,s]),es=(0,a.useCallback)((e,t,s,n)=>{m.az.trackDefinedEvent("ai_for_production.code_chat_design_node_pasted",{number_of_nodes:t,number_of_instances:s,persistent_entity_id:et,file_key:B||void 0,attachmentId:n})},[B,et]);return function(e,t,s){let n=(0,p.eY)(),{attachments:i,setAttachments:r,claimAPendingAttachmentOrMakeOne:o,createPendingAttachmentsForNodes:c}=(0,C._9)(e),d=l.Ez5?.codeSelection(),u=(0,f.ut)(d?.selectedPromptFrames,[]),x=(0,a.useCallback)(()=>{let e=u?.[0]??"";e&&t===M.Oy.EMPTY&&((0,N.E)([e],n,r,()=>{},s,o,void 0,c),l.n1M?.clearSelectedPromptFrames())},[u,t,n,r,s,o,c]);(0,a.useEffect)(()=>{0===i.length&&x()},[i,x,t])}(s,L,(0,a.useCallback)(({step:e,attachmentType:t,attachmentId:s,nodeGuid:n,elapsedMs:a,error:i,nodeCount:r,instanceCount:l})=>{e===o.doA.START&&"FIGMA_NODE"===t&&r&&l&&es(n,r,l,s),e===o.doA.START&&x.zl.set((0,C.wd)(n),performance.now()),m.az.trackDefinedEvent("ai_for_production.code_chat_figma_attachment_funnel",{step:o.doA[e],featureType:K,attachmentType:t,attachmentId:s,fileKey:B||void 0,nodeGuid:n,elapsedMs:a,error:i,nodeCount:r,instanceCount:l,persistentEntityId:et})},[K,et,B,es])),(0,n.jsx)(b.U,{chatController:V,chatMessagesNode:z,chatMessagesNodeGuid:s,codeInstanceGuid:e,emptyState:$,enableAssetImport:(0,u.kc)().bake_import,enableDragUpload:!0,enableDsImport:(0,u.kc)().bake_ds_import_plan_enabled,enableImageAttachment:!0,featureType:K,forceReadOnly:F,hideChatBox:q,isResizingPanel:O,onChatInputBlur:G,onChatInputFocus:U,rootPath:ee,sendMessage:async(n,a)=>{let i=n.plainText;i||(i=n.hidden?"":x.zl.get((0,k.mC)(s)));let o={...n,plainText:i},m=t,p=z;if((0,u.kc)().bake_canvas_server_files_client&&P){if(c.l7.ai("initialize-new-make-layer",()=>{l.glU?.initializeNewMakeLayer(e,s,P.initializingNodeIds)}),m=(0,d.UN)().get(e),p=(0,d.UN)().get(s),!m||!p){console.warn("Failed to initialize new make layer");return}R(m),D(p)}W(""),await (0,T.v)({featureType:K,userMessageContent:o,rawUserChatDetails:a,user:H,chatMessagesNode:p,chatController:V,setInput:W,fileKey:B,autoFixingUserMessageId:null,canUseSupabase:Y,todoAutoAccept:X,changedFiles:J,model:void 0,instanceNode:m,requestInitiator:r.bG.USER,mcpPreferences:Z,canUseMcpConnectors:!1})},setInput:W,showCodeStreaming:!0,showCopyButton:!0})}},96955:(e,t,s)=>{s.d(t,{tX:()=>W,Oy:()=>J});var n=s(239976),a=s(105652),i=s(220875),r=s(607696),l=s(2674),o=s(378721),c=s(649109),d=s(727640),u=s(733200);let x=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M8.526 5.525a.5.5 0 0 1 .707.708L7.465 8l1.768 1.768a.5.5 0 0 1-.707.707L6.405 8.354a.5.5 0 0 1 0-.707z",clipRule:"evenodd"})})});var m=s(3831),p=s(649657),h=s(692376),g=s(466082),f=s(379141),_=s(270450),y=s(445019);s(323264);var k=s(223487),v=s(279758),b=s(456556),j=s(373703),C=s(326205),w=s(4607),E=s(183290),N=s(160849),S=s(109833),T=s(368417),I=s(865449),A=s(740414),M=s(417643),z=s(337341),L=s(495853),O=s(757516),P=s(612788),R=s(268037),D=s(542948),F=s(125578),q=s(480659),G=s(49740),U=s(709898),K=s(379196),H=s(495004),B=s(637904),V=s(883844),$=s(255812);function W({forceReadOnly:e,hideToolbar:t,hideChatBox:s}){let i=(0,y.md)(E.Vp),l=function(){let e=(0,y.md)(j.wh),t=(0,b.Fk)((e,t)=>t.flatMap(t=>e.get(t)?.guid??[]),e);return Array.from((0,a.useMemo)(()=>{let e=(0,g.UN)();return new Map(t.map(t=>[t,e.get(t)]).filter(e=>null!=e[1]))},[t]).values())[0]}()??null,o=(0,_.kc)().bake_canvas&&(l||i?.newCodeInstanceNodeId)&&!(l&&(0,L.ON)(l)),c=(0,a.useCallback)(()=>{y.zl.set(E.Vp,null)},[]);return o?(0,n.jsx)(Q,{codeInstanceNodeToEdit:l,newCodeLayerState:i,onClose:c,forceReadOnly:e,showToolbar:!t,hideChatBox:s,featureType:r.lV.FIGMAKE_IN_DESIGN}):null}function Y({name:e,onClose:t}){return(0,n.jsxs)("div",{className:"x1kzcg16 xlup9mm x1yjdb4r xso031l x1q0q8m5 xertd99 x78zum5 x1nfngrj xkh2ocl x6s0dn4",children:[(0,n.jsx)(o.K,{onClick:t,"aria-label":(0,f.t)("general.back"),children:(0,n.jsx)(x,{})}),(0,n.jsx)(c.J,{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1akne3o",htmlAttributes:{"data-tooltip":e,"data-tooltip-type":"text"},children:e}),(0,n.jsx)(G.M,{})]})}function X({panelConfiguration:e,handleSegmentChange:t}){return(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 x1excjyp",children:(0,n.jsxs)(d.bL,{value:e,onChange:t,legend:(0,n.jsx)(u.q,{children:(0,f.t)("sites.panel.code_window_display_picker.hidden_legend")}),children:[(0,n.jsx)(d.c$,{"aria-label":(0,f.t)("make.window.preview"),value:"preview",icon:(0,n.jsx)(m.T,{})}),(0,n.jsx)(d.c$,{"aria-label":(0,f.t)("make.window.code"),value:"code",icon:(0,n.jsx)(p.U,{})})]})})}function Z({handleRefresh:e,panelConfiguration:t,handleSegmentChange:s,codeInstanceNode:a,sitesPreview:i,showToolbar:r}){let l=(0,O.rh)(a),{handleScaleLinearly:o}=(0,K.gZ)({forceRefresh:e});return l?(0,n.jsxs)("div",{className:"x1vvogim xaope02 x1yjdb4r xso031l x1q0q8m5 xertd99 x78zum5 x6s0dn4 x1nfngrj",children:[(0,n.jsx)(X,{panelConfiguration:t,handleSegmentChange:s}),(0,n.jsx)(V.n,{}),r&&(0,n.jsx)("div",{className:"x1iyjqo2",children:(0,n.jsx)(w.A,{codeSelectionToRender:l,refresh:e,onScaleLinearly:o,sitesPreview:i??void 0})})]}):null}var J=(e=>(e[e.EMPTY=0]="EMPTY",e[e.THINKING=1]="THINKING",e[e.LOADED=2]="LOADED",e))(J||{});function Q({codeInstanceNodeToEdit:e,newCodeLayerState:t,onClose:s,forceReadOnly:l,hideChatBox:o,featureType:c,showToolbar:d}){let{handleRegisterIframeRefresh:u,handleRefresh:x}=(0,K.q3)(e),[m,p]=(0,a.useState)(null),[g,f]=a.useState("preview"),[_,k]=a.useState(e),[v,b]=a.useState(()=>(0,A.hh)(e)),[C,w]=a.useState(!1),S=_?.guid??t?.newCodeInstanceNodeId,T=v?.guid??t?.newEntryPointCodeFileNodeId,I=function(e,t){let{exchange:s}=(0,E.$W)(e),n=function(e){let[t,s]=a.useState(()=>et(e?.sourceCode));return(0,a.useEffect)(()=>{t&&s(et(e?.sourceCode))},[e?.sourceCode,t,s]),t}(t);return n&&s?.messages?.length?1:n?0:2}(T,v),{setAttachments:M}=(0,N._9)(T),z=a.useCallback(()=>{(0,j.UM)(),s(),M([]),h.n1M?.clearPastedDesign()},[s,M]),L=a.useCallback(e=>{h.Ez5?.uiState()?.isMakeModalChatInputFocused.set(e)},[]),O=a.useCallback(()=>{f("code")},[]);(0,F.sl)(O);let P=a.useRef(null),R=(0,K.wE)(_),D=(0,y.md)(j.ZY),q=R&&!D;if(!_?.isAlive&&!t?.newCodeInstanceNodeId||!S||!T)return null;let G=(0,n.jsx)(ee,{chatNode:v,codeInstanceNode:_,featureType:r.lV.FIGMAKE_IN_DESIGN,forceReadOnly:l,isDragging:C,panelConfiguration:q?"preview":g,previewState:I,registerIframeRefresh:u,registerSitesPreview:p,windowRef:P});return(0,n.jsx)("div",{className:"x10l6tqk x1yjdb4r x13vifvy xu96u03 x3m8u43 x1ey2m1c x1n327nk",children:(0,n.jsx)(i.YZ,{direction:"horizontal",children:q?(0,n.jsxs)(i.Zk,{children:[(0,n.jsx)(Y,{onClose:z,name:_?.name??""}),G]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Zk,{defaultSize:35,minSize:20,children:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x5yr21d",children:[(0,n.jsx)(Y,{onClose:z,name:_?.name??""}),(0,n.jsx)($.H,{codeInstanceNode:_,codeInstanceNodeGuid:S,entryPointCodeFile:v,entryPointCodeFileGuid:T,featureType:c,forceReadOnly:l,hideChatBox:o,isResizingPanel:C,newCodeLayerState:t,onChatInputBlur:()=>{L(!1)},onChatInputFocus:()=>{L(!0)},previewState:I,setCodeInstanceNode:k,setEntryPointCodeFile:b})]})}),(0,n.jsx)(i.TW,{onDragging:e=>{w(e)},className:"x1i1rx1s xbpqucl"}),(0,n.jsx)(i.Zk,{children:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x5yr21d",children:[(0,n.jsx)(Z,{codeInstanceNode:_,sitesPreview:m,handleRefresh:x,panelConfiguration:g,handleSegmentChange:f,showToolbar:!!d}),G]})})]})})})}function ee({registerIframeRefresh:e,registerSitesPreview:t,panelConfiguration:s,chatNode:r,codeInstanceNode:l,isDragging:o,windowRef:c,previewState:d,forceReadOnly:u,featureType:x}){let m=(0,y.md)(j.Jl),p=(0,g.UN)().get(m),h=(0,A.hh)(r),f=(0,T.di)({codeFileNode:r}),b=p?.guid,w=r?.guid,E=a.useCallback(e=>{if(!b)return;let t=M.O.get(b);t&&(e===I.d.BUILD_ERROR||e===I.d.RUNTIME_ERROR?t.hasErrors=!0:e===I.d.LOADED&&(t.hasErrors=!1))},[b]),N=a.useMemo(()=>{let e=r?.codeFilePath||void 0;return(0,n.jsx)(C.S,{selectedCodeFileNode:p,nodeWithChatMessages:r,featureType:x,rootPath:e})},[r,p,x]),L=a.useMemo(()=>(0,n.jsx)(z.RL,{codeFile:p,nodeWithChatMessages:r,fullHeight:!0,forceDisableEditable:u}),[r,p,u]),F=(0,k.tS)();(0,a.useEffect)(()=>{if(!b)return;let e=M.O.start(F,b);return()=>e.end()},[b,F]);let{triggerSelfHeal:G}=(0,S.u)({chatMessagesNode:r,chatController:f,disabled:!(0,_.kc)().bake_auto_error_fix,featureType:x}),K=a.useCallback((e,t,s)=>{h&&G(h,s,t)},[G,h]),V=(0,O.rh)(l),$=(0,v.uQ)(),[W,Y]=(0,y.fp)(H.gn),[X,Z]=(0,y.fp)(H.u3),[J,Q]=(0,y.fp)(H.dD);(0,a.useEffect)(()=>{if(Y(!0),$){let e=(0,g.UN)().get($);if(e){let t=e.absoluteBoundingBox.w,s=e.absoluteBoundingBox.h;if(t>H.g_){let e=t/s,n=H.g_;Z(n),Q(n/e)}else if(s>H.L9){let e=t/s,n=H.L9;Z(n*e),Q(n)}else Z(t),Q(s)}}},[$,Q,Z,Y]);let ee=a.useMemo(()=>{let s=2===d;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{...{0:{className:"xh8yej3 x78zum5 x1iyjqo2 xs83m0k"},1:{className:"xh8yej3 x1iyjqo2 xs83m0k x1s85apg x47corl"}}[!s<<0],children:(0,n.jsx)(B.m,{children:(0,n.jsx)(D.m,{chatNodeId:w??null,codeSelectionToRender:V,disableDrawer:!0,disablePointerEvents:o,isVisible:!0,jsxDev:(0,_.kc)().code_layers_click_to_inspect,onError:K,onPreviewStateChange:E,onRegisterIframeRefresh:e,onRegisterSitesPreview:t,sandbox:null,showViewOptions:!0,surface:P.e.DesignInSeparateTabPreview})})}),(0,n.jsx)(R._,{codeSelectionToRender:V??void 0,windowRef:c})]})},[V,c,E,o,w,K,d,e,t]);return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x5yr21d",children:["preview"===s&&(0,n.jsx)("div",{className:"xh8yej3 x5yr21d x78zum5 xdt5ytf xlqzeqv x6s0dn4",children:1===d?(0,n.jsx)(U.Ay,{}):0!==d&&l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"xh8yej3",children:(0,n.jsx)(H.Yd,{})}),ee]}):(0,n.jsx)(q.p,{})}),"code"===s&&(0,n.jsxs)(i.YZ,{direction:"horizontal",children:[(0,n.jsx)(i.Zk,{defaultSize:35,children:N}),(0,n.jsx)(i.Zk,{defaultSize:65,children:L})]})]})}function et(e){return!e||""===(e=e.trim())||e===l.jP||e===l.oA}},564055:(e,t,s)=>{s.d(t,{N:()=>v,w:()=>k});var n=s(239976),a=s(943360),i=s(473295),r=s(969365),l=s(255940),o=s(941191),c=s(32404),d=s(261361),u=s(454705),x=s(379141),m=s(323264),p=s(75962),h=s(985836),g=s(811804),f=s(251799),_=s(223487),y=s(456556);let k=["TEXT","SECTION","SLICE","STICKY","CONNECTOR","STAMP"];function v(e){let t;let s=(0,y.Fk)((e,t)=>e.get(t)?.visible,e.guid),k=(0,y.Fk)((e,t)=>e.get(t)?.type,e.guid),v=(0,_.tS)(),j=(0,g.DP)(),C=(0,f.ic)(e.guid);if(!k)return null;switch(k){case"TEXT":t=(0,n.jsx)(i.B,{className:"xmauxvm"});break;case"SECTION":t=(0,n.jsx)(r.P,{className:"xmauxvm"});break;case"SLICE":t=(0,n.jsx)(l.C,{className:"xmauxvm"});break;case"STICKY":t=(0,n.jsx)(o.V,{className:"xmauxvm"});break;case"CONNECTOR":t=(0,n.jsx)(c.y,{className:"xmauxvm"});break;case"STAMP":t=(0,n.jsx)(d.b,{className:"xmauxvm"});break;default:t=C&&v?(0,n.jsx)(p.oW,{className:"x5yr21d xh8yej3 x4ouu4z",style:{objectFit:"contain",opacity:s?1:.5},src:C,alt:(0,x.t)("layer_icon.thumbnail.alt_text")}):(0,n.jsx)(h.Qp,{className:"x5yr21d xh8yej3 x4ouu4z",animationType:h.JR.LIGHT_SHIMMER})}return(0,n.jsx)(a.E,{"aria-label":(0,x.t)("layer_icon.button.pan_to_node"),htmlAttributes:{onDoubleClick:t=>{e.navigateAndPanTo&&(t.currentTarget?.blur(),e.navigateAndPanTo(e.guid))}},className:"x11g6tue",children:(0,n.jsx)("span",{...m.Ay.props(b.iconHeight(e.size),b.iconWidth(e.size),b.iconContainer,"light"===j?b.lightBackground:b.darkBackground,e.rowSelected&&b.selected),children:(0,n.jsx)(u.J,{mode:"light",children:t})})})}let b={iconHeight:e=>[{kZKoxP:null!=e?"x16ye13r":e,$$css:!0},{"--x-height":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(e)}],iconWidth:e=>[{kzqmXN:null!=e?"x5lhr3w":e,$$css:!0},{"--x-width":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(e)}],darkBackground:{kC7eKd:"x14ju1db",ku1ltF:null,kHypHr:null,kWkggS:null,kKwaWg:null,kl9DO0:null,k1YJky:null,kDwdnV:null,kAiEkY:null,kz484i:null,kgSjnq:null,$$css:!0},lightBackground:{kC7eKd:"x1usue9s",ku1ltF:null,kHypHr:null,kWkggS:null,kKwaWg:null,kl9DO0:null,k1YJky:null,kDwdnV:null,kAiEkY:null,kz484i:null,kgSjnq:null,$$css:!0},iconContainer:{kjVXCG:"xeutv01",kaIpWk:"x19y5rnk",krdFHd:null,kfmiAY:null,kVL7Gh:null,kT0f0o:null,kIxVMA:null,ksF3WI:null,kqGeR4:null,kYm2EN:null,kmVPX3:"x1i3ajwb",kg3NbH:null,kuDDbn:null,kE3dHu:null,kP0aTx:null,kpe85a:null,k8WAf4:null,kLKAdn:null,kGO01o:null,kB7OPa:"x9f619",k1xSpc:"x78zum5",kGNEyG:"x6s0dn4",kjj79g:"xl56j7k",$$css:!0},selected:{kmVPX3:"xyf9f8g",kg3NbH:null,kuDDbn:null,kE3dHu:null,kP0aTx:null,kpe85a:null,k8WAf4:null,kLKAdn:null,kGO01o:null,kMzoRj:"xmkeg23",kjGldf:null,k2ei4v:null,kZ1KPB:null,ke9TFa:null,kWqL5O:null,kLoX6v:null,kEafiO:null,kt9PQ7:null,ksu8eU:"x1y0btm7",kJRH4f:null,kVhnKS:null,k4WBpm:null,k8ry5P:null,kSWEuD:null,kDUl1X:null,kPef9Z:null,kfdmCh:null,kVAM5u:"x2mq3v4",kzOINU:null,kGJrpR:null,kaZRDh:null,kBCPoo:null,k26BEO:null,k5QoK5:null,kLZC3w:null,kL6WhQ:null,$$css:!0}}},230706:(e,t,s)=>{s.d(t,{C:()=>i});var n=s(270450);class a{constructor(e,t){this.YIELD_EVERY_N_MS=e,this.controller=t,this.timeSpentYielding=0,this.lastYieldTimeMs=-1,this.nrOfYields=0}throwIfAborted(){this.controller.signal.throwIfAborted()}shouldYield(){return(this.throwIfAborted(),-1===this.lastYieldTimeMs)?(this.lastYieldTimeMs=performance.now(),!1):performance.now()-this.lastYieldTimeMs>=this.YIELD_EVERY_N_MS}yield(){this.throwIfAborted();let e=performance.now();return scheduler.postTask(async()=>{},{signal:this.controller.signal}).finally(()=>{this.timeSpentYielding+=performance.now()-e,this.lastYieldTimeMs=performance.now(),this.nrOfYields++})}abort(e){this.controller.abort(e)}isAborted(){return this.controller.signal.aborted}getTimeSpentYieldingMs(){return this.timeSpentYielding}getNrOfYields(){return this.nrOfYields}}function i(){if((0,n.kc)().ai_assistant_serialization_async)return new a(8,new TaskController({priority:"user-visible"}))}},326205:(e,t,s)=>{s.d(t,{S:()=>e8});var n=s(239976),a=s(105652),i=s(20002),r=s(25378),l=s(363638),o=s(146119),c=s(646673),d=s(846779),u=s(735786),x=s(796557),m=s(4245),p=s(466082),h=s(379141),g=s(270450),f=s(445019),_=s(323264),y=s(522568),k=s(888903),v=s(750665),b=s(680912),j=s(946804),C=s(223487),w=s(12908),E=s(413324),N=s(824851),S=s(870141),T=s(373703),I=s(183290),A=s(717135),M=s(696002);let z=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M8 1.999a6 6 0 1 1 0 12.002 6 6 0 0 1 .002-12.002m2.505 1.672c-.59-.341-1.54.097-2.503 1.045-.963-.946-1.91-1.385-2.5-1.045s-.683 1.38-.345 2.688c-1.3.362-2.152.962-2.152 1.643s.852 1.282 2.152 1.644c-.337 1.306-.242 2.345.348 2.685s1.535-.098 2.498-1.043c.963.946 1.91 1.385 2.5 1.044s.683-1.38.345-2.686c1.303-.361 2.157-.962 2.157-1.644s-.853-1.283-2.156-1.644c.339-1.307.246-2.346-.344-2.687M9.87 9.856q.09.343.134.643c.058.408.044.697.003.872q-.011.041-.02.067-.03-.004-.07-.015c-.172-.052-.43-.184-.753-.439a6 6 0 0 1-.49-.438 11 11 0 0 0 .453-.596q.383-.035.743-.094m-3.735 0q.359.058.743.093.222.316.452.598-.25.249-.488.436c-.324.255-.581.387-.753.439q-.04.01-.069.014-.01-.025-.021-.066c-.042-.175-.057-.464.002-.872q.042-.3.134-.643m1.95-2.852a1 1 0 1 1-.957 1.483l-.015-.026a1 1 0 0 1-.035-.852l.06-.108.056-.092a1 1 0 0 1 .703-.405l.107-.002zm2.457.307q.343.092.627.206c.382.153.624.31.755.433l.05.052-.05.052c-.13.123-.373.28-.755.433a6 6 0 0 1-.627.207 11 11 0 0 0-.291-.691q.162-.352.29-.692m-5.081 0q.13.34.293.691a11 11 0 0 0-.291.69 6 6 0 0 1-.622-.205c-.383-.153-.627-.31-.757-.433q-.03-.03-.047-.052.017-.022.047-.052c.13-.123.374-.28.757-.433a6 6 0 0 1 .62-.206m.626-2.73c.172.051.429.184.753.439q.238.186.49.437-.229.282-.452.598-.386.035-.745.093A6 6 0 0 1 6 5.505c-.059-.408-.045-.697-.003-.872q.01-.041.02-.068.028.005.07.016m3.921.05c.042.176.057.465-.001.872q-.045.3-.135.643-.361-.057-.746-.092-.224-.316-.453-.598.253-.25.493-.438c.323-.255.58-.387.753-.438l.069-.017q.01.027.02.069",clipRule:"evenodd"})})}),L=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M11.5 3.001a1.5 1.5 0 0 1 1.5 1.5v7a1.5 1.5 0 0 1-1.5 1.5h-7A1.5 1.5 0 0 1 3 11.5v-7a1.5 1.5 0 0 1 1.5-1.499zm-6 4a.5.5 0 1 0 0 1H6v3.5a.5.5 0 0 0 1 0v-3.5h.5a.5.5 0 0 0 0-1zm5 0a1.5 1.5 0 1 0 0 3 .5.5 0 1 1 0 1h-1a.5.5 0 1 0 0 1h1a1.5 1.5 0 0 0 0-3 .5.5 0 0 1 0-1h.5a.5.5 0 0 0 0-1z",clipRule:"evenodd"})})}),O=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M8 2a6 6 0 1 1 0 12A6 6 0 0 1 8 2m2.505 1.67c-.59-.34-1.539.098-2.502 1.045-.963-.946-1.91-1.383-2.5-1.043s-.685 1.379-.347 2.686c-1.3.362-2.151.963-2.151 1.644s.852 1.282 2.152 1.644c-.337 1.306-.242 2.345.348 2.685s1.535-.097 2.498-1.042c.963.946 1.91 1.384 2.5 1.043s.683-1.38.345-2.687c1.303-.361 2.157-.961 2.158-1.643s-.854-1.283-2.156-1.644c.338-1.307.245-2.346-.345-2.687M9.87 9.857q.09.343.135.643c.058.407.044.696.002.871q-.01.042-.02.068-.029-.005-.07-.016c-.171-.051-.43-.183-.753-.438a6 6 0 0 1-.491-.438q.229-.282.453-.596.385-.035.744-.094m-3.735 0q.357.059.742.093.223.316.453.597a6 6 0 0 1-.488.437c-.324.255-.581.387-.753.439q-.042.01-.07.014-.01-.025-.02-.066c-.042-.175-.057-.464.002-.872q.042-.3.134-.642m1.91-2.854a1 1 0 1 1-.872 1.56l-.037-.06-.03-.057a1 1 0 0 1-.028-.836l.06-.108.056-.092a1 1 0 0 1 .745-.407L8.006 7zm-2.582.31q.13.34.29.69-.16.351-.29.69a6 6 0 0 1-.622-.205c-.383-.153-.626-.31-.756-.433q-.03-.03-.048-.052.017-.022.048-.052c.13-.123.373-.28.756-.433q.28-.113.622-.205m5.079-.001q.344.093.627.206c.382.153.624.31.755.433q.03.03.048.052-.018.021-.048.052c-.131.123-.373.28-.755.433a6 6 0 0 1-.627.205 11 11 0 0 0-.291-.69q.162-.35.29-.691M6.089 4.58c.172.052.43.183.753.438q.237.188.489.438-.23.282-.453.598-.385.035-.744.093A6 6 0 0 1 6 5.504c-.059-.408-.044-.696-.002-.871q.01-.041.02-.069zm3.92.05c.042.176.056.465-.002.872q-.045.3-.135.643-.36-.057-.745-.091-.224-.315-.453-.599.252-.25.492-.438c.324-.255.582-.387.754-.438l.069-.017q.01.027.02.069",clipRule:"evenodd"})})}),P=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M11.5 3A1.5 1.5 0 0 1 13 4.5v7a1.5 1.5 0 0 1-1.5 1.5h-7A1.5 1.5 0 0 1 3 11.5v-7A1.5 1.5 0 0 1 4.5 3zm-4 4a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-.99.1l-.02-.2a.5.5 0 0 0-.99.1 1.5 1.5 0 0 0 3 0v-3a.5.5 0 0 0-.5-.5m3 0a1.5 1.5 0 1 0 0 3 .5.5 0 0 1 0 1h-1a.5.5 0 0 0 0 1h1a1.5 1.5 0 0 0 0-3 .5.5 0 0 1 0-1h.5a.5.5 0 0 0 0-1z"})})}),R=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M8 2a6 6 0 0 1 5.934 6.895C13.719 10.325 12.39 11 11.274 11H9c0 .821-.343 1.61-.93 2.129-.615.542-1.504.78-2.407.398A6.001 6.001 0 0 1 8 2M5.958 8.715a1 1 0 1 0-1.917.57 1 1 0 0 0 1.917-.57m6.001-2a1 1 0 1 0-1.917.572 1 1 0 0 0 1.917-.572M6.187 5.273a1 1 0 1 0-1.373 1.453 1 1 0 0 0 1.373-1.453m2.545-1.245a1 1 0 1 0-.464 1.944 1 1 0 0 0 .464-1.944"})})}),D=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M8 2a6 6 0 0 1 5.934 6.895C13.719 10.325 12.39 11 11.274 11H9c0 .821-.343 1.61-.93 2.129-.615.542-1.504.78-2.407.398A6.001 6.001 0 0 1 8 2M5.959 8.715a1 1 0 1 0-1.917.572 1 1 0 0 0 1.917-.572m6-2a1 1 0 1 0-1.917.572 1 1 0 0 0 1.917-.572M6.188 5.273a1 1 0 1 0-1.375 1.455 1 1 0 0 0 1.375-1.455m2.544-1.246a1 1 0 1 0-.463 1.947 1 1 0 0 0 .463-1.947"})})}),F=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M6.901 2.718a2 2 0 0 1 2.19-.001l.517.338q.017.008.033.02l2 1.309.038.025.414.272a2 2 0 0 1 .905 1.673v.507l.001.032v2.211l-.001.027v.514a2 2 0 0 1-.905 1.674l-3.001 1.964a2 2 0 0 1-2.064.076l-.127-.076-2.999-1.964a2 2 0 0 1-.904-1.674l.001-3.292a2 2 0 0 1 .904-1.672zM5 6.353v3.293l2.998 1.963 3.001-1.964v-3.29l-3-1.964zm4.999.54v2.211l-2 1.309-2-1.309L6 6.894l1.998-1.31zM11.663 4.4l-.022-.015-2.001-1.31-.02-.013z",clipRule:"evenodd"})})}),q=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M6.585 2.344a2 2 0 0 1 2.83 0l.657.657H11a2 2 0 0 1 2 2v.928l.656.657a2 2 0 0 1 0 2.828L13 10.07V11a2 2 0 0 1-2 2h-.93l-.655.657c-.781.78-2.048.78-2.83 0l-.656-.656H5a2 2 0 0 1-1.998-2v-.93l-.658-.657a2 2 0 0 1 0-2.828l.658-.657V5a2 2 0 0 1 2-2h.927zM6 5a1 1 0 0 0-1 1v.793l-.854.853a.5.5 0 0 0 0 .707L5 9.207V10a1 1 0 0 0 1 1h.5a.5.5 0 0 0 0-1H6V9a.5.5 0 0 0-.147-.354L5.207 8l.646-.647A.5.5 0 0 0 6 7V6h.5a.5.5 0 0 0 0-1zm3.5 0a.5.5 0 0 0 0 1h.5v1c0 .132.053.26.146.353l.646.647-.646.646A.5.5 0 0 0 10 9v1h-.5a.5.5 0 0 0 0 1h.5a1 1 0 0 0 1-1v-.793l.853-.854a.5.5 0 0 0 0-.707l-.854-.853V6a1 1 0 0 0-1-1z",clipRule:"evenodd"})})}),G=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M5 12.5H4A1.5 1.5 0 0 1 2.5 11V7H5zm8.5-1.5a1.5 1.5 0 0 1-1.5 1.5H6V7h7.5zM12 3.5A1.5 1.5 0 0 1 13.5 5v1h-11V5A1.5 1.5 0 0 1 4 3.5z"})})}),U=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M12.5 4A1.5 1.5 0 0 1 14 5.5v5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 10.5v-5A1.5 1.5 0 0 1 3.5 4zM7.691 6.038a.5.5 0 0 0-.545.108L6 7.293 4.854 6.146A.5.5 0 0 0 4 6.5v3a.5.5 0 0 0 1 0V7.707l.646.647a.5.5 0 0 0 .708 0L7 7.707V9.5a.5.5 0 0 0 1 0v-3a.5.5 0 0 0-.309-.462M10.5 6a.5.5 0 0 0-.5.5v1.793l-.146-.147a.5.5 0 1 0-.708.708l1 1a.5.5 0 0 0 .707 0l1-1a.5.5 0 1 0-.707-.708L11 8.293V6.5a.5.5 0 0 0-.5-.5"})})}),K=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M8 6a1 1 0 0 0 1 1h3.5v5a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 12V4A1.5 1.5 0 0 1 5 2.5h3zm-2 4.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1zm0-2a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1zM12.5 6H9V2.5z"})})}),H=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M11.5 3A1.5 1.5 0 0 1 13 4.5v7a1.5 1.5 0 0 1-1.5 1.5h-7A1.5 1.5 0 0 1 3 11.5v-7A1.5 1.5 0 0 1 4.5 3zM6.854 7.146a.5.5 0 0 0-.63-.064l-.078.064-2 2a.5.5 0 1 0 .708.708L6.5 8.207l3.646 3.646a.5.5 0 1 0 .707-.707zM10 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2"})})}),B=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M11.5 3A1.5 1.5 0 0 1 13 4.5v7a1.5 1.5 0 0 1-1.5 1.5H9.617a1.807 1.807 0 0 1-3.234 0H4.5A1.5 1.5 0 0 1 3 11.5v-7A1.5 1.5 0 0 1 4.5 3zM8 10a.66.66 0 0 0-.654.592l-.151 1.517a.81.81 0 1 0 1.61 0l-.15-1.517A.66.66 0 0 0 8 10m-.5-2a.5.5 0 0 0 0 1h1a.5.5 0 1 0 0-1zm0-2a.5.5 0 0 0 0 1h1a.5.5 0 1 0 0-1zm0-2a.5.5 0 0 0 0 1h1a.5.5 0 1 0 0-1z"})})}),V=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M7.055 2.337a1.5 1.5 0 0 1 2.007.103l4.5 4.5a1.5 1.5 0 0 1 0 2.121l-4.5 4.5a1.5 1.5 0 0 1-2.121 0l-4.5-4.5a1.5 1.5 0 0 1 0-2.121l3.146-3.146 1.448 1.449a1 1 0 0 0 .464 1.121v3.271a1 1 0 1 0 1-.002V6.706l1.036 1.037a1 1 0 1 0 .706-.708L8.964 5.758Q9 5.634 9.001 5.5a1 1 0 0 0-1.26-.964L6.294 3.087l.647-.647z",clipRule:"evenodd"})})}),$=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M10 3c1.382 0 2.67.285 3.756.78.521.237.084.9-.483.814A8.5 8.5 0 0 0 12 4.5C8.962 4.5 6.5 6.067 6.5 8s2.463 3.5 5.5 3.5q.66-.001 1.274-.095c.567-.085 1.004.576.482.814C12.67 12.713 11.382 13 10 13c-3.866 0-7-2.239-7-5s3.134-5 7-5",clipRule:"evenodd"})})}),W=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M11.5 3A1.5 1.5 0 0 1 13 4.5v7a1.5 1.5 0 0 1-1.5 1.5h-7A1.5 1.5 0 0 1 3 11.499v-7A1.5 1.5 0 0 1 4.5 3zm-2 5c-.653 0-1.207.417-1.413 1H5.5a.5.5 0 0 0 0 1h2.588A1.499 1.499 0 1 0 9.5 8m0 1a.5.5 0 1 1 0 1 .5.5 0 0 1 0-1m-3-4a1.5 1.5 0 1 0 1.413 2H10.5a.5.5 0 0 0 0-1H7.914c-.206-.583-.76-1-1.414-1m0 1a.5.5 0 1 1 0 1 .5.5 0 0 1 0-1",clipRule:"evenodd"})})}),Y=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M10.153 2.003a.183.183 0 0 1 .211.231L9.43 5.47a.183.183 0 0 0 .211.23l1.431-.276a.184.184 0 0 1 .198.263l-4.066 8.115-.073.114c-.11.17-.375.061-.334-.137l.656-3.175a.183.183 0 0 0-.232-.213l-.859.26a.183.183 0 0 1-.232-.211l.412-2.02a.184.184 0 0 0-.22-.216l-1.39.32a.183.183 0 0 1-.224-.188l.307-5.185a.18.18 0 0 1 .148-.169z",clipRule:"evenodd"})})}),X=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M11 2a1 1 0 0 1 1 1v7H8.5a.5.5 0 0 0-.5.5v.5a2 2 0 1 1-4 0V3a1 1 0 0 1 1-1zm3 9a2 2 0 0 1-2 2H8.231A2.98 2.98 0 0 0 9 11zM9.854 7.146a.5.5 0 0 0-.708 0l-.646.647-.646-.647a.5.5 0 0 0-.63-.064l-.078.064-1 1a.5.5 0 1 0 .708.708l.646-.647.646.647a.5.5 0 0 0 .708 0l1-1a.5.5 0 0 0 0-.708M6.5 4a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z"})})}),Z=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M8 2.5a5 5 0 0 1 2.999 8.999L11 11.5v1a1 1 0 1 1-2 0 1 1 0 1 1-2 0 1 1 0 1 1-2 0v-1.001A5 5 0 0 1 8 2.5M8 10a.5.5 0 1 0 0 1 .5.5 0 0 0 0-1M6 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2m4 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2"})})}),J=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M8 6a1 1 0 0 0 1 1h3.5v5a1.5 1.5 0 0 1-1.5 1.5H5A1.5 1.5 0 0 1 3.5 12V4A1.5 1.5 0 0 1 5 2.5h3zm4.5 0H9V2.5z"})})});var Q=s(245495),ee=s(693613),et=s(692376),es=s(798913),en=s(236410),ea=s(567910),ei=s(942895),er=s(607696);function el(e){return e?e.trim().replace(/[^a-zA-Z0-9\-_.]/g,"_"):""}function eo(e,t,s){let n,a=0,i=e,r=s||(0,d.$d)(t);for(;a<1e4;)if(n=t?t+"/"+i:i,`/${n}`in r){let t=function(e){let t=e.replace(/\.[^.]+$/,"");return e.slice(t.length)}(e),s=t?e.replace(/\.[^/.]+$/,""):e;a++,i=t?`${s}-${a}${t}`:`${s}-${a}`}else break;if(a>=1e4)throw Error(`Unable to generate unique filename for "${e}" - too many existing files with similar names`);return i}function ec(e,t,s){let n,a=0,i=e,r=(0,d.$d)(t,{includeHidden:!0}),l=s?`/${s}/`:null;for(;a<1e4;){n=t?t+"/"+i:i;let s=`/${n}/`;if(Object.keys(r).some(e=>e.startsWith(s)&&(!l||!e.startsWith(l))))a++,i=`${e}-${a}`;else break}if(a>=1e4)throw Error(`Unable to generate unique folder name for "${e}" - too many existing folders with similar names`);return i}var ed=s(295870),eu=s(616246),ex=s.n(eu),em=s(129416),ep=s(772293),eh=s(842725),eg=s(562875),ef=s(836848);let e_=(0,a.createContext)(null);function ey({children:e,value:t}){return(0,n.jsx)(e_.Provider,{value:t,children:e})}function ek(){let e=(0,a.useContext)(e_);return(0,ef.KF)(!!e,"useFileTreeContext must be used within a FileTreeProvider"),e}var ev=s(881562);let eb=[".ts",".tsx",".js",".jsx",".css",".scss",".html",".json",".md",".txt"];function ej({path:e,featureType:t}){let{onNewFileCreated:s}=ek();return(0,n.jsx)(u.q7,{onClick:()=>{y.az.trackDefinedEvent("figmake.filesystem_action",{fileKey:f.zl.get(C.ze)??void 0,action:"create_file",targetType:e?"folder":"root",entryPoint:"context_menu",codeFileGuid:void 0}),es.Hq.user("create-new-code-file",()=>{try{let n;let a=t===er.lV.ANIMATION_PRESET?".ts":".tsx",i=eo(`new-file${a}`,e),r=e?`${e.replace(/\/$/,"")}/${i}`:i,l=(0,eg.EI)(e??"");if(n=(0,N.zy)()&&l?(0,eg.OP)({codeFilePath:r,sourceCodeLibraryKey:l,code:"",key:eg.an,version:eg.lY}):p.UN()?.createNewCodeFile({path:r,sourceCode:"",entryPoint:"file_context_menu",isEntrypointCodeFile:!1,onError:e=>{em.$D(ed.e.MAKE,e)},createCodeComponent:!1}),ep.Y5.commit(),n){let e=(0,p.UN)().get(n);e&&(0,ev.nU)(e),s(n)}}catch(e){(0,em.$D)(ed.e.MAKE,e)}})},"data-testid":"create-file-menu-item",children:(0,h.t)("figmake.filesystem.context_menu.create_new_file")})}function eC({path:e}){let{onNewFolderCreated:t}=ek();return(0,n.jsx)(u.q7,{onClick:()=>{y.az.trackDefinedEvent("figmake.filesystem_action",{fileKey:f.zl.get(C.ze)??void 0,action:"create_folder",targetType:e?"folder":"root",entryPoint:"context_menu",codeFileGuid:void 0}),es.Hq.user("create-folder",()=>{try{let s=ec("new-folder",e),n=e?`${e.replace(/\/$/,"")}/${s}`:s,a=`${n}/.gitkeep`,i=p.UN()?.createNewCodeFile({path:a,sourceCode:"",entryPoint:"file_context_menu",isEntrypointCodeFile:!1,onError:e=>{em.$D(ed.e.MAKE,e)},createCodeComponent:!1});ep.Y5.commit(),i&&t(n)}catch(e){(0,em.$D)(ed.e.MAKE,e)}})},"data-testid":"create-folder-menu-item",children:(0,h.t)("figmake.filesystem.context_menu.create_folder")})}function ew({path:e}){return(0,n.jsx)(u.q7,{onClick:()=>{y.az.trackDefinedEvent("figmake.filesystem_action",{fileKey:f.zl.get(C.ze)??void 0,action:"copy_path",targetType:e.includes(".")?"file":"folder",entryPoint:"context_menu",codeFileGuid:void 0}),navigator.clipboard.writeText(e)},children:(0,h.t)("figmake.filesystem.context_menu.copy_path")})}function eE({node:e,disabled:t}){return(0,n.jsx)(u.q7,{onClick:()=>{y.az.trackDefinedEvent("figmake.filesystem_action",{fileKey:f.zl.get(C.ze)??void 0,action:"delete_file",targetType:"file",entryPoint:"context_menu",codeFileGuid:e.guid}),es.Hq.user("delete-code-file",()=>{et.glU?.deleteCodeFile(e.guid),et.glU?.commit()})},disabled:t,"data-testid":"delete-file-menu-item",children:(0,h.t)("figmake.filesystem.context_menu.delete")})}function eN({openConfirmModal:e,disabled:t}){return(0,n.jsx)(u.q7,{onClick:e,disabled:t,"data-testid":"delete-folder-menu-item",children:(0,h.t)("figmake.filesystem.context_menu.delete")})}function eS(e){let t=(0,p.UN)();if(!t)return;let s=t.get(e.guid);if(s)return s.sourceCode}function eT({fileOrFolder:e}){return(0,n.jsx)(u.q7,{onClick:()=>{y.az.trackDefinedEvent("figmake.filesystem_action",{fileKey:f.zl.get(C.ze)??void 0,action:"download",targetType:e.type,entryPoint:"context_menu",codeFileGuid:"file"===e.type?e.guid:void 0});let{name:t,blob:s}=function(e){if("file"===e.type){let t=eS(e);return{name:e.name,blob:new Blob([t||""],{type:"text/plain"})}}{let t=new(ex());!function e(t,s,n){if("file"===s.type){let e=eS(s);if(!e)return;let{name:a}=s,i=s.codeFilePath?s.codeFilePath.slice(n.length)+"/":"";t.file(i+a,new TextEncoder().encode(e))}else for(let a of s.children)e(t,a,n)}(t,e,e.path);let s=t.generate({type:"blob"});return{name:e.path.length>0?e.path.split("/").pop()+".zip":"project.zip",blob:s}}}(e),n=URL.createObjectURL(s),a=document.createElement("a");a.href=n,a.download=t,a.click(),URL.revokeObjectURL(n)},children:(0,h.t)("figmake.filesystem.context_menu.download")})}function eI({handleRename:e,disabled:t}){return(0,n.jsx)(u.q7,{onClick:()=>{y.az.trackDefinedEvent("figmake.filesystem_action",{fileKey:f.zl.get(C.ze)??void 0,action:"rename",targetType:"file",entryPoint:"context_menu",codeFileGuid:void 0}),e()},htmlAttributes:{onPointerUp:e=>e.preventDefault()},disabled:t,children:(0,h.t)("figmake.filesystem.context_menu.rename")})}function eA({handleRename:e,disabled:t}){return(0,n.jsx)(u.q7,{onClick:()=>{y.az.trackDefinedEvent("figmake.filesystem_action",{fileKey:f.zl.get(C.ze)??void 0,action:"rename_folder",targetType:"folder",entryPoint:"context_menu",codeFileGuid:void 0}),e()},htmlAttributes:{onPointerUp:e=>e.preventDefault()},disabled:t,"data-testid":"rename-folder-menu-item",children:(0,h.t)("figmake.filesystem.context_menu.rename")})}function eM(e){return e.isFile&&"file"in e}function ez(e){return e.isDirectory&&"createReader"in e}async function eL(e,t,s){if(e.length>100){let t=(0,h.t)("figmake.filesystem.file_upload.error_too_many_files",{count:e.length,max:100});s?.(k.F.enqueue({message:t,error:!0,timeoutOverride:3e3}));return}let n=[];for(let t of e)try{let e=await new Promise(e=>{t.file(e)});if(e){let s="fullPath"in t?t.fullPath.replace(/^\//,""):e.name;n.push({file:e,relativePath:s})}}catch(e){console.error("Failed to process file entry:",e)}for(let{file:e,relativePath:a}of n)await eP(e,a,t,s)}function eO(e){let t=e.lastIndexOf("/");return t>=0?e.substring(0,t):void 0}async function eP(e,t,s,n){let a=s?`${s}/${t}`:t;try{!function(e){let t=(0,eh.dv)(e.name);if(!eb.includes(t))throw Error((0,h.t)("figmake.filesystem.file_upload.error_invalid_type"));if(e.size>0xa00000)throw Error((0,h.t)("figmake.filesystem.file_upload.error_too_large"))}(e);let t=await new Promise((t,s)=>{let n=new FileReader;n.onload=e=>{let n=new TextDecoder("utf-8",{fatal:!0});try{if(e.target?.result&&"object"==typeof e.target.result&&e.target.result instanceof ArrayBuffer){let s=n.decode(e.target.result);"string"==typeof s&&t(s)}}finally{s(Error("Failed to read file as text"))}},n.onerror=()=>s(Error("Failed to read file")),n.readAsArrayBuffer(e)}),s=eo(e.name,eO(a)),n=eO(a)?`${eO(a)}/${s}`:s;es.l7.user("create-file-from-drop",()=>{let e=p.UN()?.createNewCodeFile({path:n,sourceCode:t,entryPoint:"file_drop",isEntrypointCodeFile:!1,onError:e=>{em.$D(ed.e.MAKE,e)},createCodeComponent:!0});if(ep.Y5.commit(),y.az.trackDefinedEvent("figmake.file_upload_result",{fileKey:f.zl.get(C.ze)??void 0,success:!0,errorMessage:void 0,codeFileGuid:e??void 0}),e){let t=(0,p.UN)().get(e);t&&(0,ev.nU)(t)}})}catch(s){y.az.trackDefinedEvent("figmake.file_upload_result",{fileKey:f.zl.get(C.ze)??void 0,success:!1,errorMessage:s instanceof Error?s.message:void 0,codeFileGuid:void 0});let t=s instanceof Error?s.message:(0,h.t)("figmake.filesystem.file_upload.error_failed",{name:e.name});n?.(k.F.enqueue({message:t,error:!0,timeoutOverride:3e3}))}}async function eR(e,t,s){if(e&&0!==e.length){if(e[0]&&"webkitGetAsEntry"in e[0]){await eD(e,t,s);return}await eF(e,t,s)}}async function eD(e,t,s){let n=[],a=[],i=!1;for(let t of e)if(t.webkitGetAsEntry){let e=t.webkitGetAsEntry();e&&(eM(e)?n.push(e):ez(e)&&(i=!0,a.push(function e(t,s){return new Promise(n=>{let a=t.createReader(),i=()=>{a.readEntries(t=>{if(0===t.length){n();return}let a=[];for(let n of t)eM(n)?s.push(n):ez(n)&&a.push(e(n,s));Promise.all(a).then(()=>{i()})})};i()})}(e,n))))}else if("file"===t.kind){let e=t.getAsFile();e&&n.push({file:t=>t(e)})}await Promise.all(a),y.az.trackDefinedEvent("figmake.file_upload",{fileKey:f.zl.get(C.ze)??void 0,fileCount:n.length,hasDirectories:i}),await eL(n,t,s)}async function eF(e,t,s){let n=Array.from(e);if(y.az.trackDefinedEvent("figmake.file_upload",{fileKey:f.zl.get(C.ze)??void 0,fileCount:n.length,hasDirectories:!1}),n.length>100){let e=(0,h.t)("figmake.filesystem.file_upload.error_too_many_files",{count:n.length,max:100});s?.(k.F.enqueue({message:e,error:!0,timeoutOverride:3e3}));return}for(let e of n)await eP(e,e.name,t,s)}function eq({manager:e,file:t,handleRename:s,featureType:i}){let r=(0,p.UN)().get(t.guid),l=(0,S.l)(),o=(0,c.QK)(r,i);return a.useEffect(()=>{e.isOpen&&y.az.trackDefinedEvent("figmake.filesystem_open_context_menu",{fileKey:f.zl.get(C.ze)??void 0,targetType:"file",codeFileGuid:t.guid})},[e.isOpen,t]),(0,n.jsx)(u.bL,{manager:e,children:(0,n.jsxs)(u.mc,{children:[(0,n.jsx)(ew,{path:t.codeFilePath?t.codeFilePath+"/"+t.name:t.name}),(0,n.jsx)(eT,{fileOrFolder:t}),!l&&(0,n.jsx)(eI,{handleRename:s,disabled:o}),!l&&r&&(0,n.jsx)(eE,{node:r,disabled:o})]})})}let eG={kE3dHu:"x13e46o5",kZCmMZ:"",kwRFfy:"",$$css:!0},eU={fileItemLabel:{k1xSpc:"x78zum5",kGNEyG:"x6s0dn4",kmVPX3:"x7qmaab",kaIpWk:"x12oqio5",kMwMTN:"x1akne3o","--color-icon":"xe5c7bq",k9WMMc:"xdpxx8g",kWkggS:"xjbqb8w x12tve8b",khDVqt:"xuxw1ft",kXHlph:"x6ikm8r",kg5iWk:"xlyipyv",kzqmXN:"xh8yej3",kZKoxP:"xxk0z11",$$css:!0},fileItemLabelRenaming:{kWkggS:"xjbqb8w",$$css:!0},fileItemLabelActive:{kWkggS:"xcr9a89",kMwMTN:"x1akne3o",k63SB2:"x6xwguf","--color-icon":"xtlvio2",$$css:!0},disabled:{kMwMTN:"xge78cn",kWkggS:"x1yjdb4r",$$css:!0},fileItemLabelWithIndent:e=>[eG,{"--x-paddingLeft":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(8+16*e)}],fileIconContainer:{kmuXW:"x2lah0s",kpe85a:"xpf9j6y",$$css:!0},fileIconContainerWithColorIcon:e=>[{"--color-icon":null!=e?"x1g56j85":e,$$css:!0},{"--x---color-icon":null!=e?e:void 0}]};function eK({selectedNode:e,file:t,indentLevel:s,codeIsStreaming:i,featureType:r}){let l=(0,M.hk)(),o=(0,a.useRef)(null),d=(0,ea.s)(),{getContextMenuTriggerProps:x,manager:m}=u.b(),{newlyCreatedFileGuid:g,onNewFileFocused:y}=ek(),k=(0,M.Yn)(),[v,b]=a.useState(!1),[j]=(0,f.fp)(E.ES),[C]=(0,f.fp)(E.KO),w=(0,p.UN)().get(t.guid),T=g===t.guid,I=(0,S.l)(),A=(0,c.QK)(w,r),er=a.useCallback(()=>{b(!0),y()},[y]);return(0,N.zy)()&&l?.shouldHidePreviewForMakeKitCreation&&!w?.sourceCodeLibraryKey?null:(0,n.jsxs)("button",{"aria-label":(0,h.t)("figmake.filesystem.file.description",{name:t.name}),onClick:()=>{let e=(0,p.UN)().get(t.guid);e&&(0,ev.nU)(e,!0)},className:"x10w6t97 x78zum5 x6s0dn4 xjbqb8w xj8oexa xnjsko4",disabled:i,...x(),"data-testid":"code-file-item",children:[(0,n.jsxs)("div",{..._.Ay.props(eU.fileItemLabel,eU.fileItemLabelWithIndent(s),e?.guid!==t.guid||v||null!==j||C||k&&(0,N.zy)()?void 0:eU.fileItemLabelActive,i?eU.disabled:void 0,v?eU.fileItemLabelRenaming:void 0),children:[(0,n.jsx)("span",{..._.Ay.props(eU.fileIconContainer,eU.fileIconContainerWithColorIcon(i?ee.Tj.textDisabled:null)),children:function(e){switch(e.split(".").pop()?.toLowerCase()){case"tsx":return(0,n.jsx)(z,{});case"ts":return(0,n.jsx)(L,{});case"jsx":return(0,n.jsx)(O,{});case"js":return(0,n.jsx)(P,{});case"css":return(0,n.jsx)(R,{});case"scss":case"sass":return(0,n.jsx)(D,{});case"json":if("package.json"===e)return(0,n.jsx)(F,{});return(0,n.jsx)(q,{});case"html":case"htm":return(0,n.jsx)(G,{});case"md":case"markdown":return(0,n.jsx)(U,{});case"txt":return(0,n.jsx)(K,{});case"png":case"jpg":case"jpeg":case"gif":case"svg":case"webp":case"ico":return(0,n.jsx)(H,{});case"zip":case"tar":case"gz":return(0,n.jsx)(B,{});case"git":case"gitignore":case"gitattributes":return(0,n.jsx)(V,{});case"glsl":case"frag":case"vert":return(0,n.jsx)($,{});case"config":case"conf":case"cfg":return(0,n.jsx)(W,{});case"vite":return(0,n.jsx)(Y,{});case"license":return(0,n.jsx)(X,{});case"ds_store":return(0,n.jsx)(Z,{});default:if("LICENSE"===e.toUpperCase())return(0,n.jsx)(X,{});if(e.startsWith(".git"))return(0,n.jsx)(V,{});return(0,n.jsx)(J,{})}}(t.name)}),(0,n.jsx)(ei.v,{ref:o,autoFocus:T,disabled:i,name:t.name,normalize:ev.tu,onBlur:()=>b(!1),onChange:e=>{b(!1),w&&es.Hq.user("edit-code-file-name",()=>{w.setHasBeenManuallyRenamed(!0),w.name=e,et.glU?.commit()})},onFocus:er,readOnly:I||A,testId:"code-file-name-input",validate:e=>d(t.codeFilePath,t.name,e)?null:e}),t.isLarge&&(0,n.jsx)("span",{className:"x1iog12x x2lah0s x78zum5 x6s0dn4 x1gxdvn5","data-tooltip":(0,h.t)("sites.code_components.code_file_size_warning"),"data-tooltip-type":en.Ib.TEXT,children:(0,n.jsx)(Q.R,{})})]}),(0,n.jsx)(eq,{manager:m,file:t,handleRename:()=>o.current?.focus(),featureType:r})]},t.guid)}var eH=s(563225),eB=s(402731);let eV=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M13.112 7a1 1 0 0 1 .95 1.316l-1.335 4a1 1 0 0 1-.948.684H4.388a1 1 0 0 1-.95-1.316l1.334-4A1 1 0 0 1 5.721 7zm-6.73-4a1 1 0 0 1 .894.553L8 5h3.5a1 1 0 0 1 1 1H5.72a2 2 0 0 0-1.897 1.367L3 9.837V4a1 1 0 0 1 1-1z"})})}),e$=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M12 7a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zM6.382 3a1 1 0 0 1 .894.553L8 5h4a1 1 0 0 1 1 1v.27A2 2 0 0 0 12 6H4c-.365 0-.706.1-1 .27V4a1 1 0 0 1 1-1z"})})});var eW=s(178914),eY=s(863412),eX=s(585066),eZ=s(826722);function eJ(e,t,s){let n=(0,i.wA)(),[r,l]=(0,f.fp)(E.ES),[o]=(0,f.fp)(E.KO),c=r===e&&!o;return{isDragOver:c,handleDragOver:a.useCallback(t=>{t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect=s?.disabled?"none":"copy",o||l(e)},[e,l,o,s?.disabled]),handleDragLeave:a.useCallback(e=>{e.preventDefault(),e.stopPropagation(),e.currentTarget.contains(e.relatedTarget)||l(null)},[l]),handleDrop:a.useCallback(async e=>{if(e.preventDefault(),e.stopPropagation(),l(null),s?.disabled)return;let a=e.dataTransfer;a?.items&&a.items.length>0?await eR(Array.from(a.items),t,n):await eR(a?.files,t,n)},[t,n,l,s?.disabled])}}function eQ({folder:e}){return e.isLoading?(0,n.jsx)("div",{className:"x2lah0s x1iyjqo2 x78zum5 x13a6bvl x1iog12x xl010v5 x1kz6jr5",children:(0,n.jsx)(eX.k,{size:"sm"})}):e.isError?(0,n.jsx)("div",{className:"x2lah0s x1iyjqo2 x78zum5 x13a6bvl x1iog12x xl010v5 xhbv7l3",children:(0,n.jsx)(Q.R,{})}):null}function e0({manager:e,folder:t,rootPath:s,handleRename:i,openDeleteConfirmModal:r,featureType:o}){let d=(0,S.l)();a.useEffect(()=>{e.isOpen&&y.az.trackDefinedEvent("figmake.filesystem_open_context_menu",{fileKey:f.zl.get(C.ze)??void 0,targetType:"folder",codeFileGuid:void 0})},[e.isOpen,t]);let x=(s?s+"/":"")+t.path.slice(1),m=(0,c.ci)(x);return(0,n.jsx)(u.bL,{manager:e,children:(0,n.jsxs)(u.mc,{children:[!d&&(0,n.jsx)(ej,{path:x,featureType:o}),!d&&l.v.getFeatureGate("make_create_folder")&&(0,n.jsx)(eC,{path:x}),(0,n.jsx)(ew,{path:t.path.slice(1)}),(0,n.jsx)(eT,{fileOrFolder:t}),!d&&l.v.getFeatureGate("make_create_folder")&&(0,n.jsx)(eA,{handleRename:i,disabled:m}),!d&&l.v.getFeatureGate("make_create_folder")&&(0,n.jsx)(eN,{openConfirmModal:r,disabled:m})]})})}let e1={kE3dHu:"x13e46o5",kZCmMZ:"",kwRFfy:"",$$css:!0},e5={folderItemContainerDragOver:{kWkggS:"xcr9a89",kVAEAm:"x1n2onr6",kgeoSG:"x1cpjm7i",kEoFBp:"x1hmns74",k96MEf:"x1y3wzot",k75S9Q:"x1wlytlt",kLBHJ3:"xb0dqd5",k5Ofw7:"xhq5o37",k5Ohv7:"xpmqpgo",kj4x2v:"x1fo1fc9",kfXFYZ:"x1vzh1im",kPB484:"xb52w3a",km8f2m:"xkk1bqk",kxmVGU:"x12maryy",$$css:!0},folderItemLabelActive:{kMwMTN:"x1akne3o",k63SB2:"x6xwguf","--color-icon":"xtlvio2",kWkggS:"xcr9a89",$$css:!0},folderItemLabel:{kzQI83:"x1iyjqo2",kmuXW:"xs83m0k",kCS8Yb:"x1t1x2f9",k1xSpc:"x78zum5",kGNEyG:"x6s0dn4",kOIVth:"x195vfkc",kaIpWk:"x12oqio5",kWkggS:"xjbqb8w x12tve8b",k7Eaqz:"xeuugli",kZKoxP:"xxk0z11",$$css:!0},folderItemLabelError:{kMwMTN:"x1akne3o",$$css:!0},folderItemLabelDragActive:{kWkggS:"xjbqb8w",$$css:!0},folderItemLabelRenaming:{kWkggS:"xjbqb8w",$$css:!0},folderItemNameInput:{kmVPX3:"x1717udv",kg3NbH:null,kuDDbn:null,kP0aTx:null,k8WAf4:null,kLKAdn:null,kGO01o:null,kE3dHu:"x1uhho1l",kpe85a:"x1xpa7k",kZCmMZ:null,kwRFfy:null,k9WMMc:"xdpxx8g",$$css:!0},disabled:{kMwMTN:"xge78cn",kWkggS:"x1yjdb4r",$$css:!0},folderIconContainer:{k1xSpc:"x78zum5",kGNEyG:"x6s0dn4",kpe85a:"xpf9j6y",$$css:!0},folderIconContainerWithIndent:e=>[e1,{"--x-paddingLeft":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(8+16*e)}],folderIconContainerWithColorIcon:e=>[{"--color-icon":null!=e?"x1g56j85":e,$$css:!0},{"--x---color-icon":null!=e?e:void 0}]};function e2({selectedNode:e,folder:t,indentLevel:s,codeIsStreaming:r,openFolderPaths:o,toggleFolder:x,featureType:m,rootPath:p}){let g=(0,i.wA)(),v=p?`/${p}${t.path}`:t.path,b=o.has(v)&&!t.isLoading,{getContextMenuTriggerProps:j,manager:w}=u.b(),I=(0,M.hk)(),A=(0,M.Yn)(),z=t.isLoading&&t.path.endsWith("/components"),[L]=(0,f.fp)(E.ES),[O]=(0,f.fp)(E.KO),P=null!==L||O,[R,D]=a.useState(!1),F=a.useRef(null),{newlyCreatedFolderPath:q,onNewFolderFocused:G}=ek(),U=p?`${p}/${t.path.replace(/^\//,"")}`:t.path.replace(/^\//,""),K=q===U,H=a.useCallback(()=>{D(!0),G()},[G]),B=a.useCallback(()=>{D(!0),requestAnimationFrame(()=>{F.current?.focus()})},[]),[V,$]=a.useState(!1),W=a.useCallback(()=>{try{y.az.trackDefinedEvent("figmake.filesystem_action",{fileKey:f.zl.get(C.ze)??void 0,action:"delete_folder",targetType:"folder",entryPoint:"context_menu",codeFileGuid:void 0}),function(e){let t=Object.values((0,d.$d)(e,{includeHidden:!0}));0!==t.length&&es.Hq.user("delete-folder",()=>{t.forEach(e=>{et.glU?.deleteCodeFile(e.guid)}),et.glU?.commit()})}(U)}catch(e){y.az.trackDefinedEvent("figmake.filesystem_action_error",{fileKey:f.zl.get(C.ze)??void 0,action:"delete_folder",targetType:"folder"}),g(k.F.enqueue({message:(0,h.t)("figmake.filesystem.folder.delete_error"),error:!0}))}$(!1)},[U,g]),Y=a.useRef(void 0),X=a.useCallback(e=>{P&&!b&&!r&&e.dataTransfer?.items.length>0&&(Y.current&&clearTimeout(Y.current),Y.current=setTimeout(()=>{x(t.path)},250))},[P,b,r,x,t.path]),Z=a.useCallback(e=>{!e.currentTarget.contains(e.relatedTarget)&&Y.current&&clearTimeout(Y.current)},[]);a.useEffect(()=>()=>{Y.current&&clearTimeout(Y.current)},[]);let J=a.useMemo(()=>(0,ev.w_)([...t.children]),[t.children]),Q=(0,S.l)(),en=(0,c.ci)(U),ea=Q||en,{isDragOver:er,handleDragOver:eo,handleDragLeave:ed,handleDrop:eu}=eJ(`folder-${p||"root"}-${t.path}`,U,{disabled:r||Q}),ex=a.useCallback(e=>{Z(e),ed(e)},[Z,ed]);return(0,N.zy)()&&I?.shouldHidePreviewForMakeKitCreation&&!t.isDsImportedLibrary&&!z?null:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x195vfkc xkh2ocl xjbqb8w x12oqio5 xj8oexa xnjsko4",onDragOver:eo,onDragEnter:X,onDragLeave:ex,onDrop:eu,"data-folder-item":!0,children:[(0,n.jsx)("div",{..._.Ay.props(er&&!Q?e5.folderItemContainerDragOver:void 0),children:(0,n.jsxs)("div",{className:"x10w6t97 x78zum5 x6s0dn4 xjbqb8w",children:[(0,n.jsxs)("button",{...j(),"aria-label":(0,h.t)("figmake.filesystem.folder.description",{name:t.name}),"aria-expanded":b,onClick:()=>{if(R)return;let e=(0,N.zy)()&&t.isDsImportedLibrary;(function(e,t,s){let n=(0,N.zy)()?f.zl.get(eZ.ww):null;return!e||n===s||!t})(e,b,v)&&(x(t.path),y.az.trackDefinedEvent("figmake.toggle_folder",{fileKey:f.zl.get(C.ze)??void 0,isOpening:!b})),e&&(f.zl.set(eZ.ww,v),f.zl.set(T.$X,null))},..._.Ay.props(e5.folderItemLabel,r||t.isLoading?e5.disabled:void 0,P?e5.folderItemLabelDragActive:void 0,(0,N.zy)()&&A===v&&!P?e5.folderItemLabelActive:void 0,t.isError?e5.folderItemLabelError:void 0,R?e5.folderItemLabelRenaming:void 0),disabled:r||t.isLoading||t.isError,children:[(0,n.jsxs)("div",{..._.Ay.props(e5.folderIconContainer,e5.folderIconContainerWithIndent(s),e5.folderIconContainerWithColorIcon(r||t.isLoading?ee.Tj.textDisabled:null)),children:[(0,n.jsx)("span",{className:"x2lah0s",children:b?(0,n.jsx)(eH.O,{}):(0,n.jsx)(eB.k,{})}),(0,n.jsx)("span",{className:"x2lah0s",children:b?(0,n.jsx)(eV,{}):(0,n.jsx)(e$,{})})]}),l.v.getFeatureGate("make_create_folder")?(0,n.jsx)(ei.v,{ref:F,autoFocus:K,disabled:r,inputStyle:e5.folderItemNameInput,name:t.name,normalize:el,onBlur:()=>D(!1),onFocus:H,readOnly:ea,testId:"code-folder-name-input",validate:e=>{try{return function(e,t){let s=function(e,t){let s=Object.values((0,d.$d)(e,{includeHidden:!0}));if(0===s.length)return null;let n=e.split("/"),a=n[n.length-1],i=n.slice(0,-1).join("/");if(t===a)return{newFolderName:a,newFolderPath:e};let r=ec(t,i||void 0,e);if(r===a)return{newFolderName:a,newFolderPath:e};let l=i?`${i}/${r}`:r;return es.Hq.user("rename-folder",()=>{s.forEach(t=>{t.codeFilePath&&(t.codeFilePath=function(e,t,s){let n=t+"/";return e.startsWith(n)?s+"/"+e.substring(n.length):e===t?s:e}(t.codeFilePath,e,l))}),et.glU?.commit()}),{newFolderName:r,newFolderPath:l}}(e,t);return s?(f.zl.set(E.wy,t=>(function(e,t,s){let n=`/${t}`,a=`/${s}`,i=new Set;for(let t of e)t===n||t.startsWith(n+"/")?i.add(a+t.slice(n.length)):i.add(t);return i})(t,e,s.newFolderPath)),s.newFolderName):null}(U,e)}catch(e){return y.az.trackDefinedEvent("figmake.filesystem_action_error",{fileKey:f.zl.get(C.ze)??void 0,action:"rename_folder",targetType:"folder"}),g(k.F.enqueue({message:(0,h.t)("figmake.filesystem.folder.rename_error"),error:!0})),null}}}):(0,n.jsx)(eY.G,{text:t.name,"data-testid":"code-folder-name"}),(0,n.jsx)(eQ,{folder:t})]}),(0,n.jsx)(e0,{manager:w,folder:t,rootPath:p,handleRename:B,openDeleteConfirmModal:()=>$(!0),featureType:m})]})}),b?J.map(t=>"file"===t.type?(0,n.jsx)(eK,{selectedNode:e,file:t,indentLevel:s+1,codeIsStreaming:r,featureType:m},t.guid):(0,n.jsx)(e2,{selectedNode:e,folder:t,indentLevel:s+1,codeIsStreaming:r,openFolderPaths:o,toggleFolder:x,featureType:m,rootPath:p},t.name)):null,l.v.getFeatureGate("make_create_folder")&&(0,n.jsx)(eW.R,{open:V,onClose:()=>$(!1),title:(0,h.t)("figmake.filesystem.folder.delete_confirmation_title"),confirmText:(0,h.t)("figmake.filesystem.folder.delete_button"),onConfirm:e=>{e.preventDefault(),W()},destructive:!0,recordingKey:"delete-folder-confirmation",children:Object.values((0,d.$d)(U,{includeHidden:!0})).filter(e=>!e.name?.startsWith(".")).length>0?(0,h.t)("figmake.filesystem.folder.delete_confirmation_message",{folderName:t.name}):(0,h.t)("figmake.filesystem.folder.delete_confirmation_message_empty",{folderName:t.name})})]})}function e3({isDragActive:e,canScrollUp:t,canScrollDown:s,onScrollTriggerEnter:a,onScrollTriggerLeave:i}){return e?(0,n.jsxs)(n.Fragment,{children:[t&&(0,n.jsx)("div",{className:"x10l6tqk xu96u03 x3m8u43 xh8yej3 x1gbc4fu x1y47mkg x13vifvy x67bb7w",onDragEnterCapture:e=>{e.preventDefault(),e.stopPropagation(),a("up",e)},onDragOverCapture:e=>{e.preventDefault(),e.stopPropagation(),a("up",e)},onDragLeaveCapture:e=>{e.preventDefault(),e.stopPropagation(),i()}}),s&&(0,n.jsx)("div",{className:"x10l6tqk xu96u03 x3m8u43 xh8yej3 x1gbc4fu x1y47mkg x1ey2m1c x67bb7w",onDragEnterCapture:e=>{e.preventDefault(),e.stopPropagation(),a("down",e)},onDragOverCapture:e=>{e.preventDefault(),e.stopPropagation(),a("down",e)},onDragLeaveCapture:e=>{e.preventDefault(),e.stopPropagation(),i()}})]}):null}let e4=3;var e6=s(658028);function e7({manager:e,rootPath:t,codeProject:s,featureType:i}){let r=(0,S.l)();return a.useEffect(()=>{e.isOpen&&y.az.trackDefinedEvent("figmake.filesystem_open_context_menu",{fileKey:f.zl.get(C.ze)??void 0,targetType:"root",codeFileGuid:void 0})},[e.isOpen,t]),(0,n.jsx)(u.bL,{manager:e,children:(0,n.jsxs)(u.mc,{children:[!r&&(0,n.jsx)(ej,{path:t,featureType:i}),!r&&l.v.getFeatureGate("make_create_folder")&&(0,n.jsx)(eC,{path:t}),(0,n.jsx)(eT,{fileOrFolder:s})]})})}function e8({selectedCodeFileNode:e,nodeWithChatMessages:t,featureType:s,rootPath:i,onIframeRefresh:x}){let m=(0,M.hk)(),_=(0,M.Yn)(),{getContextMenuTriggerProps:y,manager:k}=u.b(),v=(0,f.md)(T.$X),b=(0,f.md)(T.T_),[C,z]=(0,a.useState)(null),[L,O]=(0,a.useState)(null),P=(0,r.N)(),R=(0,e6.S)(P),D=l.v.getFeatureGate("make_create_folder"),F=a.useMemo(()=>(0,c.Ns)(i,{disableFolderFlattening:D}),[i,R,D]),[q,G]=(0,f.fp)(E.wy),[U]=(0,f.fp)(E.ES),[K]=(0,f.fp)(E.KO),H=null!==U||K,B=a.useCallback(e=>{let t=i?`/${i}${e}`:e;G(e=>{let s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s})},[G,i]),V=a.useCallback(()=>{let e=(0,o.iB)(),t=(0,d._J)(e),s=t?.guid;if(s||(s=F.children.find(e=>"file"===e.type)?.guid),s){let e=(0,p.UN)().get(s);e&&(0,ev.nU)(e)}},[F]),$=(0,j.kK)(),W=a.useCallback(()=>{if(!$)return;let e=$[0];e&&(0,A.el)(e.name,"authoring")},[$]);(0,a.useEffect)(()=>{(0,c.kv)(e)||V(),(0,N.zy)()&&e?.name==="App.tsx"&&b===e?.guid&&m?.shouldHidePreviewForMakeKitCreation&&null===_&&!v&&W()},[e,F,V,W,m,_,v,b]);let Y=a.useMemo(()=>(0,ev.w_)([...F.children]),[F.children]),X=function(e){let{exchange:t}=(0,I.$W)(e?.guid);return Object.values(t?.fileUpdates??{}).length>0}(t),Z=(0,S.l)(),J=`file-tree-${i||"root"}`,Q=(0,a.useRef)(null),{isDragOver:ee,handleDragOver:et,handleDragLeave:es,handleDrop:en}=eJ(J,i,{disabled:X||Z}),{handleScrollTriggerEnter:ea,handleScrollTriggerLeave:ei,canScrollUp:er,canScrollDown:el}=function(e){let t=(0,a.useRef)(null),s=(0,a.useRef)(null),n=(0,a.useRef)(e4),i=(0,a.useRef)(null),[,r]=(0,f.fp)(E.KO),[l,o]=a.useState(!1),[c,d]=a.useState(!1),u=a.useCallback(()=>{if(!e.current)return;let t=e.current,s=t.scrollTop<=1,n=t.scrollTop>=t.scrollHeight-t.clientHeight-1;o(!s),d(!n)},[e]);a.useEffect(()=>{let t=e.current;if(!t)return;u();let s=()=>{u()};return t.addEventListener("scroll",s),()=>t.removeEventListener("scroll",s)},[e,u]);let x=a.useCallback(()=>{t.current&&(cancelAnimationFrame(t.current),t.current=null,s.current=null,r(!1)),i.current&&(clearTimeout(i.current),i.current=null)},[r]),m=a.useCallback((a,i=e4)=>{if(n.current=i,s.current===a&&t.current||(t.current&&(cancelAnimationFrame(t.current),t.current=null),!e.current))return;s.current=a;let l=e.current;if("up"===a&&l.scrollTop<=1||"down"===a&&l.scrollTop>=l.scrollHeight-l.clientHeight-1)return;r(!0);let o=()=>{if(!e.current||!s.current)return;let a=n.current,i="up"===s.current?-a:a,r=e.current.scrollTop+i;if("up"===s.current&&r<=0){e.current.scrollTop=0,x(),u();return}let l=e.current.scrollHeight-e.current.clientHeight;if("down"===s.current&&r>=l){e.current.scrollTop=l,x(),u();return}e.current.scrollTop=r,t.current=requestAnimationFrame(o)};t.current=requestAnimationFrame(o)},[e,r,u,x]),p=a.useCallback((t,s)=>{i.current&&(clearTimeout(i.current),i.current=null);let n=e4;if(s&&e.current){let a=e.current.getBoundingClientRect(),i=s.clientY;n="up"===t?Math.max(1,Math.min(16,Math.round(16-(i-a.top)/50*15))):Math.max(1,Math.min(16,Math.round(16-(a.bottom-i)/50*15)))}m(t,n)},[m,e]),h=a.useCallback(()=>{i.current&&clearTimeout(i.current),i.current=window.setTimeout(()=>{x()},50)},[x]);return(0,a.useEffect)(()=>()=>{x()},[x]),{canScrollUp:l,canScrollDown:c,handleScrollTriggerEnter:p,handleScrollTriggerLeave:h}}(Q),eo=a.useCallback(e=>{z(e),O(null);let t=(0,p.UN)().get(e);if(t?.codeFilePath){let e="/"+t.codeFilePath;q.has(e)||G(t=>new Set([...t,e]))}},[q,G]),ec=a.useCallback(()=>{z(null)},[]),ed=a.useCallback(e=>{O(e),z(null);let t="/"+e.split("/").slice(0,-1).join("/");"/"===t||q.has(t)||G(e=>new Set([...e,t]));let s="/"+e;q.has(s)||G(e=>new Set([...e,s]))},[q,G]),eu=a.useCallback(()=>{O(null)},[]),ex=a.useMemo(()=>({newlyCreatedFileGuid:C,onNewFileCreated:eo,onNewFileFocused:ec,newlyCreatedFolderPath:L,onNewFolderCreated:ed,onNewFolderFocused:eu}),[C,eo,ec,L,ed,eu]),em=a.useMemo(()=>{let e=(0,d.ft)();return(0,g.kc)().make_foundry&&e>=1},[]);return(0,n.jsx)(ey,{value:ex,children:(0,n.jsxs)("div",{className:"x1n2onr6 x5yr21d x1vjfegm x78zum5 xdt5ytf",children:[em&&(0,n.jsx)("div",{className:"x2lah0s",children:(0,n.jsx)(w.r,{titleTx:(0,n.jsx)(n.Fragment,{children:(0,h.t)("figmake.filesystem.file_header_menu.label")}),icon:(0,n.jsx)(e9,{onIframeRefresh:x})})}),(0,n.jsxs)("div",{ref:Q,...{0:{className:"xysyzu8 x6ikm8r x1n2onr6 x1iyjqo2 x12oqio5"},2:{className:"xysyzu8 x6ikm8r x1iyjqo2 x12oqio5 xcr9a89 x1n2onr6 x1cpjm7i x1hmns74 x1y3wzot x1wlytlt xb0dqd5 xhq5o37 xpmqpgo x1fo1fc9 x1vzh1im xb52w3a xkk1bqk x12maryy"},1:{className:"xysyzu8 x6ikm8r x1n2onr6 x1iyjqo2 x12oqio5"},3:{className:"xysyzu8 x6ikm8r x1iyjqo2 x12oqio5 xcr9a89 x1n2onr6 x1cpjm7i x1hmns74 x1y3wzot x1wlytlt xb0dqd5 xhq5o37 xpmqpgo x1fo1fc9 x1vzh1im xb52w3a xkk1bqk x12maryy"}}[!!(ee&&!Z)<<1|!!H<<0],...y(),onDragOver:et,onDragLeave:es,onDrop:en,children:[(0,n.jsx)(e7,{manager:k,rootPath:i,codeProject:F,featureType:s}),(0,n.jsx)("div",{className:"x12ulsxz xdqyycr x78zum5 xdt5ytf xlqzeqv x1qjc9v5 x1nd3289 xrxpjvj",children:Y.map(t=>"file"===t.type?(0,n.jsx)(eK,{selectedNode:e,file:t,indentLevel:0,codeIsStreaming:X,featureType:s},t.guid):(0,n.jsx)(e2,{selectedNode:e,folder:t,indentLevel:0,codeIsStreaming:X,openFolderPaths:q,toggleFolder:B,featureType:s,rootPath:i},t.name))})]}),(0,n.jsx)(e3,{isDragActive:H,canScrollUp:er,canScrollDown:el,onScrollTriggerEnter:ea,onScrollTriggerLeave:ei})]})})}function e9({onIframeRefresh:e}){let{getTriggerProps:t,manager:s}=u.b(),r=(0,i.wA)(),l=a.useCallback(async()=>{try{await v.Ay.foundry.install({autoUpdatePackages:!0},(0,b.Ay)()),await v.Ay.foundry.restart({},(0,b.Ay)()),e?.(),r(k.F.enqueue({message:(0,h.t)("figmake.filesystem.file_header_menu.hard_refresh_complete_toast")}))}catch(e){console.error("Hard refresh error",e),r(k.F.enqueue({message:(0,h.t)("figmake.filesystem.file_header_menu.hard_refresh_error_toast"),error:!0}))}},[r,e]);return(0,n.jsxs)(u.bL,{manager:s,children:[(0,n.jsx)(x.d,{...t(),"aria-label":(0,h.t)("figmake.filesystem.file_header_menu.aria_label"),children:(0,n.jsx)(m.J,{})}),(0,n.jsx)(u.mc,{children:(0,n.jsx)(u.q7,{onClick:l,"data-tooltip":(0,h.t)("figmake.filesystem.file_header_menu.hard_refresh_tooltip"),children:(0,h.t)("figmake.filesystem.file_header_menu.hard_refresh")})})]})}},658028:(e,t,s)=>{s.d(t,{S:()=>a});var n=s(105652);function a(e){let t=(0,n.useCallback)(t=>e.on("change",t),[e]),s=(0,n.useCallback)(()=>e.version,[e]);return(0,n.useSyncExternalStore)(t,s)}},4607:(e,t,s)=>{s.d(t,{A:()=>V});var n=s(239976),a=s(105652),i=s(20002),r=s(39899),l=s(378721),o=s(177102),c=s(288350),d=s(942356),u=s(386882),x=s(513466),m=s(325999),p=s(692376),h=s(854225),g=s(466082),f=s(379141),_=s(270450),y=s(445019),k=s(536378),v=s(852553),b=s(550534),j=s(862390),C=s(223487),w=s(920675),E=s(790016),N=s(935467),S=s(690252),T=s(12908),I=s(222041),A=s(870141),M=s(682499),z=s(495853),L=s(757516),O=s(373703),P=s(768853),R=s(379196),D=s(652219),F=s(610424),q=s(544392);function G(e){return e?e?.canHaveBackingCodeComponent?e?.backingCodeComponent?.exportedFromCodeFile:e?.isCodeFile?e:e?.exportedFromCodeFile:null}function U({onScaleLinearly:e}){let[t]=(0,y.fp)(O.Y_);return(0,n.jsx)(r.f,{variant:"highlighted",checked:!t,onIcon:(0,n.jsx)(u.h,{}),offIcon:(0,n.jsx)(u.h,{}),"aria-label":(0,f.t)("sites.code_component.view_at_100"),htmlAttributes:{"data-tooltip":(0,f.t)("sites.code_component.view_at_100"),"data-tooltip-type":"text"},onChange:()=>e(!t)})}function K({codeSelectionToRender:e,sitesPreview:t}){let s=(0,A.l)();return(0,n.jsx)(F.l,{disabled:s,sitesPreview:t,showTooltipAbove:!1,codeInstanceGuid:e.codeInstanceNodeGuid})}function H(){let e=(0,g.UN)(),t=(0,L.cu)(),s=t[0]?e.get(t[0]):null,{handleHtmlToDesign:a,isProcessing:r,isEnabled:o}=(0,P.mP)(),c=(0,i.wA)(),d=C.q5()?.team??null,u=(0,E.S2)(),m=(0,E.YY)(u).unwrapOr(!1);return(0,n.jsx)(l.K,{"aria-label":(0,f.t)("figmake.m2d.paste_to_canvas_as_design_layers"),htmlAttributes:{"data-tooltip":(0,f.t)("figmake.m2d.paste_to_canvas_as_design_layers"),"data-tooltip-type":"text"},disabled:r||!o,onClick:()=>{if(m){c((0,k.to)({type:I.DV,data:{team:d,resource:N.Bi.MAKE_TO_DESIGN,currentPlan:v.F.Plan.STARTER,upsellPlan:v.F.Plan.PRO,editorType:w._Y.FIGMAKE,entryPoint:b.C.MAKE_TO_DESIGN_PAYWALL}}));return}a({target:"canvas",canvasNodeGuid:s?.guid})},children:(0,n.jsx)(x.X,{})})}function B({codeSelectionToRender:e,children:t}){let[s,i]=(0,y.fp)(M.TJ),r=(0,a.useCallback)(e=>{let t=(0,g.UN)().get(e),s=t?.exportedFromCodeFile;t&&s&&i(e=>({...e,[s.guid]:t.guid}))},[i]),l="instance"===e.type?G((0,g.UN)().get(e.codeInstanceNodeGuid)):G((0,g.UN)().get(e.codeBehaviorNodeGuid)),d=l?.guid??"",u=(0,R.H1)(l??null),x=u[0],m=s[d]??x?.localGuid;return(0,n.jsx)(S.Zk,{style:{paddingBottom:0,borderBottom:"none"},children:(0,n.jsx)(T.Wv,{titleTx:u.length>1?(0,n.jsxs)(o.Root,{value:m,onChange:e=>{e&&r(e)},children:[(0,n.jsx)(o.Trigger,{label:(0,n.jsx)(c.h,{children:(0,f.t)("sites.code_component.preview_legend")})}),(0,n.jsx)(o.Container,{children:u.map(e=>(0,n.jsx)(o.Option,{value:e.localGuid,children:e.name},e.localGuid))})]}):(0,n.jsx)(n.Fragment,{}),children:t})})}function V({codeSelectionToRender:e,onAddToCanvas:t,refresh:s,onScaleLinearly:i,sitesPreview:r}){let o=(0,g.UN)(),c=(0,L.cu)(),u=c[0]?o.get(c[0]):null,x=(0,R.wE)(u),k=(0,y.md)(O.ZY),v=!x||k,b=(0,y.md)(q.s0),[C,w]=(0,y.fp)(O.qQ),E=k&&(x||C),N=(0,a.useCallback)(()=>{u&&(0,z.Py)({node:u})},[u]),S=(0,a.useCallback)(()=>{!x&&C&&(j.tJ([C]),w(null)),p.Ez5?.codeSelection().showMainComponent.set(!1)},[x,C,w]),T=(0,_.kc)().code_layers_zoom_controls&&i,I=r&&"instance"===e.type&&v&&(0,_.kc)().code_layers_click_to_inspect,A="instance"===e.type&&!g.UN().get(e.codeInstanceNodeGuid)?.isLayerLikeCodeNode&&t,M=(0,_.kc)().bake_m2d&&"instance"===e.type,P=e?"instance"===e.type?(0,g.UN)().get(e.codeInstanceNodeGuid):(0,g.UN)().get(e.codeBehaviorNodeGuid):null;return(0,n.jsxs)(B,{codeSelectionToRender:e,children:[E&&b===h.Nfd.FILE&&(0,n.jsx)(d.$n,{variant:"secondary","aria-label":(0,f.t)("fullscreen_actions.return-to-instance"),onClick:S,children:(0,f.t)("fullscreen_actions.return-to-instance")}),!v&&b===h.Nfd.FILE&&(0,n.jsx)(d.$n,{variant:"secondary","aria-label":(0,f.t)("fullscreen_actions.edit-main-component"),onClick:N,children:(0,f.t)("fullscreen_actions.edit-main-component")}),A&&(0,n.jsx)(d.$n,{variant:"secondary","aria-label":(0,f.t)("sites.code_component.add_to_canvas"),onClick:()=>t(P),children:(0,f.t)("sites.code_component.add_to_canvas")}),T&&(0,n.jsx)(U,{onScaleLinearly:i}),I&&(0,n.jsx)(K,{codeSelectionToRender:e,sitesPreview:r}),(0,n.jsx)(D.r,{openText:(0,f.t)("sites.code_component.drawer.open"),hideText:(0,f.t)("sites.code_component.drawer.hide")}),(0,n.jsx)(l.K,{"aria-label":(0,f.t)("sites.code_component.code_view_reload"),htmlAttributes:{"data-tooltip":(0,f.t)("sites.code_component.code_view_reload"),"data-tooltip-type":"text"},onClick:s,children:(0,n.jsx)(m.A,{})}),M&&(0,n.jsx)(H,{})]})}},803267:(e,t,s)=>{s.d(t,{N:()=>o});var n=s(239976),a=s(105652),i=s(693613),r=s(384795);let l="shimmer_text--container--qjQXZ",o=(0,a.memo)(({children:e,duration:t=2,baseColor:s="#a1a1aa",shimmerColor:o=i.Tj.text,spread:c=2,as:d="p",noWrap:u=!0})=>{let x=(0,a.useMemo)(()=>Math.min(e.length*c,100),[e,c]),m=`linear-gradient(
        90deg,
        transparent calc(50% - ${x}px),
        ${o} 50%,
        transparent calc(50% + ${x}px)
      ),
      linear-gradient(${s}, ${s})`,p=u?`${l} shimmer_text--noWrap--mfLhv`:l,h=(0,r.P)(d);return(0,n.jsx)(h,{className:p,style:{backgroundImage:m,width:"fit-content"},initial:{backgroundPosition:"100% center"},animate:{backgroundPosition:"0% center"},transition:{duration:t,repeat:1/0,ease:"linear"},children:e})})},716342:(e,t,s)=>{s.d(t,{y:()=>_});var n={};s.r(n),s.d(n,{baseIconButton:()=>h,highlighted:()=>p,icon:()=>f,input:()=>u,label:()=>x,primary:()=>m,srOnly:()=>d,toggleButton:()=>g});var a=s(239976),i=s(105652),r=s(70968),l=s(288350),o=s(224542),c=s.n(o);let d="toggle_button_32--srOnly--lNg5Q",u="toggle_button_32--input--Xol0M",x="toggle_button_32--label--OBJ40",m="toggle_button_32--primary--vp4Dp",p="toggle_button_32--highlighted--fW0HU",h="toggle_button_32--baseIconButton--641j6",g="toggle_button_32--toggleButton--PjvXW toggle_button_32--baseIconButton--641j6",f="toggle_button_32--icon--EAYdb",_=(0,i.forwardRef)(({onIcon:e,offIcon:t,"aria-label":s,variant:o="primary",htmlAttributes:m,...p},h)=>{let _=(0,i.useId)(),y=p.checked&&!p.mixed?e:t;return(0,a.jsxs)("span",{"data-disabled":!!p.disabled||void 0,className:g,children:[(0,a.jsx)(r.F,{className:c()(u,n[o]),id:_,htmlAttributes:m,...p,"data-tooltip":s,"data-tooltip-type":"text","data-tooltip-shortcut-key":p?.["data-tooltip-shortcut-key"]??m?.["data-tooltip-shortcut-key"],ref:h}),(0,a.jsxs)(l.J,{htmlFor:_,className:x,children:[(0,a.jsx)("span",{className:d,children:s}),(0,a.jsx)("span",{"aria-hidden":!0,className:f,children:y})]})]})});_.displayName="ToggleButton32"},256536:(e,t,s)=>{s.d(t,{F:()=>L});var n=s(239976),a=s(105652),i=s(445019),r=s(323264),l=s(622043),o=s(384795),c=s(585066),d=s(337341),u=s(997729),x=s(696002),m=s(329983),p=s(943360),h=s(378721),g=s(253753),f=s(682864),_=s(3831),y=s(321204),k=s(718801),v=s(379141),b=s(270450),j=s(803267),C=s(726735);function w({text:e,icon:t,onClick:s,title:i}){let r=!!(0,b.kc)().make_jump_to_file_via_chat,l=(0,n.jsx)(j.N,{children:e??""}),o=a.useCallback(e=>{e.stopPropagation(),s?.()},[s]);return(0,n.jsxs)("div",{className:"x78zum5 x1n0bwc9 x193iq5w x1q0g3np x6s0dn4",children:[(0,n.jsx)("div",{className:"x78zum5 x2lah0s",children:t}),s&&r?(0,n.jsx)(p.E,{className:"x78zum5 x1iog12x x12lumcd xb3r6kr xlyipyv xuxw1ft x11g6tue xfn42iu xng3xce x1r7ld26 x1717udv xdpxx8g x1ypdohk x1c5oinq xt0b8zv",onClick:o,title:i,children:l}):(0,n.jsx)("span",{className:"x78zum5 x1iog12x x12lumcd xb3r6kr xlyipyv xuxw1ft",title:i,children:l})]})}var E=s(183290),N=s(55886),S=s(253386),T=s(172397);function I(){return(0,n.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","aria-label":(0,v.t)("figmake.code_chat.live_dot_aria_label"),children:[(0,n.jsx)("path",{d:"M18 12C18 15.3137 15.3137 18 12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12Z",fill:"#14AE5C"}),(0,n.jsx)("path",{d:"M17 12C17 14.7614 14.7614 17 12 17C9.23858 17 7 14.7614 7 12C7 9.23858 9.23858 7 12 7C14.7614 7 17 9.23858 17 12Z",stroke:"white",strokeOpacity:"0.6",strokeWidth:"2"})]})}var A=s(607696);let M={artifactContainer:{k1xSpc:"x78zum5",kVAM5u:"x7z60cl",kaIpWk:"x9h44rk",kMzoRj:"xmkeg23",ksu8eU:"x1y0btm7",k8WAf4:"x1vvogim",kg3NbH:"xaope02",kLWn49:"x1o2sk6j",$$css:!0},inProgress:{kMwMTN:"x1akne3o",$$css:!0}};function z({children:e,isInProgress:t,isCurrentVersion:s,featureType:a}){let{artifactTypographyStyle:i,artifactActiveTypographyStyle:l}=(0,S.L)(a);return(0,n.jsx)("div",{"aria-current":s?"true":void 0,...r.Ay.props(M.artifactContainer,s?l:i,t?M.inProgress:void 0),children:e})}function L(e){let{chatMessagesNodeGuid:t,layerDisplayName:s,type:r,featureType:c}=e,u=(0,N.S)(c),x=(0,i.md)((0,C.l)(t)),{exchange:p}=(0,E.$W)(t),h=(0,m.Oc)(),g="progress"===e.type&&e.showCodeStreaming&&p?function(e){if(!(e&&e.messages.length>0))return;let t=e?.messages[e.messages.length-1];for(let e of t?.toolCalls??[]){let t=(0,A.m4)(e);if(t)return t}let s=t?(0,A.H5)(t,!1):null,n=e.fileUpdates[e.fileUpdates.length-1];return s&&"code"in s&&s.code?s.code:n?n.contents:void 0}(p):void 0,f="progress"===e.type?e.scrollToBottom:null;(0,a.useEffect)(()=>{!u&&g&&f&&f()},[g,f,u]);let _="code_version"===r&&e.isCurrentVersion,y="code_version"===r?e.codeVersionNumber:0,k="code_version"===r?e.versionTitle:void 0,b=a.useMemo(()=>"code_version"!==r?null:h&&k?(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xeuugli x845mor",children:[(0,n.jsx)("h3",{className:"x6xwguf xb3r6kr xlyipyv xuxw1ft","data-testid":`version-title-${y}`,children:k}),(0,n.jsx)("div",{className:"x1yuz8eb","data-testid":`version-number-${y}`,children:(0,v.t)("figmake.chat.artifact.version",{version:y})})]}):_?(0,v.t)("figmake.chat.artifact.latest_version"):(0,v.t)("figmake.chat.artifact.version",{version:y}),[r,_,k,y,h]),j=(0,C.N)(x),w=(0,T.j)(),S=a.useMemo(()=>{if(j)return()=>w(j)},[j,w]);return(0,n.jsx)(z,{isInProgress:"progress"===r,isCurrentVersion:_,featureType:c,children:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xh8yej3",children:["progress"===r?(0,n.jsx)(O,{codeChatArtifact:x,layerDisplayName:s,onClick:S}):(0,n.jsx)(P,{codeChatArtifact:x,isCurrentVersion:_,codeVersionNumber:y,versionTitle:k,versionText:b,restoreVersion:e.restoreVersion}),(0,n.jsx)(l.N,{children:!!g&&(0,n.jsxs)(o.P.div,{initial:{height:0,opacity:0},animate:{height:128,opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"x78zum5 x1n2onr6 x47corl xdt5ytf x1cy8zhl xh8yej3 xb3r6kr",children:[(0,n.jsx)(o.P.div,{className:"x10l6tqk x13vifvy xu96u03 x3m8u43 x1vqgdyp x1vjfegm x1b0inr7"}),(0,n.jsx)(d.Or,{code:g,fileName:s??"",fullHeight:!0,maxHeight:"128px",onlyShowCode:!0})]})})]})})}function O({codeChatArtifact:e,layerDisplayName:t,onClick:s}){let a=(0,C.N)(e),i=function(e,t,s,a){if(!e)return(0,n.jsx)("div",{className:"x78zum5 x1q0g3np x1n0bwc9 x193iq5w x6s0dn4",children:(0,n.jsx)(j.N,{children:(0,v.t)("figmake.chat.working")})});switch(e.type){case"toolCall":return(0,n.jsx)(w,{icon:function(e){switch(e){case"view_tool":return(0,n.jsx)(_.T,{});case"delete_tool":return(0,n.jsx)(f.i,{});case"file_search":return(0,n.jsx)(y.W,{});default:return null}}(e.toolName),text:function(e){let t=(0,C.N)(e);switch(e.toolName){case"view_tool":if(t)return(0,v.t)("figmake.tool_call.viewing",{file:t});break;case"write_tool":case"fast_apply_tool":case"edit_tool":case"insert_tool":if(t)return(0,v.t)("figmake.tool_call.writing",{file:t});break;case"think":break;case"delete_tool":if(t)return(0,v.t)("figmake.tool_call.deleting",{file:t});break;case"file_search":return(0,v.t)("figmake.tool_call.searching")}return(0,v.t)("figmake.chat.working")}(e),onClick:s,title:a});case"code":return(0,n.jsx)(w,{icon:(0,n.jsx)(g.L,{}),text:(0,v.t)("figmake.tool_call.writing",{file:t??e.fullFilePath}),onClick:s,title:a});case"editedFiles":return(0,n.jsx)(w,{icon:(0,n.jsx)(g.L,{}),text:(0,v.t)("figmake.tool_call.editing",{file:e.files.join(", ")}),onClick:s,title:a});case"deletedFiles":return(0,n.jsx)(w,{icon:(0,n.jsx)(f.i,{}),text:(0,v.t)("figmake.tool_call.deleting",{file:e.files.join(", ")}),onClick:s,title:a});default:return(0,n.jsx)("div",{className:"x78zum5 x1q0g3np x1n0bwc9 x193iq5w x6s0dn4",children:(0,n.jsx)(j.N,{children:(0,v.t)("figmake.chat.working")})})}}(e,t,s,a??void 0);return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1qughib xh8yej3",children:[(0,n.jsx)("div",{className:"x78zum5 x845mor xb3r6kr xlyipyv xuxw1ft xeuugli",children:i}),(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xet2fuk x2lah0s",children:(0,n.jsx)(c.k,{})})]})}function P({isCurrentVersion:e,codeVersionNumber:t,versionTitle:s,versionText:a,restoreVersion:i}){let r=i?(0,n.jsx)(h.K,{"aria-label":(0,v.t)("figmake.chat.artifact.restore"),"aria-description":(0,v.t)("figmake.chat.artifact.aria_restore_description",{version:t,title:s??""}),onClick:i,recordingKey:`figmake.version_history.restore_button.${t}`,children:(0,n.jsx)(k.H,{})}):null,l=(0,x.g7)()?(0,n.jsx)(u.iE,{asLargeVariant:!0,openInSameTab:!0}):(0,n.jsx)(I,{});return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1qughib xh8yej3",children:[(0,n.jsx)("div",{className:"x78zum5 x845mor xb3r6kr xlyipyv xuxw1ft xeuugli",children:a}),(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xet2fuk x2lah0s",children:e?l:r})]})}},87195:(e,t,s)=>{s.d(t,{f:()=>y});var n=s(239976),a=s(105652),i=s(330289),r=s(816748),l=s(379141),o=s(445019),c=s(323264),d=s(522568),u=s(687934),x=s(811804),m=s(223487),p=s(183290),h=s(160849),g=s(601493);let f={illustration:{kzqmXN:"xvni27",kZKoxP:"xdd8jsf",kaIpWk:"x9h44rk",kC7eKd:"x16v0e3u",k1xSpc:"x78zum5",kjj79g:"xl56j7k",kGNEyG:"x6s0dn4",$$css:!0},illustrationLightMode:{kGVxlE:"xgk9eko",$$css:!0},illustrationFrame:{kVAEAm:"x10l6tqk",k87sOh:"xys9btg",kbCHJM:"xu96u03",kLqNvP:null,kt4wiu:null,k3aq6I:"xetamn0",$$css:!0},illustrationDesign:{kVAEAm:"x10l6tqk",k87sOh:"x13vifvy",kbCHJM:"xn08lp5",kLqNvP:null,kt4wiu:null,k3aq6I:"xdzgsf4",$$css:!0}};function _({customStyle:e,children:t}){let s=(0,x.DP)();return(0,n.jsx)("div",{...c.Ay.props(f.illustration,"light"===s&&f.illustrationLightMode,e),children:(0,n.jsx)("div",{className:"x1useyqa xsdox4t x1ctf4ec x1sjmt1f x78zum5 xl56j7k x6s0dn4",children:t})})}function y({onClose:e,chatMessagesNodeGuid:t,label:s}){let c=(0,m.q5)(),x=a.useRef(!1),y=(0,o.Xr)(p.Ki),[k,v]=(0,o.fp)(p.Be),[b,j]=(0,a.useState)(!1),{attachments:C}=(0,h._9)(t);return a.useEffect(()=>{k&&(v(!1),x.current&&(d.az.trackDefinedEvent("figmake.attach_design_attachment_added",{fileKey:c?.key,type:"paste"}),e())),x.current=!0},[e,k,v,c?.key]),(0,n.jsx)(u.Y,{isDragTarget:()=>C.length<h.qQ,onTargetDragEnter:()=>j(!0),onTargetDragLeave:()=>j(!1),onTargetDrop:t=>{let s=(0,g.C)(t.files,C);if(!s.valid){j(!1);return}s.imageFiles.length>0&&y(s.imageFiles),d.az.trackDefinedEvent("figmake.attach_design_attachment_added",{fileKey:c?.key,type:"drag_and_drop"}),j(!1),e()},className:"x5yr21d",children:(0,n.jsxs)("div",{...{0:{className:"x7hzu26 x1ef8nbk x19y5rnk xmkeg23 xbsl7fq x83n4p2 x7z60cl xl0cjzi x5yr21d x1mu97ne xgqtt45 x193iq5w x78zum5 xl56j7k x6s0dn4 xdt5ytf"},1:{className:"x7hzu26 x1ef8nbk x19y5rnk xmkeg23 x5yr21d x1mu97ne xgqtt45 x193iq5w x78zum5 xl56j7k x6s0dn4 xdt5ytf x1y0btm7 x1va2ikv"}}[!!b<<0],tabIndex:-1,children:[(0,n.jsxs)("div",{className:"x13oubkp xr931m4 x1n2onr6 x12sbs06",children:[(0,n.jsx)(_,{customStyle:f.illustrationFrame,children:(0,n.jsx)(i.W,{style:{"--color-icon":"var(--color-icon-brand)",height:"32px",width:"32px"}})}),(0,n.jsx)(_,{customStyle:f.illustrationDesign,children:(0,n.jsx)(r.L,{style:{"--color-icon":"var(--color-icon-brand)",height:"32px",width:"32px"}})})]}),(0,n.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9 xumn273 x2b8uid",children:s||(0,l.tx)("figmake.attachments.attach_design_modal_body")})]})})}},399488:(e,t,s)=>{s.d(t,{r:()=>oz});var n=s(239976),a=s(105652),i=s(607696),r=s(919278),l=s(146119),o=s(846779),c=s(787049),d=s(295870),u=s(378721),x=s(446862),m=s(718801),p=s(394738),h=s(370545),g=s(854225),f=s(798913),_=s(379141),y=s(445019),k=s(323264),v=s(622043),b=s(384795),j=s(522568),C=s(844268),w=s(129416),E=s(577225),N=s(17147),S=s(687934),T=s(652154),I=s(384203),A=s(223487),M=s(207436),z=s(415315),L=s(717805),O=s(788995),P=s(824851),R=s(826722),D=s(682499),F=s(183290),q=s(55886),G=s(203250),U=s(373703),K=s(764972),H=s(839970),B=s(953286),V=s(125578),$=s(484131),W=s(77143),Y=s(823865),X=s(991007),Z=s(736213),J=s(591408),Q=s(610424),ee=s(39899),et=s(727029),es=s(716342),en=s(629648);function ea({disabled:e,sitesPreview:t,asLargeVariant:s,onboardingKey:i,showTooltipAbove:r}){let{isCommentModeActive:l,disableComments:o}=(0,en.jy)(),{mode:c}=(0,Z.lA)(),d=a.useCallback((e,s)=>{e&&l&&o(),t.pointAndEditControl({type:"mode",mode:e?"editor":"inactive"}),s.event.currentTarget?.blur(),t.iframe?.focus()},[t,l,o]),u=s?es.y:ee.f,x=(0,n.jsx)(et.Z,{});return(0,n.jsx)(u,{"aria-label":(0,_.t)("figmake.chat.click_to_inspect.label"),checked:"editor"===c,disabled:e,htmlAttributes:{"data-onboarding-key":i,"data-tooltip-show-above":r||void 0,"data-tooltip-show-below":!r||void 0},offIcon:x,onChange:d,onIcon:x,variant:"highlighted"})}var ei=s(470056),er=s(696002),el=s(329983),eo=s(20002),ec=s(524326),ed=s(254056),eu=s(827466),ex=s(536493),em=s(249563),ep=s(942356),eh=s(943360),eg=s(771234),ef=s(731643),e_=s(939514);let ey=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"m16.7 5.699.315-1.26c.126-.505.844-.505.97 0L18.3 5.7l1.26.315c.505.126.505.844 0 .97L18.3 7.3l-.315 1.26c-.126.505-.844.505-.97 0L16.7 7.3l-1.26-.315c-.505-.126-.505-.844 0-.97zM13 6a.5.5 0 0 1 0 1H7.5a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V11a.5.5 0 0 1 1 0v5.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 6 16.5v-9A1.5 1.5 0 0 1 7.5 6zm-2.146 4.146a.5.5 0 0 1 0 .708L9.707 12l1.147 1.146a.5.5 0 0 1-.708.708l-1.5-1.5a.5.5 0 0 1 0-.708l1.5-1.5a.5.5 0 0 1 .708 0m2.292.708a.5.5 0 0 1 .708-.708l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708-.708L14.293 12z",clipRule:"evenodd"})})});var ek=s(441498),ev=s(35940),eb=s(693613),ej=s(692376),eC=s(270450),ew=s(846666),eE=s(100029),eN=s(141288),eS=s(723850),eT=s(309742),eI=s(943866),eA=s(393463),eM=s(75962),ez=s(842582),eL=s(714778),eO=s(585066),eP=s(375296),eR=s(732730),eD=s(136393),eF=s(338630),eq=s(720410),eG=s(841301),eU=s(935020),eK=s(748181),eH=s(394396),eB=s(920675),eV=s(790016),e$=s(947467),eW=s(13939),eY=s(558604),eX=s(236410),eZ=s(581121),eJ=s(892691),eQ=s(660259),e0=s(881562),e1=s(754158),e5=s(723401),e2=s(379196),e3=s(771160),e4=s(671661),e6=s(395823),e7=s(497503),e8=s(453720),e9=s(363337),te=s(270166);let tt={chatBoxMessageRow:{kaIpWk:"x9h44rk",k1K539:"x38tqe7",kLKAdn:"x1y1aw1k",kg3NbH:"xdqyycr",kGO01o:"x1s51fez",kVAEAm:"x1n2onr6",kY2c9j:"x8knxv4",$$css:!0},chatBoxMessageRowPrimary:{kWkggS:"xu5wzci",kMwMTN:"x1tk3asg",k63SB2:"x1s688f",$$css:!0},chatBoxMessageRowError:{kWkggS:"x3yuajn",kMwMTN:"x172n1ly",$$css:!0},chatBoxMessageRowWarning:{kWkggS:"x1mt81i5",kMwMTN:"x12fzf0q",$$css:!0},chatBoxMessageRowCommunity:{kWkggS:"x1v8gsql",kMwMTN:"x1akne3o",$$css:!0},chatBoxMessageRowInfo:{kWkggS:"x1yjdb4r",kMzoRj:"xmkeg23",ksu8eU:"x1y0btm7",kVAM5u:"x7z60cl",kMwMTN:"x1akne3o",$$css:!0},chatBoxMessageRowWithClose:{kpe85a:"x1m2p0i2",$$css:!0}};function ts({children:e,secondaryContent:t,variant:s,onClose:a}){return(0,n.jsxs)("div",{...k.Ay.props(tt.chatBoxMessageRow,"primary"===s&&tt.chatBoxMessageRowPrimary,"error"===s&&tt.chatBoxMessageRowError,"warning"===s&&tt.chatBoxMessageRowWarning,"community"===s&&tt.chatBoxMessageRowCommunity,"info"===s&&tt.chatBoxMessageRowInfo,a&&tt.chatBoxMessageRowWithClose),children:[(0,n.jsxs)("div",{className:"x6s0dn4 x78zum5 x1q0g3np x1qughib",children:[e,a&&(0,n.jsx)("div",{className:"x10l6tqk xclnmbr",children:(0,n.jsx)(u.K,{onClick:a,"aria-label":(0,_.t)("living_designs.chat.errors.close"),children:(0,n.jsx)(te.A,{})})})]}),t]})}var tn=s(585109),ta=s(997129),ti=s(844552);function tr(){let e=(0,ta.RK)(),t=e?.name??"",{isConnectedNonOwner:s}=(0,ta.zA)(),[i,r]=a.useState(!1),{getTriggerProps:l,getContainerProps:o,getArrowProps:c}=e7.fP({isOpen:i,onOpenChange:r,type:"dialog",openOnHover:!0,placement:"top"}),d=(0,y.Xr)(eQ.Xl),u=(0,y.md)(eQ.Xl),x=(0,y.md)(eQ.GV),m=(0,ti.A)();return((0,eT.h)(()=>{x&&m({showVisualBells:!1})}),x||!u)?null:(0,n.jsx)(ts,{variant:"warning",onClose:()=>d(!1),children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 xh8yej3","data-testid":"supabase-deploy-nudge",children:[(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x167g77z xkh2ocl x6s0dn4",children:[(0,n.jsx)("div",{className:"x1gxdvn5",children:(0,n.jsx)(e8.n,{})}),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf",children:[(0,n.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:(0,_.t)("figmake.deploy_nudge.init.title")}),(0,n.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up",children:(0,_.t)("figmake.deploy_nudge.init.subtitle")})]})]}),(0,n.jsxs)(e7.mc,{...o({style:{boxShadow:"var(--elevation-500-modal-window)",borderRadius:"var(--radius-large, 0.8125rem)",padding:"4px",background:"var(--color-bg)",width:"240px"}}),children:[(0,n.jsx)(e7.i3,{...c()}),(0,n.jsx)("div",{className:"x78zum5 xkh2ocl xz9dl7a xsag5q8 xnm25rq",children:(0,n.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:(0,_.t)("figmake.deploy_nudge.popover.title")})}),(0,n.jsx)("div",{className:"x178xt8z x13fuv20 x16ufvko xh8yej3"}),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xkh2ocl x1n565qt x15gqxvk x1l90r2v xpymby5 x1v2ro7d x1cy8zhl",children:[(0,n.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up",children:(0,_.t)("figmake.deploy_nudge.popover.subtitle")}),(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x167g77z",children:[(0,n.jsx)(tn.ls,{size:e9.Pf.LARGE}),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1nhvcw1",children:[(0,n.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:t}),(0,n.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,_.t)("figmake.deploy_nudge.popover.user_avatar.subtitle")})]}),(0,n.jsx)("div",{})]})]})]}),(0,n.jsx)(ep.$n,{variant:"secondary",disabled:s,onClick:()=>m({showVisualBells:!0}),...s?l({onClick:()=>m({showVisualBells:!0})}):{},children:(0,_.t)("figmake.settings.connected_project.deploy_button")})]})})}var tl=s(924278),to=s(617391),tc=s(200498),td=s(807461),tu=s(382367),tx=s(632381),tm=s(580664),tp=s(473295),th=s(362744),tg=s(418379),tf=s(644404),t_=s(444038),ty=s(969365),tk=s(2227),tv=s(763147),tb=s(737169),tj=s(536411),tC=s(113139),tw=s(218665),tE=s(490438),tN=s(275088),tS=s(163226),tT=s(809598);let tI=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24L",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M5 5h9v4h-4a1 1 0 0 0-1 1v4H5zm4 10H5a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v4h4a1 1 0 0 1 1 1v9a1 1 0 0 1-1 1h-9a1 1 0 0 1-1-1zm6-5h4v9h-9v-4h4a1 1 0 0 0 1-1zm-1 0v4h-4v-4z",clipRule:"evenodd"})})});function tA(e){switch(e){case"FRAME":default:return tv.v;case"GROUP":return tb.h;case"RECTANGLE":case"ROUNDED_RECTANGLE":return tj.n;case"TEXT":return tp.B;case"SYMBOL":case"INSTANCE":return tC.D;case"VECTOR":return tw.b;case"LINE":return tE.W;case"ELLIPSE":return tN.m;case"REGULAR_POLYGON":return tS.V;case"STAR":return tT.F;case"BOOLEAN_OPERATION":return tI;case"SECTION":return ty.P}}var tM=s(341153),tz=s(862390),tL=s(1007);let tO={elementAttachment:{k1xSpc:"x78zum5",kXwgrk:"x1q0g3np",kjj79g:"x1qughib",kGNEyG:"x6s0dn4",koQZXg:"xq1n1xh",keoZOQ:"x14vqqas",kOIVth:"x1jnr06f",kaIpWk:"x12oqio5",kzqmXN:"xeq5yr9",ks0D6T:"x16q51m2",$$css:!0},elementPrompt:{kWkggS:"x1v8gsql",kMzoRj:"xmkeg23",ksu8eU:"x1y0btm7",kVAM5u:"x7z60cl",kMwMTN:"x1akne3o",$$css:!0},elementChat:{kogj98:"x1ghz6dp",koQZXg:null,keoZOQ:null,kpe85a:"xy13l1i",kWkggS:"xcr9a89",kMwMTN:"x1quhyk7",$$css:!0},elementPromptWithoutRemove:{kpe85a:"xy13l1i",$$css:!0}};function tP({icon:e,label:t,variant:s="prompt",onRemove:a,onMouseEnter:i,onMouseLeave:r,onClick:l}){return(0,n.jsxs)("div",{...k.Ay.props(tO.elementAttachment,"prompt"===s?[tO.elementPrompt,!a&&tO.elementPromptWithoutRemove]:tO.elementChat),onMouseEnter:i,onMouseLeave:r,children:[(0,n.jsxs)(eh.E,{onClick:l,children:[(0,n.jsx)("div",{children:e}),(0,n.jsx)("div",{className:"xb3r6kr xlyipyv xuxw1ft xazcve0",children:t})]}),"prompt"===s&&a?(0,n.jsx)(u.K,{"aria-label":(0,_.t)("figmake.chat.click_to_inspect.remove"),onClick:a,children:(0,n.jsx)(tu.f,{className:"xmauxvm"})}):null]})}function tR({tagName:e,variant:t="prompt",iconType:s,onRemove:a}){let i="component"===s?tx.P:"library"===s?tm.e:tD(e,s);return(0,n.jsx)(tP,{icon:(0,n.jsx)(i,{...{0:{className:"x1aue78i"},1:{className:"xmauxvm"}}[!("prompt"!==t)<<0]}),label:e,variant:t,onRemove:a})}let tD=(e,t)=>"library"===t?tm.e:"component"===t?tx.P:tF(e),tF=e=>{switch(e.toLocaleLowerCase()){case"p":case"span":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":case"label":case"strong":case"em":case"b":case"i":return tp.B;case"a":return th.W;case"img":case"video":return tg.T;case"li":case"ul":return tf.Z;case"ol":return t_.p;default:return ty.P}};function tq({nodes:e,variant:t="prompt",iconType:s,onRemove:i}){let r=(0,tM.Z)("chat_box_attachment_navigate"),l=e.length>0&&!!e[0],o=(0,a.useCallback)(()=>{l&&(0,tz.Uc)(e[0].guid)},[e,l]),c=(0,a.useCallback)(()=>{(0,tz.Uc)(tk.AD)},[]),d=(0,a.useCallback)(()=>{l&&r((0,tL.QZ)({nodeId:e[0].guid,alwaysPan:!1}))},[e,r,l]);if(!l)return null;let u=e[0],x="component"===s?tx.P:tA(u.type),m=e.length>1?(0,_.t)("ai_assistant.selected_layers_count",{count:e.length}):u.name;return(0,n.jsx)(tP,{icon:(0,n.jsx)(x,{...{0:{className:"x1aue78i"},1:{className:"xmauxvm"}}[!("prompt"!==t)<<0]}),label:m,variant:t,onRemove:i,onMouseEnter:o,onMouseLeave:c,onClick:d})}function tG({selectedJsxSource:e,variant:t="prompt",onRemove:s,sitesPreview:i}){let r=(0,a.useCallback)(()=>{i?.pointAndEditControl({type:"scrollSelectedIntoView"})},[i]);return(0,n.jsx)(tP,{icon:(0,n.jsx)(tx.P,{className:"xmauxvm"}),label:"element"===e.type&&e.name||"",variant:t,onRemove:s,onClick:r})}var tU=s(363638),tK=s(446724),tH=s(640753),tB=s(840864),tV=s(518798);(0,tH.Wh)(e=>(0,y.eU)({todos:[],addTodosToolCallId:void 0,lastUpdatedTodoIdx:void 0}),{preserveValue:!0}),(0,tH.Wh)(e=>(0,y.eU)([]),{preserveValue:!0});let t$=(0,tB.H)(!1),tW=(0,y.eU)(new Set),tY=(0,y.eU)(null,(e,t,s)=>{t(t$(s),!0),t(tW,e=>new Set([...e,s]))}),tX=(0,y.eU)(null,(e,t,s)=>{t(t$(s),!1),t(tW,e=>{let t=new Set(e);return t.delete(s),t})});var tZ=s(467102),tJ=s(182299),tQ=s(160849),t0=s(973407),t1=s(925546),t5=s(610265),t2=s(578939),t3=s(447995);let t4="dismissed_chat_soft_limit_banner";var t6=s(938832),t7=s(76075),t8=s(335213),t9=s(235591),se=s(629332),st=s(522314),ss=s(864693),sn=s(431757),sa=s(910970),si=s(474917),sr=s(328452),sl=s(515283),so=s(402791),sc=s(222060),sd=s(211464);function su(){let e=(0,so.Y9)((0,_.t)("auth.welcome-to-figma")),t=(0,eo.wA)();return(0,n.jsx)(eF.fu,{name:"Logged Out File Chatbox Banner",children:(0,n.jsxs)("div",{className:"x9f619 x78zum5 x1y1aw1k xnuq7ks x18d9i69 xnm25rq x9a3u73 x1cy8zhl x1mxnbhz x131gfan x1mgsydn x167g77z",children:[(0,n.jsx)("div",{className:"x1tk3asg x1g2dr8m xiqqdae x1j61x8r xkezfkh x14kxzw3 xqp8s7e x78zum5 x6s0dn4 xxk0z11 x1iyjqo2 xeuugli",children:(0,n.jsx)("span",{className:"xb3r6kr xuxw1ft xlyipyv",children:(0,_.t)("auth.sign_up_to_use_figma_rev")})}),(0,n.jsxs)("div",{className:"xeq5yr9 x78zum5 x13a6bvl x167g77z x3psx0u",children:[(0,n.jsx)(eh.E,{onClick:()=>{(0,sr.UK)("SIGN_UP_BUTTON_BANNER"),e({origin:ss.ty.FIGMA_REV_LOGGED_OUT_FOOTER,formState:sa.qB.SIGN_UP})},className:"xxk0z11 x16v0e3u xf67zum x19y5rnk x1akne3o x2b8uid xeq5yr9 xclx6tv xiqqdae x1j61x8r xkezfkh x14kxzw3 xqp8s7e x2lah0s",children:(0,_.t)("auth.sign_up")}),(0,n.jsx)(sl.M,{onClick:()=>{(0,sr.UK)("GOOGLE_SSO_BUTTON"),(0,ss.Rm)({dispatch:t,origin:ss.ty.FIGMA_REV_LOGGED_OUT_FOOTER_WITH_GOOGLE,redirectUrl:eN.Ay.location.pathname}).then(e=>{"login"===e.type&&t(sn.My({userId:e.user.id}))},e=>{(0,si.g)("google_signup_error",ss.ty.FIGMA_REV_LOGGED_OUT_FOOTER_WITH_GOOGLE,{error:e.message}),(0,sd.z)("ff_show_auth_modal_on_google_sso_error")&&(0,ss.Y2)({dispatch:t,origin:ss.ty.FIGMA_REV_LOGGED_OUT_FOOTER_WITH_GOOGLE,message:e.message,redirectUrl:eN.Ay.location.pathname,errorType:e.errorType})})}})]}),(0,n.jsx)(sc.P,{origin:ss.DT.LOGGED_OUT_FILE,overrideUseFedCMPrompt:!1})]})})}var sx=s(187278),sm=s(961998);let sp={RIGHT:8,LEFT:4,GAP:2},sh={kgeoSG:"x1cpjm7i",kEoFBp:"x1hmns74",k96MEf:"x1y3wzot",k75S9Q:"x1wlytlt",kLBHJ3:"x19phtbt",kSJ0CW:"",koaPKo:"",kgzTxl:"xxt7thn",kB0Uj5:"x1i4no3d",kGFycz:"",k2irxo:"",kLkRvE:"",k3DiCg:"",khXQ3S:"",kuPSpR:"",kGZpU5:"",kDwdTO:"",kTP8oX:"",k836YN:"",km8f2m:"xkk1bqk",kxmVGU:"x12maryy",k5JduY:"x1s928wv",kwXMNM:"x1j6awrg",k8Iv0R:"x1xrz1ek",kH8cDV:"x17cx49",kLxBhq:"x13aubvv",kc1e00:"",kH8aOt:"",k4zj60:"xua7q2g",kiGxCN:"xhh15h2",kg3FMZ:"",kM2ZXO:"",ks3ayO:"",kNctxI:"",kJM1pu:"",kgUb28:"",k1b5ph:"",kVcwut:"",kIWj2l:"",kakxe6:"",kloYau:"x2q1x1w",kDVEDD:"xitxdhh",$$css:!0},sg={chatboxTextareaWrapper:{kVAEAm:"x1n2onr6",k1xSpc:"x78zum5",kzQI83:"x1iyjqo2",kmuXW:"xs83m0k",$$css:!0},chatboxTextareaWrapperFade:e=>[sh,{"--x-63pznm":`linear-gradient(to bottom, ${e}, transparent)`,"--x-4ad71l":`linear-gradient(to top, ${e}, transparent)`}],sendButton:{kaIpWk:"x1xwekrv",kZKoxP:"xlrawln",kmVPX3:"x10db7i2",kE3dHu:null,kpe85a:null,kLKAdn:null,kGO01o:null,kjj79g:"xlqzeqv",kGNEyG:"x6s0dn4",k1xSpc:"x78zum5",kmuXW:"x2lah0s",$$css:!0},sendButtonEnabled:{kWkggS:"xu5wzci",$$css:!0},sendButtonDisabled:{kWkggS:"xgbcquw",$$css:!0},stopButton:{k1xSpc:"x78zum5",kZKoxP:"xlrawln",kLKAdn:"xexx8yu",kpe85a:"xy13l1i",kGO01o:"x18d9i69",kE3dHu:"x6wrskw",kGNEyG:"x6s0dn4",kC7eKd:"xsqpjig",kaIpWk:"x1xwekrv",kOIVth:"x195vfkc",$$css:!0},stopButtonIconOnly:{kaIpWk:"x1xwekrv",kZKoxP:"xlrawln",kmVPX3:"x10db7i2",kE3dHu:null,kpe85a:null,kLKAdn:null,kGO01o:null,kGNEyG:"x6s0dn4",k1xSpc:"x78zum5",kC7eKd:"xsqpjig",$$css:!0}};function sf({children:e}){return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x2lah0s xr9ek0c x1o6q14k x1yztbdb xq1n1xh x7wzq59 x1ey2m1c","data-onboarding-key":X.HB,children:e})}function s_(){return(0,n.jsx)(ed.N,{href:"https://creativecommons.org/licenses/by/4.0/",newTab:!0,children:(0,_.tx)("design_systems.preset_libraries.tooltip.figma_license_link")})}function sy({communityAttributions:e,onClose:t}){if(e.length<=0||e.length>3)return null;let s=e.map(e=>(0,n.jsx)(eL.Ph,{newTab:!0,href:(0,eH.X$)(e.hubFileId),trusted:!0,children:(0,N.EJ)(e.hubFileName,30)},e.hubFileId));return(0,n.jsx)(ts,{variant:"community",onClose:t,children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x17d4w8g",children:[(0,n.jsx)("div",{className:"x2lah0s",children:(0,n.jsx)(eg.o,{})}),(0,n.jsx)("div",{children:1===e.length?(0,_.tx)("figmake.chat.community_attribution.attributions_one",{hubFileLink:s[0],creatorName:e[0].creatorName,licenseLink:(0,n.jsx)(s_,{})}):2===e.length?(0,_.tx)("figmake.chat.community_attribution.attributions_two",{hubFileLink1:s[0],hubFileLink2:s[1],licenseLink:(0,n.jsx)(s_,{})}):(0,_.tx)("figmake.chat.community_attribution.attributions_three",{hubFileLink1:s[0],hubFileLink2:s[1],hubFileLink3:s[2],licenseLink:(0,n.jsx)(s_,{})})})]})})}let sk=(0,eF.tf)(eu.$);function sv({licenseType:e,onClose:t}){let s=(0,eV.No)(),a=s.unwrapOr(null)?.tier,{getProvisionalAccessBanner:i,getPendingRequest:r}=(0,e$.wH)(),{text:l,shouldShowCurf:o}=i(e),{curfCtaHandler:c,curfCtaLabel:d}=(0,e$.mT)(e),u=l;return o||r(e)?.entryPoint!==eR.tc.CODE_CHAT_LIMIT||(u=(0,_.t)("fullscreen.toolbar_banner.provisional_access.code_chat")),(0,n.jsx)(eF.fu,{name:"ChatBoxProvisionalAccessBanner",properties:{tier:a},children:(0,n.jsx)("div",{className:"xyorhqc xj0a0fe","data-testid":"provisional-access-banner",children:(0,n.jsxs)(ex.Yy,{variant:"brand",icon:null,onDismiss:t,children:[(0,n.jsx)(em.Q,{children:u}),o&&(0,n.jsx)(sk,{onClick:c,children:d})]})})})}function sb({onClose:e,children:t}){let s=(0,eV.No)(),a=s.unwrapOr(null)?.tier;return(0,n.jsx)(eF.fu,{name:"ChatBoxSoftLimitBanner",properties:{tier:a},children:(0,n.jsx)("div",{className:"xyorhqc xj0a0fe","data-testid":"chat-soft-limit-banner",children:(0,n.jsx)(ex.Yy,{variant:"brand",icon:null,onDismiss:e,children:(0,n.jsx)(em.Q,{children:t})})})})}function sj({onClose:e}){let t=(0,eW.eP)({forAiMetering:!0}),s=(0,eW.nJ)({forAiMetering:!0}),[a]=(0,eE.OR)(),i=a.data?.monthly_summary;if(!t.data||!s.data||!i||(0,eY.aV)()&&!i.bypass_metering)return null;let{name:r,activeTrialLicenseTypes:l}=s.data,o=l?.includes(eB.G_.FIGMAKE);return(0,n.jsx)(sb,{onClose:e,children:o?(0,_.tx)("ai_credits_meter.soft_limit_in_plan",{planName:r,numTotalMonthlyCredits:i.total.toLocaleString(),learnMoreLink:(0,n.jsx)(eL.Ph,{newTab:!0,trusted:!0,href:eZ._t,children:(0,_.tx)("general.learn_more")})}):(0,_.tx)("ai_credits_meter.soft_limit_for_seat_type_in_plan",{seatType:(0,eP.JT)(t.data),planName:r,numTotalMonthlyCredits:i.total.toLocaleString(),learnMoreLink:(0,n.jsx)(eL.Ph,{newTab:!0,trusted:!0,href:eZ._t,children:(0,_.tx)("general.learn_more")})})})}function sC({onClose:e}){return(0,eY.T3)()?(0,n.jsx)(sj,{onClose:e}):(0,n.jsx)(sb,{onClose:e,children:(0,_.tx)("figmake.meter_limit.reached_future_credit_limit",{learnMoreLink:(0,n.jsx)(eL.Ph,{newTab:!0,trusted:!0,href:eZ._t,children:(0,_.tx)("general.learn_more")})})})}function sw({testId:e,config:t,trackingProperties:s}){return(0,n.jsx)(eF.fu,{name:"ChatBoxToast",properties:s,children:(0,n.jsx)("div",{className:"xyorhqc xj0a0fe","data-testid":e,children:(0,n.jsx)(ex.Yy,{variant:"brand",icon:t.icon,children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib xou54vl x6s0dn4 xh8yej3",children:[(0,n.jsx)("div",{className:"x78zum5 x1q0g3np xkh2ocl x6s0dn4",children:(0,n.jsx)(em.Q,{title:t.title,children:t.content?.()})}),t.button]})})})})}function sE({testId:e,config:t,trackingProperties:s}){return(0,n.jsx)(eF.fu,{name:"ChatBoxToast",properties:s,children:(0,n.jsx)("div",{className:"xyorhqc xj0a0fe","data-testid":e,children:(0,n.jsxs)(ex.cV,{variant:"brand",icon:t.icon,children:[(0,n.jsx)(em.Q,{title:t.title,children:t.content?.()}),t.button]})})})}function sN(){return(0,n.jsx)(eF.fu,{name:"ChatBoxToast-InProgress",children:(0,n.jsx)("div",{className:"xyorhqc xj0a0fe x1iwbaqv","data-testid":"mobile-in-progress-banner",children:(0,n.jsx)(ex.Yy,{variant:"brand",icon:(0,n.jsx)(eO.k,{}),children:(0,n.jsx)("div",{className:"x78zum5 x1q0g3np x1qughib xou54vl x6s0dn4 xh8yej3",children:(0,n.jsx)("div",{className:"x78zum5 x1q0g3np xkh2ocl x6s0dn4",children:(0,n.jsx)(em.Q,{children:(0,_.t)("make_mobile_chat.working_on_it_stay_on")})})})})})})}function sS(){let{openFigmakeFullscreenInSameTab:e}=(0,er.Ve)();return(0,n.jsx)(eF.fu,{name:"ChatBoxToast-Complete",children:(0,n.jsx)("div",{className:"xyorhqc xj0a0fe","data-testid":"mobile-complete-banner",children:(0,n.jsx)(ex.Yy,{variant:"success",icon:(0,n.jsx)(ef.U,{}),children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib xou54vl x6s0dn4 xh8yej3",children:[(0,n.jsx)("div",{className:"x78zum5 x1q0g3np xkh2ocl x6s0dn4",children:(0,n.jsx)(em.Q,{children:(0,_.t)("make_mobile_chat.all_set")})}),(0,n.jsx)("div",{className:"xu159t0 xpavgux",children:(0,n.jsx)(ez.$z,{variant:"primary",onClick:e,children:(0,_.t)("make_mobile_chat.preview")})})]})})})})}function sT({attachments:e,clearAttachment:t}){return e&&e.filter(e=>"error"!==e.status).length>0?(0,n.jsx)("div",{className:"x78zum5 x1q0g3np x167g77z x14vqqas x1wsuqlk xat24cr xq1n1xh",children:e.map(e=>"error"===e.status?null:(0,n.jsx)(sx.V,{attachment:e,clearAttachment:t},e.uniqueId))}):null}function sI(){let e=(0,y.Xr)(td.nJ);return(0,n.jsx)(ts,{variant:"warning",onClose:()=>e(!0),children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 xh8yej3 xg2d0mh","data-testid":"mcp-warning-banner",children:[(0,n.jsx)(e_.e,{"aria-hidden":!0,style:{"--color-icon":"currentColor"}}),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1iyjqo2",children:[(0,n.jsx)("div",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh xmyi33j",children:(0,_.t)("figmake.mcp_clients.warning_banner.title")}),(0,n.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up xmyi33j",children:(0,_.t)("figmake.mcp_clients.warning_banner.message")})]})]})})}function sA(){let e=(0,eo.wA)(),{mcpClients:t,isLoading:s}=(0,se.Qh)(),i=(0,a.useRef)(!1);a.useEffect(()=>{i.current||s||t.length||(e(eD.b({has_authed_figmake_mcp_client:!1})),i.current=!0)},[e,s,t.length]);let r=a.useMemo(()=>[...t].sort((e,t)=>t.createdAt.localeCompare(e.createdAt))[0],[t]);return s||!r?null:(0,n.jsx)(sM,{mcpServer:r.server})}function sM({mcpServer:e}){let t=(0,eo.wA)(),s=(0,eS.hC)();return(0,eT.h)(()=>{s("ai_chat_mcp.education_banner_viewed",{featureEntrypoint:"figmake"})}),(0,n.jsx)(ts,{variant:"info",onClose:()=>{t(eD.b({dismissed_figmake_chat_mcp_tool_banner:!0})),s("ai_chat_mcp.education_banner_dismissed",{featureEntrypoint:"figmake"})},children:(0,n.jsxs)("div",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x78zum5 x6s0dn4 xilkfi8 x1nfngrj","data-testid":"mcp-education-banner",children:[(0,n.jsx)(eM.oW,{className:"x1kky2od xlup9mm x192jxwq x19kjcj4",src:e.logoUrl||void 0,alt:e.name}),(0,_.t)("figmake.chat_box.mcp_education_banner",{serverName:e.name})]})})}function sz(){let e=(0,to.P)(),t=(0,y.Xr)(eQ.rK);return(0,n.jsx)(ts,{variant:"error",onClose:()=>t(!1),children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 xh8yej3","data-testid":"supabase-error-banner",children:[(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x167g77z xkh2ocl x6s0dn4",children:[(0,n.jsx)(e_.e,{"aria-hidden":!0,style:{"--color-icon":"currentColor"}}),(0,_.t)("figmake.supabase_error.title")]}),(0,n.jsx)(ep.$n,{variant:"secondary",onClick:e,children:(0,_.t)("figmake.supabase_error.button")})]})})}function sL({text:e,...t}){let[s,i]=(0,a.useState)(!1),r=(0,a.useRef)(null);return(0,n.jsx)(eh.E,{onClick:()=>{navigator.clipboard.writeText(e),i(!0),r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{i(!1)},1e3)},"aria-label":(0,_.t)("figmake.chat_box.error.copy_request_id"),...t,children:s?(0,_.t)("figmake.chat_box.error.request_id_copied"):e})}function sO({chatError:e,onClose:t,onRetry:s,featureType:a}){let{error:i,cortexClientGeneratedRequestUuid:r}=e,l=(0,e3.c)(),{node:o,dismissable:c,shouldShowRetry:d,severity:u,shouldShowReload:x}=(0,tJ.Ex)(i,{isExperimentalModelSelected:l}),m=r;(0,sd.z)("make_error_tsid")&&(m??=(0,eA.tl)().tracking_session_id);let p=!m;return(0,eT.h)(()=>{if(!(0,sd.z)("make_report_chat_error_banner"))return;let e=(0,tJ.tx)(i);(0,O.Nh)({requestUUID:r??"",featureType:a,errorReason:e,errorMessage:i.message,errorName:i.name})}),(0,n.jsx)(ts,{variant:u,onClose:c?t:void 0,secondaryContent:m&&(0,n.jsxs)("div",{className:"xrybvsa x15r87gk xh8yej3 x78zum5 xozqiw3 xg2d0mh",children:[(0,n.jsx)("p",{className:"x2lah0s",children:(0,_.t)("figmake.chat_box.error.request_id")}),(0,n.jsx)(sL,{text:m,className:"x172n1ly xebhuq6 xb3r6kr"})]}),children:(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x1cy8zhl x1nfngrj xh8yej3",children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 xg2d0mh xh8yej3",children:[p&&(0,n.jsx)("span",{className:"xvy4d1p",children:p&&(0,n.jsx)(e_.e,{"aria-hidden":!0,style:{"--color-icon":"currentColor"}})}),(0,n.jsx)("div",{role:"alert",...{0:{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x1iyjqo2"},1:{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x1iyjqo2 xrybvsa"}}[!p<<0],"data-testid":"code-chat-error-message",children:o}),d&&s&&(0,n.jsx)("div",{className:"x1yjdb4r x78zum5 x1q0g3np x6s0dn4 x167g77z x19y5rnk",children:(0,n.jsx)(ep.$n,{variant:"secondary",onClick:s,children:(0,_.t)("ai.try_again")})}),x&&(0,n.jsx)("div",{className:"x1yjdb4r x78zum5 x1q0g3np x6s0dn4 x167g77z x19y5rnk",children:(0,n.jsx)(ep.$n,{variant:"secondary",onClick:()=>eN.Ay.reload("AI Assistant: Outdated Client Error"),children:(0,_.t)("ai.refresh_page")})})]})})})}function sP({onClose:e,onRefactor:t,numLargeFiles:s}){return(0,n.jsxs)(ts,{variant:"warning",onClose:e,children:[(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1jnr06f",children:[(0,n.jsx)(e_.e,{"aria-hidden":!0,style:{"--color-icon":"currentColor"}}),(0,n.jsx)("div",{style:{color:"currentColor"},children:(0,_.t)("figmake.chat_box.refactor_large_files",{numLargeFiles:s})})]}),(0,n.jsx)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z x19y5rnk x1yjdb4r",children:(0,n.jsx)(ep.$n,{variant:"secondary",onClick:t,children:(0,_.t)("figmake.chat_box.refactor_large_files_cta")})})]})}function sR({onClose:e,requestFixErrors:t,errorFixingDisabled:s,isLastUserMessageAutoErrorFix:a,errorCount:i,variant:r}){let l=(0,y.Xr)(D.YD),o=(0,y.Xr)(D.Vo),c=(0,_.t)("living_designs.chat.errors.error_count",{count:i});return c="error"===r?a?i>10?(0,_.t)("figmake.errors.autofix_failed_max_errors",{maxCount:10}):(0,_.t)("figmake.errors.autofix_failed",{count:i}):i>10?(0,_.t)("figmake.errors.max_errors",{maxCount:10}):(0,_.t)("living_designs.chat.errors.error_count",{count:i}):i>10?(0,_.t)("figmake.chat.warning_message_max_errors",{maxCount:10}):(0,_.t)("figmake.chat.warning_message",{count:i}),(0,n.jsxs)(ts,{variant:r,onClose:e,children:[(0,n.jsx)(eh.E,{onClick:()=>{l(!0),o("console")},...{0:{className:"xjbqb8w x1ypdohk"},2:{className:"xjbqb8w x1ypdohk x172n1ly"},1:{className:"xjbqb8w x1ypdohk x1akne3o"},3:{className:"xjbqb8w x1ypdohk x1akne3o"}}[!("error"!==r)<<1|!("info"!==r)<<0],children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1jnr06f",children:[(0,n.jsx)(e_.e,{"aria-hidden":!0,style:{"--color-icon":"currentColor"}}),(0,n.jsx)("div",{style:{color:"currentColor"},children:c})]})}),(0,n.jsx)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z x19y5rnk x1yjdb4r",children:(0,n.jsx)(ep.$n,{variant:"secondary",onClick:t,disabled:s,children:(0,_.t)("living_designs.chat.errors.ask_figma_fix")})})]})}function sD({onClose:e}){return(0,n.jsx)(ts,{variant:"info",onClose:e,children:(0,n.jsxs)("span",{className:"x78zum5 x1q0g3np x6s0dn4 x1jnr06f",children:[(0,n.jsx)(ey,{}),(0,_.t)("figmake.chat.autofix_message")]})})}function sF({onClose:e,onContinue:t}){return(0,n.jsxs)(ts,{variant:"warning",onClose:e,children:[(0,n.jsx)("span",{children:(0,_.t)("ai.error.max_steps_reached")}),(0,n.jsx)(ep.$n,{variant:"secondary",onClick:t,children:(0,_.t)("figmake.chat.continue")})]})}function sq({state:e,requestScrollToBottom:t,featureType:s}){let r="normal"!==e.type,l=(0,q.S)(s);return((0,a.useEffect)(()=>{l&&r&&t?.()},[r,l]),"chatDisabled"===e.type)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tZ.$,{testId:"chat-box-toast",renderer:e.featureType===i.lV.AI_ASSISTANT?sE:sw,featureType:e.featureType}),e.showLoggedOutBanner&&(0,n.jsx)(su,{})]}):"supabaseNudge"===e.type?(0,n.jsx)(tr,{}):"supabaseError"===e.type?(0,n.jsx)(sz,{}):"chatError"===e.type?(0,n.jsx)(sO,{chatError:e.chatError,onClose:e.onClose,onRetry:e.onRetry,featureType:e.featureType}):"refactorLargeFiles"===e.type?(0,n.jsx)(sP,{onClose:e.onClose,onRefactor:e.onRefactor,numLargeFiles:e.numLargeFiles}):"consoleErrors"===e.type?(0,n.jsx)(sR,{onClose:e.onClose,requestFixErrors:e.requestFixErrors,errorFixingDisabled:e.errorFixingDisabled,isLastUserMessageAutoErrorFix:e.isLastUserMessageAutoErrorFix,errorCount:e.errorCount,variant:e.variant}):"selfHealing"===e.type?(0,n.jsx)(sD,{onClose:e.onClose}):"communityAttribution"===e.type?(0,n.jsx)(sy,{communityAttributions:e.communityAttributions,onClose:e.onClose}):"chatSoftLimit"===e.type?(0,n.jsx)(sC,{onClose:e.onClose}):"provisionalAccess"===e.type?(0,n.jsx)(sv,{licenseType:e.licenseType,onClose:e.onClose}):"mobileInProgress"===e.type?(0,n.jsx)(sN,{}):"mobileComplete"===e.type?(0,n.jsx)(sS,{}):"mcpToolWarning"===e.type?(0,n.jsx)(sI,{}):"mcpClientEducation"===e.type?(0,n.jsx)(sA,{}):"maxStepsReached"===e.type?(0,n.jsx)(sF,{onClose:e.onClose,onContinue:e.onContinue}):null}let sG=a.forwardRef((e,t)=>{let{placeholderText:s,canSend:r,sendMessage:l,chatBoxLeftExtraContent:o,chatBoxRightExtraContent:c,inspectedElement:d,selectedPointAndEditJsxSource:u,errorFixingDisabled:x,showPasteDesignsCallout:m,generationInProgress:p,chatMessagesNodeGuid:h,canCancelGeneration:g,chatContainerRef:f,isDraggingAttachment:k,chatMessageCount:v,isLastUserMessageAutoErrorFix:b,featureType:j,onBlur:C,onFocus:w,cleanUpResumableMake:E,requestScrollToBottom:S}=e,T=(0,a.useRef)(null),[I,A]=(0,y.fp)((0,F.mC)(h)),M=(0,a.useRef)(null),{chatError:z,clearChatError:L}=(0,t0.tk)(h),O=(0,t1.Xt)(h),R=(0,t1.kV)(h),[D,q]=(0,e2.jT)(),[U]=(0,tl.PM)(),K=(0,y.md)(e1.UV)&&!(0,P.zy)(),H=D.filter(e=>"error"===e.type||"warn"===e.type),B=(0,eI.ZC)(H),V=a.useMemo(()=>H.every(e=>"warn"===e.type)&&0===U.length,[H,U]),$=(0,eI.ZC)(v),[W,Y]=(0,a.useState)(!1),X=r&&!(0,N.jN)(I)&&!K,Z=function(e){let[t,s]=a.useState(!1),n=a.useRef(null);return a.useEffect(()=>(n.current&&clearTimeout(n.current),s(e.length>0),n.current=setTimeout(()=>{s(!1)},1e4),()=>{n.current&&clearTimeout(n.current)}),[e]),t}(I);a.useEffect(()=>{let e=(0,F.A5)(h);e?e.isTyping!==Z&&(0,F.YZ)({...e,isTyping:Z}):h&&(0,F.YZ)({node:h,isTyping:Z,messages:[],fileUpdates:[]})},[Z,h]),a.useEffect(()=>{(B?.length!==H.length||$!==v)&&Y(!1)},[B,H,$,v]);let[J,Q]=(0,y.fp)((0,tc.o0)(h)),[ee,et]=(0,y.fp)((0,tc.AK)(h)),[es,en]=(0,a.useState)(300),[ea,ei]=(0,a.useState)(0),{communityAttributionDisplay:ec,clearCommunityAttributionDisplay:ed}=(0,t6.Pe)();(0,a.useEffect)(()=>{if(!f?.current)return;let e=()=>{en(Math.max(96,.25*(f.current?.clientHeight||300)))},t=()=>{ei(f.current?.clientWidth??0)},s=()=>{e(),t()};s(),new ResizeObserver(s).observe(f.current)},[f]);let eu=(0,t8.S)({textareaRef:T,maxHeight:es});(0,a.useEffect)(()=>{eu()},[es,I,eu,ea]);let ex=(0,G.ry)(j),em=(0,y.md)(t7.Ng),ep=(0,eq.k)(),eh=(0,el.Oc)(),eg=eh?eB.G_.FIGMAKE:eB.G_.SITES,ef=(0,e6.Xu)(),e_=(0,y.md)(eQ.Xl),{connectedProject:ey,isConnectedNonOwner:ek}=(0,ta.GC)(),ev=(0,ta.Iz)(),{showProvisionalAccessBanner:eb,onCloseProvisionalAccessBanner:ej}=function(e){let{getProvisionalAccessBanner:t}=(0,e$.wH)(),s=t(e),[n,i]=(0,a.useState)(!0);return{showProvisionalAccessBanner:s?.showBanner&&n,onCloseProvisionalAccessBanner:()=>{i(!1)}}}(eg),{showChatSoftLimitBanner:ew,onCloseChatSoftLimitBanner:eE}=function(e){let t=(0,eo.wA)(),s=(0,eK.f)(t4),n=(0,eV.No)(),a=n.unwrapOr(null)?.tier,{meterUsed:i,bypassMetering:r}=(0,t3.xD)(e),l=(0,t2.Tf)();if(e===eZ.JT.AI_CHAT_DEPRECATED)return{showChatSoftLimitBanner:!1};if(s&&function(e){let t=(0,t5.A)(new Date).tz("America/Los_Angeles");return(0,t5.A)(e).tz("America/Los_Angeles").isBefore(t,"month")}(s.updatedAt))t(eD.b({[t4]:!1}));else if(s)return{showChatSoftLimitBanner:!1};return(!(0,eY.aV)()||r)&&a&&a!==eB.Ag.STARTER&&a!==eB.Ag.STUDENT?{showChatSoftLimitBanner:i>=l[a],onCloseChatSoftLimitBanner:()=>{t(eD.b({[t4]:!0}))}}:{showChatSoftLimitBanner:!1}}(eh?eZ.JT.FIGMAKE:j===i.lV.AI_ASSISTANT?eZ.JT.START_AI_ASSISTANT:eZ.JT.LIVING_DESIGNS),eN=!p&&v>0,eS=(0,er.g7)(),eT=(H.length>0||ef&&U.length>0)&&!W,eA=(0,y.md)(td.nJ),eM=(0,tV.dH)(),ez=(0,se.pA)(eM??!1),eL=(0,eC.kc)().bake_mcp_warning_banner&&ez>=td.G6&&!eA,eO=(0,eK.f)("dismissed_figmake_chat_mcp_tool_banner"),eP=(0,eK.f)("has_authed_figmake_mcp_client"),eR=!!((0,eC.kc)().bake_mcp_education_banner&&!eO&&eP),eF=Array.from((0,e0.vj)().entries()).filter(([e,t])=>!t.isInternal()).map(([e])=>e),eG=(0,a.useCallback)(()=>{l({message:(0,_.t)("figmake.chat_box.refactor_large_files_cta"),errors:eF,origin:i.zm.REFACTOR_LARGE_FILES_BUTTON}),Q(!0)},[l,Q,eF]),eU="true"!==localStorage.getItem("hide-refactor-large-files-banner"),eH=(0,eC.kc)().make_refactor_large_files,eW=a.useMemo(()=>eH&&eU&&!J&&eF.length>0,[J,eF,eU,eH]),eX=function(e){let{shouldDisableCodeChat:t,isSendToMakeInProgress:s,canUseSupabase:n,showSupabaseDeployNudge:a,connectedProject:r,isConnectedNonOwner:l,hasSupabaseError:o,chatError:c,clearChatError:d,hasConsoleMessages:u,isFixingErrors:x,setHideErrorMessage:m,generationInProgress:p,communityAttributionDisplay:h,clearCommunityAttributionDisplay:g,showChatSoftLimitBanner:f,onCloseChatSoftLimitBanner:y,isFigmake:k,showProvisionalAccessBanner:v,onCloseProvisionalAccessBanner:b,licenseType:j,isFigmaMakeMobile:C,isGenerationComplete:w,showRefactorLargeFilesBanner:E,onRefactorLargeFiles:N,largeFileNames:S,consoleErrorsAndWarnings:T,supabaseConsoleMessages:I,allWarnings:A,errorFixingDisabled:M,isLastUserMessageAutoErrorFix:z,wasLastMessageAttemptErrorFix:L,requestFixErrors:O,sendMessage:P,featureType:R,isLoggedOutCommentUser:D,showMcpWarningBanner:F,showMcpEducationBanner:q,isPausedAtMaxSteps:G,clearFinishReason:U}=e,K=(0,tV.dH)();return t||s?{type:"chatDisabled",showLoggedOutBanner:k&&D,featureType:R}:n&&a&&(r||l)?{type:"supabaseNudge"}:n&&o?{type:"supabaseError"}:c?{type:"chatError",chatError:c,onClose:d,onRetry:L?O:()=>P({}),featureType:R}:u&&x?{type:"selfHealing",onClose:()=>m(!0)}:u&&!p?{type:"consoleErrors",onClose:()=>m(!0),requestFixErrors:O,errorFixingDisabled:M,isLastUserMessageAutoErrorFix:!!z,errorCount:T.length+I.length,variant:A?"info":"error"}:h&&h.length>0?{type:"communityAttribution",communityAttributions:h,onClose:g}:!(0,eC.kc)().disable_code_chat_soft_limit_banner&&(0,eC.kc)().enable_code_chat_soft_limit_banner_for_plan&&f?{type:"chatSoftLimit",onClose:y}:K&&F?{type:"mcpToolWarning"}:(0,eC.kc)().bake_monetization_plan&&k&&v?{type:"provisionalAccess",licenseType:j,onClose:b}:C&&p?{type:"mobileInProgress"}:C&&w?{type:"mobileComplete"}:E?{type:"refactorLargeFiles",onClose:()=>localStorage.setItem("hide-refactor-large-files-banner","true"),onRefactor:N,numLargeFiles:S.length}:G?{type:"maxStepsReached",onClose:U,onContinue:()=>{P({message:(0,_.t)("figmake.chat.continue"),origin:i.zm.MAX_STEPS_REACHED_BUTTON})}}:K&&q?{type:"mcpClientEducation"}:{type:"normal"}}({shouldDisableCodeChat:ex,isSendToMakeInProgress:em,canUseSupabase:ef,showSupabaseDeployNudge:e_,connectedProject:ey,isConnectedNonOwner:ek,hasSupabaseError:ev,chatError:z,clearChatError:L,hasConsoleMessages:eT,isFixingErrors:J,setHideErrorMessage:Y,generationInProgress:p,communityAttributionDisplay:ec,clearCommunityAttributionDisplay:ed,showChatSoftLimitBanner:ew,onCloseChatSoftLimitBanner:eE,isFigmake:eh,showProvisionalAccessBanner:eb,onCloseProvisionalAccessBanner:ej,licenseType:eg,isFigmaMakeMobile:eS,isGenerationComplete:eN,showRefactorLargeFilesBanner:eW,onRefactorLargeFiles:eG,largeFileNames:eF,consoleErrorsAndWarnings:H,supabaseConsoleMessages:U,allWarnings:V,errorFixingDisabled:x,isLastUserMessageAutoErrorFix:b,wasLastMessageAttemptErrorFix:ee,requestFixErrors:function(){Q(!0),et(!0);let e=Array.from(new Set([...H.map(e=>e.message)??[],...U.map(e=>e.event_message)]));l({message:V?(0,_.t)("figmake.chat.warning_fix_message"):(0,_.t)("living_designs.chat.errors.fix_these_errors"),errors:e,origin:i.zm.FIX_ERRORS_BUTTON}),q([])},sendMessage:l,featureType:j,isLoggedOutCommentUser:ep,showMcpWarningBanner:eL,showMcpEducationBanner:eR,isPausedAtMaxSteps:"tool-calls"===O,clearFinishReason:R});return(0,n.jsx)("form",{"data-point-and-edit-tool":!0,onSubmit:e=>{e.preventDefault(),M.current?.()},children:(0,n.jsxs)(sf,{children:[(0,n.jsx)(sq,{state:eX,requestScrollToBottom:S,featureType:j}),(0,n.jsx)(sU,{cachedChatContainerWidth:ea,canCancelGeneration:g,canSend:X,chatBoxLeftExtraContent:o,chatBoxRightExtraContent:c??[],chatMessagesNodeGuid:h,cleanUpResumableMake:E,featureType:j,generationInProgress:p,input:I,inspectedElement:d,internalTextareaRef:T,isDraggingAttachment:k,onBlur:C,onFocus:w,onSubmitMessageRef:M,placeholderText:s,selectedPointAndEditJsxSource:u,sendMessage:l,setInput:A,showPasteDesignsCallout:m,textareaRef:t,updateTextareaHeight:eu})]})})});function sU({chatMessagesNodeGuid:e,generationInProgress:t,canSend:s,canCancelGeneration:r,sendMessage:l,input:o,setInput:c,updateTextareaHeight:d,inspectedElement:u,internalTextareaRef:x,selectedPointAndEditJsxSource:m,isDraggingAttachment:p,showPasteDesignsCallout:h,textareaRef:f,placeholderText:C,chatBoxLeftExtraContent:w,chatBoxRightExtraContent:E,onBlur:N,onFocus:S,featureType:I,cachedChatContainerWidth:M,cleanUpResumableMake:z,onSubmitMessageRef:L}){let O=(0,el.Oc)(),R=(0,T.O1)(),q=I===i.lV.AI_ASSISTANT&&R&&!u,K=a.useCallback(e=>{e.stopPropagation(),ej.Egt?.clearSelection()},[]),{isCommentModeActive:H}=(0,en.jy)(),B=u&&!H,$=m&&!H,W=(0,V.sG)(),Y=(0,V.YC)(),X=I===i.lV.AI_ASSISTANT,Z=(0,y.md)(D.mK),J=a.useCallback(()=>{(0,sd.z)("bake_point_and_edit")||Z?.setDirectManipulationEnabled({enabled:!1})},[Z]),Q=a.useCallback(()=>{Z?.pointAndEditControl({type:"elementSelect",element:void 0})},[Z]),ee=(0,y.md)(e1.UV)&&!(0,P.zy)(),et=(0,a.useCallback)(e=>{let t=e.target;d(),c(t.value)},[c,d]),{isOrWasRecentlyComposing:es,handleCompositionStart:ea,handleCompositionEnd:ei}=(0,e5.T)(),er=(0,y.Xr)((0,tc.AK)(e)),[eo,ed]=(0,y.fp)(F.PD),eu=(0,e4.S)(),ex=(0,y.Xr)(F.f4),em=(0,a.useRef)(null),ep=(0,a.useCallback)(()=>{if(er(!1),eo){let t=y.zl.get((0,F.mC)(e));if(t.trim()){let e={success:!0,message:t.trim(),isChatBoxUserResponse:!0};ex({toolCallId:eo.toolCallId,toolResult:e}),eu({toolCallId:eo.toolCallId,toolName:eo.toolName,toolResult:e}),c(""),ed(null)}}else s&&l({});(0,sd.z)("bake_point_and_edit")?m&&Z?.pointAndEditControl({type:"mode",mode:"inactive"}):(u||Z?.directManipulationEditor.directManipulationEnabled())&&J()},[eo,e,ex,eu,c,ed,s,er,l,u,Z,m,J]);(0,a.useEffect)(()=>{L.current=ep},[ep,L]);let eh=(0,a.useCallback)(e=>{e.stopPropagation(),es(e)||("Enter"!==e.key||e.shiftKey||(e.preventDefault(),ep()),"Escape"===e.key&&em?.current?.value.trim()===""&&(0,U.UM)())},[em,es,ep]),eg=y.zl.get((0,F.Z3)(e)),ef=(0,G.ry)(),{attachments:e_}=(0,tQ._9)(e),ey=(0,tQ.oz)(),eb=(0,st.Mq)({origin:st.tl.CHAT_SIDEBAR_INPUT});async function eE(e){if(O){if((0,eC.kc)().allow_node_links_in_make)await eb(e);else try{let t=(e.clipboardData||window.clipboardData).getData("Text");(0,sm.Dv)(t)&&(0,tQ.hH)(g.FDn.USER_PASTED_FIGMA_LINK_IN_CHAT)}catch{}}else e.stopPropagation()}let eN=(0,a.useRef)(null),[eS,eT]=(0,a.useState)(0),eI=t&&M>300;(0,a.useEffect)(()=>{eT(eI&&eN.current?eN.current.scrollWidth+sp.RIGHT+sp.LEFT+24+sp.GAP:25)},[eI]);let[eA,eM]=(0,y.fp)(F.uz),ez=(0,y.md)(A.ze),eL=(0,y.md)(eG.wg),eP=(0,t9.Z)();(0,a.useEffect)(()=>{if(t)eM(Date.now());else{if(eA&&O){let e=Date.now()-eA;j.az.trackDefinedMetric("figmake.generation_in_progress",{fileKey:ez??void 0,durationMilliseconds:e,userCanEdit:eL,onPageUnload:!1,resumableMakeEnabled:eP})}eM(null)}},[t]);let eR=ef?"var(--color-bg-secondary)":"var(--color-bg)",eD=eo?(0,_.t)("figmake.ask_question.cta.add_custom_response"):C;return(0,n.jsxs)("div",{...{0:{className:"x1n2onr6 x78zum5 xdt5ytf x2lah0s x1iorvi4 xb3r6kr x1y0btm7 xmkeg23 x9h44rk x1ey2m1c x1753ylo x7z60cl x1j937ru xhfuivf xsag5q8 x1v2ro7d"},4:{className:"x1n2onr6 x78zum5 xdt5ytf x2lah0s x1iorvi4 xb3r6kr x9h44rk x1ey2m1c x1753ylo xhfuivf xsag5q8 x1v2ro7d xdh2fpr x1y0btm7 x1va2ikv"},2:{className:"x1n2onr6 x78zum5 xdt5ytf x2lah0s x1iorvi4 xb3r6kr x9h44rk x1ey2m1c x1753ylo xhfuivf xsag5q8 x1v2ro7d xdh2fpr x1y0btm7 x1fa9rx7"},6:{className:"x1n2onr6 x78zum5 xdt5ytf x2lah0s x1iorvi4 xb3r6kr x9h44rk x1ey2m1c x1753ylo xhfuivf xsag5q8 x1v2ro7d xdh2fpr x1y0btm7 x1fa9rx7"},1:{className:"x1n2onr6 x78zum5 xdt5ytf x2lah0s x1iorvi4 xb3r6kr x1y0btm7 xmkeg23 x9h44rk x1ey2m1c x1753ylo x7z60cl x1j937ru xsag5q8 x1v2ro7d x15ysqaf"},5:{className:"x1n2onr6 x78zum5 xdt5ytf x2lah0s x1iorvi4 xb3r6kr x9h44rk x1ey2m1c x1753ylo xsag5q8 x1v2ro7d xdh2fpr x1y0btm7 x1va2ikv x15ysqaf"},3:{className:"x1n2onr6 x78zum5 xdt5ytf x2lah0s x1iorvi4 xb3r6kr x9h44rk x1ey2m1c x1753ylo xsag5q8 x1v2ro7d xdh2fpr x1y0btm7 x1fa9rx7 x15ysqaf"},7:{className:"x1n2onr6 x78zum5 xdt5ytf x2lah0s x1iorvi4 xb3r6kr x9h44rk x1ey2m1c x1753ylo xsag5q8 x1v2ro7d xdh2fpr x1y0btm7 x1fa9rx7 x15ysqaf"}}[!!p<<2|!!eo<<1|!(I!==i.lV.CODE_IN_SITES)<<0],style:{backgroundColor:eR},children:[(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1iyjqo2 xs83m0k x1r8uery",style:{backgroundColor:eR},children:[h&&(0,n.jsx)(sK,{}),(0,n.jsx)(sT,{attachments:e_,clearAttachment:ey}),$?(0,n.jsx)(tG,{selectedJsxSource:m,sitesPreview:Z,variant:"prompt",onRemove:Q}):null,B?(0,n.jsx)(tR,{tagName:u.tagName||"",variant:"prompt",iconType:"element",onRemove:J}):W?(0,n.jsx)(tR,{tagName:W.tagName||"",variant:"prompt",iconType:"component"}):Y&&Y.libraryName?(0,n.jsx)(tR,{tagName:Y.libraryName,variant:"prompt",iconType:"library"}):null,q?(0,n.jsx)(tq,{nodes:R,variant:"prompt",onRemove:K}):null,(0,n.jsx)("div",{...k.Ay.props(sg.chatboxTextareaWrapper,sg.chatboxTextareaWrapperFade(eR)),children:(0,n.jsx)("textarea",{ref:function(e){em.current=e,x.current=e,"function"==typeof f?f(e):f&&(f.current=e)},className:"x78zum5 x1iyjqo2 xtt52l0 x1edz59j xz9dl7a xsag5q8 xnm25rq xyfqnmn x1ed109x x8yk33q x1fc57z9 xh8yej3 x9f619 xjb0lab xk3rhcj xalqmnw","data-testid":"code-chat-chat-box",disabled:ef,id:eU.x2,maxLength:5e5,onBlur:e=>{N?.(e)},onChange:et,onCompositionEnd:ei,onCompositionStart:ea,onFocus:e=>{let t=e.target.value.length;e.target.setSelectionRange(t,t),S?.(e)},onKeyDown:eh,onPaste:eE,placeholder:eD,style:{backgroundColor:eR,height:"auto"},value:o})})]}),(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 xt970qd xaope02",children:[(0,sd.z)("ai_assistant_ds_library_selector")?(0,n.jsx)("div",{style:{display:"flex",alignItems:"center"},children:w}):(0,n.jsxs)(n.Fragment,{children:[X?(0,n.jsx)(eJ.yi,{helpUrlVariant:eZ.JT.AI_CHAT_DEPRECATED}):null,w]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0},children:[E,(0,n.jsx)("div",{style:{flexShrink:0},children:(()=>{let e=(0,ew.A)(.19,1,.22,1),a={play:{width:"25px",transition:{duration:.3,ease:e}},stop:{width:`${eS}px`,transition:{duration:.3,ease:e}}};return(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k x11umrmk",children:(0,n.jsxs)(b.P.button,{disabled:t?!r:!s,onClick:async()=>{t?(eg&&eg.abort((0,ec.NK)(ec.XD.USER_ABORTED)),z&&await z("figmake_or_resume_abort")):ep()},type:"button",...k.Ay.props(t?eI?sg.stopButton:sg.stopButtonIconOnly:sg.sendButton,!t&&s&&sg.sendButtonEnabled,!t&&!s&&sg.sendButtonDisabled),animate:t?"stop":"play","aria-label":t?(0,_.t)("living_designs.chat.stop_button.alt_text"):(0,_.t)("living_designs.chat.send_button.alt_text"),"data-testid":t?"code-chat-stop-button":"code-chat-send-button","data-tooltip":ee?(0,_.t)("figmake.ds_imports.library_files_downloading"):null,"data-tooltip-type":eX.Ib.TEXT,initial:"play",variants:a,children:[(0,n.jsx)(b.P.div,{className:"x1n2onr6 x78zum5 x6s0dn4 xl56j7k xvy4d1p xxk0z11",variants:{play:{x:0,transition:{duration:.3,ease:e}},stop:{x:0,transition:{duration:.3,ease:e}}},animate:t?"stop":"play",children:(0,n.jsx)(v.N,{mode:"wait",children:t?(0,n.jsx)(b.P.div,{className:"absolute",animate:{opacity:1,scale:1,rotate:0},exit:{opacity:0,scale:0,rotate:-45},initial:{opacity:0,scale:0,rotate:100},transition:{duration:.3,ease:e},children:(0,n.jsx)(ev.Q,{className:"xwa2v1s xvy4d1p xxk0z11 x2lah0s"})},"square"):(0,n.jsx)(b.P.div,{className:"absolute",animate:{opacity:1,scale:1,rotate:0},exit:{opacity:0,scale:0,rotate:45},initial:{opacity:0,scale:0,rotate:-45},transition:{duration:.25,ease:e},children:ee?(0,n.jsx)(eO.k,{size:"sm"}):(0,n.jsx)(ek.W,{className:"xwa2v1s xvy4d1p xxk0z11 x2lah0s"})},"arrow")})}),(0,n.jsx)(v.N,{children:eI&&(0,n.jsx)(b.P.span,{ref:eN,className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up xb3r6kr xuxw1ft x1tk3asg x1j61x8r",initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},transition:{opacity:{duration:.25,ease:e},width:{duration:.25,ease:e}},children:(0,_.t)("living_designs.chat.stop_button")})})]})})})()})]})]})]})}function sK(){return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1nejdyq x1ruevkc xmkeg23 xbsl7fq xaqgqki xw7yly9 x1o6q14k xat24cr xq1n1xh x1sxf85j",children:[(0,n.jsx)(sH,{}),(0,n.jsx)("div",{className:"x1nmd3yn xm735u9 xkbmbem xqp8s7e xv1l7n4 xvwc6ox x1j61x8r",children:(0,_.t)("figmake.chat.paste_existing_design_callout")})]})}function sH(){return(0,n.jsxs)("svg",{width:"22",height:"27",viewBox:"0 0 22 27",children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.3438 5.59766H18.8389V20.5352H16.2041V22.7998H5.85938V20.3682H3.1377V5.79492H5.7168V3.06641H16.3438V5.59766ZM7.83398 9.25586C7.691 9.24173 7.55088 9.29393 7.44922 9.39551L7.39355 9.45117C7.29203 9.55285 7.23973 9.69297 7.25391 9.83594C7.34716 10.7618 7.7613 14.2858 8.74023 15.2656C9.40363 15.9289 10.4407 16.2157 11.4219 16.1045L12.167 16.8545C12.5491 17.2397 13.171 17.241 13.5547 16.8574L14.834 15.5781C15.2154 15.1967 15.2167 14.5783 14.8369 14.1953L14.0986 13.4512C14.2185 12.4619 13.9322 11.4128 13.2627 10.7432C12.283 9.76425 8.76013 9.34913 7.83398 9.25586Z",fill:eb.Tj.bgSelected}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.2261 0.0282208C5.71996 0.0785065 6.10527 0.495932 6.10527 1.00306V2.22185H15.9015V1.00306C15.9015 0.495932 16.2868 0.0785065 16.7807 0.0282208L16.8811 0.0234375H20.7996L20.9001 0.0282208C21.3939 0.0785065 21.7792 0.495932 21.7792 1.00306V4.92155L21.7745 5.022C21.7275 5.48284 21.3609 5.84947 20.9001 5.89639L20.7996 5.90117H19.8238V20.1057H20.7996L20.9001 20.1105C21.3939 20.1608 21.7792 20.5782 21.7792 21.0853V25.0038L21.7745 25.1043C21.7275 25.5651 21.3609 25.9317 20.9001 25.9787L20.7996 25.9834H16.8811L16.7807 25.9787C16.3198 25.9317 15.9532 25.5651 15.9063 25.1043L15.9015 25.0038V23.7869H6.10527V25.0038L6.10049 25.1043C6.05357 25.5651 5.68694 25.9317 5.2261 25.9787L5.12565 25.9834H1.20716L1.10671 25.9787C0.645871 25.9317 0.279246 25.5651 0.232322 25.1043L0.227539 25.0038V21.0853C0.227539 20.5782 0.612855 20.1608 1.10671 20.1105L1.20716 20.1057H2.19444V5.90117H1.20716L1.10671 5.89639C0.645871 5.84947 0.279246 5.48284 0.232322 5.022L0.227539 4.92155V1.00306C0.227539 0.495932 0.612855 0.0785065 1.10671 0.0282208L1.20716 0.0234375H5.12565L5.2261 0.0282208ZM1.20716 25.0038H5.12565V21.0853H1.20716V25.0038ZM16.8811 25.0038H20.7996V21.0853H16.8811V25.0038ZM6.10527 3.20147V4.92155L6.10049 5.022C6.05357 5.48284 5.68694 5.84947 5.2261 5.89639L5.12565 5.90117H3.17406V20.1057H5.12565L5.2261 20.1105C5.71996 20.1608 6.10527 20.5782 6.10527 21.0853V22.8073H15.9015V21.0853C15.9015 20.5782 16.2868 20.1608 16.7807 20.1105L16.8811 20.1057H18.8442V5.90117H16.8811L16.7807 5.89639C16.3198 5.84947 15.9532 5.48284 15.9063 5.022L15.9015 4.92155V3.20147H6.10527ZM1.20716 4.92155H5.12565V1.00306H1.20716V4.92155ZM16.8811 4.92155H20.7996V1.00306H16.8811V4.92155Z",fill:eb.Tj.iconBrand}),(0,n.jsx)("path",{d:"M7.39116 8.45953C7.62267 8.28138 7.92476 8.21392 8.21343 8.28179L12.0259 9.17828V9.17926L12.2076 9.22613C13.9005 9.71089 15.0432 11.2703 15.0259 13.0045L15.4644 13.4429C15.8466 13.8255 15.8467 14.4452 15.4644 14.8277L12.8267 17.4654C12.4442 17.8478 11.8245 17.8476 11.4419 17.4654L11.0035 17.0269C9.26918 17.0443 7.70984 15.9015 7.22514 14.2086L7.17827 14.0269H7.17729L6.28081 10.2144C6.20316 9.88421 6.30267 9.53728 6.54253 9.29742L7.29643 8.54351L7.39116 8.45953ZM7.95952 9.26519L10.1744 11.481C10.4208 11.3465 10.703 11.2691 11.0035 11.2691L11.1802 11.2779C12.0543 11.3666 12.7369 12.105 12.7369 13.0025C12.7367 13.9595 11.9605 14.7357 11.0035 14.7359C10.106 14.7358 9.36756 14.0533 9.27885 13.1793L9.27007 13.0025L9.27885 12.8248C9.30267 12.5907 9.37346 12.3705 9.481 12.1734L7.26616 9.95855L7.23491 9.9898L8.13139 13.8023C8.4771 15.2707 9.88699 16.2325 11.3804 16.0191L12.1343 16.773L14.772 14.1353L14.0181 13.3814C14.2314 11.888 13.2696 10.4781 11.8013 10.1324L7.98882 9.2359L7.95952 9.26519ZM11.0035 12.2486C10.5873 12.2487 10.2496 12.5863 10.2496 13.0025C10.2497 13.3926 10.5464 13.7139 10.9263 13.7525L11.0035 13.7564C11.3934 13.7562 11.7147 13.4594 11.7535 13.0796L11.7574 13.0025C11.7574 12.5863 11.4196 12.2488 11.0035 12.2486Z",fill:eb.Tj.iconBrand})]})}var sB=s(12908);function sV({showAiBetaBadge:e}){return(0,n.jsx)("div",{className:"xh8yej3 x78zum5 x87ps6o",children:(0,n.jsx)(sB.Wv,{titleTx:(0,_.tx)("living_designs.chat.default_title"),children:e?(0,n.jsx)(eJ.yi,{helpUrlVariant:eZ.JT.CODE_CHAT}):null})})}var s$=s(57712),sW=s(12484),sY=s(270351),sX=s(933870),sZ=s(605985),sJ=s(919530),sQ=s(316833);function s0({onCopy:e}){let[t,s]=(0,a.useState)(!1);return(0,n.jsx)(ep.$n,{onClick:()=>{e(),s(!0),setTimeout(()=>{s(!1)},1e3)},iconPrefix:t?(0,n.jsx)(sJ.g,{}):(0,n.jsx)(sQ.h,{}),variant:"ghost",children:(0,_.t)("figmake.chat.copy")})}var s1=s(253386),s5=s(190809);let s2={messageContent:{k1xSpc:"x78zum5",kaIpWk:"x1m3ak92",k8WAf4:"x1m7iz9m",kg3NbH:"xaope02",kWkggS:"x1v8gsql",kfSwDN:"x1hx0egp",khDVqt:"x126k92a",kTgw9:"x13faqbe",kkrTdU:"x1ed109x",$$css:!0}};function s3({user:e,featureType:t,plainText:s,imports:r=[],inspectedElement:l,inspectedComponent:o,inspectedLibrary:c,selectedNodeIds:d}){let{userMessageTypographyStyle:u}=(0,s1.L)(t),x=s.trim(),m=(0,sZ.iZ)(),p=m?.id===e.id?(0,_.t)("file_browser.request_access_modal.you",{username:e.name??e.handle}):e.name??e.handle,h=t===i.lV.AI_ASSISTANT&&d&&d.length>0&&!l,g=(0,I.eY)(),f=(0,a.useMemo)(()=>d&&Array.isArray(d)?d.map(e=>(0,T.Zl)(g,e)).filter(e=>null!==e):[],[d,g]),y=(0,s5.N)(),v=e=>{y(e)},b=(0,a.useRef)(null),[j,C]=(0,a.useState)(!1),[w,E]=(0,a.useState)(!1),N=tU.v.getFeatureGate("make_user_msg_actions"),S=(0,a.useMemo)(()=>()=>{navigator.clipboard.writeText(x)},[x]);return(0,a.useLayoutEffect)(()=>{if(b.current){let e=b.current,t=getComputedStyle(e),s=parseFloat(t.lineHeight),n=parseFloat(t.paddingTop),a=parseFloat(t.paddingBottom);C(1===Math.round((e.clientHeight-n-a)/s))}},[x]),(0,n.jsx)("div",{role:"region","aria-label":(0,_.t)("figmake.chat.artifact.a11y_prompt_section_title",{user:e.name??e.handle}),className:"x1eaahee x1n2onr6",children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x167g77z x13a6bvl","data-testid":"user-chat-message",children:[(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x167g77z xuk3077 x1n2onr6",children:[l&&l.tagName?(0,n.jsx)(tR,{variant:"chat",tagName:l.tagName}):o&&o.tagName?(0,n.jsx)(tR,{variant:"chat",tagName:o.tagName,iconType:"component"}):c&&c.libraryName?(0,n.jsx)(tR,{variant:"chat",tagName:c.libraryName,iconType:"library"}):null,h?(0,n.jsx)(tq,{nodes:f,variant:"chat"}):null,r.length>0?(0,n.jsx)("div",{className:"x78zum5 x1q0g3np x167g77z x1a02dak x13a6bvl",children:r.map(e=>(0,n.jsx)(sx.s,{pastedDesignNodeId:e.guid,onClick:()=>v(e.guid),attachmentType:(0,tQ.yM)(e)},e.guid))}):null,(0,n.jsxs)("div",{ref:b,...k.Ay.props(s2.messageContent,u),onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),children:[x,N&&(0,n.jsx)("div",{...{0:{className:"x10l6tqk x19up5dg x130t2gz x78zum5 x6s0dn4 xg2d0mh x1yjdb4r xhpnuu7 xtuhdl6 xt9pc3i xpka0n7 xg01cxk x1bvilyr x47corl x6o7n8i x13dflua x9lcvmn"},1:{className:"x10l6tqk x19up5dg x130t2gz x78zum5 x6s0dn4 xg2d0mh x1yjdb4r xhpnuu7 xtuhdl6 xt9pc3i xpka0n7 x6o7n8i x13dflua x9lcvmn x1hc1fzr xnn1q72 x67bb7w"}}[!!w<<0],children:(0,n.jsx)(s0,{onCopy:S})})]})]}),(0,n.jsx)("div",{...{0:{className:"xpvyfi4 x1ty9z65"},1:{className:"x1ty9z65 xamitd3"}}[!!j<<0],"data-tooltip-type":eX.Ib.TEXT,"data-tooltip":p,"data-tooltip-offset-y":4,children:(0,n.jsx)(e9.H8,{user:e})})]})})}var s4=s(346524),s6=s(269751),s7=s(803267),s8=s(800307);function s9({option:e,isSelected:t,onClick:s}){let{isDisabled:i,getBackgroundColor:r}=function(e){let t="failed"===e.status||"pending"===e.status||e.isLoading||e.isDisabled,s=a.useCallback(()=>"failed"===e.status?eb.Tj.bgTertiary:t?eb.Tj.bgSecondary:e.backgroundColor||eb.Tj.bgSecondary,[e.status,e.backgroundColor,t]);return{isDisabled:t,getBackgroundColor:s}}(e),l={backgroundColor:r()};return(0,n.jsxs)("button",{...{0:{className:"x1n2onr6 xh8yej3 x5yr21d x1y5e3q9 x98rzlu x19y5rnk x1qgsegg x1g40iwv xaatb59 x7w0sw3 x1717udv xt0e3qv x1s07b3s x1v8gsql xb3r6kr x2lah0s"},4:{className:"x1n2onr6 xh8yej3 x5yr21d x1y5e3q9 x98rzlu x19y5rnk xaatb59 x1717udv xt0e3qv x1s07b3s x1v8gsql xb3r6kr x2lah0s x1beg8kv x1wfwxd8 x1de99jn"},2:{className:"x1n2onr6 xh8yej3 x5yr21d x1y5e3q9 x98rzlu x19y5rnk x1qgsegg x1g40iwv xaatb59 x7w0sw3 x1717udv x1v8gsql xb3r6kr x2lah0s x1h6gzvc x197sbye x1xfd4ba"},6:{className:"x1n2onr6 xh8yej3 x5yr21d x1y5e3q9 x98rzlu x19y5rnk xaatb59 x1717udv x1v8gsql xb3r6kr x2lah0s x1beg8kv x1wfwxd8 x1de99jn x1h6gzvc x197sbye x1xfd4ba"},1:{className:"x1n2onr6 xh8yej3 x5yr21d x1y5e3q9 x98rzlu x19y5rnk x1qgsegg x1g40iwv xaatb59 x7w0sw3 x1717udv xt0e3qv x1s07b3s x1v8gsql xb3r6kr x2lah0s x1fzvlhx"},5:{className:"x1n2onr6 xh8yej3 x5yr21d x1y5e3q9 x98rzlu x19y5rnk xaatb59 x1717udv xt0e3qv x1s07b3s x1v8gsql xb3r6kr x2lah0s x1beg8kv x1wfwxd8 x1de99jn x1fzvlhx"},3:{className:"x1n2onr6 xh8yej3 x5yr21d x1y5e3q9 x98rzlu x19y5rnk x1qgsegg x1g40iwv xaatb59 x7w0sw3 x1717udv x1v8gsql xb3r6kr x2lah0s x1h6gzvc x197sbye x1fzvlhx"},7:{className:"x1n2onr6 xh8yej3 x5yr21d x1y5e3q9 x98rzlu x19y5rnk xaatb59 x1717udv x1v8gsql xb3r6kr x2lah0s x1beg8kv x1wfwxd8 x1de99jn x1h6gzvc x197sbye x1fzvlhx"}}[!!t<<2|!!i<<1|!("failed"!==e.status)<<0],onClick:s,disabled:i,type:"button","aria-label":e.alt||`Option ${e.id}`,title:"failed"===e.status?`Failed: ${e.error?.message||"Unknown error"}`:e.isDisabled?(0,_.t)("ai_assistant.multiple_options.option_not_available"):void 0,children:[e.thumbnailUrl?(0,n.jsx)(eM.oW,{className:"xh8yej3 x5yr21d x192jxwq x19kjcj4",src:e.thumbnailUrl,alt:e.alt||`Option ${e.id}`}):(0,n.jsx)("div",{className:"xh8yej3 x5yr21d x192jxwq",style:l}),"pending"===e.status&&(0,n.jsx)("div",{className:"x10l6tqk x13vifvy xu96u03 x3m8u43 x1ey2m1c x192jxwq x78zum5 x6s0dn4 xl56j7k x1v8gsql",children:(0,n.jsx)(eO.k,{size:"sm"})}),"failed"===e.status&&(0,n.jsx)("div",{className:"x10l6tqk x13vifvy xu96u03 x3m8u43 x1ey2m1c x192jxwq x78zum5 x6s0dn4 xl56j7k x1v79ifo x1vjfegm",children:(0,n.jsx)("div",{className:"x1pvqxga x1quhyk7",children:(0,n.jsx)(e_.e,{})})}),"thumbnail-generating"===e.status&&(0,n.jsx)("div",{className:"x10l6tqk x13vifvy xu96u03 x3m8u43 x1ey2m1c x192jxwq x78zum5 x6s0dn4 xl56j7k x1531fpn xhtitgo",children:(0,n.jsx)(eO.k,{size:"sm"})})]})}function ne({selectedOptionThumbnailUrl:e,selectedOptionId:t}){if(!t)return null;let s="original"===t;return(0,n.jsxs)("div",{className:"x1vqgdyp x9f619 x78zum5 x1q0g3np x1qughib x6s0dn4 x1nfngrj xmkeg23 x1y0btm7 x1mxnbhz x7z60cl xf7z5ut",children:[(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 xg2d0mh",children:[(0,n.jsx)(s8.u,{}),(0,n.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1uhho1l",children:s?(0,_.t)("ai_assistant.multiple_options.original_design_kept"):(0,_.t)("ai_assistant.multiple_options.option_applied")})]}),!s&&e&&(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k xvy4d1p xxk0z11 x1v8gsql x19y5rnk x19kjcj4 xmkeg23 x1y0btm7 x7z60cl xb3r6kr",children:(0,n.jsx)(eM.oW,{className:"xxk0z11 x1j14ogj x19kjcj4",src:e})})]})}function nt({selectedId:e,onSelectionChange:t,onContinue:s,options:a}){let i;return e&&t&&(i=(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 x1v2ro7d x1mh6rdz",children:[(0,n.jsx)("div",{className:"x146b8cn",children:(0,n.jsx)(ep.$n,{variant:"secondary",onClick:()=>{t("original"),s()},children:(0,_.t)("ai_assistant.multiple_options.cancel")})}),(0,n.jsx)("div",{className:"x146b8cn",children:(0,n.jsx)(ep.$n,{variant:"primary",onClick:()=>s(),children:(0,_.t)("ai_assistant.multiple_options.choose_option")})})]})),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1nfngrj xmkeg23 x1y0btm7 x1mxnbhz x7z60cl xf7z5ut",children:[(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 x1nfngrj",children:[(0,n.jsxs)("div",{id:"header-left",className:"x78zum5 x1q0g3np xl56j7k x6s0dn4 xg2d0mh",children:[(0,n.jsx)("div",{children:(0,n.jsx)(s8.u,{})}),(0,n.jsx)("div",{children:(0,_.t)("ai_assistant.multiple_options.user_prompt")})]}),!1]}),(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 x1v2ro7d xnfn54o x1057jvv x1ah0xmj",children:a.map(s=>(0,n.jsx)(s9,{option:s,isSelected:e===s.id,onClick:()=>!s.isLoading&&t?.(s.id)},s.id))}),!!i&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"x178xt8z x13fuv20 x16ufvko x1vi7shn x5es7k4 x9aucu1"}),i]})]})}s(899543);var ns=s(820857),nn=s(795867),na=s(582902),ni=s(574257),nr=s(724674),nl=s(236883),no=s(256536),nc=s(157750);function nd(e){let t=a.useCallback(()=>{ej.glU?.findMissingFontsAndShowPopoverWithScope(ej.vhv.CURRENT_PAGE)},[]),s=(0,nc.ut)(ej.Ez5?.uiState().showMissingFontsButton,!1);return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1nfngrj",children:[(0,n.jsx)("div",{className:"x1ed109x x1hx0egp xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up",children:e.message}),(0,n.jsx)("div",{className:"x1ed109x x1hx0egp xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up",children:(0,_.t)("ai_assistant.missing_fonts_explanation")}),(0,n.jsxs)("div",{className:"x78zum5 x1nfngrj x7hzu26",children:[s&&(0,n.jsx)(ep.$n,{variant:"secondary",onClick:t,children:(0,_.t)("ai_assistant.resolve_fonts")}),(0,n.jsx)(ep.$n,{variant:"primary",onClick:e.onContinue,children:s?(0,_.t)("ai_assistant.missing_fonts_continue_anyway"):(0,_.t)("ai_assistant.missing_fonts_continue")})]})]})}var nu=s(349051),nx=s(351298),nm=s(850465),np=s(536378),nh=s(245814),ng=s(655793),nf=s(517478),n_=s(665477);let ny=(0,s(747079).Ju)(function(e){let t=nh.hS({open:e.open,onClose:e.onClose}),s=(0,eo.wA)(),i=a.useCallback(()=>{s(n_.L({fileKey:e.fileKey,restoreVersionId:e.restoreVersionId,trackingContext:e.trackingContext})),s((0,np.Lo)())},[s,e.fileKey,e.restoreVersionId,e.trackingContext]);return(0,n.jsx)(ng.bL,{manager:t,width:"lg",children:(0,n.jsxs)(nf.vo,{children:[(0,n.jsx)(nf.Y9,{children:(0,n.jsx)(nf.hE,{children:(0,_.tx)("ai_assistant.restore.warning.header")})}),(0,n.jsx)(nf.nB,{children:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1rjybxy",children:[(0,n.jsx)("div",{children:(0,_.tx)("ai_assistant.restore.warning.body")}),(0,n.jsx)("div",{children:(0,_.tx)("ai_assistant.restore.warning.are_you_sure")})]})}),(0,n.jsx)(nf.wi,{children:(0,n.jsxs)(nf.jk,{children:[(0,n.jsx)(ep.$n,{variant:"secondary",onClick:()=>s((0,np.Lo)()),children:(0,_.tx)("ai_assistant.restore.warning.cancel")}),(0,n.jsx)(ep.$n,{variant:"primary",type:"submit",onClick:i,htmlAttributes:{"data-testId":"restore-version-confirm-button"},children:(0,_.tx)("ai_assistant.restore.warning.confirm")})]})})]})})},"assistant_restore_warning_modal");function nk({fileKey:e,trackingContext:t}){let s=(0,eo.wA)(),a=(0,y.md)((0,nm.wc)(t.clientLifecycleId)),i=(0,y.md)((0,nm.ru)(t.clientLifecycleId)),r=(0,y.md)(nm.fC);return!(0,nx.xj)(a)||r&&a.value.restoreVersionId===r?null:(0,nx.Mx)(i)?(0,n.jsx)(eO.k,{}):(0,n.jsx)("div",{className:"xmauxvm x1k89kn4 x3qs9px",children:(0,n.jsx)(u.K,{"aria-label":(0,nx.xj)(i)?(0,_.t)("ai_assistant.restore.restored_tooltip"):(0,_.t)("ai_assistant.restore.tooltip"),disabled:(0,nx.xj)(i),onClick:()=>{if(!(0,nx.xj)(a)){console.warn("No valid savepoint available for restore");return}if((0,nx.Mx)(i)){console.warn("Restore already in progress");return}s((0,np.to)({type:ny,data:{fileKey:e,restoreVersionId:a.value.restoreVersionId,trackingContext:t}}))},"data-testid":"assistant-chat-restore-button",children:(0,n.jsx)(nu.I,{})})})}var nv=s(256065);function nb(e){let t=(0,T.O1)(),s=t.map(e=>e.id),a=1===s.length?s[0]:null,i=t.length>0,r=1===t.length?t[0]:null,l=i?r&&r.type?tA(r.type):tA("FRAME"):nv.H;return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1nfngrj",children:[(0,n.jsx)("div",{className:"x1ed109x x1hx0egp xrlp15q x1nmd3yn xm735u9 x37zpob x3wk4up x1akne3o",children:e.message}),(0,n.jsxs)("div",{className:"x78zum5 x6s0dn4 x1nfngrj xvxsjr2 xjbqb8w xmkeg23 x1y0btm7 x7z60cl x1mxnbhz x7hzu26",children:[(0,n.jsxs)("div",{className:"x78zum5 x6s0dn4 x1nfngrj x98rzlu",children:[(0,n.jsx)(l,{}),(0,n.jsx)("div",{className:"xrlp15q x1nmd3yn x1s688f xkbmbem x3wk4up x98rzlu x1quhyk7",children:i?s&&s.length>1?(0,_.t)("ai_assistant.selected_layers_count",{count:s.length}):r?.name||(0,_.t)("ai_assistant.selected_layer"):(0,_.t)("ai_assistant.no_layers_selected")})]}),(0,n.jsx)("div",{className:"x2lah0s",children:i&&(0,n.jsx)(ep.$n,{variant:"primary",onClick:()=>{let t=a?[a]:s||[];e.onContinue(t)},children:(0,_.t)("ai_assistant.continue")})})]})]})}var nj=s(231349);let nC=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24L",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M14.5 5a6.5 6.5 0 1 1 0 13h-5A6.5 6.5 0 0 1 3 11.5v-5A1.5 1.5 0 0 1 4.5 5zm-10 1-.1.01a.5.5 0 0 0-.4.49v5a5.5 5.5 0 0 0 5.217 5.493L9.5 17h5a5.5 5.5 0 0 0 .283-10.993L14.5 6zM8 10.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2m4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2m4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"})})});function nw({header:e,body:t,bodyVerticalPadding:s="default",withDivider:a=!0}){return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xkh2ocl x9h44rk xmkeg23 x1y0btm7 x7z60cl xeuugli xb3r6kr",children:[(0,n.jsx)("div",{className:"x78zum5 xkh2ocl x1y1aw1k xy13l1i xwib8y2 x163pfp",children:e}),t&&(0,n.jsxs)(n.Fragment,{children:[a&&(0,n.jsx)(tn.cG,{}),(0,n.jsx)("div",{...{0:{className:"x78zum5 xkh2ocl x1y1aw1k xy13l1i xwib8y2 x163pfp xeuugli"},2:{className:"x78zum5 xkh2ocl xy13l1i x163pfp xeuugli xexx8yu x18d9i69"},1:{className:"x78zum5 xkh2ocl xy13l1i xwib8y2 x163pfp xeuugli xexx8yu"},3:{className:"x78zum5 xkh2ocl xy13l1i x163pfp xeuugli x18d9i69 xexx8yu"}}[!("none"!==s)<<1|!("remove-top"!==s)<<0],children:t})]})]})}function nE(e){return String.fromCharCode(65+e)}function nN({toolCallId:e,toolName:t,question:s,options:a,disabledStatus:r,toolResult:l}){let o=(0,sZ.iZ)(),c=(0,y.md)(F.PD),d=(0,y.md)(F.f4);if(!a||0===a.length){let e=l?.result?.isChatBoxUserResponse===!0,t=e?l?.result?.message:null;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(nw,{header:(0,n.jsx)(nI,{question:s,showQuestionLabel:!0}),bodyVerticalPadding:"remove-top",withDivider:!1}),e&&t&&o&&(0,n.jsx)(s3,{user:o,featureType:i.lV.FIGMAKE,plainText:t})]})}{let u=d[e],x=!!u;if(x||r===nj.VD.TOOL_CALL_SUCCESS){let r=x?{toolCallId:e,toolName:t,result:u}:l,c=r?.result?.isChatBoxUserResponse===!0,d=c?r?.result?.message:null;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(nw,{header:(0,n.jsx)(nI,{question:s}),body:(0,n.jsx)(nS,{toolResult:r,options:a}),bodyVerticalPadding:"remove-top",withDivider:!1}),c&&d&&o&&(0,n.jsx)(s3,{user:o,featureType:i.lV.FIGMAKE,plainText:d})]})}if(c?.toolCallId===e){let t=!!d[e];return(0,n.jsx)(nw,{header:(0,n.jsx)(nI,{question:s}),body:(0,n.jsx)(nT,{hasSubmitted:t,options:a}),bodyVerticalPadding:"remove-top",withDivider:!1})}return(0,n.jsx)(nw,{header:(0,n.jsx)(nI,{question:s}),body:(0,n.jsx)(nA,{toolCallId:e,toolName:t,options:a}),bodyVerticalPadding:"remove-top",withDivider:!1})}}function nS({toolResult:e,options:t}){let s=a.useMemo(()=>e?.result?.isChatBoxUserResponse?(0,_.t)("figmake.ask_question.cta.collapsed.custom_response"):e?.result?.message||"",[e]),i=a.useMemo(()=>{if(!t||0===t.length||e?.result?.isChatBoxUserResponse)return -1;let s=e?.result?.message;return t.findIndex(e=>e===s)},[e,t]);return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xh8yej3 x1a2a7pz",children:(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xh8yej3",children:(0,n.jsx)("div",{className:"xuzfeq1 x8yk33q x1e00guj x17fgdl5 xreldp6 x78zum5 x6s0dn4 x1qughib xt9pc3i xapmr0x x1yjdb4r x1n0bwc9 xtlvio2 x5y9vh5 xv0k7do xc342km x1sxf85j xdpxx8g xeaf4i8 x13faqbe x1ypdohk x1s07b3s x1hc1fzr xijokvz x1ah0xmj",children:(0,n.jsxs)("span",{className:"xuzfeq1 x8yk33q x1e00guj x17fgdl5 xreldp6 x78zum5 x1q0g3np x6s0dn4 xxhr3t x98rzlu",children:[(0,n.jsx)("span",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x78zum5 x6s0dn4 xl56j7k xw4jnvo x1qx5ct2 x1sxf85j xmkeg23 x1y0btm7 x17qaar8 x2lah0s x1va2ikv x1quhyk7",children:nE(i)}),s]})})})})}function nT({hasSubmitted:e,options:t}){let s=e?(0,_.t)("figmake.ask_question.cta.collapsed.custom_response"):(0,_.t)("figmake.ask_question.cta.awaiting_custom_response"),a=t?.length||0;return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xh8yej3 x1a2a7pz",children:(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xh8yej3",children:(0,n.jsx)("div",{className:"xuzfeq1 x8yk33q x1e00guj x17fgdl5 xreldp6 x78zum5 x6s0dn4 x1qughib xt9pc3i xapmr0x x1yjdb4r x1n0bwc9 xtlvio2 x5y9vh5 xv0k7do xc342km x1sxf85j xdpxx8g xeaf4i8 x13faqbe x1ypdohk x1s07b3s x1hc1fzr xijokvz x1ah0xmj",children:(0,n.jsxs)("span",{className:"xuzfeq1 x8yk33q x1e00guj x17fgdl5 xreldp6 x78zum5 x1q0g3np x6s0dn4 xxhr3t x98rzlu",children:[(0,n.jsx)("span",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x78zum5 x6s0dn4 xl56j7k xw4jnvo x1qx5ct2 x1sxf85j xmkeg23 x1y0btm7 x17qaar8 x2lah0s x1va2ikv x1quhyk7",children:nE(a)}),s]})})})})}function nI({question:e,showQuestionLabel:t=!1}){return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1cy8zhl x1nhvcw1 xh8yej3 x1nfngrj xilkfi8 x1cmmqis",children:[(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k x2lah0s xr9ek0c",children:(0,n.jsx)(nC,{})}),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1cy8zhl xg2d0mh x98rzlu",children:[t&&(0,n.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1quhyk7",children:(0,_.t)("figmake.ask_question.cta.question_label")}),(0,n.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:e})]})]})}function nA({toolCallId:e,toolName:t,options:s}){let i=(0,e4.S)(),[r,l]=(0,a.useState)(!1),[o,c]=(0,a.useState)(!1),d=(0,y.Xr)(F.PD),u=(0,y.md)(F.PD),x=(0,y.Xr)(F.f4),m=(0,y.md)(F.oy),p=(0,a.useRef)(null),h=a.useMemo(()=>s&&s.length>0?s:[],[s]),g=a.useMemo(()=>0===h.length?[]:[...h,(0,_.t)("figmake.ask_question.cta.add_custom_response")],[h]),[f,v]=(0,a.useState)(0),b=(0,a.useRef)(!1),j=g.length,C=h.length,w=(0,a.useCallback)(e=>{b.current=!0,v(e),p.current&&p.current.focus()},[]),E=(0,a.useCallback)(s=>{if(r)return;l(!0);let n={success:!0,message:s};x({toolCallId:e,toolResult:n}),i({toolCallId:e,toolName:t,toolResult:n})},[r,e,t,x,i]),N=(0,a.useCallback)(()=>{!r&&(c(!0),d({toolCallId:e,toolName:t}),m&&m.focus())},[r,e,t,m,d]);return((0,a.useEffect)(()=>{if(o||0===j)return;let e=p.current;if(!e)return;let t=e=>{if(!r)switch(e.key){case"ArrowDown":e.preventDefault(),b.current=!0,v(e=>(e+1)%j);break;case"ArrowUp":e.preventDefault(),b.current=!0,v(e=>(e-1+j)%j);break;case"Enter":e.preventDefault(),v(e=>{if(e===C)N();else if(e>=0&&e<h.length){let t=h[e];t&&E(t)}return e})}};return e.addEventListener("keydown",t),e.setAttribute("tabindex","0"),()=>{e.removeEventListener("keydown",t)}},[j,C,h,r,o,E,N]),(0,a.useEffect)(()=>{o&&!u&&c(!1)},[u,o]),0===h.length)?null:(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xh8yej3 x1a2a7pz",ref:p,children:(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xh8yej3",children:g.map((e,t)=>{let s=t===f,a=t===C;return(0,n.jsx)(eh.E,{onClick:()=>{a?N():E(e)},onMouseEnter:()=>w(t),disabled:r,className:k.Ay.classNames(nM.optionButton,s&&nM.optionButtonHighlighted),children:(0,n.jsxs)("span",{className:"xuzfeq1 x8yk33q x1e00guj x17fgdl5 xreldp6 x78zum5 x1q0g3np x6s0dn4 xxhr3t x98rzlu",children:[(0,n.jsx)("span",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x78zum5 x6s0dn4 xl56j7k xw4jnvo x1qx5ct2 x1sxf85j xmkeg23 x1y0btm7 x7z60cl x17qaar8 x1n0bwc9 x2lah0s",children:nE(t)}),e]})},t)})})})}let nM={optionButton:{kMv6JI:"xuzfeq1",kGuDYH:"x8yk33q",k63SB2:"x1e00guj",kLWn49:"x17fgdl5",kb6lSQ:"xreldp6",k1xSpc:"x78zum5",kGNEyG:"x6s0dn4",kjj79g:"x1qughib",kg3NbH:"xt9pc3i",kuDDbn:null,kE3dHu:null,kP0aTx:null,kpe85a:null,k8WAf4:"xapmr0x",kLKAdn:null,kGO01o:null,kWkggS:"x1yjdb4r",kMwMTN:"x1n0bwc9","--color-icon":"xtlvio2","--color-icon-secondary":"x5y9vh5","--color-icon-tertiary":"xv0k7do",kMzoRj:"xc342km",kjGldf:null,k2ei4v:null,kZ1KPB:null,ke9TFa:null,kWqL5O:null,kLoX6v:null,kEafiO:null,kt9PQ7:null,kaIpWk:"x1sxf85j",krdFHd:null,kfmiAY:null,kVL7Gh:null,kT0f0o:null,kIxVMA:null,ksF3WI:null,kqGeR4:null,kYm2EN:null,k9WMMc:"xdpxx8g",khDVqt:"xeaf4i8",kTgw9:"x13faqbe",kkrTdU:"x1ypdohk x1s07b3s",kSiTet:"x1hc1fzr xijokvz",k1K539:"x1ah0xmj",$$css:!0},optionButtonHighlighted:{kWkggS:"x1v8gsql","--color-icon":"xtlvio2","--color-icon-secondary":"x5y9vh5","--color-icon-tertiary":"xv0k7do",$$css:!0}};var nz=s(259714),nL=s(299823),nO=s(74122),nP=s(784616),nR=s(956819);function nD({text:e}){return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z xkh2ocl",children:[(0,n.jsx)("div",{className:"xvvfnsg",children:(0,n.jsx)(nP.r,{})}),(0,n.jsx)("div",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:e})]})}function nF({title:e,subtitle:t,interaction:s}){return(0,n.jsx)(nU,{icon:(0,n.jsx)(eO.k,{size:"md"}),title:e,subtitle:t,interaction:s})}function nq({title:e,subtitle:t,interaction:s}){return(0,n.jsx)(nU,{icon:(0,n.jsx)(nR.V,{}),title:e,subtitle:t,interaction:s})}function nG({title:e,subtitle:t,interaction:s}){return(0,n.jsx)(nU,{icon:(0,n.jsx)("div",{className:"x15edyk6",children:(0,n.jsx)(e_.e,{})}),title:e,subtitle:t,interaction:s})}function nU({icon:e,title:t,subtitle:s,interaction:a}){return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x167g77z xwib8y2 xkh2ocl",children:[(0,n.jsx)("div",{className:"x78zum5 x1cy8zhl xkh2ocl",children:e}),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1cy8zhl x167g77z xkh2ocl",children:[(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1cy8zhl xdpxx8g",children:[(0,n.jsx)("div",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:t}),(0,n.jsx)("div",{className:"xuzfeq1 x8yk33q x1e00guj x18zpg43 x22v61l x1n0bwc9",children:s})]}),a]})]})}function nK({dismissSupabase:e,trackingContext:t}){let s=(0,ta.wT)(),i=(0,A.tS)()||"",r=a.useCallback(()=>{(0,O.oU)({persistentEntityId:t.persistentEntityId,clientLifecycleId:t.clientLifecycleId},"toolCta",i),s()},[s,t.persistentEntityId,t.clientLifecycleId,i]),l=(0,er.g7)();return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xilkfi8 x1cmmqis",children:(0,n.jsx)(nq,{title:(0,_.t)("figmake.supabase.cta.list.account_connected"),subtitle:(0,_.t)("figmake.supabase.cta.auth.body_text"),interaction:(0,n.jsxs)("div",{className:"x78zum5 x167g77z",children:[(0,n.jsx)(ep.WW,{variant:l?"secondary":"primary",onClick:r,children:(0,_.t)("figmake.supabase.connect")}),(0,n.jsx)(ep.WW,{variant:"secondary",onClick:()=>e(),children:(0,_.t)("figmake.supabase.cancel")})]})})})}var nH=s(866401);function nB({toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:a}){let{organization:i}=(0,ta.mS)(),r=(0,eo.wA)();return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x167g77z xkh2ocl xilkfi8 x1cmmqis",children:[(0,n.jsx)(nD,{text:(0,_.t)("figmake.supabase.cta.list.account_connected")}),(0,n.jsx)(nD,{text:(0,_.t)("figmake.supabase.cta.list.org_connected",{org:i?.name??""})}),(0,n.jsx)(nq,{title:(0,_.t)("figmake.supabase.cta.connect_to_existing_projects.title"),subtitle:(0,_.t)("figmake.supabase.cta.connect_to_existing_projects.subtitle"),interaction:(0,n.jsxs)("div",{className:"x78zum5 x167g77z",children:[(0,n.jsx)(ep.WW,{variant:"primary",onClick:()=>{r((0,np.to)({type:nH.Z,data:{toolCallId:e,toolName:t,trackingContext:a,source:"toolCta"},showModalsBeneath:!0}))},children:(0,_.t)("figmake.supabase.cta.connect_to_existing_projects.button")}),(0,n.jsx)(ep.WW,{variant:"secondary",onClick:()=>s(),children:(0,_.t)("figmake.supabase.cancel")})]})})]})}function nV(){let{organization:e}=(0,ta.mS)(),{connectedProject:t}=(0,ta.GC)(),s=t?.name??"";return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x167g77z xkh2ocl xilkfi8 x1cmmqis",children:[(0,n.jsx)(nD,{text:(0,_.t)("figmake.supabase.cta.list.account_connected")}),(0,n.jsx)(nD,{text:(0,_.t)("figmake.supabase.cta.list.org_connected",{org:e?.name??""})}),(0,n.jsx)(nD,{text:(0,_.t)("figmake.supabase.cta.list.project_connected",{project:s})})]})}function n$(){let{organization:e}=(0,ta.mS)(),t=(0,y.md)(nO.Kj);if(!t||"connecting"!==t.state)return null;let s=t.project.name??"";return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x167g77z xkh2ocl xilkfi8 x1cmmqis",children:[(0,n.jsx)(nD,{text:(0,_.t)("figmake.supabase.cta.list.account_connected")}),(0,n.jsx)(nD,{text:(0,_.t)("figmake.supabase.cta.list.org_connected",{org:e?.name??""})}),(0,n.jsx)(nF,{title:(0,_.t)("figmake.supabase.cta.list.project_connecting",{project:s}),subtitle:(0,_.t)("figmake.supabase.cta.list.project_connecting.subtitle")})]})}var nW=s(59610);function nY({toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:a}){let{organization:i}=(0,ta.mS)(),r=(0,eo.wA)();return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x167g77z xkh2ocl xilkfi8 x1cmmqis",children:[(0,n.jsx)(nD,{text:(0,_.t)("figmake.supabase.cta.list.account_connected")}),(0,n.jsx)(nD,{text:(0,_.t)("figmake.supabase.cta.list.org_connected",{org:i?.name??""})}),(0,n.jsx)(nq,{title:(0,_.t)("figmake.supabase.cta.create_project.title"),subtitle:(0,_.t)("figmake.supabase.cta.create_project.subtitle"),interaction:(0,n.jsxs)("div",{className:"x78zum5 x167g77z",children:[(0,n.jsx)(ep.WW,{variant:"primary",onClick:()=>{r((0,np.to)({type:nW.AP,data:{toolCallId:e,toolName:t,trackingContext:a,source:"toolCta"},showModalsBeneath:!0}))},children:(0,_.t)("figmake.supabase.cta.create_project.button")}),(0,n.jsx)(ep.WW,{variant:"secondary",onClick:()=>s(),children:(0,_.t)("figmake.supabase.cancel")})]})})]})}function nX(){return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x167g77z xkh2ocl xl56j7k x6s0dn4 x1gcgh60 x1jwbysl xh8yej3",children:(0,n.jsx)(eO.k,{})})}function nZ({toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:i}){let{authenticated:r,authenticationExpired:l,connectedProject:o,existingProjects:c,isLoading:d}=(0,ta.zA)(),u=(0,y.Xr)(eQ.hR),x=(0,y.md)(nO.Kj);return(0,a.useEffect)(()=>{if(d){u(eQ.s8.LOADING);return}if(x&&"connecting"===x.state){u(eQ.s8.CONNECTING_TO_PROJECT);return}o?u(eQ.s8.CONNECTED_PROJECT):r&&c.length?u(eQ.s8.CONNECT_TO_EXISTING_PROJECTS):r&&!l?u(eQ.s8.CREATE_PROJECT):u(eQ.s8.AUTH)},[d,o,c,r,u,x,l]),(0,n.jsx)(nJ,{toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:i})}function nJ({toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:i}){let r=(0,y.md)(eQ.hR),l=(0,A.tS)()||"",o=a.useRef(!1);switch(a.useEffect(()=>{if(o.current)return;let e=(0,O.oR)({persistentEntityId:i.persistentEntityId,clientLifecycleId:i.clientLifecycleId},"toolCta",r,l);o.current=e},[r,i.persistentEntityId,i.clientLifecycleId,l]),r){case eQ.s8.AUTH:return(0,n.jsx)(nK,{dismissSupabase:s,trackingContext:i});case eQ.s8.CONNECTING_TO_PROJECT:return(0,n.jsx)(n$,{});case eQ.s8.CONNECT_TO_EXISTING_PROJECTS:return(0,n.jsx)(nB,{toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:i});case eQ.s8.CREATE_PROJECT:return(0,n.jsx)(nY,{toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:i});case eQ.s8.CONNECTED_PROJECT:return(0,n.jsx)(nV,{});case eQ.s8.LOADING:return(0,n.jsx)(nX,{})}}var nQ=s(751526);function n0({toolCallId:e,toolName:t,disabledStatus:s,dismissSupabase:a,trackingContext:i}){return s?(0,n.jsx)(nw,{header:(0,n.jsx)(n1,{disabledStatus:s})}):(0,n.jsx)(nw,{header:(0,n.jsx)(n5,{}),body:(0,n.jsx)(nZ,{toolCallId:e,toolName:t,dismissSupabase:a,trackingContext:i})})}function n1({disabledStatus:e}){let t=a.useMemo(()=>{switch(e){case nj.VD.TOOL_CALL_SUCCESS:return(0,_.t)("figmake.supabase.cta.collapsed.success");case nj.VD.TOOL_CALL_DISABLED:return(0,_.t)("figmake.supabase.cta.collapsed.disabled");case nj.VD.TOOL_CALL_PENDING:return(0,_.t)("figmake.supabase.cta.collapsed.pending");case nj.VD.TOOL_CALL_CANCELLED:default:return(0,_.t)("figmake.supabase.cta.collapsed.failure")}},[e]);return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,n.jsx)("div",{className:"xvy4d1p xxk0z11 x78zum5 xl56j7k x6s0dn4",children:(0,n.jsx)(nz.B,{svg:nQ.A,useOriginalSrcFills_DEPRECATED:!0,svgWidth:"14px",svgHeight:"14px"})}),(0,n.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:t})]})}function n5(){return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1qughib xh8yej3 xou54vl xilkfi8 x1cmmqis",children:[(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,n.jsx)("div",{className:"xvy4d1p xxk0z11 x78zum5 xl56j7k x6s0dn4",children:(0,n.jsx)(nz.B,{svg:nQ.A,useOriginalSrcFills_DEPRECATED:!0,svgWidth:"14px",svgHeight:"14px"})}),(0,n.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:(0,_.t)("figmake.supabase.cta.title")})]}),(0,n.jsx)(tn.jc,{url:nL.kS,linkText:(0,_.t)("figmake.supabase.cta.link")})]})}var n2=s(545414),n3=s(861793),n4=s(863412),n6=s(463838),n7=s(306809);function n8({toolCallId:e,toolName:t,disabledStatus:s,initialSecretName:a,dismissSupabase:i,trackingContext:r}){return s?(0,n.jsx)(nw,{header:(0,n.jsx)(n9,{disabledStatus:s,initialSecretName:a})}):(0,n.jsx)(nw,{header:(0,n.jsx)(ae,{}),body:(0,n.jsx)(at,{toolCallId:e,toolName:t,initialSecretName:a,dismissSupabase:i,trackingContext:r})})}function n9({initialSecretName:e,disabledStatus:t}){let s=a.useMemo(()=>{switch(t){case nj.VD.TOOL_CALL_SUCCESS:return(0,_.t)("figmake.supabase.create_secret_cta.collapsed.success",{secretName:e});case nj.VD.TOOL_CALL_DISABLED:return(0,_.t)("figmake.supabase.create_secret_cta.collapsed.disabled");case nj.VD.TOOL_CALL_CANCELLED:default:return(0,_.t)("figmake.supabase.create_secret_cta.collapsed.failure")}},[t,e]);return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,n.jsx)(n3.P,{}),(0,n.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:s})]})}function ae(){let{connectedProject:e}=(0,ta.GC)();return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1qughib xh8yej3 xou54vl",children:[(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,n.jsx)(n3.P,{}),(0,n.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:(0,_.t)("figmake.supabase.create_secret_cta.header")})]}),(0,n.jsx)(tn.jc,{url:(0,nL.C4)(e?.id),linkText:(0,_.t)("figmake.supabase.create_secret_cta.link")})]})}function at({toolCallId:e,toolName:t,initialSecretName:s,dismissSupabase:i,trackingContext:r}){let[l,o]=a.useState("init"),c=(0,n.jsx)(n4.G,{text:s,className:"x1i89z7r x1ey7xld x256u9z"});switch(l){case"init":return(0,n.jsx)(nq,{title:(0,_.tx)("figmake.supabase.create_secret_cta.body.title_secret_name",{secretName:c}),subtitle:(0,_.t)("figmake.supabase.create_secret_cta.body.subtitle"),interaction:(0,n.jsx)(an,{interactionState:l,setInterationState:o,toolCallId:e,toolName:t,initialSecretName:s,dismissSupabase:i,trackingContext:r})});case"loading":return(0,n.jsx)(nF,{title:(0,_.t)("figmake.supabase.create_secret_cta.body.loading.title"),subtitle:(0,_.t)("figmake.supabase.create_secret_cta.body.loading.subtitle")});case"success":return(0,n.jsx)(nD,{text:(0,_.t)("figmake.supabase.create_secret_cta.body.title")});case"failed":return(0,n.jsx)(nG,{title:(0,_.tx)("figmake.supabase.create_secret_cta.body.error.title_secret_name",{secretName:c}),subtitle:(0,_.t)("figmake.supabase.create_secret_cta.body.error.subtitle"),interaction:(0,n.jsx)(an,{interactionState:l,setInterationState:o,toolCallId:e,toolName:t,initialSecretName:s,dismissSupabase:i,trackingContext:r})})}}var as=(e=>(e.INIT="init",e.LOADING="loading",e.SUCCESS="success",e.FAILED="failed",e))(as||{});function an({interactionState:e,setInterationState:t,toolCallId:s,toolName:i,initialSecretName:r,dismissSupabase:l,trackingContext:o}){let[c,d]=a.useState(""),u=(0,A.tS)(),x="loading"===e,m=(0,e4.S)(),p=async()=>{if(!u){console.error("No open file key found");return}t("loading");try{await n6.R.createSecret({fileKey:u,secretName:r,secretValue:c}),(0,O.XJ)(o,u)}catch(e){t("failed"),(0,n7.fQ)(e);return}t("success"),m({toolCallId:s,toolName:i,toolResult:{success:!0,message:`Successfully created secret ${r}.`}})};return(0,n.jsxs)("form",{className:"x78zum5 xdt5ytf x1cy8zhl xl56j7k x167g77z xkh2ocl xy13l1i",children:[(0,n.jsx)(n2.p,{type:"password",id:"password",value:c,onChange:d,placeholder:(0,_.t)("figmake.supabase.create_secret_cta.body.secret_value"),size:"lg",disabled:x}),x?(0,n.jsx)(tn.lV,{variant:"primary",children:(0,_.t)("figmake.supabase.create_secret_cta.body.button")}):(0,n.jsxs)("div",{className:"x78zum5 x167g77z",children:[(0,n.jsx)(ep.WW,{type:"submit",variant:"primary",onClick:p,children:(0,_.t)("figmake.supabase.create_secret_cta.body.button")}),(0,n.jsx)(ep.WW,{variant:"secondary",onClick:()=>l(),children:(0,_.t)("figmake.supabase.cancel")})]})]})}var aa=s(836848),ai=s(255398),ar=s(6477),al=s(25300),ao=s(575015),ac=s(820198),ad=s(980343),au=s(153925),ax=s(833915);function am({text:e,onEditStart:t,onSaveEdits:s,isEditing:i,isReadOnly:r,status:l}){let[o,c]=a.useState(e),d=a.useRef(null),u=()=>{s(o.trim())};return a.useEffect(()=>{i&&d.current&&(c(e),d.current.focus())},[i,e]),(0,n.jsx)("div",{className:"x98rzlu x78zum5 x6s0dn4",children:(0,n.jsx)(ad.W,{...{0:{className:"xrlp15q x4z9k3i xm735u9 x1fc57z9 x3wk4up x1n0bwc9 xh8yej3 x18s2yiw xc342km xng3xce xjbqb8w x1717udv x16dsc37 x1ed109x x9f619 x10wlt62"},4:{className:"xrlp15q x4z9k3i xm735u9 x1fc57z9 x3wk4up x1n0bwc9 xh8yej3 x18s2yiw xc342km xng3xce xjbqb8w x1717udv x16dsc37 x9f619 x10wlt62 xt0e3qv"},2:{className:"xrlp15q x4z9k3i xm735u9 x1fc57z9 x3wk4up xh8yej3 x18s2yiw xc342km xng3xce xjbqb8w x1717udv x16dsc37 x1ed109x x9f619 x10wlt62 x1akne3o"},6:{className:"xrlp15q x4z9k3i xm735u9 x1fc57z9 x3wk4up xh8yej3 x18s2yiw xc342km xng3xce xjbqb8w x1717udv x16dsc37 x9f619 x10wlt62 xt0e3qv x1akne3o"},1:{className:"xrlp15q x4z9k3i xm735u9 x1fc57z9 x3wk4up x1n0bwc9 xh8yej3 x18s2yiw xc342km xng3xce xjbqb8w x1717udv x16dsc37 x1ed109x x9f619 x10wlt62 xmqliwb x11dwbv0"},5:{className:"xrlp15q x4z9k3i xm735u9 x1fc57z9 x3wk4up x1n0bwc9 xh8yej3 x18s2yiw xc342km xng3xce xjbqb8w x1717udv x16dsc37 x9f619 x10wlt62 xt0e3qv xmqliwb x11dwbv0"},3:{className:"xrlp15q x4z9k3i xm735u9 x1fc57z9 x3wk4up xh8yej3 x18s2yiw xc342km xng3xce xjbqb8w x1717udv x16dsc37 x1ed109x x9f619 x10wlt62 x1akne3o xmqliwb x11dwbv0"},7:{className:"xrlp15q x4z9k3i xm735u9 x1fc57z9 x3wk4up xh8yej3 x18s2yiw xc342km xng3xce xjbqb8w x1717udv x16dsc37 x9f619 x10wlt62 xt0e3qv x1akne3o xmqliwb x11dwbv0"}}[!!(!i||r)<<2|!("in_progress"!==l)<<1|!("done"!==l)<<0],ref:d,"aria-label":(0,_.t)("figmake.chat.new_todo_input"),expandable:!0,onBlur:i?u:void 0,onChange:i?c:void 0,onFocus:()=>{i||r||t()},onKeyDown:i?e=>{"Escape"===e.key&&(e.preventDefault(),u()),"Enter"!==e.key||e.shiftKey||(e.preventDefault(),u())}:void 0,readOnly:!i||r,rows:1,value:i?o:e})})}function ap({icon:e,circleStyle:t}){return(0,n.jsxs)("div",{className:"x1n2onr6 x78zum5 x6s0dn4 xl56j7k xqcrz7y xvy4d1p xxk0z11",children:[(0,n.jsx)("div",{...k.Ay.props(ay.todoCircle,t)}),e]})}function ah({status:e,isRejected:t}){if(t)return(0,n.jsx)("div",{className:"x1n2onr6 x78zum5 x6s0dn4 xl56j7k xqcrz7y xvy4d1p xxk0z11",children:(0,n.jsx)(ap,{icon:(0,n.jsx)(tu.f,{className:"x1kky2od xlup9mm xmauxvm"})})});switch(e){case"todo":return(0,n.jsx)(ap,{});case"in_progress":return(0,n.jsx)(ap,{circleStyle:ay.todoCircleInProgress,icon:(0,n.jsx)(au.a,{className:"x10l6tqk xsmyaan x1kpxq89"})});case"done":return(0,n.jsx)(ap,{icon:(0,n.jsx)(ax.l,{className:"x10l6tqk xsmyaan x1kpxq89 xmauxvm"})});default:(0,aa.xb)(e)}}function ag({todo:e,onEditStart:t,onSaveEdits:s,onDelete:a,isEditing:i,isReadOnly:r,isRejected:l,todoRef:o}){return(0,n.jsxs)("div",{...{0:{className:"x78zum5 x1n2onr6 x1q0g3np xl56j7k xkh2ocl x6s0dn4 x1nfngrj xilkfi8 x1cmmqis xjbqb8w xv2f06h x1f11sc0 x19y5rnk xyj4381 x1mrdigs x1cdx3vg"},1:{className:"x78zum5 x1n2onr6 x1q0g3np xl56j7k xkh2ocl x6s0dn4 x1nfngrj xilkfi8 x1cmmqis x19y5rnk xyj4381 x1mrdigs x1cdx3vg xjbqb8w x87ps6o"}}[!!r<<0],ref:o,children:[(0,n.jsx)(ah,{status:e.status,isRejected:l}),(0,n.jsx)(am,{text:e.content,onEditStart:()=>t(e.id),onSaveEdits:t=>s(e.id,t),isEditing:i,isReadOnly:r,status:e.status},`${e.id}-editable-text`),!r&&!i&&(0,n.jsx)("div",{className:"x1fw8xb2 x5yr21d x10l6tqk x3m8u43 x1useyqa x78zum5 x1cy8zhl x13a6bvl x10pwc4n x19y5rnk",children:(0,n.jsx)(eh.E,{className:"x78zum5 x6s0dn4 xl56j7k xc342km xng3xce xjbqb8w x1717udv x10e2c7l x5hs570 x192jxwq",onClick:()=>a(e.id),"aria-label":(0,_.t)("figmake.chat.delete_todo_button"),"data-tooltip-type":eX.Ib.TEXT,"data-tooltip":(0,_.t)("figmake.chat.delete_todo_button"),"data-tooltip-hide-immediately":!0,children:(0,n.jsx)(te.A,{})})})]})}function af({todos:e,onEditStart:t,onSaveEdits:s,onDelete:a,isReadOnly:i,editingTodoId:r,isRejected:l,todoRef:o,scrollContainerRef:c}){let d=(0,n.jsx)(n.Fragment,{children:e.map((e,c)=>(0,n.jsx)(ag,{todo:e,onEditStart:t,onSaveEdits:s,onDelete:a,isReadOnly:i,isEditing:!!r&&r===e.id,isRejected:l,todoRef:o?.index===c?o.ref:void 0},e.id))});return(0,n.jsx)("div",{...k.Ay.props(ay.todoListWrapper,ay.todoListWrapperFade(eb.Tj.bg)),children:(0,n.jsx)("div",{ref:c,className:"x78zum5 xdt5ytf xg2d0mh xkh2ocl xh8yej3 x1vi7shn xp6roeo x13bm0uv x1odjw0f x185mbhu xjb0lab",children:d})})}let a_={kgeoSG:"x1cpjm7i",kEoFBp:"x1hmns74",k96MEf:"x1y3wzot",k75S9Q:"x1wlytlt",kLBHJ3:"xb0dqd5",kSJ0CW:"",koaPKo:"",kgzTxl:"x84k3j6",kB0Uj5:"x1i4no3d",kGFycz:"",k2irxo:"",kLkRvE:"",k3DiCg:"",khXQ3S:"",kuPSpR:"",kGZpU5:"",kDwdTO:"",kTP8oX:"",k836YN:"",km8f2m:"xkk1bqk",kxmVGU:"x12maryy",k5JduY:"x1s928wv",kwXMNM:"x1j6awrg",k8Iv0R:"x1xrz1ek",kH8cDV:"x17cx49",kLxBhq:"xnbfe2x",kc1e00:"",kH8aOt:"",k4zj60:"x1qzecn0",kiGxCN:"xhh15h2",kg3FMZ:"",kM2ZXO:"",ks3ayO:"",kNctxI:"",kJM1pu:"",kgUb28:"",k1b5ph:"",kVcwut:"",kIWj2l:"",kakxe6:"",kloYau:"x2q1x1w",kDVEDD:"xitxdhh",$$css:!0},ay={todoCircle:{kVAEAm:"x10l6tqk",kzqmXN:"x1kky2od",kZKoxP:"xlup9mm",kaIpWk:"x16rqkct",krdFHd:null,kfmiAY:null,kVL7Gh:null,kT0f0o:null,kIxVMA:null,ksF3WI:null,kqGeR4:null,kYm2EN:null,kMzoRj:"xmkeg23",kjGldf:null,k2ei4v:null,kZ1KPB:null,ke9TFa:null,kWqL5O:null,kLoX6v:null,kEafiO:null,kt9PQ7:null,kVAM5u:"x1dzeurx",kzOINU:null,kGJrpR:null,kaZRDh:null,kBCPoo:null,k26BEO:null,k5QoK5:null,kLZC3w:null,kL6WhQ:null,ksu8eU:"x1y0btm7",kJRH4f:null,kVhnKS:null,k4WBpm:null,k8ry5P:null,kSWEuD:null,kDUl1X:null,kPef9Z:null,kfdmCh:null,kB7OPa:"x9f619",$$css:!0},todoCircleInProgress:{kVAM5u:"x110w64q",kzOINU:null,kGJrpR:null,kaZRDh:null,kBCPoo:null,k26BEO:null,k5QoK5:null,kLZC3w:null,kL6WhQ:null,$$css:!0},todoListWrapper:{kVAEAm:"x1n2onr6",kSGwAc:"xkh2ocl",kzqmXN:"xh8yej3",$$css:!0},todoListWrapperFade:e=>[a_,{"--x-63pznm":`linear-gradient(to bottom, ${e}, transparent)`,"--x-4ad71l":`linear-gradient(to top, ${e}, transparent)`}]},ak=(0,ao.PN)()||window.INITIAL_OPTIONS.e2e_test_name?1:3;function av({status:e,remainingSeconds:t}){let s="pending"===e?(0,_.t)("figmake.chat.todos.auto_start_message",{seconds:t}):(0,_.t)("figmake.chat.todos.auto_start_message_cancelled");return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1qughib",children:[(0,n.jsx)("span",{className:"xrlp15q x4z9k3i xm735u9 xkbmbem x3wk4up x1n0bwc9",children:s}),"pending"===e&&(0,n.jsx)(eO.k,{size:"sm"})]})}let ab=(0,tH.Wh)(e=>(0,y.eU)(void 0));function aj({onAccept:e,todos:t,toolResult:s,isMostRecentMessage:i,toolCallId:r,todoStatusMap:l,isCurrentTodoList:o}){let c=a.useMemo(()=>tK.vn.safeParse(s?.result),[s]),d=c.success?c.data:void 0,[u,x]=(0,y.fp)(ab),m=function(){let e=(0,er.hk)(),{exchange:t}=(0,F.$W)(e?.guid);return void 0!==t&&t.messages.length>0}(),p=(0,y.Xr)(tY),h=(0,y.md)(t$(r)),g=(0,y.Xr)(tX),f=(0,er.hk)(),k=(0,eS.hC)(),j=(0,y.md)((0,F.Z3)(f?.guid)),C=j?.signal,w=(0,y.md)(F.PO),{todos:E,setTodos:N}=(0,ac.R1)({todoStatusMap:l,addTodosResult:d,toolCallId:r,editedTodosState:u,initialTodos:t}),S=d?.success===!0||h||l?"accepted":d?.success===!1?"rejected":void 0,[T,I]=a.useState(S?{status:"read-only",todoResult:S}:m&&i?{status:"pending"}:{status:"editing",editingTodoId:null}),A=(0,eI.ZC)(E),{completedTodoCount:M,isCompleted:z,hasStartedTodos:L,lastModifiedTodoIndex:O}=a.useMemo(()=>{let e,t=0,s=!1;for(let n=0;n<E.length;n++){let a=E[n];if(!a)continue;"done"===a.status&&++t,s=s||"todo"!==a.status;let i=A?.[n];i&&i.content===a.content&&i.status!==a.status&&(e=n)}return{completedTodoCount:t,isCompleted:E.length>0&&E.length===t,hasStartedTodos:s,lastModifiedTodoIndex:A&&E.length===A.length?e:void 0}},[E,A]),[P,R]=a.useState((i||o)&&!z);a.useEffect(()=>{S&&I({status:"read-only",todoResult:S}),(z||"rejected"===S)&&R(!1)},[z,S]),a.useEffect(()=>{if(!C)return;let e=()=>{h&&!s&&(g(r),I({status:"editing",editingTodoId:null}))};return C.addEventListener("abort",e),()=>{C.removeEventListener("abort",e)}},[C,h,s,r,g]);let D=a.useCallback(e=>{(0,aa.KF)("read-only"!==T.status,"You cannot edit a todo in read-only"),null===e&&k("figmake.todos_edit_button_clicked",{todoCount:E.length}),I({status:"editing",editingTodoId:e})},[T.status,k,E.length]),q=a.useCallback((e,t)=>{(0,aa.KF)("editing"===T.status,"We should already be in editing mode"),I({status:"editing",editingTodoId:null}),N(t?E.map(s=>(s.id===e&&(s.content=t),s)):E.filter(t=>t.id!==e))},[E,T.status,N]),G=a.useCallback(e=>{(0,aa.KF)("editing"===T.status,"You cannot delete a todo in read-only or rejected mode"),k("figmake.todos_delete_clicked",{todoCount:E.length-1}),I({status:"editing",editingTodoId:null}),N(E.filter(t=>t.id!==e))},[E,T.status,k,N]),U=a.useCallback(()=>{k("figmake.todos_add_clicked",{todoCount:E.length+1}),P||R(!0);let e={id:(0,ac.fk)(),content:"",status:"todo"};N([...E,e]),I({status:"editing",editingTodoId:e.id})},[E,P,k,N]),K=a.useCallback(()=>{if("read-only"===T.status)return;I({status:"read-only",todoResult:"accepted"}),p(r);let t=E.map(e=>e.content);e(t),x({toolCallId:r,todos:t})},[T.status,E,e,p,r,x]),H=w&&i,B=Math.max(0,ak-function(e){let[t,s]=a.useState(0);return a.useEffect(()=>{if(!e)return;let n=setTimeout(()=>s(t+1),1e3);return()=>clearTimeout(n)},[e,t]),t}(H&&!m&&"pending"===T.status));a.useEffect(()=>{H&&"pending"===T.status&&B<=0&&(k("figmake.todos_auto_accepted",{todoCount:E.length}),K())},[T.status,H,K,B,k,E.length]);let V=a.useRef(null),$=a.useRef(null);if(a.useEffect(()=>{if(void 0===O||!L||!V.current||!$.current)return;let e=V.current,t=$.current,s=e.offsetTop,n=s+e.offsetHeight,a=t.scrollTop,i=t.clientHeight;s<a?t.scrollTo({top:Math.max(0,s-4),behavior:"smooth"}):n>a+i&&t.scrollTo({top:n-i+4,behavior:"smooth"})},[O,L]),0===E.length)return null;let W=(0,n.jsx)(v.N,{initial:!1,children:P&&(0,n.jsxs)(b.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15,ease:"easeInOut"},className:"x78zum5 xdt5ytf xkh2ocl xh8yej3 x1ihwiht xm4efwp xb3r6kr",children:[(0,n.jsx)(af,{todos:E,onEditStart:D,onSaveEdits:q,onDelete:G,isReadOnly:"read-only"===T.status,editingTodoId:"editing"===T.status?T.editingTodoId:null,todoRef:void 0!==O?{index:O,ref:V}:void 0,scrollContainerRef:$}),"editing"===T.status&&(0,n.jsx)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1nfngrj xkh2ocl x1cmmqis xilkfi8 x1vi7shn xdmjnt8",children:(0,n.jsx)(ep.$n,{size:"lg",variant:"primary",onClick:K,children:(0,_.t)("figmake.todo_list.start_tasks_button")})})]})});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(nw,{bodyVerticalPadding:"none",withDivider:P,header:(0,n.jsx)(aC,{todoCount:E.length,completedTodoCount:M,onAddTodo:U,onEdit:()=>D(null),state:T,isExpanded:P,onToggleExpand:()=>R(e=>!e),isGenerating:m}),body:"pending"===T.status?(0,n.jsx)(eh.E,{type:"button",onClick:()=>D(null),className:"x1lliihq xh8yej3 x5hs570 x192jxwq",children:W}):W}),"pending"===T.status&&H&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1qughib",children:(0,n.jsx)("span",{className:"xrlp15q x4z9k3i xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,_.t)("figmake.chat.todos.click_anywhere_to_edit")})}),(0,n.jsx)(av,{status:T.status,remainingSeconds:B})]})]})}function aC({todoCount:e,completedTodoCount:t,isExpanded:s,onAddTodo:a,onEdit:i,onToggleExpand:r,state:l,isGenerating:o}){let c;let d="read-only"===l.status&&"rejected"===l.todoResult;"pending"===l.status?c=(0,n.jsx)(ep.$n,{variant:"secondary",onClick:i,children:(0,_.t)("figmake.todo_list.edit_button")}):"editing"===l.status&&(c=(0,n.jsx)(u.K,{variant:"ghost","aria-label":(0,_.t)("figmake.todo_list.add_todo_button"),onClick:a,children:(0,n.jsx)(ai.$,{})}));let x=o&&"pending"===l.status,m=(0,n.jsx)(tf.Z,{}),p=x?(0,n.jsx)(s7.N,{as:"span",noWrap:!1,children:(0,_.t)("figmake.todo_list.header_title_generating")}):(0,_.t)("figmake.todo_list.header_title"),h=t===e,g=!x&&(0,n.jsxs)("span",{className:"x1n0bwc9",children:[" \xb7 ",d?(0,_.t)("figmake.todo_list.cancelled_label"):h?(0,_.t)("figmake.todo_list.completed_label"):(0,_.t)("figmake.todo_list.header_todo_count",{completedTodoCount:t,totalTodoCount:e})]});return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1qughib xh8yej3 x1cmmqis",children:[(0,n.jsxs)(eh.E,{type:"button",className:"x78zum5 x1q0g3np x6s0dn4 x1nfngrj x98rzlu x5hs570 x192jxwq",onClick:r,children:[(0,n.jsx)("div",{className:"x78zum5 xl56j7k x6s0dn4 xnfn54o",children:m}),(0,n.jsxs)("span",{className:"xuzfeq1 x8yk33q x1e00guj x18zpg43 x22v61l",children:[p,g]})]}),(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 xg2d0mh",children:[c,(0,n.jsx)("div",{className:"xjp7ctv xqhrz8i x1qd94qu",children:(0,n.jsx)(u.K,{variant:"ghost","aria-label":(0,_.t)("figmake.todo_list.toggle_expand_button"),onClick:e=>{e.stopPropagation(),r()},children:h?(0,n.jsx)(nP.r,{}):s?(0,n.jsx)(ar.l,{}):(0,n.jsx)(al.k,{})})})]})]})}function aw({toolCall:e,toolResult:t,isMostRecentMessage:s,chatMessagesNodeGuid:i,trackingContext:r,mergedMessagesMetadata:l}){!function(e,t,s){let n=(0,y.md)((0,F.Z3)(s)),i=(0,y.Xr)(F.f4);a.useEffect(()=>{if("ask_question"===t)return n?.signal.addEventListener("abort",s),()=>{n?.signal.removeEventListener("abort",s)};function s(){i({toolCallId:e,toolResult:void 0})}},[n,e,t,i])}(e.toolCallId,e.toolName,i),function(e,t){let s=(0,y.Xr)(F.PD);(0,a.useEffect)(()=>("ask_question"===e.toolName&&t&&"freeform"===e.partialArgs.mode&&s({toolCallId:e.toolCallId,toolName:e.toolName}),()=>{"ask_question"===e.toolName&&s(null)}),[e.partialArgs.mode,e.toolCallId,e.toolName,t,s])}(e,s);let o=function(e,t){let s=(0,y.md)(F.f4);return a.useMemo(()=>{if("ask_question"===e.toolName){let t=s[e.toolCallId];if(t)return{toolCallId:e.toolCallId,toolName:e.toolName,result:t}}return t},[e.toolCallId,e.toolName,s,t])}(e,t),c=!o||!o.result||"object"==typeof o.result&&"unhydrated"in o.result&&o.result.unhydrated?nj.t4.PENDING:o.result.success?nj.t4.SUCCESS:nj.t4.FAILURE;return(0,n.jsx)(aE,{chatMessagesNodeGuid:i,isMostRecentMessage:s,mergedMessagesMetadata:l,partialArgs:e.partialArgs,status:c,toolCallId:e.toolCallId,toolName:e.toolName,toolResult:o,trackingContext:r})}function aE({toolName:e,toolCallId:t,partialArgs:s,isMostRecentMessage:i,status:r,trackingContext:l,toolResult:o,mergedMessagesMetadata:c}){let d=(0,e6.gJ)(),[u,x]=a.useState(!1),[m,p]=a.useState(!1),h=(0,G.ry)(),g=a.useMemo(()=>{if("ask_question"===e&&r===nj.t4.SUCCESS)return nj.VD.TOOL_CALL_SUCCESS;if(!i)switch(r){case nj.t4.SUCCESS:return nj.VD.TOOL_CALL_SUCCESS;case nj.t4.FAILURE:return nj.VD.TOOL_CALL_CANCELLED;case nj.t4.PENDING:return nj.VD.TOOL_CALL_PENDING}return h||d&&(0,e6.d4)(e)?nj.VD.TOOL_CALL_DISABLED:u?nj.VD.TOOL_CALL_CANCELLED:void 0},[i,r,d,u,h,e,m]),f=(0,e4.S)(),_=(0,A.tS)()||"",y=a.useCallback(s=>{(0,O.IB)({persistentEntityId:l.persistentEntityId,clientLifecycleId:l.clientLifecycleId},e,_),x(!0),p(!1),f({toolCallId:t,toolName:e,toolResult:s})},[t,e,f,_,l.persistentEntityId,l.clientLifecycleId]);switch(e){case"ask_question":return(0,n.jsx)(nN,{toolCallId:t,toolName:e,question:s.question??"",options:s.options,disabledStatus:g,toolResult:o});case"supabase_connect":{let s={success:!1,message:"User dismissed Supabase connect tool call"};return(0,n.jsx)(n0,{toolCallId:t,toolName:e,disabledStatus:g,dismissSupabase:()=>y(s),trackingContext:l})}case"create_supabase_secret":{let a={success:!1,message:"User dismissed secret creation tool call"};return(0,n.jsx)(n8,{toolCallId:t,toolName:e,disabledStatus:g,initialSecretName:s.secretName??"",dismissSupabase:()=>y(a),trackingContext:l})}case"add_todos_tool":{if(!(0,sd.z)("make_todo_list_ui"))return null;let a=c?.todoMetadata,r=a?.todoStatusMap.get(t),l=a?.currentTodoId===t;return(0,n.jsx)(aj,{onAccept:s=>{f({toolCallId:t,toolName:e,toolResult:{success:!0,message:tK.rI,todos:(0,ac.Qk)(s)}})},toolCallId:t,toolResult:o,todos:s.todos??[],isMostRecentMessage:i,todoStatusMap:r,isCurrentTodoList:l})}default:return null}}var aN=s(524924);function aS({groupedToolCallData:e}){let[t,s]=a.useState(!1),{totalFileCount:i,displayStrings:r}=e;return 0===i?null:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf",children:[(0,n.jsxs)(eh.E,{...{0:{className:"x1ypdohk x78zum5 x6s0dn4 x87ps6o x11g6tue xng3xce x1r7ld26 x1717udv xh8yej3 xv1l7n4 x1op4zxa xdpxx8g"},1:{className:"x1ypdohk x78zum5 x6s0dn4 x87ps6o x11g6tue xng3xce x1r7ld26 x1717udv xh8yej3 x1op4zxa xdpxx8g xiuzu7u"}}[!!t<<0],onClick:()=>{s(!t)},"aria-expanded":t,"aria-label":t?(0,_.t)("figmake.chat.hide_files"):(0,_.t)("figmake.chat.show_files"),children:[(0,_.t)("figmake.chat.worked_on_files",{count:i}),(0,n.jsx)(aN.a,{...{0:{className:"xtc4nxu x1bmturs"},1:{className:"x1bmturs xtlvio2 x1iffjtl"}}[!!t<<0]})]}),(0,n.jsx)(v.N,{mode:"wait",children:t&&(0,n.jsx)(b.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},children:(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x167g77z xv1l7n4 x1anpbxc x1hx0egp x1odjw0f xkcv6ua x1ed109x",children:r.map((e,t)=>(0,n.jsx)("div",{children:e},`${e}-${t}`))})},"completed")})]})}var aT=s(683900),aI=s(480866),aA=s(344810),aM=s(493083),az=s(618295),aL=s(424178),aO=s(747279),aP=s(550974),aR=s(420475),aD=s(96295),aF=s(437509),aq=s(245312),aG=s(623494),aU=s(917844),aK=s(224542),aH=s.n(aK),aB=s(600643),aV=s(941610);s(521353),s(247447),s(993827),s(264247);var a$=s(99185),aW=s(888903),aY=s(490549),aX=s(786543);function aZ({code:e,language:t,title:s,isLoading:i}){let[r,l]=(0,a.useState)(!1),o=e.split("\n"),c=o.length>10,d=(0,eo.wA)(),x=(0,a.useCallback)(()=>{d(aY.lW({stringToCopy:e,ignoreLineBreaks:!1})),d(aW.F.enqueue({message:(0,_.t)("dev_handoff.ai_assistant.code_block.copy_to_clipboard_toast")}))},[e,d]),m=(0,a.useCallback)(()=>{let t=s??"code.txt",n=new Blob([e],{type:"text/plain"}),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download=t,i.click(),URL.revokeObjectURL(a)},[e,s]),p=s?`${s}`:t?(0,_.t)("dev_handoff.ai_assistant.code_block.title_for_language",{language:t}):(0,_.t)("dev_handoff.ai_assistant.code_block.title_no_language"),h=function(e){if(!e)return"plaintext";let t=e.toLowerCase();return({ts:"typescript",js:"javascript",py:"python",rb:"ruby",sh:"bash"})[t]||t}(t),g=r?e:o.slice(0,10).join("\n"),f=aV.highlight(g,aV.languages[h],h);return(0,n.jsxs)("div",{className:"x1yjdb4r xmkeg23 x1y0btm7 x7z60cl x1mxnbhz xb3r6kr",children:[(0,n.jsxs)("div",{className:"x78zum5 x6s0dn4 x1qughib xf7z5ut x1v8gsql xjwf9q1",children:[(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 x1iyjqo2 xs83m0k xeuugli",children:(0,n.jsxs)("div",{className:"x78zum5 x6s0dn4 xg2d0mh x1cmmqis x192jxwq xeuugli",children:[(0,n.jsx)(aq.k,{}),(0,n.jsx)("div",{className:"x1j6dyjg x10p5zqr x1d3mw78 x1akne3o xb3r6kr xlyipyv xuxw1ft",children:p})]})}),(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xg2d0mh x2lah0s xt0e3qv",children:i?(0,n.jsx)(eO.k,{size:"md"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.K,{"aria-label":(0,_.t)("dev_handoff.ai_assistant.code_block.download_tooltip"),onClick:m,variant:"ghost",children:(0,n.jsx)(aG.W,{})}),(0,n.jsx)(u.K,{"aria-label":(0,_.t)("dev_handoff.ai_assistant.code_block.copy_to_clipboard_tooltip"),onClick:x,variant:"ghost",children:(0,n.jsx)(aU.E,{})})]})})]}),(0,n.jsxs)("div",{className:"x1n2onr6",children:[(0,n.jsx)("div",{className:aH()(aX.y,k.Ay.classNames(a0.codeContent,!r&&!i&&a0.codeContentCollapsed)),"data-lang":h,children:(0,n.jsx)("pre",{className:"x1ghz6dp x1j6dyjg x1ey7xld x1d3mw78 x1akne3o xebhuq6 x1yn0g08",dangerouslySetInnerHTML:{__html:(0,a$.p)(f)}})}),c&&!r&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"x10l6tqk x1ey2m1c xu96u03 x3m8u43 xwzfr38 xzdc4m2 x47corl"}),(0,n.jsx)("div",{className:"x1yjdb4r x19y5rnk x10l6tqk x1ey2m1c xu96u03 x3m8u43 x78zum5 xuk3077 xl56j7k xp6roeo xt0e3qv",children:(0,n.jsx)(ep.$n,{onClick:()=>{l(!r)},disabled:i,variant:"secondary",children:i?(0,n.jsx)(eO.k,{size:"sm"}):(0,_.t)("dev_handoff.ai_assistant.code_block.show_more")})})]})]})]})}class aJ extends aB.Kp{static getType(){return"devmode-ai-chat-code-block"}static clone(e){return new aJ(e.__code,e.__language,e.__title,e.__isLoading,e.__key)}constructor(e,t=null,s=null,n,a){super(a),this.__code=e,this.__language=t,this.__title=s,this.__isLoading=n??!1}exportJSON(){return{type:"devmode-ai-chat-code-block",version:1,language:this.__language,title:this.__title,code:this.__code,isLoading:this.__isLoading}}static importJSON(e){return new aJ(e.code,e.language,e.title,e.isLoading??!1)}createDOM(){return document.createElement("div")}updateDOM(){return!1}decorate(){return(0,n.jsx)(aZ,{code:this.__code,language:this.__language??void 0,title:this.__title??void 0,isLoading:this.__isLoading})}}function aQ(e,t,s,n){let a=new aJ(e,t??null,s??null,n);return(0,aB.pT)(a)}let a0={codeContent:{kmVPX3:"xi4r6k5",kg3NbH:null,kuDDbn:null,kE3dHu:null,kP0aTx:null,kpe85a:null,k8WAf4:null,kLKAdn:null,kGO01o:null,kVQacm:"xysyzu8",kXHlph:null,kORKVm:null,$$css:!0},codeContentCollapsed:{kXHlph:"x14aock7",$$css:!0}};var a1=s(840720),a5=s(103922),a2=s(466082);function a3({nodeId:e,text:t}){let s=(0,a2.UN)(),i=s.get(e),r=(0,tM.Z)("ai_assistant"),l=(0,a.useMemo)(()=>i&&tA(i.type),[i]),o=(0,a.useCallback)(t=>{r((0,tL.QZ)({nodeId:t.guid,alwaysPan:!0})),s.getCurrentPage()?.setSelectionToSingleNode(e)},[r,e,s]);return i&&l?(0,n.jsx)("div",{className:"x3nfvp2 x3ajldb xmgb6t1",onMouseEnter:()=>(0,tz.Uc)(e),onMouseLeave:()=>(0,tz.Uc)(""),children:(0,n.jsx)(eh.E,{onClick:()=>o(i),children:(0,n.jsx)(a5.v,{leading:(0,n.jsx)(l,{}),size:"sm",children:t})})}):(0,n.jsx)(n.Fragment,{})}class a4 extends aB.Kp{static getType(){return"figma-node-link"}static clone(e){return new a4(e.__nodeId,e.__text,e.__key)}constructor(e,t,s){super(s),this.__nodeId=e,this.__text=t}getNodeId(){return this.__nodeId}getText(){return this.__text}createDOM(e){let t=document.createElement("div"),s=e?.theme?.figmaNodeLink||e?.theme?.link;return s&&(t.className=s),t}decorate(){return(0,n.jsx)(a3,{nodeId:this.__nodeId,text:this.__text})}updateDOM(){return!1}static importJSON(e){let{nodeId:t,text:s}=e;return a6({nodeId:t,text:s})}exportJSON(){return{type:"figma-node-link",nodeId:this.__nodeId,text:this.__text,version:1,children:[],direction:null,format:"",indent:0}}}function a6({nodeId:e,text:t}){let s=new a4(e,t);return(0,aB.pT)(s)}let a7=[aP.iK,aR.Db,aD.v5,aD.YW,aF.jL,aF.dJ,aR.k_,aR.Db,a4,aJ,a1.R];var a8=s(732783),a9=s(27074),ie=s(11894),it=s(628607),is=s(990462),ia=s(814647),ii=s(704900),ir=s(360777),il=s(181327),io=s(581080),ic=s(999047),id=s(310318);let iu=/^(https?|ircs?|mailto|xmpp)$/i,ix=new class{constructor(){this.cache=new Map,this.maxSize=100}generateCacheKey(e){let t=e.rehypePlugins||[],s=e.remarkPlugins||[],n=e.remarkRehypeOptions||{},a=e=>JSON.stringify(e.map(e=>{if(Array.isArray(e)){let[t,s]=e;return{name:"function"==typeof t?t.name:String(t),options:s}}return{name:"function"==typeof e?e.name:String(e),options:null}})),i=a(t),r=a(s),l=JSON.stringify(n);return`${r}::${i}::${l}`}get(e){let t=this.generateCacheKey(e),s=this.cache.get(t);return s&&(this.cache.delete(t),this.cache.set(t,s)),s}set(e,t){let s=this.generateCacheKey(e);if(this.cache.size>=this.maxSize){let e=this.cache.keys().next().value;e&&this.cache.delete(e)}this.cache.set(s,t)}clear(){this.cache.clear()}},im=e=>{let t=ip(e),n=new id.T(e.children||"");return function(e,t){let n=t.urlTransform||ig;(0,ic.YR)(e,e=>{if("element"===e.type){let t;for(t in"ref"in e.properties&&delete e.properties.ref,"key"in e.properties&&delete e.properties.key,ii.$)if(Object.prototype.hasOwnProperty.call(ii.$,t)&&Object.prototype.hasOwnProperty.call(e.properties,t)){let s=e.properties[t],a=ii.$[t];(null===a||a&&a.includes(e.tagName))&&(e.properties[t]=n(String(s||""),t,e))}}});let{jsx:i,jsxs:r}=s(239976);return(0,ia.H)(e,{Fragment:a.Fragment,components:t.components,ignoreInvalidStyle:!0,jsx:i,jsxs:r,passKeys:!0,passNode:!0})}(t.runSync(t.parse(n),n),e)},ip=e=>{let t=ix.get(e);if(t)return t;let s=ih(e);return ix.set(e,s),s},ih=e=>{let t=e.rehypePlugins||[],s=e.remarkPlugins||[],n={allowDangerousHtml:!0,...e.remarkRehypeOptions};return(0,io.l)().use(ir.A).use(s).use(il.A,n).use(t)},ig=e=>{let t=e.indexOf(":"),s=e.indexOf("?"),n=e.indexOf("#"),a=e.indexOf("/");return -1===t||-1!==a&&t>a||-1!==s&&t>s||-1!==n&&t>n||iu.test(e.slice(0,t))?e:""};var i_=s(895596);let iy=/\[\^[^\]\s]{1,200}\](?!:)/,ik=/\[\^[^\]\s]{1,200}\]:/,iv=/<\/(\w+)>/,ib=/<(\w+)[\s>]/,ij=e=>{let t=iy.test(e),s=ik.test(e);if(t||s)return[e];let n=i_.JG.lex(e,{gfm:!0}),a=[],i=[];for(let e of n){let t=e.raw;if(i.length>0){if(a[a.length-1]+=t,"html"===e.type){let e=t.match(iv);if(e){let t=e[1];i[i.length-1]===t&&i.pop()}}continue}if("html"===e.type&&e.block){let e=t.match(ib);if(e){let s=e[1];if(!s)continue;t.includes(`</${s}>`)||i.push(s)}}if("$$"===t.trim()&&a.length>0){let e=a[a.length-1];if(!e){a.push(t);continue}let s=e.trimStart().startsWith("$$"),n=(e.match(/\$\$/g)||[]).length;if(s&&n%2==1){a[a.length-1]=e+t;continue}}if(a.length>0&&t.trimEnd().endsWith("$$")){let e=a[a.length-1];if(!e){a.push(t);continue}let s=e.trimStart().startsWith("$$"),n=(e.match(/\$\$/g)||[]).length,i=(t.match(/\$\$/g)||[]).length;if(s&&n%2==1&&!t.trimStart().startsWith("$$")&&1===i){a[a.length-1]=e+t;continue}}a.push(t)}return a},iC=/(\*\*)([^*]*?)$/,iw=/(__)([^_]*?)$/,iE=/(\*\*\*)([^*]*?)$/,iN=/(\*)([^*]*?)$/,iS=/(_)([^_]*?)$/,iT=/(`)([^`]*?)$/,iI=/(~~)([^~]*?)$/,iA=/^[\s_~*`]*$/,iM=/^[\s]*[-*+][\s]+$/,iz=/[\p{L}\p{N}_]/u,iL=/^```[^`\n]*```?$/,iO=/^\*{4,}$/,iP=e=>{let t=(e.match(/```/g)||[]).length;return t>0&&t%2==0&&e.includes("\n")},iR=null,iD="",iF=e=>{let t=e.length,s=Array(t).fill(!1),n=!1,a=!1;for(let i=0;i<t;i++){let r=e[i],l=i+1<t?e[i+1]:"",o=i+2<t?e[i+2]:"",c=i>0?e[i-1]:"",d=i>1?e[i-2]:"";if("`"===r&&"`"===l&&"`"===o){n=!n,s[i]=s[i+1]=s[i+2]=n,i+=2;continue}"`"!==r||"`"===l&&"`"===o||"`"===c&&"`"===l||"`"===d&&"`"===c||n||(a=!a),s[i]=n||a}return s},iq=(e,t)=>(iD!==e&&(iD=e,iR=iF(e)),!!(iR&&t<iR.length&&iR[t])),iG=e=>{let t=e.lastIndexOf("](");if(-1!==t&&-1===e.indexOf(")",t+2)){let s=-1,n=0;for(let a=t-1;a>=0;a--)if("]"===e[a])n+=1;else if("["===e[a]){if(0===n){s=a;break}n-=1}if(-1!==s){let n=s>0&&"!"===e[s-1],a=n?s-1:s,i=e.substring(s+1,t);if(iq(e,a))return e;let r=e.substring(0,a);return n?r:`${r}[${i}](streamdown:incomplete-link)`}}let s=-1,n=!1;for(let t=e.length-1;t>=0;t--)if("["===e[t]){t>0&&"!"===e[t-1]?(s=t-1,n=!0):(s=t,n=!1);break}if(-1!==s){let t=n?s+2:s+1;if(!(-1!==e.indexOf("]",t)))return iq(e,s)?e:n?e.substring(0,s):`${e}](streamdown:incomplete-link)`}return e},iU=e=>{if(iP(e))return e;let t=e.match(iC);if(t){let s=t[2];if(!s||iA.test(s))return e;let n=t[1];if(!n)return e;let a=e.lastIndexOf(n),i=e.substring(0,a).lastIndexOf("\n"),r=e.substring(-1===i?0:i+1,a);if(iM.test(r)&&s.includes("\n"))return e;if((e.match(/\*\*/g)||[]).length%2==1)return`${e}**`}return e},iK=e=>{let t=e.match(iw);if(t){let s=t[2];if(!s||iA.test(s))return e;let n=t[1];if(!n)return e;let a=e.lastIndexOf(n),i=e.substring(0,a).lastIndexOf("\n"),r=e.substring(-1===i?0:i+1,a);if(iM.test(r)&&s.includes("\n"))return e;if((e.match(/__/g)||[]).length%2==1)return`${e}__`}return e},iH=e=>e.split("").reduce((t,s,n)=>{if("*"===s){let s=e[n-1],a=e[n+1];if("\\"===s||s&&a&&iz.test(s)&&iz.test(a))return t;let i=n;for(let t=n-1;t>=0;t--){if("\n"===e[t]){i=t+1;break}if(0===t){i=0;break}}if(""===e.substring(i,n).trim()&&(" "===a||"	"===a))return t;if("*"!==s&&"*"!==a)return t+1}return t},0),iB=e=>{if(iP(e))return e;if(e.match(iN)){let t=-1;for(let s=0;s<e.length;s++)if("*"===e[s]&&"*"!==e[s-1]&&"*"!==e[s+1]&&"\\"!==e[s-1]){let n=s>0?e[s-1]:"",a=s<e.length-1?e[s+1]:"";if(n&&a&&iz.test(n)&&iz.test(a))continue;t=s;break}if(-1===t)return e;let s=e.substring(t+1);if(!s||iA.test(s))return e;if(iH(e)%2==1)return`${e}*`}return e},iV=(e,t)=>{let s=!1,n=!1;for(let a=0;a<e.length&&a<t;a+=1){if("\\"===e[a]&&"$"===e[a+1]){a+=1;continue}"$"!==e[a]||("$"===e[a+1]?(n=!n,a+=1,s=!1):n||(s=!s))}return s||n},i$=e=>e.split("").reduce((t,s,n)=>{if("_"===s){let s=e[n-1],a=e[n+1];if("\\"===s||iV(e,n)||s&&a&&iz.test(s)&&iz.test(a))return t;if("_"!==s&&"_"!==a)return t+1}return t},0),iW=e=>{if(iP(e))return e;if(e.match(iS)){let t=-1;for(let s=0;s<e.length;s++)if("_"===e[s]&&"_"!==e[s-1]&&"_"!==e[s+1]&&"\\"!==e[s-1]&&!iV(e,s)){let n=s>0?e[s-1]:"",a=s<e.length-1?e[s+1]:"";if(n&&a&&iz.test(n)&&iz.test(a))continue;t=s;break}if(-1===t)return e;let s=e.substring(t+1);if(!s||iA.test(s))return e;if(i$(e)%2==1){let t=e.length;for(;t>0&&"\n"===e[t-1];)t-=1;if(t<e.length){let s=e.slice(0,t),n=e.slice(t);return`${s}_${n}`}return`${e}_`}}return e},iY=(e,t)=>{let s="```"===e.substring(t,t+3),n=t>0&&"```"===e.substring(t-1,t+2),a=t>1&&"```"===e.substring(t-2,t+1);return s||n||a},iX=e=>{let t=0;for(let s=0;s<e.length;s+=1)"`"!==e[s]||iY(e,s)||(t+=1);return t},iZ=e=>{if(e.match(iL)&&!e.includes("\n"))return e.endsWith("``")&&!e.endsWith("```")?`${e}\``:e;let t=(e.match(/```/g)||[]).length;if(t>0&&t%2==0&&e.includes("\n")||(e.endsWith("```\n")||e.endsWith("```"))&&t%2==0)return e;let s=e.match(iT);if(s&&t%2!=1){let t=s[2];if(!t||iA.test(t))return e;if(iX(e)%2==1)return`${e}\``}return e},iJ=e=>{let t=e.match(iI);if(t){let s=t[2];if(!s||iA.test(s))return e;if((e.match(/~~/g)||[]).length%2==1)return`${e}~~`}return e},iQ=e=>{if((e.match(/\$\$/g)||[]).length%2==0)return e;let t=e.indexOf("$$");return -1===t||-1===e.indexOf("\n",t)||e.endsWith("\n")?`${e}$$`:`${e}
$$`},i0=e=>{let t=0;for(let s of e.match(/\*+/g)||[]){let e=s.length;e>=3&&(t+=Math.floor(e/3))}return t},i1=e=>{if(iP(e)||iO.test(e))return e;let t=e.match(iE);if(t){let s=t[2];if(!s||iA.test(s))return e;if(i0(e)%2==1)return`${e}***`}return e},i5=e=>{if(!e||"string"!=typeof e)return e;let t=e,s=iG(t);return s.endsWith("](streamdown:incomplete-link)")?s:t=iQ(t=iJ(t=iZ(t=iW(t=iB(t=iK(t=iU(t=i1(t=s))))))))},i2={harden:[a8.b,{allowedImagePrefixes:["*"],allowedLinkPrefixes:["*"],defaultOrigin:void 0,allowDataImages:!0}],raw:a9.A},i3={gfm:[is.A,{}],cjkFriendly:[ie.A,{}],cjkFriendlyGfmStrikethrough:[it.A,{}]},i4=Object.values(i2),i6=Object.values(i3),i7=(0,a.createContext)({controls:!0,isAnimating:!1,mode:"streaming"}),i8={container:{kfSwDN:"x1hx0egp",kkrTdU:"x1ed109x",$$css:!0}},i9=(0,a.memo)(({content:e,shouldParseIncompleteMarkdown:t,...s})=>{let i=(0,a.useMemo)(()=>"string"==typeof e&&t?i5(e.trim()):e,[e,t]);return(0,n.jsx)(im,{...s,children:i})},(e,t)=>{if(e.content!==t.content||e.shouldParseIncompleteMarkdown!==t.shouldParseIncompleteMarkdown||e.index!==t.index)return!1;if(e.components!==t.components){let s=Object.keys(e.components||{}),n=Object.keys(t.components||{});if(s.length!==n.length||s.some(s=>e.components?.[s]!==t.components?.[s]))return!1}return e.rehypePlugins===t.rehypePlugins&&e.remarkPlugins===t.remarkPlugins&&e.urlTransform===t.urlTransform});i9.displayName="Block";let re=e=>{let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e.charCodeAt(s),t&=t;return Math.abs(t).toString(36)},rt=(0,a.memo)(({children:e,mode:t="streaming",parseIncompleteMarkdown:s=!0,components:i,rehypePlugins:r=i4,remarkPlugins:l=i6,className:o,controls:c=!0,isAnimating:d=!1,urlTransform:u=e=>e,BlockComponent:x=i9,parseMarkdownIntoBlocksFn:m=ij,...p})=>{let h=(0,a.useId)(),[g,f]=(0,a.useTransition)(),[_,y]=(0,a.useState)([]),v=(0,a.useMemo)(()=>m("string"==typeof e?e:""),[e,m]);(0,a.useEffect)(()=>{"streaming"===t?f(()=>{y(v)}):y(v)},[v,t]);let b="streaming"===t?_:v,j=(0,a.useMemo)(()=>b.map((e,t)=>`${h}-${re(e)}-${t}`),[b,h]),C=(0,a.useMemo)(()=>({controls:c,isAnimating:d,mode:t}),[c,d,t]);return"static"===t?(0,n.jsx)(i7.Provider,{value:C,children:(0,n.jsx)("div",{className:aH()(o,k.xW(i8.container)),children:(0,n.jsx)(im,{components:i,rehypePlugins:r,remarkPlugins:l,urlTransform:u,...p,children:e})})}):(0,n.jsx)(i7.Provider,{value:C,children:(0,n.jsx)("div",{className:aH()(o,k.xW(i8.container)),children:b.map((e,t)=>(0,n.jsx)(x,{components:i,content:e,index:t,rehypePlugins:r,remarkPlugins:l,shouldParseIncompleteMarkdown:s,urlTransform:u,...p},j[t]))})})},(e,t)=>e.children===t.children&&e.isAnimating===t.isAnimating&&e.mode===t.mode);rt.displayName="Streamdown";let rs="editor_theme--heading--xgJ1D",rn="editor_theme--revTextCode--9h-PC",ra="editor_theme--revHeading--Tr4i9",ri="editor_theme--revHeadingMedium--ZwVii",rr="editor_theme--revHeadingSmall--c2pM4",rl={code:"editor_theme--code--KBf5B",heading:{h1:rs,h2:rs,h3:rs,h4:rs,h5:rs,h6:rs},link:"editor_theme--link--uKqE0",list:{listitem:"editor_theme--listItem--6ymRx",nested:{listitem:"editor_theme--nestedListItem--MN8Ce"},ol:"editor_theme--listOl--3kID1",ul:"editor_theme--listUl--37So4"},ltr:"editor_theme--ltr--knyij",rtl:"editor_theme--rtl--jPNbE",paragraph:"editor_theme--paragraph--vVTAq",placeholder:"editor_theme--placeholder--MFeMv",quote:"editor_theme--quote--o2JlB",text:{bold:"editor_theme--textBold--0Ncap",code:"editor_theme--textCode--TMhj8",italic:"editor_theme--textItalic--VJkTq",strikethrough:"editor_theme--textStrikethrough--HyaC7",underline:"editor_theme--textUnderline--SwPey",underlineStrikethrough:"editor_theme--textUnderlineStrikethrough--BPC-M"},figmaNodeLink:"editor_theme--figmaNodeLink---Lnjv",figmaAssetDialog:"editor_theme--figmaAssetDialog--Vvpjo"},ro=(0,a.createContext)(!1);function rc({children:e,node:t,...s}){let i=(0,a.useContext)(ro);return(0,n.jsx)("pre",{...{0:{className:"x1v8gsql x4p5aij x1j85h84 xf00w7v x1d60ukw x15klxpg x1hjwid2 x192jxwq x126k92a x1mzt3pk"},1:{className:"x1v8gsql x4p5aij x1j85h84 xf00w7v x1d60ukw x15klxpg x1hjwid2 x192jxwq x126k92a x1mzt3pk x4vex6e xzboxd6"}}[!i<<0],...s,children:e})}function rd({children:e,node:t,...s}){let i=(0,a.useContext)(ro);return(0,n.jsx)("p",{...{0:{className:"xvwc6ox x4z9k3i x1j61x8r x15m7nig xdod15v x22v61l"},1:{className:"xvwc6ox x4z9k3i x1j61x8r x15m7nig xdod15v x22v61l x4vex6e xzboxd6"}}[!i<<0],...s,children:e})}function ru({children:e,node:t,...s}){let i=(0,a.useContext)(ro);return(0,n.jsx)("h1",{...{0:{className:"xor4psk x1ncjjhx xaoa4km xdod15v x14terfx"},1:{className:"xor4psk x1ncjjhx xaoa4km xdod15v x14terfx x134cssr xzboxd6"}}[!i<<0],...s,children:e})}function rx({children:e,node:t,...s}){let i=(0,a.useContext)(ro);return(0,n.jsx)("h2",{...{0:{className:"xor4psk x1ncjjhx xaoa4km xdod15v x14terfx"},1:{className:"xor4psk x1ncjjhx xaoa4km xdod15v x14terfx x134cssr xzboxd6"}}[!i<<0],...s,children:e})}function rm({children:e,node:t,...s}){let i=(0,a.useContext)(ro);return(0,n.jsx)("h3",{...{0:{className:"xor4psk x1ncjjhx xaoa4km xdod15v x14terfx"},1:{className:"xor4psk x1ncjjhx xaoa4km xdod15v x14terfx x134cssr xzboxd6"}}[!i<<0],...s,children:e})}function rp({children:e,node:t,...s}){let i=(0,a.useContext)(ro);return(0,n.jsx)("h4",{...{0:{className:"xor4psk x1ncjjhx xaoa4km xdod15v x14terfx"},1:{className:"xor4psk x1ncjjhx xaoa4km xdod15v x14terfx x134cssr xzboxd6"}}[!i<<0],...s,children:e})}function rh({children:e,node:t,...s}){let i=(0,a.useContext)(ro);return(0,n.jsx)("h5",{...{0:{className:"x1l3kr2 x1mnx3iv xo8tsow xdod15v xdjnq2g"},1:{className:"x1l3kr2 x1mnx3iv xo8tsow xdod15v xdjnq2g x134cssr xzboxd6"}}[!i<<0],...s,children:e})}function rg({children:e,node:t,...s}){let i=(0,a.useContext)(ro);return(0,n.jsx)("h6",{...{0:{className:"x1l3kr2 x1mnx3iv xo8tsow xdod15v xdjnq2g"},1:{className:"x1l3kr2 x1mnx3iv xo8tsow xdod15v xdjnq2g x134cssr xzboxd6"}}[!i<<0],...s,children:e})}function rf({children:e,node:t,...s}){let i=(0,a.useContext)(ro);return(0,n.jsx)(ro.Provider,{value:!0,children:(0,n.jsx)("blockquote",{...{0:{className:"x1ghz6dp x400o59 x4z9k3i x15m7nig xdod15v xuf8qxk x1n0bwc9 x1u2bih1 xe0pwq x19ypqd9 xnm25rq x1anpbxc"},1:{className:"x1ghz6dp x400o59 x4z9k3i x15m7nig xdod15v xuf8qxk x1n0bwc9 x1u2bih1 xe0pwq x19ypqd9 xnm25rq x1anpbxc x4vex6e xzboxd6"}}[!i<<0],...s,children:e})})}function r_({children:e,node:t,...s}){let i=(0,a.useContext)(ro);return(0,n.jsx)(ro.Provider,{value:!0,children:(0,n.jsx)("ol",{...{0:{className:"x1717udv x1ghz6dp x43c9pm x3yw8vx"},2:{className:"x1717udv x1ghz6dp x43c9pm x3yw8vx x4vex6e xzboxd6"},1:{className:"x1717udv x1ghz6dp x43c9pm x3yw8vx x1swbamy"},3:{className:"x1717udv x1ghz6dp x43c9pm x3yw8vx x4vex6e xzboxd6 x1swbamy"}}[!i<<1|!!i<<0],...s,children:e})})}function ry({children:e,node:t,...s}){let i=(0,a.useContext)(ro);return(0,n.jsx)(ro.Provider,{value:!0,children:(0,n.jsx)("ul",{...{0:{className:"x1717udv x1ghz6dp x43c9pm xtaz4m5"},2:{className:"x1717udv x1ghz6dp x43c9pm xtaz4m5 x4vex6e xzboxd6"},1:{className:"x1717udv x1ghz6dp x43c9pm xtaz4m5 x1swbamy"},3:{className:"x1717udv x1ghz6dp x43c9pm xtaz4m5 x4vex6e xzboxd6 x1swbamy"}}[!i<<1|!!i<<0],...s,children:e})})}function rk({node:e,...t}){let s=(0,a.useContext)(ro);return(0,n.jsx)("hr",{...{0:{className:"xc342km x178xt8z x13fuv20 x16ufvko"},1:{className:"xc342km x178xt8z x13fuv20 x16ufvko x4vex6e xzboxd6"}}[!s<<0],...t})}function rv({children:e,node:t,...s}){return(0,n.jsx)("strong",{className:"x19s9jnd",...s,children:e})}function rb({children:e,node:t,...s}){return(0,n.jsx)("em",{className:"x1k4tb9n",...s,children:e})}function rj({children:e,node:t,...s}){return(0,n.jsx)("del",{className:"xmqliwb",...s,children:e})}function rC({children:e,node:t,...s}){return(0,n.jsx)("code",{className:"x1v8gsql xtczco7 x4p5aij x1j85h84 xf00w7v x1d60ukw x15klxpg x1hjwid2 x192jxwq",...s,children:e})}function rw({children:e,node:t,...s}){return(0,n.jsx)("a",{className:"x1quhyk7 x1hl2dhg",...s,children:e})}function rE({children:e,node:t,...s}){return(0,n.jsx)("li",{className:"xq1n1xh x1e56ztr xzboxd6 x4z9k3i xdod15v x22v61l x1tij9ou",...s,children:e})}var rN=s(579762);let rS={dependencies:[a4],export:(e,t)=>{if(!(e instanceof a4))return null;let s=e.getNodeId(),n=e.getText();return`<figma-node-link node-id="${s}">${n}</figma-node-link>`},importRegExp:/<figma-node-link node-id="([^"]+)">([^<]+)<\/figma-node-link>/,regExp:/<figma-node-link node-id="([^"]+)">([^<]+)<\/figma-node-link>$/,replace:(e,t)=>{let[,s,n]=t;if(!s||!n)return;let a=a6({nodeId:s,text:n});e.replace(a)},trigger:">",type:"text-match"};function rT(e){let[t]=(0,aM.DF)(),s=a.useMemo(()=>(function({elementTransformers:e=[],multilineElementTransformers:t=[],textFormatTransformers:s=[],textMatchTransformers:n=[],includeInlineCode:a=!1}){return[aI.TB,aI.jA,aI.mK,aI.NB,...e,...t,...a?[aI.Up]:[],aI.eA,aI.gb,aI.d7,aI.Pi,aI.Eg,aI.gW,aI.WY,...s,rS,rN.f,aI.ps,...n]})({elementTransformers:e.elementTransformers,multilineElementTransformers:e.multilineElementTransformers,textFormatTransformers:e.textFormatTransformers,textMatchTransformers:e.textMatchTransformers,includeInlineCode:e.transformInlineCode}),[e.elementTransformers,e.multilineElementTransformers,e.textFormatTransformers,e.textMatchTransformers,e.transformInlineCode]);return(0,a.useEffect)(()=>{try{t.update(()=>{let t=(0,q.S)(e.featureType)?e.textContent.split("\n").map(e=>e.match(/^( {2,3})([-*+]|\d+\.)\s/)?"    "+e.trimStart():e).join("\n"):e.textContent;(0,aI.Wn)(t,s,void 0,!0)},{discrete:!0})}catch(s){console.error("Error parsing editor state. Default to empty lexical state",s);let e=t.parseEditorState('{"root":{"children":[{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textStyle":""}],"direction":null,"format":"","indent":0,"type":"root","version":1}}');t.setEditorState(e)}},[e.textContent,t,s,e.featureType]),(0,n.jsx)("div",{children:(0,n.jsx)(aO.$,{contentEditable:(0,n.jsx)(az.a,{className:"x1iyjqo2",spellCheck:!1,"data-testid":"code-chat-content-editable",contentEditable:!1}),placeholder:null,ErrorBoundary:aL.R})})}function rI({textContent:e,editorTheme:t,elementTransformers:s,multilineElementTransformers:r,textFormatTransformers:l,textMatchTransformers:o,transformInlineCode:c,featureType:d,isActiveExchange:u}){let x=d===i.lV.FIGMAKE&&tU.v.getFeatureGate("make_better_markdown"),m=a.useMemo(()=>({strong:rv,em:rb,del:rj,code:rC,pre:rc,a:rw,p:rd,h1:ru,h2:rx,h3:rm,h4:rp,h5:rh,h6:rg,blockquote:rf,ol:r_,ul:ry,li:rE,hr:rk}),[]);if(x)return(0,n.jsx)(rt,{components:m,mode:u?"streaming":"static",children:e});let p=function({editorTheme:e}={}){return{namespace:"code-chat-rich-text-editor",onError(e){throw e},theme:e??rl,nodes:a7}}({editorTheme:t});return(0,n.jsx)(aA.n,{initialConfig:{...p,editable:!1},children:(0,n.jsx)(rT,{textContent:e,elementTransformers:s,multilineElementTransformers:r,textFormatTransformers:l,textMatchTransformers:o,transformInlineCode:c,featureType:d})})}let rA={dependencies:[aJ],export:e=>{if(e instanceof aJ){let t=e.exportJSON(),s=t.language??"",n=t.code,a=t.title?` title="${t.title}"`:"";return`\`\`\`${s}${a}
${n}
\`\`\``}return null},regExpStart:/^[ \t]*```([\w-]+)?( *title="([^"]+)")?/,regExpEnd:{optional:!0,regExp:/[ \t]*```$/},replace:(e,t,s,n,a,i)=>{let r=s[1]??null,l=s[2]??null,o=s[3]??null;if(!t&&a){let t;if(1===a.length)t=n?aQ((r||"")+(l||"")+a[0],null):aQ(a[0]?.startsWith(" ")?a[0]?.slice(1):a[0]||"",r,o);else{if(a[0]?.trim().length===0)for(;a.length>0&&!a[0]?.length;)a.shift();else a[0]=a[0]?.startsWith(" ")?a[0].slice(1):a[0]||"";for(;a.length>0&&!a[a.length-1]?.length;)a.pop();t=aQ(a.join("\n"),r,o,!n)}e.append(t)}},type:"multiline-element"};function rM(e,t){let s=(0,el.Oc)()?function(){let e=tU.v.getFeatureGate("make_chat_ui_improvements");return{code:rn,heading:{h1:e?ri:ra,h2:e?ri:ra,h3:e?ri:ra,h4:e?ri:ra,h5:e?rr:ra,h6:e?rr:ra},link:"editor_theme--revLink--j9SJo",list:{listitem:e?"editor_theme--revListItemNew--5tKUd":"editor_theme--revListItem--H3xgM",nested:{listitem:"editor_theme--revNestedListItem--mFHKS"},ol:e?"editor_theme--revListOlNew--B24gs":"editor_theme--revListOl--Pehvl",ul:e?"editor_theme--revListUlNew--n6qAb":"editor_theme--revListUl--D7-6S"},ltr:"editor_theme--revLtr--kPcRQ",rtl:"editor_theme--revRtl--bbZQr",paragraph:e?"editor_theme--revParagraphNew--xhTr1":"editor_theme--revParagraph--6lCBw",placeholder:"editor_theme--revPlaceholder--3h1Ok",quote:e?"editor_theme--revQuoteNew--M6wWW":"editor_theme--revQuote--nhO7q",text:{bold:e?"editor_theme--revTextBoldNew--s1qrI":"editor_theme--revTextBold--3Hzs5",code:e?"editor_theme--revTextInlineCode--WyVrl":rn,italic:"editor_theme--revTextItalic--y4l9s",strikethrough:"editor_theme--revTextStrikethrough--GGSMJ",underline:"editor_theme--revTextUnderline--LvGAE",underlineStrikethrough:"editor_theme--revTextUnderlineStrikethrough--pP7FN"}}}():rl,r=(0,q.S)(e),l=(0,a.useMemo)(()=>[rA],[]),o=(0,a.useMemo)(()=>[aI.Sq],[]),c=(0,a.useMemo)(()=>e===i.lV.AI_ASSISTANT?l:r?o:void 0,[e,r,l,o]);return function(a){return(0,n.jsx)(rI,{textContent:a,editorTheme:s,multilineElementTransformers:c,transformInlineCode:r,featureType:e,isActiveExchange:t})}}var rz=s(480652),rL=s(732731),rO=s(563225),rP=s(402731),rR=s(806946),rD=s(232839),rF=s(396126),rq=s(366941),rG=s(538050),rU=s(183757),rK=s(244054);function rH({result:e,toolName:t,serverLogoUrl:s,toolArgs:i}){let[r,l]=a.useState(!1),[o,c]=a.useState(!1),[d,u]=a.useState(!1),x=e.success?nj.lh.SUCCESS:nj.lh.FAILED,m=a.useCallback(()=>{l(e=>!e)},[]),p=a.useCallback(()=>{c(e=>!e)},[]),h=a.useCallback(()=>{u(e=>!e)},[]),g=a.useMemo(()=>JSON.stringify(i,null,2),[i]),f=a.useMemo(()=>{if(!e.data)return JSON.stringify(e,null,2);try{let t=JSON.parse(e.data);if(!Array.isArray(t))return JSON.stringify(t,null,2);let s=t.map(e=>{if("text"===e.type){let t;try{t=JSON.parse(e.text)}catch(s){t=e.text}return{...e,text:t}}return e});return JSON.stringify(s,null,2)}catch(t){return JSON.stringify(e,null,2)}},[e]);return(0,n.jsx)("div",{className:"xh8yej3",children:(0,n.jsxs)(rL.bL,{isOpen:r,toggle:m,className:"x78zum5 xdt5ytf x1nfngrj xh8yej3",children:[(0,n.jsx)(rL.Y9,{children:(0,n.jsxs)(rL.JU,{className:"x78zum5 x6s0dn4 x1nfngrj x11g6tue xc342km xng3xce x9r1u3d x1717udv xh8yej3 xdpxx8g x1ypdohk",children:[(0,n.jsx)(rV,{status:x}),(0,n.jsx)("div",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly x78zum5 xh8yej3",children:t}),s&&(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k xvy4d1p xxk0z11 x1ai9mow",children:(0,n.jsx)(eM.oW,{className:"x1xp8n7a xmix8c7 x19y5rnk x19kjcj4 x10d6zji",src:s,alt:t})}),r?(0,n.jsx)(al.k,{}):(0,n.jsx)(aN.a,{})]})}),(0,n.jsx)(rL.UC,{children:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1nfngrj x1ihwiht",children:[(0,n.jsx)(rB,{isOpen:o,toggle:p,label:(0,_.t)("figmake.mcp_tool.cta.request"),data:g}),(0,n.jsx)(rB,{isOpen:d,toggle:h,label:(0,_.t)("figmake.mcp_tool.cta.results"),data:f})]})})]})})}function rB({isOpen:e,toggle:t,label:s,data:i}){let r=(0,eo.wA)(),l=a.useCallback(()=>{r(aY.lW({stringToCopy:i,ignoreLineBreaks:!1}))},[r,i]),o={lines:(0,rK.Xl)(i),language:"javascript",name:s},c=(0,rU.ln)(o,()=>{});return(0,n.jsxs)(rL.bL,{className:"x1v8gsql x19y5rnk x1akne3o xmkeg23 x1y0btm7 x7z60cl xs2suwn x17qaar8",isOpen:e,toggle:t,children:[(0,n.jsxs)(rL.Y9,{className:"x78zum5 x6s0dn4 x1v8gsql x1kiqupf x19y5rnk",children:[(0,n.jsxs)(rL.JU,{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9 x1vi7shn xp6roeo x1j5tlza x1iyjqo2 x78zum5",children:[(0,n.jsx)("div",{className:"x1iyjqo2",children:s}),e?(0,n.jsx)(rO.O,{}):(0,n.jsx)(rP.k,{})]}),(0,n.jsx)(rL.X0,{className:"x1n0bwc9 xc2ngpw",children:(0,n.jsx)(u.K,{"aria-label":(0,_.t)("figmake.mcp_tool.cta.copy"),onClick:l,children:(0,n.jsx)(rR.O,{})})})]}),(0,n.jsx)(rL.UC,{className:"xf7z5ut",children:(0,n.jsx)(rq.Z,{scrollBarAlways:!0,children:(0,n.jsx)("div",{className:"xwib8y2 xeq5yr9",children:(0,n.jsx)(rG.FL,{code:o,lines:c})})})})]})}function rV({status:e}){let t=(0,n.jsx)(nR.V,{});switch(e){case nj.lh.LOADING:t=(0,n.jsx)(eO.k,{size:"md"});break;case nj.lh.SUCCESS:t=(0,n.jsx)(nP.r,{className:"x11vm0g5"});break;case nj.lh.FAILED:t=(0,n.jsx)(rD.f,{className:"x11ui4if"});break;case nj.lh.CANCELLED:t=(0,n.jsx)(rF.J,{className:"xmauxvm"});break;case nj.lh.IDLE:t=(0,n.jsx)(nR.V,{});break;default:(0,aa.xb)(e)}return(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k xvy4d1p xxk0z11 x2lah0s xb3r6kr",children:t})}function r$({server:e,onAuthorize:t,onDismiss:s,isUserAuthorized:a}){return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1nfngrj xh8yej3 xp6roeo xilkfi8 x1cmmqis",children:[(0,n.jsxs)("div",{className:"x78zum5 x1cy8zhl x1nfngrj",children:[(0,n.jsx)(rV,{status:nj.lh.LOADING}),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xg2d0mh",children:[(0,n.jsx)("div",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:(0,_.t)("figmake.mcp_tool.cta.setup_connection")}),(0,n.jsx)("div",{className:"xuzfeq1 x8yk33q x1e00guj x18zpg43 x22v61l x1n0bwc9",children:e.tagline})]})]}),(0,n.jsxs)("div",{className:"x78zum5 x1nfngrj x1nhvcw1 xh8yej3 xl8oe17",children:[(0,n.jsx)(ep.WW,{variant:"primary",onClick:t,children:(0,_.t)("figmake.mcp_tool.cta.connect")}),a&&(0,n.jsx)(ep.WW,{variant:"secondary",onClick:s,children:(0,_.t)("figmake.mcp_tool.cta.cancel")})]})]})}function rW({toolArgs:e,toolName:t,status:s,serverLogoUrl:i}){let[r,l]=a.useState(!1),o=()=>l(!r),c=Object.keys(e).length>0,d=a.useMemo(()=>c?JSON.stringify(e,null,2):(0,_.t)("figmake.mcp_tool.args.no_parameters"),[e,c]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{className:"x78zum5 x6s0dn4 x1nfngrj x11g6tue xc342km xng3xce x9r1u3d x1717udv xh8yej3 xdpxx8g x1ypdohk",onClick:o,"aria-expanded":r,type:"button",children:[(0,n.jsx)(rV,{status:s}),(0,n.jsx)("div",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly x1iyjqo2 xs83m0k xeuugli",children:t}),i&&(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k xvy4d1p xxk0z11 x1ai9mow",children:(0,n.jsx)(eM.oW,{className:"x1xp8n7a xmix8c7 x19y5rnk x19kjcj4 x10d6zji",src:i,alt:t})}),(0,n.jsx)(u.K,{onClick:o,"aria-label":(0,_.t)("figmake.mcp_tool.cta.toggle_args"),children:r?(0,n.jsx)(al.k,{}):(0,n.jsx)(aN.a,{})})]}),r&&(0,n.jsx)("div",{className:"xl8oe17 x1ihwiht",children:(0,n.jsx)("pre",{...{0:{className:"x1v8gsql x19y5rnk xi4r6k5 xif65rj x1ey7xld x1akne3o x126k92a x1vvkbs xuyqlj2 x1odjw0f xmkeg23 x1y0btm7 x7z60cl x1ghz6dp x1hx0egp"},1:{className:"x1v8gsql x19y5rnk xi4r6k5 xif65rj x1ey7xld x126k92a x1vvkbs xuyqlj2 x1odjw0f xmkeg23 x1y0btm7 x7z60cl x1ghz6dp x1hx0egp x3vvef7"}}[!c<<0],children:d})})]})}var rY=s(881619),rX=s(670664);function rZ({serverName:e,serverLogoUrl:t,variant:s}){let i=a.useMemo(()=>{switch(s){case"cancelled":return(0,_.t)("figmake.mcp_tool.cta.cancelled",{server_name:e});case"unauthorized":return(0,_.t)("figmake.mcp_tool.cta.connect_to_server",{server_name:e});case"unauthorized_success":return(0,_.t)("figmake.mcp_tool.cta.successful_connection",{server_name:e});case"unauthorized_cancelled":return(0,_.t)("figmake.mcp_tool.cta.cancelled_connection_for_server",{server_name:e});case"default":return e}},[s,e]);return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xg2d0mh xh8yej3 xilkfi8 x1cmmqis",children:(0,n.jsxs)("div",{className:"x78zum5 x6s0dn4 x1nfngrj xh8yej3",children:[(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k xvy4d1p xxk0z11",children:(0,n.jsx)(eM.oW,{className:"x1xp8n7a xmix8c7 x19y5rnk x19kjcj4 x10d6zji",src:t,alt:e})}),(0,n.jsx)("div",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:i}),"unauthorized"===s&&(0,n.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1iyjqo2 x78zum5 x13a6bvl",children:(0,n.jsx)(ed.N,{href:"https://help.figma.com/hc/articles/35440096186007",newTab:!0,children:(0,n.jsxs)("div",{className:"x78zum5 x6s0dn4 xg2d0mh",children:[(0,n.jsx)(rY.G,{className:"xrnak4o"}),(0,_.t)("figmake.mcp_tool.cta.learn_more")]})})})]})})}function rJ(){let e=(0,tV.nA)(),t=(0,eV.No)(),s=t.unwrapOr(null)?.tier,i=a.useMemo(()=>{if(e){if(s===eB.Ag.ORG||s===eB.Ag.ENTERPRISE)return(0,_.t)("figmake.mcp_tool.connectors_disabled_for_org");if(s===eB.Ag.PRO||s===eB.Ag.STUDENT||s===eB.Ag.STARTER)return(0,_.t)("figmake.mcp_tool.connectors_disabled_for_team")}return(0,_.t)("figmake.mcp_tool.connectors_disabled")},[e,s]);return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xg2d0mh xh8yej3 xilkfi8 x1cmmqis",children:(0,n.jsxs)("div",{className:"x78zum5 x6s0dn4 x1nfngrj xh8yej3",children:[(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k xvy4d1p xxk0z11",children:(0,n.jsx)(rX.t,{})}),(0,n.jsx)("div",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:i})]})})}function rQ({toolCall:e,toolResult:t}){let s;let a=(0,tV.dH)(),i=e.partialArgs,r=i.tool_name||e.toolName,l=i.tool_input||{},o=i.serverName||"",c=i.serverLogoUrl,d=(0,tK.Tr)(r).serverToolName;if(t?.result){let e=t.result;s={success:e.success??!0,message:e.message??"",data:e.data}}return s?.success===!1&&s?.message.startsWith("tool_validation_failed")?null:r&&"run_mcp_tool"!==r&&o&&d&&c?a?s?(0,n.jsx)(nw,{header:(0,n.jsx)(rZ,{serverName:o,serverLogoUrl:c,variant:"default"}),body:(0,n.jsx)("div",{className:"x1ihwiht xh8yej3 xeuugli xb3r6kr",children:(0,n.jsx)(rH,{toolArgs:(0,tV.y8)(l),result:s,toolName:d,serverLogoUrl:void 0})})}):(0,n.jsx)(nw,{header:(0,n.jsx)(rZ,{serverName:o,serverLogoUrl:c,variant:"default"}),body:(0,n.jsx)("div",{className:"x1ihwiht xh8yej3 xeuugli xb3r6kr",children:(0,n.jsx)(rW,{toolArgs:(0,tV.y8)(l),toolName:d,status:nj.lh.LOADING,serverLogoUrl:void 0})})}):(0,n.jsx)(nw,{header:(0,n.jsx)(rJ,{})}):(console.warn("[McpAutoRunToolCall] Insufficient information to render:",{fullToolName:r,serverName:o,serverToolName:d,hasLogo:!!c}),null)}function r0({onConfirm:e,onDismiss:t,isExecutingTools:s,chatMessagesNodeGuid:i,isBatch:r=!1}){let l=(0,y.md)((0,F.mC)(i)),o=!l||""===l.trim(),c=a.useCallback(async()=>{e&&await e()},[e]),d=a.useCallback(async()=>{e&&await e(!0)},[e]),u=a.useCallback(()=>{t&&t()},[t]);a.useEffect(()=>{if(!o||!e||s)return;let t=e=>{"Enter"!==e.key||e.shiftKey||e.metaKey||e.ctrlKey||e.altKey||(e.preventDefault(),c())};return window.addEventListener("keydown",t,{capture:!0}),()=>window.removeEventListener("keydown",t,{capture:!0})},[o,e,c,s]);let x=r?(0,_.t)("figmake.mcp_tool.cta.run_all"):(0,_.t)("figmake.mcp_tool.cta.run_tool"),m=r?(0,_.t)("figmake.mcp_tool.cta.cancel_all"):(0,_.t)("figmake.mcp_tool.cta.cancel");return(0,n.jsx)("div",{className:"x78zum5 xh8yej3 x1ihwiht",children:(0,n.jsxs)("div",{className:"x78zum5 x1nfngrj x1nhvcw1 xl8oe17 x1iyjqo2",children:[(0,n.jsx)(ep.WW,{variant:"primary",onClick:c,disabled:s,children:x+(o?" \u21B5":"")}),!r&&(0,n.jsx)(ep.WW,{variant:"secondary",onClick:d,disabled:s,children:(0,_.t)("figmake.mcp_clients.allow_unsupervised")}),(0,n.jsx)(ep.WW,{variant:"secondary",onClick:u,disabled:s,children:m})]})})}function r1({batchedToolMap:e}){let t=Object.keys(e).length>1;return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x1nfngrj xh8yej3 x1ihwiht xeuugli xb3r6kr",children:(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x1nfngrj xh8yej3 xeuugli",children:Object.values(e).flatMap(({serverInfo:e,toolStates:s})=>s.map(s=>{if(!s.toolResult)return console.error("Tool result is undefined",s),null;let a=t?e.serverLogoUrl:void 0;return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xg2d0mh xh8yej3 xeuugli",children:(0,n.jsx)(rH,{toolArgs:(0,tV.y8)(s.toolArgs),result:s.toolResult,toolName:s.serverToolName,serverLogoUrl:a})},s.toolCallId)}))})})}function r5({batchedToolMap:e,onConfirmAll:t,onDismissAll:s,isUserAuthorized:i,allDismissed:r,isExecutingTools:l,isStreamingToolCalls:o,chatMessagesNodeGuid:c}){let d=Object.keys(e).length>1,u=a.useMemo(()=>Object.values(e).flatMap(({toolStates:e})=>e).length>1,[e]);return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1nfngrj xh8yej3 x1ihwiht xeuugli xb3r6kr",children:[(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x1nfngrj xh8yej3 xeuugli",children:Object.values(e).flatMap(({serverInfo:e,toolStates:t})=>t.map(({toolCallId:t,toolArgs:s,serverToolName:a,status:i})=>{let l=d?e.serverLogoUrl:void 0;return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xg2d0mh xh8yej3 xeuugli",children:(0,n.jsx)(rW,{toolArgs:(0,tV.y8)(s),toolName:a,status:r?nj.lh.CANCELLED:i,serverLogoUrl:l})},t)}))}),i&&!r&&!l&&!o&&(0,n.jsx)(r0,{onConfirm:t,onDismiss:s,isExecutingTools:l,chatMessagesNodeGuid:c,isBatch:u})]})}function r2({batchedToolMap:e,variant:t}){let s=Object.keys(e).length;if(1===s){let{serverName:s,serverLogoUrl:a}=Object.values(e)[0].serverInfo;return(0,n.jsx)(rZ,{serverName:s,serverLogoUrl:a,variant:t})}return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xg2d0mh xh8yej3 xilkfi8 x1cmmqis",children:(0,n.jsxs)("div",{className:"x78zum5 x6s0dn4 x1nfngrj xh8yej3",children:[(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k xvy4d1p xxk0z11",children:(0,n.jsx)(rX.t,{})}),(0,n.jsx)("div",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:"cancelled"===t?(0,_.t)("figmake.mcp_clients.multi_connector_cancelled",{num_servers:s}):(0,_.t)("figmake.mcp_clients.multi_connector",{num_servers:s})})]})})}var r3=s(611034),r4=s(607231);function r6({serverId:e,onDismiss:t,isUserAuthorized:s,onSuccess:a,onClientCreated:i}){let{mcpServers:r}=(0,se.oJ)(),{refetch:l}=(0,se.Qh)(),o=(0,eo.wA)(),c=y.zl.get(A.ze),d=r.find(t=>t.id===e),u=d?.name||"server",{initiateOauth:x}=(0,r4.R)({onAuthSuccess:async()=>{let t=await r3.p.createMcpClient({mcpServerId:e,fileKey:c??void 0});i?.(t.data.meta.client.id),await l(),a?.()},onAuthFailure:()=>{o(aW.F.enqueue({message:(0,_.t)("figmake.mcp_clients.oauth_failed_with_server_name",{server_name:u}),error:!0,timeoutOverride:2e3}))}});return d?(0,n.jsx)(nw,{header:(0,n.jsx)(rZ,{serverName:d.name,serverLogoUrl:d.logoUrl||void 0,variant:"unauthorized"}),body:(0,n.jsx)(r$,{server:d,onAuthorize:()=>x(d),onDismiss:t,isUserAuthorized:s})}):null}function r7({server:e,success:t}){return(0,n.jsx)(nw,{header:(0,n.jsx)(rZ,{serverName:e.name,serverLogoUrl:e.logoUrl||void 0,variant:t?"unauthorized_success":"unauthorized_cancelled"})})}function r8({batchedToolMap:e,onConfirmAll:t,onDismissAll:s,hasDismissedAll:i,isExecutingTools:r,isStreamingToolCalls:l,chatMessagesNodeGuid:o,mcpClients:c}){let d=(0,sZ.iZ)(),{serverAuthMap:u,allServersAuthenticated:x}=a.useMemo(()=>{let t=new Set(c.map(e=>e.server.id)),s=Object.keys(e).reduce((e,s)=>(e[s]=t.has(s),e),{});return{serverAuthMap:s,allServersAuthenticated:Object.values(s).every(e=>e)}},[e,c]),{allToolsAuthenticatedForUser:m,hasAllResults:p}=a.useMemo(()=>{let t=Object.values(e).flatMap(({toolStates:e})=>e);return{allToolsAuthenticatedForUser:t.every(e=>!e.toolArgs.userId||!d||d.id===e.toolArgs.userId),hasAllResults:t.every(e=>void 0!==e.toolResult)}},[e,d]);if(!x&&!i&&!p)return(0,n.jsx)(n.Fragment,{children:Object.entries(u).filter(([e,t])=>!t).map(([e])=>(0,n.jsx)(r6,{serverId:e,onDismiss:s,isUserAuthorized:m},e))});let h={batchedToolMap:e,isUserAuthorized:m};return i?(0,n.jsx)(r9,{...h}):p?(0,n.jsx)(le,{...h}):(0,n.jsx)(lt,{...h,onConfirmAll:t,onDismissAll:s,isExecutingTools:r,isStreamingToolCalls:l,chatMessagesNodeGuid:o})}function r9(e){return(0,n.jsx)(nw,{header:(0,n.jsx)(r2,{batchedToolMap:e.batchedToolMap,variant:"cancelled"}),body:(0,n.jsx)(r5,{batchedToolMap:e.batchedToolMap,isUserAuthorized:e.isUserAuthorized,allDismissed:!0})})}function le(e){return(0,n.jsx)(nw,{header:(0,n.jsx)(r2,{batchedToolMap:e.batchedToolMap,variant:"default"}),body:(0,n.jsx)(r1,{batchedToolMap:e.batchedToolMap})})}function lt(e){return(0,n.jsx)(nw,{header:(0,n.jsx)(r2,{batchedToolMap:e.batchedToolMap,variant:"default"}),body:(0,n.jsx)(r5,{batchedToolMap:e.batchedToolMap,onConfirmAll:e.onConfirmAll,onDismissAll:e.onDismissAll,isUserAuthorized:e.isUserAuthorized,isExecutingTools:e.isExecutingTools,isStreamingToolCalls:e.isStreamingToolCalls,chatMessagesNodeGuid:e.chatMessagesNodeGuid})})}function ls({toolCalls:e,toolResults:t,isMostRecentMessage:s,chatMessagesNodeGuid:i,trackingContext:r}){let l=(0,y.md)(td.iw),o=(0,y.Xr)(td.iw),c=(0,y.Xr)(td.KU),d=(0,y.Xr)(td.kU),u=(0,eS.hC)(),x=(0,se.q6)(),{mcpServers:m,isLoading:p}=(0,se.oJ)(),{mcpClients:h,isLoading:g}=(0,se.Qh)(),f=(0,se.Wy)(h),[_,k]=a.useState(!1),[v,b]=a.useState(!1),j=(0,sZ.TA)(),{exchange:C}=(0,F.$W)(i),w=a.useMemo(()=>void 0!==C&&C.messages.length>0,[C]),E=s&&w,N=a.useMemo(()=>{let n=[],a=new Map;for(let e of t)a.set(e.toolCallId,e);for(let t of e){let{serverToolName:e}=(0,tK.Tr)(t.toolName),i=l[t.toolCallId],r=(0,tV.KS)(i,a.get(t.toolCallId)),o=t.partialArgs.serverId,c=t.partialArgs.userId,d=(0,tV.Qw)(o,e,h,m,f);j!==c||d.isValid||u("ai_chat_mcp.tool_validation_failed",{toolType:"call_mcp_tool",toolName:e,mcpServerId:o||"unknown",featureEntrypoint:"figmake",validationReason:d.reason,toolCallId:t.toolCallId,availableServerCount:d.availableServerCount});let x={toolCallId:t.toolCallId,serverId:o,status:(0,tV.xA)({hasDismissedToolCall:v,isExecutingTool:_,isMostRecentMessage:s,isCurrentUserInitiator:c===j,toolResult:r}),toolArgs:t.partialArgs,fullToolName:t.toolName,serverToolName:e,toolResult:r};n.push(x)}return n},[t,e,l,h,f,m,v,_,s,j,u]),S=a.useMemo(()=>{let e={};for(let t of N){let{serverName:s}=(0,tK.Tr)(t.fullToolName),n=t.toolArgs.serverLogoUrl;e[t.serverId]||(e[t.serverId]={serverInfo:{serverId:t.serverId,serverName:s,serverLogoUrl:n},toolStates:[]}),e[t.serverId].toolStates.push(t)}return e},[N]),T=a.useMemo(()=>Object.values(S).flatMap(({toolStates:e})=>e),[S]),[I,A]=(0,y.fp)(td.dB);(0,eT.h)(()=>{T.forEach(e=>{I[e.toolCallId]||(A(e.toolCallId),u("ai_chat_mcp.tool_prompt_shown",{toolName:e.serverToolName,mcpServerId:e.serverId,featureEntrypoint:"figmake",clientLifecycleId:r.clientLifecycleId,persistentEntityId:r.persistentEntityId,toolCallId:e.toolCallId}))})});let{cancelBatchToolCalls:M}=(0,se.Rr)(T.map(e=>e.toolCallId),i),z=(0,e4.Y)(),L=a.useMemo(()=>T.every(e=>(0,tV.Gt)({status:e.status,result:e.toolResult,completeToolName:e.fullToolName})),[T]),O=a.useCallback(()=>{b(!0),k(!1),d("end"),M(T,{...r,autoRunEnabled:!1})},[T,M,d,r]),P=a.useCallback(async e=>{for(let e of(k(!0),d("start"),T)){let{serverName:t,serverToolName:s}=(0,tK.Tr)(e.fullToolName);if((0,td.IN)(t,s)){let t={success:!1,message:`Tool "${s}" is set to auto-run.

          The user has turned on auto-run for this tool in their MCP settings. This tool now should be executed automatically.

          \u26A0\uFE0F CRITICAL INSTRUCTIONS:
          1. Call discover_tools again to get updated execution methods for this tool
          2. For THIS specific request, use run_mcp_tool instead of call_mcp_tool
          3. run_mcp_tool will automatically execute the tool without requiring user confirmation`,content:[]};o({toolCallId:e.toolCallId,toolResult:t}),k(!1),d("end");return}}if(1===T.length&&T[0]&&e){let e=T[0],{serverName:t,serverToolName:s}=(0,tK.Tr)(e.fullToolName);c({serverName:t,toolName:s,runSetting:td.A4.AUTO_RUN,trackPreferenceUpdate:()=>{u("ai_chat_mcp.tool_preferences_updated",{toolName:s,mcpServerId:t,featureEntrypoint:"figmake",enabled:!0,autoRunEnabled:!0})}})}z({results:await Promise.all(T.map(async({toolCallId:e,serverId:t,fullToolName:s,serverToolName:n,toolArgs:a})=>{let i=await x(t,e,a,n,{...r,autoRunEnabled:!1});return o({toolCallId:e,toolResult:i}),{toolCallId:e,toolName:s,toolResult:i}}))}),k(!1),d("end")},[T,x,o,d,r,z,c,u]);return g||p?null:(0,n.jsx)(r8,{batchedToolMap:S,onConfirmAll:P,onDismissAll:O,hasDismissedAll:v||L,isExecutingTools:_,isStreamingToolCalls:E,chatMessagesNodeGuid:i,mcpClients:h})}function ln({toolCalls:e,toolResults:t,trackingContext:s}){let{mcpServers:i,isLoading:r}=(0,se.oJ)(),l=a.useMemo(()=>new Map(i.map(e=>[e.id,e])),[i]);return r?null:(0,n.jsx)(n.Fragment,{children:e.map(e=>(0,n.jsx)(la,{toolCall:e,toolResult:t.find(t=>t.toolCallId===e.toolCallId),trackingContext:s,server:l.get(e.partialArgs.serverId),availableServerCount:i.length},e.toolCallId))})}function la({toolCall:e,toolResult:t,trackingContext:s,server:i,availableServerCount:r}){let l=(0,sZ.iZ)(),o=(0,e4.S)(),c=(0,eS.hC)(),[d,u]=(0,y.fp)(td.iw),[x,m]=(0,y.fp)(td.No),{refetch:p}=(0,se.Qh)(),h=(0,er.hk)(),g=(0,y.md)((0,F.Z3)(h?.guid)),f=g?.signal,_=e.partialArgs.serverId,k=e.partialArgs.userId,v=l?.id===k,b=(0,tV.KS)(d[e.toolCallId],t),{serverToolName:j}=(0,tK.Tr)(e.toolName),[C,w]=(0,y.fp)(td.dB);(0,eT.h)(()=>{!C[e.toolCallId]&&(w(e.toolCallId),c("ai_chat_mcp.tool_prompt_shown",{toolName:j,mcpServerId:_,featureEntrypoint:"figmake",clientLifecycleId:s.clientLifecycleId,persistentEntityId:s.persistentEntityId,toolCallId:e.toolCallId}),i||c("ai_chat_mcp.tool_validation_failed",{toolType:"call_mcp_tool",toolName:e.toolName,mcpServerId:_,featureEntrypoint:"figmake",validationReason:"unknown_server_recommendation",toolCallId:e.toolCallId,availableServerCount:r}))});let E=a.useCallback(()=>{let t={success:!0,message:"User authorized recommendation tool call"};c("ai_chat_mcp.tool_run_success",{toolName:j,mcpServerId:_,featureEntrypoint:"figmake",clientLifecycleId:s.clientLifecycleId,persistentEntityId:s.persistentEntityId,toolCallId:e.toolCallId}),o({toolCallId:e.toolCallId,toolName:e.toolName,toolResult:t}),u({toolCallId:e.toolCallId,toolResult:t})},[o,e.toolCallId,e.toolName,u,j,_,s.clientLifecycleId,s.persistentEntityId,c]),N=a.useCallback(()=>{let t={success:!1,message:"User dismissed recommendation tool call"};c("ai_chat_mcp.tool_run_cancelled",{toolName:j,mcpServerId:_,featureEntrypoint:"figmake",clientLifecycleId:s.clientLifecycleId,persistentEntityId:s.persistentEntityId,toolCallId:e.toolCallId}),o({toolCallId:e.toolCallId,toolName:e.toolName,toolResult:t}),u({toolCallId:e.toolCallId,toolResult:t})},[o,e.toolCallId,e.toolName,u,j,_,c,s.clientLifecycleId,s.persistentEntityId]),S=!!d[e.toolCallId],T=x[e.toolCallId];return(a.useEffect(()=>{if(!f)return;let s=async()=>{if(S&&!t&&u({toolCallId:e.toolCallId,toolResult:void 0}),T){let t=y.zl.get(A.ze);try{await r3.p.deleteMcpClient({id:T,fileKey:t??void 0}),m({toolCallId:e.toolCallId,clientId:null}),p()}catch(e){console.error("Failed to clean up MCP client on abort:",e)}}};return f.addEventListener("abort",s),()=>{f.removeEventListener("abort",s)}},[f,d,e.toolCallId,t,u,x,m,p,S,T]),i)?b?(0,n.jsx)(r7,{server:i,success:b.success}):(0,n.jsx)(r6,{serverId:_,onSuccess:E,onDismiss:N,isUserAuthorized:v,onClientCreated:t=>{m({toolCallId:e.toolCallId,clientId:t})}}):null}function li({toolCalls:e,toolResults:t,trackingContext:s,chatMessagesNodeGuid:i,isMostRecentMessage:r}){let l=(0,tV.dH)(),{recommendationToolCalls:o,recommendationToolResults:c,mcpToolCalls:d,mcpToolResults:u}=a.useMemo(()=>(function(e,t){let s=e=>e.includes(tK.Jz),n=e.filter(e=>s(e.toolName)),a=e.filter(e=>!s(e.toolName)),i=new Set(n.map(e=>e.toolCallId));return{recommendationToolCalls:n,recommendationToolResults:t.filter(e=>i.has(e.toolCallId)),mcpToolCalls:a,mcpToolResults:t.filter(e=>!i.has(e.toolCallId))}})(e,t),[e,t]);return 0===e.length?null:l?(0,n.jsxs)(n.Fragment,{children:[o.length>0&&(0,n.jsx)(ln,{toolCalls:o,toolResults:c,trackingContext:s}),d.length>0&&(0,n.jsx)(ls,{toolCalls:d,toolResults:u,isMostRecentMessage:r,chatMessagesNodeGuid:i,trackingContext:s})]}):(0,n.jsx)(nw,{header:(0,n.jsx)(rJ,{})})}function lr({code:e,isCodeComplete:t,toolResult:s,featureType:i}){let r=rM(i,!t),l=a.useRef(null),[o,c]=a.useState(!1),[d,u]=a.useState(!1),[x,m]=a.useState(!0);a.useEffect(()=>{l.current&&c((l.current?.scrollHeight||0)>300)},[e]);let p=r(e?`\`\`\`javascript
${e}
\`\`\``:""),h=a.useMemo(()=>{if(!s)return"";try{let e=JSON.parse(s),t=JSON.stringify(e,null,2);return r(`\`\`\`json
${t}
\`\`\``)}catch(e){return r(`\`\`\`
${s}
\`\`\``)}},[s,r]);a.useEffect(()=>{if(l.current&&!t){let e=l.current;requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight})}},[e,t]);let g=d||!t;return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf",children:[t?(0,n.jsxs)(eh.E,{...{0:{className:"x78zum5 x6s0dn4 x87ps6o x1ypdohk x11g6tue xfn42iu xng3xce x1r7ld26 x1717udv xh8yej3 xdpxx8g xv1l7n4 x1op4zxa"},1:{className:"x78zum5 x6s0dn4 x87ps6o x1ypdohk x11g6tue xfn42iu xng3xce x1r7ld26 x1717udv xh8yej3 xdpxx8g x1op4zxa xiuzu7u"}}[!!d<<0],onClick:()=>u(!d),"aria-expanded":d,"aria-label":d?"Hide plugin code":"Show plugin code",recordingKey:"pluginCodeToggle",children:["Plugin Code",(0,n.jsx)(aN.a,{...{0:{className:"xtc4nxu x1bmturs"},1:{className:"x1bmturs xtlvio2 x1iffjtl"}}[!!d<<0]})]}):(0,n.jsx)(s7.N,{children:"Writing code..."}),(0,n.jsx)("div",{className:"xb3r6kr",children:(0,n.jsxs)(v.N,{mode:"wait",children:[!t&&(0,n.jsxs)(b.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},style:{position:"relative"},children:[o&&(0,n.jsx)("div",{className:"x10l6tqk xu96u03 x3m8u43 xxk0z11 x47corl x13vifvy x1b0inr7"}),(0,n.jsx)("div",{ref:l,className:"xv1l7n4 x19sr0n1 x19ypqd9 x1u2bih1 xf18ygs xnuq7ks x889kno x1iog12x x1hx0egp xkcv6ua x1ed109x xb3r6kr x78zum5 xdt5ytf xmidabu xuyqlj2",children:p}),o&&(0,n.jsx)("div",{className:"x10l6tqk xu96u03 x3m8u43 xxk0z11 x47corl x1ey2m1c xdu2321"})]},"in-progress"),t&&g&&(0,n.jsx)(b.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},children:(0,n.jsx)("div",{className:"xv1l7n4 x19sr0n1 x19ypqd9 x1u2bih1 xf18ygs xnuq7ks x889kno x1iog12x x1hx0egp x1odjw0f xkcv6ua x1ed109x",children:p})},"completed")]})}),s&&(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1xmf6yo",children:[(0,n.jsxs)(eh.E,{...{0:{className:"x78zum5 x6s0dn4 x87ps6o x1ypdohk x11g6tue xfn42iu xng3xce x1r7ld26 x1717udv xh8yej3 xdpxx8g xv1l7n4 x1op4zxa"},1:{className:"x78zum5 x6s0dn4 x87ps6o x1ypdohk x11g6tue xfn42iu xng3xce x1r7ld26 x1717udv xh8yej3 xdpxx8g x1op4zxa xiuzu7u"}}[!!x<<0],onClick:()=>m(!x),"aria-expanded":x,"aria-label":x?"Hide result":"Show result",recordingKey:"pluginResultToggle",children:["Result",(0,n.jsx)(aN.a,{...{0:{className:"xtc4nxu x1bmturs"},1:{className:"x1bmturs xtlvio2 x1iffjtl"}}[!!x<<0]})]}),(0,n.jsx)("div",{className:"xb3r6kr",children:(0,n.jsx)(v.N,{mode:"wait",children:x&&(0,n.jsx)(b.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},children:(0,n.jsx)("div",{className:"xv1l7n4 x19sr0n1 x19ypqd9 x1u2bih1 xf18ygs xnuq7ks x889kno x1iog12x x1hx0egp x1odjw0f xkcv6ua x1ed109x",children:h})},"result-expanded")})})]})]})}function ll(e){return e?300:184}let lo={kskxy:"x1jols5v",$$css:!0},lc={reasoningText:{kMwMTN:"xv1l7n4",kLKAdn:"x889kno",kfSwDN:"x1hx0egp",kORKVm:"x1odjw0f",khEr5k:"xkcv6ua",kkrTdU:"x1ed109x",k5wCbM:"x1597r2g",k6w4Gs:"xsal60d x1eazdmp",$$css:!0},reasoningInProgressHidden:{kVQacm:"xb3r6kr",kORKVm:null,$$css:!0},reasoningInProgress:{k1xSpc:"x78zum5",kXwgrk:"xdt5ytf",kmkexE:"xmidabu",$$css:!0},reasoningInProgressWithHeight:e=>[lo,{"--x-maxHeight":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(`${e}px`)}]};function ld({reasoning:e,isReasoningComplete:t,featureType:s,setUserHasControl:i,isExchangeReasoning:r}){let l=rM(s,!t),o=a.useRef(null),c=a.useRef(null),d=a.useRef(0),[u,x]=a.useState(!1),[m,p]=a.useState(!1),[h,g]=a.useState(!1),f=(0,q.S)(s);a.useEffect(()=>{if(o.current){let e=o.current,t=e.scrollHeight>ll(f),s=0===e.scrollTop,n=h&&s;x(t&&!n)}},[e,f,h]);let y=l(e??"");a.useEffect(()=>{if(!f){if(e&&o.current&&!t){let e=o.current;requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight})}return}if(h&&c.current){clearTimeout(c.current),c.current=null;return}if(e&&o.current&&!t&&!h){if(c.current)return;let e=o.current;e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),c.current=setTimeout(()=>{c.current=null},50)}},[e,t,h,f]);let j=!t||h,C=m&&!h,w=a.useCallback(e=>{let t=e.currentTarget,s=t.scrollTop,n=s<d.current;n&&(i?.(!0),r&&(g(!0),p(!0)));let a=t.scrollHeight>ll(f),l=h||n&&r;x(a&&(!l||0!==s)),d.current=s},[i,r,f,h]);return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf",children:[t?(0,n.jsxs)(eh.E,{...{0:{className:"x78zum5 x6s0dn4 x87ps6o x1ypdohk x11g6tue xfn42iu xng3xce x1r7ld26 x1717udv xh8yej3 xdpxx8g xv1l7n4 x1op4zxa"},1:{className:"x78zum5 x6s0dn4 x87ps6o x1ypdohk x11g6tue xfn42iu xng3xce x1r7ld26 x1717udv xh8yej3 xdpxx8g x1op4zxa xiuzu7u"}}[!!m<<0],onClick:()=>{r&&f&&!m&&i?.(!0),m&&g(!1),p(!m)},"aria-expanded":m,"aria-label":m?(0,_.t)("figmake.chat.hide_reasoning"):(0,_.t)("figmake.chat.show_reasoning"),recordingKey:"reasoningToggle",children:[(0,_.t)("figmake.chat.reasoning"),(0,n.jsx)(aN.a,{...{0:{className:"xtc4nxu x1bmturs"},1:{className:"x1bmturs xtlvio2 x1iffjtl"}}[!!m<<0]})]}):(0,n.jsx)(s7.N,{children:(0,_.t)("figmake.chat.reasoning")}),(0,n.jsx)("div",{className:"xb3r6kr",children:(0,n.jsxs)(v.N,{mode:"wait",children:[j&&(0,n.jsxs)(b.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0,transition:{delay:h?0:.5,duration:.5,ease:"easeOut"}},transition:{duration:.3,ease:"easeInOut"},style:{position:"relative"},children:[u&&(0,n.jsx)("div",{className:"x10l6tqk xu96u03 x3m8u43 xxk0z11 x47corl x13vifvy x1b0inr7"}),(0,n.jsx)("div",{ref:o,onScroll:f?w:void 0,...k.Ay.props(lc.reasoningText,!f&&lc.reasoningInProgressHidden,lc.reasoningInProgress,lc.reasoningInProgressWithHeight(ll(f))),children:y})]},"in-progress"),!j&&C&&(0,n.jsx)(b.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},children:(0,n.jsx)("div",{className:"xv1l7n4 x889kno x1hx0egp x1odjw0f xkcv6ua x1ed109x x1597r2g xsal60d x1eazdmp",children:y})},"completed")]})})]})}var lu=s(594242),lx=s(636379);let lm={container:{k1xSpc:"x78zum5",kXwgrk:"xdt5ytf",kOIVth:"xou54vl",$$css:!0}};function lp({messages:e,isMostRecent:t,isInProgress:s,hasExchangeMessages:i,showCodeStreaming:r,scrollToBottom:l,trackingContext:o,chatMessagesNodeGuid:c,codeVersionNumber:d,isAutoErrorFix:u,featureType:x,title:m,layerDisplayName:p,isCurrentVersion:h,chatController:g,setUserHasControl:f,messagesMetadata:v,mergedMessagesMetadata:b}){let{defaultTypographyStyle:j}=(0,s1.L)(x),C=(0,tV.dH)(),w=(0,y.md)(e1.UV),E=(0,y.md)(D.mK),N=(0,q.S)(x),[S]=e,T=e[e.length-1],I=(()=>{switch(T?.type){case"message":case"visible_message":return T.message;case"plan":return T.plan;case"summary":return T.summary;case"work":return T.work;default:return}})(),A=T?.type==="reasoning"?T.reasoning:void 0,M=(0,lu.IW)(e),z=(0,lx.WL)(e),{codeRestoreVersion:L}=(0,aT.nm)({codeSnapshotKey:M?.codeSnapshotKey,codeSnapshotBlobstoreContentKey:M?.blobstoreContentKey,chatMessagesNodeGuid:c,featureType:x,restoreToVersionTitle:m,chatController:g,...o}),O=a.useCallback(async()=>{E&&(tU.v.getFeatureGate("bake_point_and_edit")?E.pointAndEditControl({type:"mode",mode:"inactive"}):E.setDirectManipulationEnabled({enabled:!1})),L&&await L()},[E,L]),R=a.useRef((I||A)??""),F=a.useRef(T?.id);a.useEffect(()=>{if(!s)return;let e=(I||A)??"";(T?.id!==F.current||e.length>R.current.length)&&l(),R.current=e,F.current=T?.id},[I,A,l,s,T?.id]);let G=(0,eI.ZC)(s);a.useEffect(()=>{!s&&G&&t&&l()},[s,t,l,G]);let U=a.useRef(null);a.useEffect(()=>{if(!N||!s||!U.current)return;let e=U.current.offsetHeight,t=new ResizeObserver(t=>{for(let s of t){let t=s.contentRect.height;t!==e&&(e=t,l())}});return t.observe(U.current),()=>{t.disconnect()}},[s,l,N]);let K=a.useMemo(()=>t&&s?(0,n.jsx)(no.F,{type:"progress",showCodeStreaming:r,chatMessagesNodeGuid:c,layerDisplayName:p,scrollToBottom:l,featureType:x},`progress-${c}`):null,[t,s,c,l,p,r,x]),H=a.useMemo(()=>{if(0===e.length&&i)return w&&(0,P.zy)()?[(0,n.jsx)(ly,{featureType:x},"downloading-make-kit-files")]:u?[(0,n.jsx)(lv,{},"fixing")]:[(0,n.jsx)(lf,{featureType:x},"thinking")];let a=!1,r=!1;return e.flatMap((i,l)=>{let d=l===e.length-1,u=!1;switch(i.type){case"reasoning":let m=l<e.length-1||!s;return[(0,n.jsx)(ld,{reasoning:i.reasoning,isReasoningComplete:m,featureType:x,setUserHasControl:f,isExchangeReasoning:s},`reasoning-${l}`)];case"pluginCode":return[(0,n.jsx)(lr,{code:i.code,isCodeComplete:i.isCodeComplete,toolResult:i.toolResult,featureType:x},`plugin-code-${l}`)];case"plan":return[(0,n.jsx)(lj,{plan:i.plan,featureType:x,isActiveExchange:s},`plan-${l}}`)];case"summary":return[(0,n.jsx)(lC,{summary:i.summary,featureType:x,isActiveExchange:s},`summary-${l}`)];case"clientSideToolCall":return u=d&&s&&!(0,ns.p$)(i.toolCall.toolName,i.toolCall.partialArgs),[(0,n.jsx)(aw,{toolCall:i.toolCall,toolResult:i.toolResult,isMostRecentMessage:t&&d,chatMessagesNodeGuid:c,trackingContext:o,mergedMessagesMetadata:b},`clientSideToolCall-${l}`),...u?[(0,n.jsx)(lk,{},"working")]:[]];case"mcpClientSideToolCall":u=d&&s&&!!C;let p=e.slice(l+1),h=t&&(d||p.every(e=>"mcpClientSideToolCall"===e.type||"toolCall"===e.type));return[(0,n.jsx)(li,{toolCalls:i.toolCalls,toolResults:i.toolResults,isMostRecentMessage:h,trackingContext:o,chatMessagesNodeGuid:c},`batchedClientSideToolCall-${l}`),...u?[(0,n.jsx)(lk,{},"working")]:[]];case"mcpServerSideToolCall":return[(0,n.jsx)(rQ,{toolCall:i.toolCall,toolResult:i.toolResult},`mcpServerSideToolCall-${l}`)];case"selectionRequest":return[(0,n.jsx)(nb,{type:i.type,message:i.message,selectedNodeIds:i.selectedNodeIds,onContinue:i.onContinue},`selectionRequest-${l}`)];case"missingFontsResolution":return[(0,n.jsx)(nd,{type:i.type,message:i.message,onContinue:i.onContinue},`missingFontsResolution-${l}`)];case"visible_message":let g=!a;a=!0;let _=[(0,n.jsx)(lw,{message:i.message,featureType:x,isActiveExchange:s},`visible_message-${l}`)];return N&&g&&!r&&v?.groupedToolCallData&&(r=!0,_.push((0,n.jsx)(aS,{groupedToolCallData:v.groupedToolCallData},"completed-grouped-tool-calls"))),_;case"multipleOptions":return function({item:e,currentMessageIndex:t}){if(e.isToolResultArtifact)return[(0,n.jsx)(ne,{selectedOptionThumbnailUrl:e.selectedOptionThumbnailUrl,selectedOptionId:e.selectedOptionId},`multipleOptions-artifact-${t}`)];let s=e.options.filter(e=>"original"!==e.id);return s.length<2?null:[(0,n.jsx)(nt,{options:[s[0],s[1]],selectedId:e.selectedId,onSelectionChange:e.onSelectionChange,onContinue:e.onContinue},`multipleOptions-${t}`)]}({item:i,currentMessageIndex:l});default:let y=[];N&&"toolCall"===i.type&&i.toolResult&&!r&&v?.groupedToolCallData&&(r=!0,y.push((0,n.jsx)(aS,{groupedToolCallData:v.groupedToolCallData},"completed-grouped-tool-calls")));let k=function({isLastItem:e,progressArtifact:t}){if(e&&t)return t}({isLastItem:d,progressArtifact:K});return k&&y.push(k),y}})},[e,u,t,K,s,c,o,i,C,x,w,N,f,v,b]),B=(0,n.jsx)(lE,{trackingContext:o,isInProgress:s,featureType:x,firstMessage:S,lastMessage:T,chatMessagesNodeGuid:c,isMostRecent:t}),V=!s&&z?(0,n.jsx)(no.F,{type:"code_version",isCurrentVersion:h,codeVersionNumber:d,restoreVersion:O,chatMessagesNodeGuid:c,layerDisplayName:p,versionTitle:m,featureType:x},`version-${d}`):null;return 0===H.length?null:(0,n.jsx)("div",{ref:U,role:"region","aria-label":(0,_.t)("figmake.chat.artifact.a11y_reasoning_section_title",{version:d,title:m||""}),children:(0,n.jsxs)("div",{...k.Ay.props(lm.container,j),"data-testid":"assistant-chat-messages-v2",children:[H,V,B]})})}let lh={thinkingContainer:{k1xSpc:"x78zum5",kGNEyG:"x6s0dn4",kOIVth:"x167g77z",$$css:!0}};function lg({message:e}){return(0,n.jsx)("div",{className:"x1n2onr6",children:(0,n.jsx)(s4.E,{children:(0,n.jsx)(s6.T,{role:"alert",children:e})})})}function lf({featureType:e}){let{defaultTypographyStyle:t}=(0,s1.L)(e),s=(0,_.t)("figmake.chat.thinking");return(0,n.jsxs)("div",{...k.Ay.props(lh.thinkingContainer,(0,P.zy)()?t:void 0),children:[(0,n.jsx)(nl.H,{}),(0,n.jsx)(lg,{message:s}),(0,n.jsx)(s7.N,{children:s})]})}function l_(){let e=(0,_.t)("figmake.chat.resuming_make_view_only");return(0,n.jsxs)("div",{className:"x78zum5 x6s0dn4 x167g77z",id:"make-mid-generation-warning",children:[(0,n.jsx)(nl.H,{}),(0,n.jsx)(lg,{message:e}),(0,n.jsx)(s7.N,{children:e})]})}function ly({featureType:e}){let{defaultTypographyStyle:t}=(0,s1.L)(e),s=(0,_.t)("figmake.chat.downloading_code_files");return(0,n.jsxs)("div",{...k.Ay.props(lh.thinkingContainer,t),children:[(0,n.jsx)(nl.H,{}),(0,n.jsx)(lg,{message:s}),(0,n.jsx)(s7.N,{children:s})]})}function lk(){return(0,n.jsxs)("div",{className:"x78zum5 x6s0dn4 x167g77z",children:[(0,n.jsx)(nl.H,{}),(0,n.jsx)(s7.N,{children:(0,_.t)("figmake.chat.working")})]})}function lv(){return(0,n.jsxs)("div",{className:"x78zum5 x6s0dn4 x167g77z",children:[(0,n.jsx)(nl.H,{}),(0,n.jsx)(s7.N,{children:(0,_.t)("figmake.chat.fixing")})]})}function lb({text:e,featureType:t,isActiveExchange:s}){let a=rM(t,s);return(0,n.jsx)("div",{className:"x1ed109x",children:a(e.trim())})}function lj({plan:e,featureType:t,isActiveExchange:s}){return(0,n.jsx)(lb,{text:e,featureType:t,isActiveExchange:s})}function lC({summary:e,featureType:t,isActiveExchange:s}){return(0,n.jsx)(lb,{text:e,featureType:t,isActiveExchange:s})}function lw({message:e,featureType:t,isActiveExchange:s}){return(0,n.jsx)(lb,{text:e,featureType:t,isActiveExchange:s})}function lE({trackingContext:e,isInProgress:t,featureType:s,firstMessage:a,lastMessage:r,chatMessagesNodeGuid:l,isMostRecent:o}){let c=(0,A.q5)(),d=c?.key||null,u=r?.type==="clientSideToolCall"&&"ask_question"===r.toolCall.toolName,x=e.clientLifecycleId&&!t&&c?.canEdit&&!u,{feedbackState:m,setFeedbackState:p,sentimentFeedbackCallback:h,additionalFeedbackCallback:g,categoryFeedbackCallback:f,productType:y}=(0,rz.q)(e,d,s,r?.id||"",l,na.FY.CHAT_PANEL),k=[{id:na.nj.MISSING_FUNCTIONALITY,label:(0,_.t)("figmake.chat.artifact.feedback_category.missing_functionality")},{id:na.nj.LOW_QUALITY_VISUALS,label:(0,_.t)("figmake.chat.artifact.feedback_category.low_quality_visuals")},{id:na.nj.SLOW,label:(0,_.t)("figmake.chat.artifact.feedback_category.slow")},{id:na.nj.BROKEN,label:(0,_.t)("figmake.chat.artifact.feedback_category.broken")},{id:na.nj.BAD_EDIT,label:(0,_.t)("figmake.chat.artifact.feedback_category.bad_edit")},{id:na.nj.OTHER,label:(0,_.t)("figmake.chat.artifact.feedback_category.other")}],v=s===i.lV.AI_ASSISTANT?eZ.JT.START_AI_ASSISTANT:eZ.JT.CODE_CHAT,b=(0,T.uQ)(),j={action:v,source:s,clientLifecycleId:e.clientLifecycleId,persistentEntityId:e.persistentEntityId,quick_actions_session_id:null,file_key:d,product_type:y},C=(0,t5.A)(new Date(Number(a?.sentAt64))),w=(0,t5.A)().subtract(7,"days").startOf("day"),E=C.isSameOrAfter(w),N=(0,eY.T3)()&&E;return x?(0,n.jsxs)("div",{className:"x11yfylt x78zum5 xg2d0mh",children:[(0,n.jsx)(ni.z,{additionalFeedbackCallback:g,aiTrackingContext:j,categoryFeedbackCallback:f,detailedFeedbackOptions:k,externalFeedbackState:m,hideInitialText:!0,location:na.FY.CHAT_PANEL,sentimentFeedbackCallback:h,setExternalFeedbackState:p,showUserActionCreditUsageInfo:N&&s!==i.lV.AI_ASSISTANT,thumbsDownLabel:(0,_.t)("figmake.chat.thumbs_down"),thumbsUpLabel:(0,_.t)("figmake.chat.thumbs_up")}),s===i.lV.AI_ASSISTANT&&(0,n.jsx)(lN,{selectedNodeId:b,aiActionCommonProps:j,showUserActionCreditUsageInfo:N,isMostRecent:o})]}):null}function lN({selectedNodeId:e,aiActionCommonProps:t,showUserActionCreditUsageInfo:s,isMostRecent:i}){return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x1iyjqo2",children:[(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np",children:[(0,sd.z)("ai_assistant_force_savepoints")&&(0,sd.z)("ai_assistant_restore")&&t.file_key&&!i&&(0,n.jsx)(nk,{fileKey:t.file_key,trackingContext:t}),(0,sd.z)("make_edits_debug")&&(0,n.jsx)(a.Suspense,{fallback:null,children:(0,n.jsx)(lS,{nodeId:e,aiTrackingContext:t})})]}),(0,n.jsx)("div",{children:t.clientLifecycleId&&s&&(0,sd.z)("assistant_charge_credits")&&(0,n.jsx)(nr.O,{userActionUuid:t.clientLifecycleId,trackingContext:nn.e0.AI_CREDIT_USAGE_ASSISTANT,popoverPlacement:"bottom"})})]})}let lS=a.lazy(()=>s.e(3057).then(s.bind(s,683057)));var lT=s(865702);let lI=3*window.innerHeight,lA=100;var lM=s(978589),lz=s(60123);let lL=!1,lO={k8WAf4:"x10dr8xq",kLKAdn:"",kGO01o:"",kg3NbH:"x30g6up",kuDDbn:"",kE3dHu:"",kP0aTx:"",kpe85a:"",k1xSpc:"x78zum5",kXwgrk:"xdt5ytf",$$css:!0},lP={messageContainer:e=>[lO,{"--x-paddingInline":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(e===i.lV.FIGMAKE?"24px":"16px")}],messageContainerWithDynamicHeight:{kAzted:"xy4buan",$$css:!0},innerScrollContainer:{k8WAf4:"x10dr8xq",kLKAdn:null,kGO01o:null,kg3NbH:"xnjsko4",kuDDbn:null,kE3dHu:null,kP0aTx:null,kpe85a:null,$$css:!0}};function lR({chatMessagesNodeGuid:e,messagesForRendering:t,messagesMetadata:s,exchangeMessageIds:r,emptyState:l,dragOverlay:o,featureType:c,layerDisplayName:d,isResizingPanel:u,clientLifecycleIdMap:x,showCodeStreaming:m,codeFileChanges:p,chatController:h,resumableMakeInProgress:g,currentUserCanHandleResumableMake:f,onScrollControlsReady:_,isDownloadingCodeFiles:y}){let v=(0,a.useRef)(null),b=(0,a.useRef)(null),C=(0,a.useRef)(null),w=(0,a.useRef)(null),E=(0,a.useRef)(null),N=(0,a.useRef)(new Map),S=(0,A.q5)(),T=S?.key||void 0,I=S?.name||void 0,M=(0,a.useMemo)(()=>(0,O.qE)(T??null,e),[T,e]),z=(0,a.useRef)(new Map),L=(0,a.useRef)(void 0),[R,D]=(0,a.useState)([]),G=(0,a.useRef)(null),[U,K]=(0,a.useState)(!1),{exchange:H}=(0,F.$W)(e),B=(0,a.useMemo)(()=>void 0!==H&&H.messages.length>0,[H]);B&&(lL=!0);let V=(0,q.S)(c),{handleScroll:$,showScrollToBottomButton:W,handleScrollToBottomClick:Y,requestScrollToBottom:X,onScrollToBottom:Z,isFirstMountScrollComplete:J,userHasControl:Q,setUserHasControl:ee}=function({scrollContainerRef:e,scrollEndRef:t,nearBottomThreshold:s=.3,scrollToBottomOnMount:n=!1,numScrollToBottomRetries:i=5,chatController:r,featureType:l,trackingContext:o}){let[c,d]=(0,a.useState)(!1),[u,x]=(0,a.useState)(!1),[m,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(!1),[f,_]=(0,a.useState)(!1),y=(0,a.useRef)({scrollTop:0,scrollHeight:0,clientHeight:0}),k=(0,a.useRef)(0),v=(0,a.useRef)(0),b=r?.pagination,C=r?.getMessages().length??0,w=function({context:e}){let t=e?.chatController?.pagination,s=e&&!!e?.persistentEntityId&&!!e?.fileKey&&e?.chatController&&e?.chatController.isInitialized&&!!t,n=(0,a.useRef)({sessionStartTime:Date.now(),lastPaginationTriggerTime:0,totalPaginationTriggers:0}),i=(0,a.useRef)(null),r=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{if(!s||!t)return;let n=t.isLoading;if(r.current&&!n&&i.current){let s=Date.now(),n=i.current,a=s-n.loadStartTime;j.az.trackDefinedEvent("ai_for_production.chat_pagination_triggered",{persistentEntityId:e.persistentEntityId,featureType:e.featureType,fileKey:e.fileKey,scrollPositionFromTop:n.scrollPositionFromTop,messageCountBefore:n.messageCountBefore,consecutiveTriggers:n.totalTriggers,loadTimeMs:a,hitEndOfHistory:!t.hasMore,timeSinceLastTriggerSec:n.timeSinceLastTriggerSec,totalMessagesInChat:n.messageCountBefore,timeSinceSessionStartSec:n.timeSinceSessionStartSec}),i.current=null}r.current=!!n},[s,e,t]),{trackPaginationLoadStart:(0,a.useCallback)((t,a)=>{if(!s||!e)return;let r=n.current,l=Date.now();r.totalPaginationTriggers++;let o=Math.floor((l-r.sessionStartTime)/1e3),c=r.lastPaginationTriggerTime>0?Math.floor((l-r.lastPaginationTriggerTime)/1e3):0;r.lastPaginationTriggerTime=l,i.current={loadStartTime:l,scrollPositionFromTop:t,messageCountBefore:a,totalTriggers:r.totalPaginationTriggers,timeSinceLastTriggerSec:c,timeSinceSessionStartSec:o}},[s,e])}}({context:o}),E=(0,a.useRef)(null);(0,a.useEffect)(()=>()=>{E.current&&clearTimeout(E.current),k.current&&(clearTimeout(k.current),k.current=null)},[]);let N=(0,a.useCallback)(t=>{if(!e.current)return!1;let{scrollTop:n,scrollHeight:a,clientHeight:i}=e.current,r=void 0!==t?t:i*s;return a-n-i<r},[s,e]),S=(0,a.useCallback)((t=lA)=>{if(!e.current)return!1;let{scrollTop:s}=e.current;return s<t},[e]),T=(0,a.useCallback)((s="smooth",n=lT.lQ)=>{if(!e.current||k.current)return;if(e.current&&N(5)){n();return}let a=()=>{k.current&&(clearTimeout(k.current),k.current=null),p(!1),requestAnimationFrame(()=>n())},r=0,l=()=>{r++;let n=e.current;if(!n){a();return}if(r>2&&"smooth"===s){let{scrollTop:e,scrollHeight:t,clientHeight:s}=n;t-e-s>lI&&(n.scrollTop=t-lI)}if(requestAnimationFrame(()=>t.current?.scrollIntoView({behavior:s})),r>=i){a();return}k.current=setTimeout(()=>{requestAnimationFrame(()=>{if(!n){a();return}N(5)?a():l()})},"smooth"===s?300:50)};l()},[t,e,N,i]),I=(0,a.useCallback)(()=>{u||c?(p(!0),N()||g(!0)):(T(),g(!1))},[N,u,T,c]);(0,a.useEffect)(()=>{if(!f){if(!n){_(!0);return}if(C>0){T("instant",()=>_(!0));return}if((!r||r?.isInitialized&&!b?.isLoading)&&0===C){_(!0);return}}},[n,f,T,C,r,b?.isLoading]);let A=(0,a.useCallback)(e=>{k.current||d(e)},[k]);return{showScrollToBottomButton:h,handleScroll:(0,a.useCallback)((t,s)=>{E.current&&clearTimeout(E.current);let{scrollTop:n,scrollHeight:a,clientHeight:i}=y.current,r=t-n,o=k.current,c=e.current?.clientHeight??0;if(t!==n&&s.scrollHeight===a){if(r<0){if((!(0,q.S)(l)||!o&&!(i>0&&c!==i))&&(x(!0),A(!0),N()||g(m),S(500)&&b&&b.hasMore&&!b.isLoading)){let e=Date.now();e-v.current>300&&(v.current=e,w.trackPaginationLoadStart(t,C),b.loadNextPage())}}else x(!1),r>=0&&N()&&(A(!1),g(!1),m&&T());N()&&g(!1)}y.current={scrollTop:t,scrollHeight:s.scrollHeight,clientHeight:c},o||(E.current=window.setTimeout(()=>{x(!1),E.current=null},200))},[l,N,S,A,T,b,m,C,e,w]),handleScrollToBottomClick:(0,a.useCallback)(()=>{d(!1),g(!1),T()},[T]),requestScrollToBottom:I,onScrollToBottom:T,isFirstMountScrollComplete:f,userHasControl:c,isScrollingUp:u,pendingScrollToBottom:m,isNearBottom:N,setUserHasControl:A}}({scrollContainerRef:v,scrollEndRef:w,scrollToBottomOnMount:!0,chatController:h,featureType:c,trackingContext:{featureType:c,fileKey:T,persistentEntityId:M,chatController:h}});(0,a.useEffect)(()=>{_?.({requestScrollToBottom:X,setUserHasControl:ee})},[_,X,ee]);let et=(0,sZ.iZ)();!function(e){let{messagesForRendering:t,currentUserId:s,onScrollToBottom:n,requestScrollToBottom:i,scrollContainerRef:r,userHasControl:l,paginationEnabled:o,stagedMessages:c,setStagedMessages:d,stagedMessagesContainerRef:u,isProcessingPagination:x,setIsProcessingPagination:m}=e,p=(0,a.useRef)(t.length),h=(0,a.useRef)(t[t.length-1]?.uniqueId),g=(0,a.useRef)(t[0]?.uniqueId);(0,a.useEffect)(()=>{let e=t[0],a=t[t.length-1],c=e?.uniqueId,x=a?.uniqueId,f=t.length,_=g.current,y=h.current,k=p.current;if(o&&k>0&&void 0!==_&&f>k&&c!==_){d(t.slice(0,f-k)),m(!0);let e=e=>requestAnimationFrame(()=>{e?.(),m(!1)}),s=r.current;if(s){let t=s.scrollTop,n=0,a=()=>{n++;let i=u.current;if(!i||!s)return;let r=i.getBoundingClientRect().height;if(r>0){let n=t+r;e(()=>s.scrollTop=n)}else n<10?requestAnimationFrame(a):e()};requestAnimationFrame(a)}else e()}else if(x&&x!==y&&f>k){let e=a?.type==="user"&&a?.user?.id===s,t=a?.type==="system";if(l)i();else{let s=!1,a=r.current;if(a){let{scrollTop:e,scrollHeight:t,clientHeight:n}=a;s=t-e-n<100}e||t||s?n():i()}}g.current=c,h.current=x,p.current=f},[t,s,n,i,r,d,u,x,m,c.length,l,o])}({messagesForRendering:t,currentUserId:et?.id,onScrollToBottom:Z,requestScrollToBottom:X,scrollContainerRef:v,userHasControl:Q,paginationEnabled:!!h?.pagination,stagedMessages:R,setStagedMessages:D,stagedMessagesContainerRef:G,isProcessingPagination:U,setIsProcessingPagination:K});let es=(0,a.useMemo)(()=>W?(0,n.jsx)(eh.E,{className:"x78zum5 x6s0dn4 xl56j7k x10l6tqk x1td3qas x10w6t97 x1c7jfne x1nrll8i xuuh30 x1yjdb4r x16rqkct x16a2w50 x1ypdohk x1epfdc x1vjfegm xk82a7y",onClick:Y,children:(0,n.jsx)(sW.t,{})}):null,[W,Y]),en=a.useMemo(()=>R.length>0?t.slice(R.length):t,[R.length,t]),ea=(0,a.useCallback)(e=>{if(0===en.length)return 0;let t=en[e];if(!t)return 600;let s=(0,lM._)(t,c);return N.current.get(s)||600},[en,c]),ei=(0,a.useCallback)(()=>(v.current?.scrollTop??0)-(G.current?.getBoundingClientRect().height??0),[]),{messageIdToMeasure:er,assistantMessageGroup:el}=(0,a.useMemo)(()=>{let e={messageIdToMeasure:void 0,assistantMessageGroup:void 0};if(!V||t.length<2)return e;let s=[],n=null,a=-1;for(let i=t.length-1;i>=0;i--){let r=t[i];if(r){if("user"===r.type){n=r,a=i;break}if("assistant"!==r.type)return e;s.unshift(r)}}return n&&-1!==a&&a!==t.length-1?{messageIdToMeasure:(0,lM._)(n,c),assistantMessageGroup:s}:e},[t,V,c]);(0,a.useEffect)(()=>{if(er){let e=N.current.get(er);e&&b.current?.style.setProperty("--measured-message-height",`${e}px`)}},[er]);let eo=(0,a.useMemo)(()=>el&&el.length>0?el.length:1,[el]),ec=(0,s$.z)({size:en.length-eo,parentRef:v,estimateSize:ea,overscan:10,scrollOffsetFn:ei});C.current=ec;let ed=(0,sY.A)(()=>{C.current&&!L.current&&C.current.measure()},16),eu=(0,a.useCallback)((e,t)=>{z.current.set(e,t),N.current.get(e)!==t.height&&(N.current.set(e,t.height),e===er&&t.height>0&&b.current&&b.current.style.setProperty("--measured-message-height",`${t.height}px`),ed())},[ed,er,b]);(0,a.useEffect)(()=>{let e=L.current;if(!e&&u&&(z.current.clear(),ec.virtualItems.forEach(e=>{let s=t[e.index+R.length],n=(0,lM._)(s,c),a=v.current?.querySelector(`[data-virtual-index="${n}"]`);if(a){let e=lK(a);z.current.set(n,e)}}),E.current)){let e=lK(E.current),s=el&&el.length>0?el[0]:t[t.length-1];if(s){let t=(0,lM._)(s,c);z.current.set(t,e)}}e&&!u&&(z.current.clear(),C.current&&C.current.measure()),L.current=u},[u,ec.virtualItems,t.length,R.length,t,el,c]);let{versionNumbersByUniqueId:ex,currentVersionUniqueId:em}=(0,lx.G$)(t,c,h),ep=0===t.length,eg=t.length>0&&t[t.length-1]?.type==="user"&&(c===i.lV.AI_ASSISTANT||c===i.lV.FIGMAKE&&!y&&(0,P.zy)()),ef=ep?(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x98rzlu x1iyjqo2 xs83m0k x1r8uery xysyzu8 xl56j7k",children:l}):(0,n.jsxs)(sX.P,{className:"x78zum5 xdt5ytf x98rzlu x1iyjqo2 xs83m0k x1r8uery xb3r6kr xjkvuk6",scrollContainerRef:v,onScroll:$,innerClassName:k.Ay.classNames(lP.innerScrollContainer),children:[(0,n.jsx)("div",{ref:G,style:{visibility:R.length>0&&U?"hidden":void 0},children:R.map(t=>{let a=(0,lM._)(t,c),i=z.current.get(a);return(0,n.jsx)(lG,{addMinHeightStyle:!1,featureType:c,frozenDimensions:i,hasBeenMeasured:N.current.has(a),isExchangeMessage:!!t.isExchangeMessage,isFirstMountScrollComplete:J,isLast:!1,isResizingPanel:u,isUserMessage:"user"===t.type,setSize:eu,uniqueId:a,children:(0,n.jsx)(lU,{chatController:h,chatMessagesNodeGuid:e,clientLifecycleIdMap:x,codeFileChanges:p,codeVersionNumber:ex.get(a)??0,exchangeMessageIds:r,featureType:c,fileName:I,isCurrentVersion:!1,isLast:!1,layerDisplayName:d,message:t,messagesMetadata:s,persistentEntityId:M,requestScrollToBottom:X,setUserHasControl:ee,showCodeStreaming:m})},`staged-${a}`)})}),(0,n.jsx)("div",{style:{height:`${ec.totalSize}px`,width:"100%",position:"relative"},className:"x78zum5 xdt5ytf",children:ec.virtualItems.map(t=>{let a=en[t.index];if(!a)return null;let i=(0,lM._)(a,c),l=z.current.get(i);return(0,n.jsx)(lG,{addMinHeightStyle:!1,featureType:c,frozenDimensions:l,hasBeenMeasured:N.current.has(i),isExchangeMessage:!!a.isExchangeMessage,isFirstMountScrollComplete:J,isLast:!1,isResizingPanel:u,isUserMessage:"user"===a.type,setMeasureRef:t.measureRef,setSize:eu,start:t.start,uniqueId:i,children:(0,n.jsx)(lU,{chatController:h,chatMessagesNodeGuid:e,clientLifecycleIdMap:x,codeFileChanges:p,codeVersionNumber:ex.get((0,lM._)(a,c))??0,exchangeMessageIds:r,featureType:c,fileName:I,isCurrentVersion:(0,lM._)(a,c)===em,isLast:!1,layerDisplayName:d,message:a,messagesMetadata:s,persistentEntityId:M,requestScrollToBottom:X,setUserHasControl:ee,showCodeStreaming:m})},i)})}),t.length>0&&(()=>{if(el&&el.length>1){let t=(0,lM._)(el[0],c);return(0,n.jsx)(lG,{addMinHeightStyle:V,featureType:c,frozenDimensions:void 0,hasBeenMeasured:N.current.has(t),isExchangeMessage:el[el.length-1].isExchangeMessage??!1,isFirstMountScrollComplete:J,isLast:!0,isResizingPanel:u,isUserMessage:!1,setMeasureRef:e=>{E.current=e},setSize:eu,uniqueId:t,children:(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x1r05qx8",children:el.map((t,a)=>{let i=(0,lM._)(t,c),l=a===el.length-1;return(0,n.jsx)(lU,{chatController:h,chatMessagesNodeGuid:e,clientLifecycleIdMap:x,codeFileChanges:p,codeVersionNumber:ex.get(i)??0,exchangeMessageIds:r,featureType:c,fileName:I,isCurrentVersion:i===em,isLast:l,layerDisplayName:d,message:t,messagesMetadata:s,persistentEntityId:M,requestScrollToBottom:X,showCodeStreaming:m},i)})})},t)}let a=t[t.length-1],i=(0,lM._)(a,c);return(0,n.jsx)(lG,{addMinHeightStyle:V&&el&&1===el.length&&i===(0,lM._)(el[0],c),featureType:c,frozenDimensions:z.current.get(i),hasBeenMeasured:N.current.has(i),isExchangeMessage:!!a.isExchangeMessage,isFirstMountScrollComplete:J,isLast:!0,isResizingPanel:u,isUserMessage:"user"===a.type,setMeasureRef:e=>{E.current=e},setSize:eu,uniqueId:i,children:(0,n.jsx)(lU,{chatController:h,chatMessagesNodeGuid:e,clientLifecycleIdMap:x,codeFileChanges:p,codeVersionNumber:ex.get(i)??0,exchangeMessageIds:r,featureType:c,fileName:I,isCurrentVersion:i===em,isLast:!0,layerDisplayName:d,message:a,messagesMetadata:s,persistentEntityId:M,requestScrollToBottom:X,setUserHasControl:ee,showCodeStreaming:m})},i)})(),y&&(0,P.zy)()&&(0,n.jsx)("div",{...k.Ay.props(lP.messageContainer(c)),children:(0,n.jsx)(ly,{featureType:c})},"downloading-code-files"),eg&&(0,n.jsx)("div",{...k.Ay.props(lP.messageContainer(c)),children:(0,n.jsx)(lf,{featureType:c})},"post-user-thinking"),g&&!f&&!B&&(0,n.jsx)("div",{...k.Ay.props(lP.messageContainer(c)),children:(0,n.jsx)(l_,{})},"post-user-thinking"),(0,n.jsx)("div",{ref:w},"messages-end")]});return(0,a.useEffect)(()=>{let e=b.current;if(!e)return;let t=lq();return lF.set(e,t=>{let s=t.contentRect.height;e.style.setProperty("--chat-container-height",`${s}px`)}),t.observe(e),()=>{lF.delete(e),t.unobserve(e)}},[]),(0,n.jsxs)("div",{ref:b,className:"x1n2onr6 x78zum5 xdt5ytf x5yr21d xh8yej3","data-testid":"code-chat-messages",style:{visibility:J?"visible":"hidden"},children:[ef,es,o&&(0,n.jsx)("div",{className:"x10l6tqk x13vifvy xu96u03 x3m8u43 x1ey2m1c xhtitgo",children:o})]})}let lD=null,lF=new WeakMap;function lq(){return lD||(lD=new ResizeObserver(e=>{requestAnimationFrame(()=>{for(let t of e){let e=lF.get(t.target);e&&e(t)}})})),lD}let lG=a.memo(function(e){let{setSize:t,isResizingPanel:s,frozenDimensions:i,uniqueId:r,setMeasureRef:l,start:o,isLast:c,isFirstMountScrollComplete:d,featureType:u,addMinHeightStyle:x,isUserMessage:m,isExchangeMessage:p,hasBeenMeasured:h}=e,[g,f]=a.useState(!!h),_=(0,a.useRef)(0),y=(0,q.S)(u),v=y&&m&&p,b=d&&(s?i:v||g),j=(0,a.useRef)(!1),C=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=C.current;if(!e||s||!r)return;let n=lq();return lF.set(e,e=>{let s=e.contentRect.height;s>0&&Math.abs(s-_.current)>.5&&(_.current=s,t(r,{width:e.contentRect.width,height:s}),f(!0))}),n.observe(e),()=>{n.unobserve(e),lF.delete(e)}},[t,s,r]),(0,a.useEffect)(()=>{if((c||!j.current)&&C.current&&!s&&r){j.current=!0;let e=lK(C.current);e.height&&(t(r,e),f(!0)),l&&l(C.current)}},[c,t,l,s,r]);let w=s&&i?{width:`${i.width}px`,height:`${i.height}px`}:{};return(0,n.jsx)("div",{ref:C,"data-virtual-index":r,style:{...o?{position:"absolute",top:o,left:0,width:"100%"}:{},...w,visibility:b?"visible":"hidden"},children:(0,n.jsx)("div",{...k.Ay.props(lP.messageContainer(u),y&&x&&lL&&lP.messageContainerWithDynamicHeight),tabIndex:-1,children:e.children})})});function lU({message:e,messagesMetadata:t,featureType:s,codeVersionNumber:a,isLast:i,chatMessagesNodeGuid:r,clientLifecycleIdMap:l,codeFileChanges:o,layerDisplayName:c,exchangeMessageIds:d,requestScrollToBottom:u,showCodeStreaming:x,isCurrentVersion:m,chatController:p,setUserHasControl:h,fileName:g,persistentEntityId:f}){let _=(0,lM._)(e,s);switch(e.type){case"user":return(0,n.jsx)(s3,{user:e.user,featureType:s,plainText:e.plainText,imports:e.imports,inspectedElement:e.inspectedElement,inspectedComponent:e.inspectedComponent,inspectedLibrary:e.inspectedLibrary,selectedNodeIds:e.selectedNodeIds},`${e.type}-${_}`);case"system":switch(e.systemMessageType){case"restore":return(0,n.jsx)(lz.V,{chatController:p,chatMessagesNodeGuid:r,codeVersionNumber:a,featureType:s,isCurrentVersion:m,layerDisplayName:c,message:e,title:e.title||g,trackingContext:{persistentEntityId:f,clientLifecycleId:l.get(e.id)??""}},`${e.type}-${_}`);case"manual_edit":if(e.id===lz.ct&&o)return(0,n.jsx)(lz.Re,{chatController:p,chatMessagesNodeGuid:r,featureType:s,codeFileChanges:o,layerDisplayName:c,codeVersionNumber:a},`${e.type}-${_}`);return(0,n.jsx)(lz.pr,{chatController:p,chatMessagesNodeGuid:r,codeVersionNumber:a,featureType:s,isCurrentVersion:m,layerDisplayName:c,message:e,title:e.title||g,trackingContext:{persistentEntityId:f,clientLifecycleId:l.get(e.id)??""}},`${e.type}-${_}`);case"duplicated_file":return(0,n.jsx)(lz.M_,{},`${e.type}-${_}`);case"deleted_chat_history":return(0,n.jsx)(lz.a_,{message:e},`${e.type}-${_}`);default:return null}case"assistant":let y=e.messages[e.messages.length-1],k=e.clientLifecycleId??l.get(y?.id||"")??"",v=d.has(y?.id||"");return(0,n.jsx)(lp,{chatController:p,chatMessagesNodeGuid:r,codeVersionNumber:a,featureType:s,hasExchangeMessages:d.size>0,isAutoErrorFix:e.isAutoErrorFix??!1,isCurrentVersion:m,isInProgress:v,isMostRecent:i,layerDisplayName:c??void 0,mergedMessagesMetadata:t,messages:e.messages,messagesMetadata:e.messagesMetadata,scrollToBottom:u,setUserHasControl:h,showCodeStreaming:x,title:e.title||g,trackingContext:{persistentEntityId:f,clientLifecycleId:k}})}}function lK(e){if(!e)return{width:0,height:0};let t=e.getBoundingClientRect();return{width:t.width,height:t.height}}var lH=s(482132),lB=s(646673);let lV=(e,t,s,n)=>{let a=(0,o.ft)();a>=2&&(n=n?`${n}/src`:"src");let i=e.codeFiles.map(e=>{let s=t.get(e.codeFileGuid);return s?(f.l7.ai("set-code-file-path",()=>{let e=((0,sd.z)("multi_file_code_layers")||(0,sd.z)("bake_canvas")||a>=2)&&n?`${n}/${lB.zM}`:lB.zM;s.codeFilePath=e}),{fullFilePath:s.codeFileFullPathWithoutScheme,code:s.sourceCode,codeFileGuid:s.guid}):(console.error("codeFileNode not found",{codeFileAttachment:e}),null)}).filter(e=>!!e);return{type:"node",guid:e.nodeGuid,codeFiles:i,communityAttribution:s.get(e.nodeGuid),image:e.image??void 0}},l$=e=>({type:"image",guid:e.nodeGuid,image:e.image,imageHash:e.imageHash??void 0}),lW=e=>({type:"diff",guid:e.nodeGuid,diffs:e.diffs,image:e.image??void 0}),lY={hidden:{opacity:0,scale:.8},visible:{opacity:1,scale:1,transition:{duration:.3}},exit:{opacity:0,scale:.8,transition:{duration:.2}}},lX={animate:e=>({opacity:[.5,1,.5],y:[0,-2,0],transition:{duration:1,repeat:Number.POSITIVE_INFINITY,ease:"easeOut",times:[0,.5,1],delay:e}})};function lZ({visible:e}){return(0,n.jsx)(v.N,{mode:"wait",children:e&&(0,n.jsx)(b.P.div,{className:"x78zum5 x6s0dn4 x1v8gsql xc7ga6q x1i2kgm6 x1db2dqx",animate:"visible",exit:"exit",initial:"hidden",variants:lY,children:(0,n.jsxs)("div",{className:"x78zum5 x195vfkc xpqajaz",children:[(0,n.jsx)(b.P.span,{className:"x1g8rjiy xuoj239 x1vc12gn xorixrz",custom:0,animate:"animate",variants:lX}),(0,n.jsx)(b.P.span,{className:"x1g8rjiy xuoj239 x1vc12gn xorixrz",custom:.25,animate:"animate",variants:lX}),(0,n.jsx)(b.P.span,{className:"x1g8rjiy xuoj239 x1vc12gn xorixrz",custom:.5,animate:"animate",variants:lX})]})})})}function lJ({typingUsers:e}){return(0,n.jsx)("div",{className:"xqtp20y x1vjfegm x1n2onr6",children:(0,n.jsxs)("div",{className:"x10l6tqk x2rgi x131sewu x78zum5 xh8yej3 x13a6bvl",children:[(0,n.jsx)(lZ,{visible:e.length>0}),(0,n.jsx)(v.N,{mode:"wait",children:e.map((e,t)=>(0,n.jsx)(u.K,{"aria-label":e.name,"data-tooltip-show-above":!0,children:(0,n.jsx)(b.P.div,{className:"x1qgsegg xaatb59 xlofgcs x16rqkct",style:{marginLeft:t>0?"-6px":"0"},animate:"visible",exit:"exit",initial:"hidden",variants:lY,children:(0,n.jsx)(e9.H8,{user:e})})},e.sessionID))})]})})}function lQ(){return(0,n.jsxs)("svg",{width:"41",height:"41",viewBox:"0 0 41 41",fill:"none",children:[(0,n.jsx)("rect",{x:"0.776855",y:"0.777344",width:"40",height:"40",rx:"5",fill:"white"}),(0,n.jsx)("rect",{x:"2.77686",y:"2.77734",width:"36",height:"36",rx:"4",fill:"url(#paint0_linear_9279_71495)"}),(0,n.jsx)("circle",{cx:"28.2769",cy:"13.2773",r:"5.5",fill:"#FFD966"}),(0,n.jsx)("path",{d:"M10.7964 19.4661L2.77686 28.4176V35.7773C2.77686 37.4342 4.12 38.7773 5.77686 38.7773H34.7769L17.4119 19.4604C15.6442 17.4939 12.5608 17.4966 10.7964 19.4661Z",fill:"#009951"}),(0,n.jsx)("defs",{children:(0,n.jsxs)("linearGradient",{id:"paint0_linear_9279_71495",x1:"20.7769",y1:"2.77734",x2:"20.7769",y2:"38.7773",gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#6EC2FF"}),(0,n.jsx)("stop",{offset:"0.117896",stopColor:"#6FC2FF"}),(0,n.jsx)("stop",{offset:"0.213837",stopColor:"#72C4FF"}),(0,n.jsx)("stop",{offset:"0.2912",stopColor:"#76C6FF"}),(0,n.jsx)("stop",{offset:"0.353363",stopColor:"#7CC8FF"}),(0,n.jsx)("stop",{offset:"0.403704",stopColor:"#84CBFF"}),(0,n.jsx)("stop",{offset:"0.4456",stopColor:"#8CCFFF"}),(0,n.jsx)("stop",{offset:"0.48243",stopColor:"#95D2FF"}),(0,n.jsx)("stop",{offset:"0.51757",stopColor:"#9FD7FF"}),(0,n.jsx)("stop",{offset:"0.5544",stopColor:"#A9DBFF"}),(0,n.jsx)("stop",{offset:"0.596296",stopColor:"#B4DFFF"}),(0,n.jsx)("stop",{offset:"0.646637",stopColor:"#BEE4FF"}),(0,n.jsx)("stop",{offset:"0.7088",stopColor:"#C9E8FF"}),(0,n.jsx)("stop",{offset:"0.786163",stopColor:"#D3ECFF"}),(0,n.jsx)("stop",{offset:"0.882104",stopColor:"#DCF0FF"}),(0,n.jsx)("stop",{offset:"1",stopColor:"#E5F4FF"})]})})]})}function l0(){return(0,n.jsx)(v.N,{children:(0,n.jsxs)(b.P.div,{className:"x1n2onr6 xh8yej3 x5yr21d x1yjdb4r x78zum5 xdt5ytf x6s0dn4 xl56j7k",initial:{opacity:0},animate:{opacity:.95},exit:{opacity:0,transition:{delay:.1}},transition:{duration:.2},children:[(0,n.jsxs)("div",{className:"x1n2onr6 xrostsh xng8ra x78zum5 x6s0dn4 xl56j7k",children:[(0,n.jsx)(b.P.div,{className:"x10l6tqk xu96u03",style:{originX:.5,originY:.5},initial:{rotate:0,x:34,y:2,scale:.8,opacity:0},animate:{rotate:-20,x:20,y:4,scale:1,opacity:.95},exit:{rotate:-23,x:20,y:4,scale:.8,opacity:0,transition:{delay:.1}},transition:{duration:.3,type:"spring",delay:.1},children:(0,n.jsx)(lQ,{})}),(0,n.jsx)(b.P.div,{className:"x1vjfegm",style:{originX:.5,originY:.5},initial:{scale:.8,y:0,opacity:0},animate:{scale:1,y:0,opacity:.95},exit:{scale:.8,y:0,opacity:0,transition:{delay:.1}},transition:{duration:.4,type:"spring"},children:(0,n.jsx)(lQ,{})}),(0,n.jsx)(b.P.div,{className:"x10l6tqk x3m8u43",style:{originX:.5,originY:.5},initial:{rotate:0,x:-34,y:4,scale:.8,opacity:0},animate:{rotate:23,x:-22,y:4,scale:1,opacity:.95},exit:{rotate:23,x:-22,y:2,scale:.8,opacity:0,transition:{delay:.1}},transition:{duration:.4,type:"spring",delay:.1},children:(0,n.jsx)(lQ,{})})]}),(0,n.jsxs)(b.P.div,{className:"xw7yly9 x78zum5 xdt5ytf x6s0dn4",children:[(0,n.jsx)(b.P.p,{className:"x1wtuluy x1vzchgk x123g5w4 x1akne3o x1ghz6dp",initial:{opacity:0,y:8},animate:{opacity:.95,y:0},exit:{opacity:0,y:0,transition:{delay:0}},transition:{duration:.2,ease:"easeOut"},children:(0,_.t)("figmake.code_chat.drag_upload_overlay.title")}),(0,n.jsx)(b.P.p,{className:"x17hqfcz xemv814 x1ma9mv9 x1n0bwc9 x1xmf6yo x2b8uid x1jkqq1h",initial:{opacity:0,y:8},animate:{opacity:.95,y:0},exit:{opacity:0,y:0,transition:{delay:0}},transition:{duration:.2,delay:.1,ease:"easeOut"},children:(0,_.t)("figmake.code_chat.drag_upload_overlay.description")})]})]})})}var l1=s(63760),l5=s(580763),l2=s(750665),l3=s(680912),l4=s(276647),l6=s(2674),l7=s(735786),l8=s(796557),l9=s(179189),oe=s(597472),ot=s(13782),os=s(253753),on=s(442182),oa=s(875253),oi=s(859100),or=s(852553),ol=s(634224),oo=s(550534),oc=s(935467),od=s(215496),ou=s(222041),ox=s(271625),om=s(530079),op=s(172397),oh=s(639184),og=s(527205),of=s(355441),o_=s(328772);function oy({targetKey:e,isShowing:t,onComplete:s}){return(0,n.jsx)(og.rq,{arrowPosition:of.F_.BOTTOM,description:(0,_.tx)("figmake.design_system_imports.selected_design_system_overlay.description"),emphasized:!0,isShowing:t,onClose:s,onTargetLost:s,primaryCta:{label:(0,_.tx)("figmake.design_system_imports.learn_more"),href:o_.kC,type:"link",variantOverride:"white",ctaTrackingDescriptor:oh.c.DS_IMPORT_LEARN_MORE},targetKey:e,title:(0,_.tx)("figmake.design_system_imports.selected_design_system_overlay.title"),trackingContextName:"Make Design System Imports > Selected Design System Overlay"})}let ok=(0,ol.r1)("seen_figmake_selected_design_system_onboarding");function ov({isViewOnly:e,hasMessages:t,disabled:s,chatController:i}){let r;let l=(0,P.zy)(),c=(0,y.md)(ok),{libraryImport:u}=(0,e1.S1)({chatController:i}),{show:x,isShowing:m,complete:p}=(0,oi.e)({overlay:ox.q6k,priority:od.N.DEFAULT_MODAL},[c]),h=(0,A.tS)();a.useEffect(()=>{if(e)return;let t=(0,o.$d)();t[o_.dY]||t[o_.x1]||f.l7.ai("code-chat",()=>{a2.UN()?.createNewCodeFile({path:o_.dY,sourceCode:"",entryPoint:null,isEntrypointCodeFile:!1,onError:e=>{w.$D(d.e.MAKE,e)},createCodeComponent:!1})})},[e]);let g=(0,A.q5)(),k=(0,eV.X$)("LibraryImportButton"),v=(0,eV.YY)(k).unwrapOr(!1),b=(0,om.S)(),C=(0,a.useRef)(null),E=(0,eo.wA)();a.useEffect(()=>{u&&!y.zl.get(ei.FX)&&x({canShow:e=>!e})},[u,x]);let N=u?.frozen?u:null,{getTriggerProps:S,manager:T}=l7.b(),I=(0,op.j)(),M=v&&(0,sd.z)("bake_starter_limit"),z=()=>{if(M){E(np.to({type:ou.DV,data:{team:g?.team??null,resource:oc.Bi.CODE_CHAT_LIBRARY_IMPORT,currentPlan:or.F.Plan.STARTER,upsellPlan:or.F.Plan.PRO,editorType:eB._Y.FIGMAKE,entryPoint:oo.C.CODE_CHAT_LIBRARY_IMPORT}}));return}let e=C.current;if(!e)return;if(b){E(np.ES(om.u));return}j.az.trackDefinedEvent("ds_import.library_import_button_clicked",{...(0,e1.FN)(u),file_key:h||""});let s=e.getBoundingClientRect(),n=new oa.Mi(s.left,s.top);E(np.to({type:om.u,data:{defaultPosition:{left:n.x,bottom:window.innerHeight-n.y+10},hasExistingChatMessages:t,chatController:i}}))},L=S(),O=L.onMouseDown;if(L.onMouseDown=e=>{e.preventDefault(),e.stopPropagation(),j.az.trackDefinedEvent("ds_import.settings_button_clicked",{...(0,e1.FN)(u),file_key:h||""}),p(),O(e)},(0,sd.z)("bake_ds_import_extract"))return(0,n.jsx)("div",{ref:C,children:(0,n.jsx)(l8.d,{"aria-label":(0,_.t)("sites.modal.select_library"),"aria-expanded":b,"data-tooltip-show-above":!0,disabled:s,htmlAttributes:{"data-onboarding-key":X.t$},onClick:z,children:(0,n.jsx)(l9.l,{})})});let R=(0,o.ft)(),D=(0,n.jsxs)(l7.bL,{manager:T,children:[(0,a.createElement)(eh.E,{...{0:{className:"x1ia1hqs x14msgrb xi46uaa xfrllxf xe0pwq x19ypqd9 x1u2bih1 xuk1p4z xv2f06h xvy4d1p xxk0z11 x78zum5 x6s0dn4 xl56j7k xxhr3t"},1:{className:"x1ia1hqs x14msgrb xi46uaa xfrllxf xe0pwq x19ypqd9 x1u2bih1 xuk1p4z xvy4d1p xxk0z11 x78zum5 x6s0dn4 xl56j7k xxhr3t x1yjdb4r"}}[!!(!s&&N)<<0],disabled:s,key:"editButton",...L,"data-onboarding-key":X.oD},(0,n.jsx)(oe.g,{})),(0,n.jsxs)(l7.mc,{children:[(0,n.jsxs)(l7.q7,{onClick:()=>{j.az.trackDefinedEvent("ds_import.edit_styles_menu_item_clicked",{...(0,e1.FN)(u),file_key:h||""}),I(R>=2?l6.VY:o_.VK)},children:[(0,n.jsx)(l7.Q$,{children:(0,n.jsx)(ot.J,{})}),(0,n.jsxs)("div",{children:[(0,_.t)("sites.modal.edit_styles_menu_title"),(0,n.jsx)(l7.ME,{children:(0,_.t)("sites.modal.edit_styles_menu_subtitle")})]})]}),(0,n.jsxs)(l7.q7,{onClick:()=>{j.az.trackDefinedEvent("ds_import.edit_guidelines_menu_item_clicked",{...(0,e1.FN)(u),file_key:h||""}),I(o_.dY,o_.x1)},children:[(0,n.jsx)(l7.Q$,{children:(0,n.jsx)(os.L,{})}),(0,n.jsxs)("div",{children:[(0,_.t)("sites.modal.edit_guidelines_menu_title"),(0,n.jsx)(l7.ME,{children:(0,_.t)("sites.modal.edit_guidelines_menu_subtitle")})]})]})]})]}),F=u?.libraries;return(F&&F.length>0&&F.every(e=>e&&e.library_key)&&(1===F.length?r=F[0].library_name:F.length>1&&(r=(0,_.t)("figmake.ds_imports.library_selector_multiple_libraries"))),l)?(0,n.jsxs)("div",{ref:C,children:[(0,n.jsx)(oy,{targetKey:X.oD,isShowing:m,onComplete:p}),(0,n.jsx)(l8.d,{"aria-label":(0,_.t)("sites.modal.select_library"),"aria-expanded":b,"data-tooltip-show-above":!0,disabled:s,htmlAttributes:{"data-onboarding-key":X.oD},onClick:z,children:(0,n.jsx)(l9.l,{})})]}):N?(0,n.jsxs)("div",{ref:C,className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up xmkeg23 x1y0btm7 x7z60cl xpzoddv x1v8gsql xxk0z11 x3nfvp2 x1q0g3np x6s0dn4 xxhr3t x2lah0s",children:[(0,a.createElement)(eh.E,{className:"xuk1p4z xv2f06h x1hb7l2i x1a2w583 xjppbhk xsz7qvg x1lqa7cf x1ug7bdz xxhr3t",disabled:!0,key:"libraryImportButton",onClick:lT.lQ},(0,n.jsx)("div",{className:"x10739mo xlup9mm xb3r6kr xlyipyv xuxw1ft",children:r})),D]}):r?(0,n.jsxs)("div",{ref:C,...{0:{className:"x3nfvp2 x1q0g3np xxk0z11 x6s0dn4 xxhr3t x2lah0s xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up xmkeg23 x1y0btm7 x7z60cl xpzoddv"},1:{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up xmkeg23 x1y0btm7 x7z60cl xpzoddv x1v8gsql xxk0z11 x3nfvp2 x1q0g3np x6s0dn4 xxhr3t x2lah0s"}}[!!s<<0],children:[(0,n.jsx)(oy,{targetKey:X.oD,isShowing:m,onComplete:p}),(0,a.createElement)(eh.E,{...{0:{className:"x1hb7l2i x1a2w583 xjppbhk xsz7qvg x1lqa7cf xuk1p4z xv2f06h xxhr3t"},1:{className:"xuk1p4z xv2f06h x1hb7l2i x1a2w583 xjppbhk xsz7qvg x1lqa7cf x1ug7bdz xxhr3t"}}[!!s<<0],disabled:s,key:"libraryImportButton",onClick:z},(0,n.jsx)("div",{className:"x10739mo xlup9mm xb3r6kr xlyipyv xuxw1ft",children:r}),(0,n.jsx)("div",{className:"x1kky2od x78zum5 xl56j7k xb3r6kr",children:(0,n.jsx)(on.r,{})})),D]}):(0,n.jsx)("div",{ref:C,children:(0,n.jsx)(l8.d,{"aria-label":(0,_.t)("sites.modal.select_library"),"aria-expanded":b,"data-tooltip-show-above":!0,disabled:s,htmlAttributes:{"data-onboarding-key":X.t$},onClick:z,children:(0,n.jsx)(l9.l,{})})})}var ob=s(320598),oj=s(568659);function oC({disabled:e}){let{usedMakeLibraryIds:t}=(0,e1.cH)(),s=(0,A.q5)(),i=(0,eV.No)(),r=(0,eV.YY)(i).unwrapOr(!1),l=(0,om.S)(),o=(0,a.useRef)(null),c=(0,eo.wA)(),{getTriggerProps:d}=l7.b(),u=r&&(0,sd.z)("bake_starter_limit"),x=d(),m=x.onMouseDown;x.onMouseDown=e=>{e.preventDefault(),e.stopPropagation(),j.az.trackDefinedEvent("ds_import.settings_button_clicked",{library_keys:t.join(","),file_key:s?.key??""}),m(e)};let p=t&&t.length>0,h=p?t.length:0,g=p?1===h?(0,_.t)("figmake.empty_state.make_kit_selected"):(0,_.t)("figmake.empty_state.make_kits_selected",{count:h}):(0,_.t)("figmake.empty_state.select_a_make_kit");return(0,n.jsx)("div",{ref:o,...{0:{},1:{className:"xdozpx"}}[!!p<<0],children:(0,n.jsx)(l8.d,{"aria-label":g,"aria-expanded":l,"data-tooltip":g,disabled:e,onClick:()=>{if(u){c(np.to({type:ou.DV,data:{team:s?.team??null,resource:oc.Bi.CODE_CHAT_LIBRARY_IMPORT,currentPlan:or.F.Plan.STARTER,upsellPlan:or.F.Plan.PRO,editorType:eB._Y.FIGMAKE,entryPoint:oo.C.CODE_CHAT_LIBRARY_IMPORT}}));return}let e=o.current;if(!e)return;if(l){c(np.ES(oj.W));return}j.az.trackDefinedEvent("ds_import.library_import_button_clicked",{library_keys:t.join(","),file_key:s?.key??""});let n=e.getBoundingClientRect(),a=new oa.Mi(n.left,n.top);c(np.to({type:oj.W,data:{defaultPosition:{left:a.x,bottom:window.innerHeight-a.y+10},entrypoint:"chat"}}))},children:p?(0,n.jsx)(ob.r,{}):(0,n.jsx)(l9.l,{})})})}var ow=s(24867),oE=s(66892),oN=s(601493);let oS={ENHANCE_PROMPT:"enhance-prompt-button",ATTACH_IMAGE:"attach-image-button"};function oT({disabled:e,onClick:t,onUndo:s,isEnhanced:a}){return(0,sd.z)("bake_enhance_prompt")?(0,n.jsx)(v.N,{mode:"wait",children:a?(0,n.jsx)(b.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2,ease:"easeInOut"},children:(0,n.jsx)(u.K,{"aria-label":(0,_.t)("figmake.chat_box.undo_enhance_prompt"),"data-tooltip-show-above":!0,disabled:e,onClick:s,children:(0,n.jsx)(m.H,{})})},"undo"):(0,n.jsx)(b.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2,ease:"easeInOut"},children:(0,n.jsx)(u.K,{"aria-label":(0,_.t)("figmake.chat_box.enhance_prompt"),"data-tooltip-show-above":!0,"data-testid":oS.ENHANCE_PROMPT,disabled:e,onClick:t,children:(0,n.jsx)(p.K,{})})},"enhance")}):(0,n.jsx)(n.Fragment,{})}function oI({enableAssetImport:e,enableImageAttachment:t,enableDsImport:s,enableConnections:i,createLoadedAttachment:r,attachments:l,isViewOnly:o,chatMessagesNodeGuid:c,codeInstanceGuid:x,enhancePrompt:m,isEnhancing:p,generationInProgress:g,hasMessages:f,chatController:k}){let v=(0,y.md)(D.mK),b=a.useRef(null),[j,C]=(0,y.fp)((0,F.mC)(c)),[E,S]=a.useState(""),[T,I]=a.useState(!1),A=(0,er.g7)(),M=(0,er.Gu)(),L=!!(0,y.md)(U.$X),O=!!(0,y.md)(R.ww),q=(0,P.zy)()&&(L||O),G=(0,y.md)(Y.jx)===Y.Ic.CODE,K=(0,y.md)((0,aT.ye)(c)),H=a.useCallback(async e=>{let t=e.target.files?.[0];t&&(await (0,ow.zF)(t,r),b.current&&(b.current.value=""))},[r]),B=a.useCallback(async()=>{try{for await(let e of(S(j),m(j)))C(e);I(!0)}catch(e){S(""),I(!1),(0,w.$D)(d.e.MAKE,e instanceof Error?e:Error(String(e)))}},[m,j,C]),V=a.useCallback(()=>{C(E),I(!1),S("")},[E,C]);a.useEffect(()=>{T&&""===j&&(I(!1),S(""))},[j,T]);let $=t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{type:"file",className:"x1s85apg",ref:b,accept:z.xp.join(","),"data-testid":"image-attachment-input",onChange:H}),(0,n.jsx)(u.K,{"aria-label":l.length>=tQ.qQ?(0,_.t)("sites.panel.make.attach_limit_reached",{limit:tQ.qQ}):(0,_.t)("sites.panel.make.attach_image"),"data-tooltip-show-above":!0,"data-testid":oS.ATTACH_IMAGE,disabled:o||l.length>=tQ.qQ,onClick:()=>{b.current?.click()},children:(0,n.jsx)(h.s,{})})]}):null;return t||e?A?(0,n.jsx)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:$}):(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,n.jsx)(lH.D,{enableAssetImport:e,enableImageAttachment:t,enableConnections:i,attachments:l,isViewOnly:o,chatMessagesNodeGuid:c,createLoadedAttachment:r,shouldProcessDroppedAttachments:!0}),(0,n.jsx)(oT,{disabled:o||(0,N.jN)(j)||p,onClick:B,onUndo:V,isEnhanced:T}),s&&((0,P.zy)()?(0,n.jsx)(oC,{disabled:g||o}):(0,n.jsx)(ov,{isViewOnly:o,hasMessages:f,disabled:g||o,chatController:k})),v&&x&&(0,n.jsx)(oA,{sitesPreview:v,codeInstanceGuid:x,disabled:o||!1!==M||g||K||q&&G})]}):(0,n.jsx)("div",{})}function oA({sitesPreview:e,codeInstanceGuid:t,disabled:s}){return(0,n.jsx)(n.Fragment,{children:(0,sd.z)("bake_point_and_edit")?(0,n.jsx)(ea,{disabled:s,sitesPreview:e,onboardingKey:X.kx,showTooltipAbove:!0}):(0,sd.z)("bake_click_to_inspect")?(0,n.jsx)(Q.l,{disabled:s,sitesPreview:e,onboardingKey:X.kx,showTooltipAbove:!0,codeInstanceGuid:t}):null})}async function oM(e,t,s){let{nodeGuid:n,uniqueId:a}=t,i=e.get(n);if(!i)return t;let l=performance.now();try{let e=await (0,r.rt)(i);if(!e)throw Error("Failed to downgrade Figma node to image");let t={status:"success",nodeGuid:i.guid,image:e,imageHash:null,type:"IMAGE",uniqueId:a,wasImageConvertedFromFigmaNode:!0};return s({step:g.doA.CONVERT_FIGMA_NODE_TO_IMAGE,attachmentType:"FIGMA_NODE",attachmentId:a,nodeGuid:n,elapsedMs:performance.now()-l}),t}catch(e){return(0,w.$D)(d.e.MAKE_EDITING,e,{extra:{nodeGuid:i.guid}}),s({step:g.doA.CONVERT_FIGMA_NODE_TO_IMAGE,attachmentType:"FIGMA_NODE",attachmentId:a,nodeGuid:n,elapsedMs:performance.now()-l,error:e.message}),t}}function oz({setInput:e,chatMessagesNodeGuid:t,chatController:s,codeInstanceGuid:r,exchangeMessageIds:d,layerDisplayName:u,codeFileChanges:m,sendMessage:p,emptyState:h,sendDisabled:k,enableAssetImport:v=!1,enableImageAttachment:b=!1,chatBoxLeftExtraContent:w,chatBoxRightExtraContent:N,showChatHeader:z=!1,featureType:R,enableDragUpload:Y=!1,enableDsImport:X=!1,enableConnections:Q=!1,isResizingPanel:ee,isLastUserMessageAutoErrorFix:et,messagesForRendering:es,messagesMetadata:en,clientLifecycleIdMap:ea,showCodeStreaming:eo,rootPath:ec,onChatInputBlur:ed,onChatInputFocus:eu,typingUsers:ex=[],forceReadOnly:em,hideChatBox:ep,canCancelGeneration:eh,generationInProgress:eg,resumableMakeInProgress:ef,currentUserCanHandleResumableMake:e_,cleanUpResumableMake:ey}){let ek=(0,G.ry)()||em,ev=(0,sd.z)("bake_client_side_context_limit"),eb=(0,er.hk)(),ej=(0,y.Xr)(ei.St),ew=(0,I.eY)(),eE=(0,y.md)(D.mK),eN=(0,y.Xr)(F.oy),eS=(0,y.md)(K.UV),{Sprig:eT}=(0,E.A)(),eI=function(e){let t=(0,sZ.iZ)();return t?e.filter(e=>"user"===e.type&&e.user.id===t.id).length:0}(es.filter(e=>"user"===e.type&&!d.has(e.id))),eA=function({chatController:e}){let{usedMakeLibraryIds:t}=(0,B.c)(),{libraryImport:s}=(0,H.S)({chatController:e}),n=s?.libraries.map(e=>e.library_key)??[];return(0,P.zy)()?t??[]:n}({chatController:s}),{exchange:eM,user:ez}=(0,F.$W)(t),eL=(0,a.useRef)(null),eO=(0,a.useRef)(null),eP=(0,a.useRef)(null),eR=(0,t7.YT)(),eD=(0,A.q5)(),eF=eD?.key,eq=(0,a.useMemo)(()=>(0,O.qE)(eF||null,t),[eF,t]);a.useEffect(()=>{eL.current&&"keyboard"!==x.F.type&&eL.current.focus()},[]),(0,t7.vG)(t);let eG=(0,a.useCallback)(s=>{if(!eL.current)return;let n=eL.current.selectionStart,a=eL.current.selectionEnd,i=y.zl.get((0,F.mC)(t));e(i.substring(0,n)+s+i.substring(a))},[t,e]),eU=(0,a.useCallback)((e,t,s,n)=>{j.az.trackDefinedEvent("ai_for_production.code_chat_design_node_pasted",{featureType:R,hasInstances:s>0,number_of_nodes:t,number_of_instances:s,persistent_entity_id:eq,file_key:eF,attachmentId:n})},[R,eq,eF]),eK=(0,a.useCallback)((e,t,s,n)=>{j.az.trackDefinedEvent("ai_for_production.code_chat_design_node_paste_completed",{featureType:R,elapsedMs:s,hasInstances:t>0,number_of_nodes:e,number_of_instances:t,persistent_entity_id:eq,file_key:eF,attachmentId:n})},[R,eq,eF]),eH=(0,a.useCallback)(({step:e,attachmentType:t,attachmentId:s,nodeGuid:n,elapsedMs:a,error:i,nodeCount:r,instanceCount:l})=>{e===g.doA.START&&"FIGMA_NODE"===t&&void 0!==r&&void 0!==l?eU(n,r,l,s):e===g.doA.PASTE_COMPLETED&&"FIGMA_NODE"===t&&void 0!==r&&void 0!==l&&eK(r,l,a,s),e===g.doA.START&&y.zl.set((0,tQ.wd)(n),performance.now()),j.az.trackDefinedEvent("ai_for_production.code_chat_figma_attachment_funnel",{step:g.doA[e],featureType:R,attachmentType:t,attachmentId:s,fileKey:eF,nodeGuid:n,elapsedMs:a,error:i,nodeCount:r,instanceCount:l,persistentEntityId:eq})},[R,eq,eF,eU,eK]);(0,l5.p)(t,eG,eH,{sitesPreview:eE??void 0,fileKey:eF??"",fileName:y.zl.get(A.yV)?.name||""});let{attachments:eB,setAttachments:eV,stashAllAttachments:e$,createLoadedAttachment:eW,attachmentsReady:eY}=(0,tQ._9)(t),eX=a.useMemo(()=>eB.some(e=>"success"===e.status&&"FIGMA_NODE"===e.type&&e.image),[eB]),eZ=a.useCallback(async()=>{eV(await (0,c.lX)(eB,async e=>"success"===e.status&&"FIGMA_NODE"===e.type?await oM(ew,e,eH):e))},[eB,ew,eV,eH]),{selectedElement:eJ,selectedElementCodeSnippet:eQ}=(0,V.fl)(),{selectedJsxSource:e0}=(0,Z.lA)(),e1=(0,V.sG)(),e5=(0,P.zy)()&&e1&&!eJ,e2=(0,V.YC)(),{setChatError:e3,chatError:e4,clearChatError:e6}=(0,t0.tk)(t),e7=(0,t1.kV)(t),e8=(0,y.md)(t7.Ng),e9=eJ&&eQ?(0,$.F)(eJ,eQ):null,te=(0,l1.C)({fileKey:eF,persistentEntityId:eq,chatMessagesNodeGuid:t,attachments:eB,inspectedElement:e9,inspectedComponent:e5?e1:null});a.useEffect(()=>{te||e4?.error.message===t0.T_.MAX_CONTENT_LENGTH_EXCEEDED?te&&e4?.error.message===t0.T_.MAX_CONTENT_LENGTH_EXCEEDED&&e6():(0,sd.z)("bake_downgrade_figma_nodes_to_images")&&eX?(e3({error:Error(t0.T_.MAX_CONTEXT_LENGTH_EXCEEDED_IMAGE_FALLBACK)}),eZ()):e3({error:Error(t0.T_.MAX_CONTENT_LENGTH_EXCEEDED)})},[te,e4,e3,e6,eX,eZ]);let{communityAttribution:tt}=(0,t6.Pe)(),ts=(0,el.Oc)(),tn=(0,T.Tv)(),ta=async({message:e,errors:t,hidden:s,origin:n,isUserInput:a=!1})=>{if(!ek&&!e8&&(e||s))try{let r;e6(),e7();let c=function(e,t,s){let n=(0,a2.UN)();return e.filter(e=>"success"===e.status).map(e=>{switch(e.type){case"FIGMA_NODE":return lV(e,n,t,s);case"IMAGE":return l$(e);case"DIFF":return lW(e)}})}(eB,tt,ec);(0,sd.z)("make_import_improvements_experimental")&&function(e){let t;e.forEach(e=>{"node"===e.type&&e.codeFiles&&e.codeFiles.forEach(e=>{if(void 0===e.code)return;let s=e.code,n=!1;if(s=s.replace(/^(?!export\s)(async\s+)?function\s+(\w+)/gm,e=>(n=!0,`export ${e}`)),n&&e.fullFilePath){let t=(0,o._J)(e.fullFilePath);t&&t.sourceCode!==s&&f.l7.ai("export-functions",()=>{t.sourceCode=s})}let a=e.code.match(/export\s+default\s+function\s+(\w+)/);a&&a[1]&&!t&&(t={functionName:a[1],filePath:e.fullFilePath})})});let s=es&&es.length>0;if(t&&eb&&!s){let e=t.filePath.replace(/^\//,"").replace(/\.tsx?$/,""),s=`import ${t.functionName} from "./${e}";

export default function App() {
  return <${t.functionName} />;
}`,n=(0,l.iB)(),a=(0,o._J)(n);a&&f.l7.ai("update-app-tsx",()=>{a.sourceCode=s}),ej(!0)}}(c),e$();let d=e||"";eJ&&eQ?r=(0,$.F)(eJ,eQ):e0&&(r=(0,J.Fo)(e0));let u=tn.filter(e=>!!ew.get(e)),x={plainText:e,libraryKey:eA&&eA.length>0?eA[0]:void 0,libraryKeys:eA,imports:c,inspectedElement:r,inspectedComponent:e5?e1:void 0,inspectedLibrary:e2,errors:t,hidden:s,selectedNodeIds:u,origin:n},m=e0?(0,J.uA)(e0,d):(0,oE.u)(d,c,eJ?.elementAndParentSources);await p(x,m);let h=eA[0];if(h){let e={fileKey:eF||"",libraryKey:h,library_keys:eA.join(",")};(0,sd.z)("bake_ds_import_l3a")||(0,P.zy)()?(0,L.ZR)(h).then(t=>{j.az.trackDefinedEvent("ds_import.library_used_in_generation",{...e,includeComponents:t.data.meta.has_generated_components})}):j.az.trackDefinedEvent("ds_import.library_used_in_generation",{...e})}eR("success",{message:d}),(0,sd.z)("bake_sprig")&&R===i.lV.FIGMAKE&&a&&eI>=2&&eT("track","bake_survey_1_3_chats_sent")}catch(e){eR("error",{error:e instanceof Error?e.message:"Unknown error"}),e3(e instanceof Error?{error:e}:{error:Error("Unknown error")})}},ti=(0,C.F)(ta);(0,a.useEffect)(()=>{let e=()=>{ti.current({message:y.zl.get((0,F.mC)(t)),isUserInput:!0})};return W.Uy.on("submit",e),()=>{W.Uy.removeListener("submit",e)}},[ti,t]);let tr=(0,M.KP)(),tl=void 0!==eM&&eM.messages.length>0||ef,to=(0,U.Wn)(t);!function({chatMessagesNodeGuid:e,featureType:t}){let{exchange:s,user:n}=(0,F.$W)(e),r=void 0!==s&&s.messages.length>0,l=(0,y.md)(td.kU),o=(0,A.tS)(),c=(0,sZ.iZ)(),d=(0,t9.Z)();a.useEffect(()=>{if(!r&&!l||!o||r&&n?.userID!==c?.id||d)return;let e=e=>{let n;e.preventDefault(),e.returnValue=!0;let a=s?.messages[0];a&&a.type===g.K$p.USER_MESSAGE&&(n=(0,i.MK)(a,!!(0,eC.kc)().make_chat_contents_cache).requestUuid),j.az.trackDefinedEvent("ai_for_production.unsaved_changes_warning_shown",{fileKey:o,featureType:t,requestUuid:n,userMessageId:a?.id})};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[r,l,d,o,t,s?.messages,n?.userID,c?.id])}({chatMessagesNodeGuid:t,featureType:R});let tc=(0,er.g7)(),{enhancePrompt:tu,isEnhancing:tx}=function(e){let[t,s]=(0,a.useState)(!1),{setChatError:n,clearChatError:i}=(0,t0.tk)(e);return{enhancePrompt:(0,a.useCallback)(async function*(e){let t;if(!e.trim())return e;s(!0),i();try{t=(await l2.Ay.shared.figmakeEnhancePrompt({prompt:e},{...(0,l3.Ay)()})).getReader();let s="";for(;;){let{done:e,value:n}=await t.read();if(e)break;s+=n.delta,yield s}return s}catch(t){let e=t instanceof Error?t:Error("Failed to enhance prompt");throw n({error:Error(t0.T_.PROMPT_ENHANCEMENT_FAILED)}),e}finally{t?.releaseLock(),s(!1)}},[n,i]),isEnhancing:t}}(t),tm=!tl&&eY&&!to&&(te||!ev)&&!tx&&!e8&&(!s||s.isInitialized);(0,l4.R)({enabled:!!(R===i.lV.FIGMAKE&&tm&&eD?.canEdit),chatController:s,setInput:e,sendMessage:ta});let tp=es?.length?(0,_.t)("living_designs.chat.placeholder.iterate"):(0,_.t)("living_designs.chat.placeholder.blank_slate"),[th,tg]=a.useState(!1),tf=async e=>{if(ek||e8||!b||!Y)return;let t=(0,oN.C)(e.files,eB);if(!t.valid){tg(!1);return}let s=t.imageFiles.map(async e=>{await (0,ow.zF)(e,eW)});await Promise.all(s),tg(!1)},t_=(0,q.S)(R);return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xh8yej3 x5yr21d",ref:eO,children:[(0,n.jsxs)("div",{className:"x1n2onr6 xh8yej3 x5yr21d x78zum5 xdt5ytf",children:[z&&(0,n.jsx)(sV,{showAiBetaBadge:R!==i.lV.FIGMAKE}),(0,n.jsx)(lR,{chatController:s,chatMessagesNodeGuid:t,clientLifecycleIdMap:ea,codeFileChanges:m,currentUserCanHandleResumableMake:e_,dragOverlay:th?(0,n.jsx)(l0,{}):void 0,emptyState:h,exchangeMessageIds:d,featureType:R,isDownloadingCodeFiles:eS,isResizingPanel:ee,layerDisplayName:u,messagesForRendering:es,messagesMetadata:en,onScrollControlsReady:e=>{eP.current=e},resumableMakeInProgress:ef,showCodeStreaming:eo}),(0,n.jsx)(lJ,{typingUsers:ex}),(0,n.jsx)("div",{className:"x10l6tqk xu96u03 x3m8u43 x1vqgdyp x47corl x1ey2m1c xdu2321"})]}),ep?null:(0,n.jsx)(S.Y,{isDragTarget:()=>Y,onTargetDragEnter:()=>tg(!0),onTargetDragLeave:()=>tg(!1),onTargetDrop:tf,children:(0,n.jsx)(sG,{ref:e=>{eL.current=e,eN(e)},canCancelGeneration:ez?.sessionID===tr&&!ef||eh,canSend:tm&&!k,chatBoxLeftExtraContent:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(oI,{attachments:eB,chatController:s,chatMessagesNodeGuid:t,codeInstanceGuid:r,createLoadedAttachment:eW,enableAssetImport:v,enableConnections:Q,enableDsImport:X,enableImageAttachment:b,enhancePrompt:tu,generationInProgress:tl||eg||!1,hasMessages:es.length>0,isEnhancing:tx,isViewOnly:ek}),w??null]}),chatBoxRightExtraContent:N,chatContainerRef:eO,chatMessageCount:es.length,chatMessagesNodeGuid:t,cleanUpResumableMake:ey,errorFixingDisabled:tl||eg,featureType:R,generationInProgress:tl||eg,inspectedElement:eJ,isDraggingAttachment:th,isLastUserMessageAutoErrorFix:et,onBlur:ed,onFocus:eu,placeholderText:tp,requestScrollToBottom:eP.current?.requestScrollToBottom,selectedPointAndEditJsxSource:e0,sendMessage:({message:e,errors:s,origin:n})=>{t_&&(eP.current?.setUserHasControl(!1),eP.current?.requestScrollToBottom()),ta({message:e??y.zl.get((0,F.mC)(t)),errors:s,isUserInput:!0,origin:n,hidden:(0,sd.z)("make_fewer_error_fix_attempts")&&n===i.zm.FIX_ERRORS_BUTTON})},showPasteDesignsCallout:ts&&v&&!ek&&!e8&&0===es.length&&0===eB.length&&!tc})})]})}},55886:(e,t,s)=>{s.d(t,{S:()=>i});var n=s(363638),a=s(607696);function i(e){return e===a.lV.FIGMAKE&&n.v.getFeatureGate("make_chat_ui_improvements")}},530079:(e,t,s)=>{s.d(t,{u:()=>es,S:()=>et});var n=s(239976),a=s(105652),i=s(20002),r=s(846779),l=s(424364),o=s(931547),c=s(517478),d=s(942356),u=s(735786),x=s(796557),m=s(179189),p=s(4245),h=s(310955),g=s(379141),f=s(445019),_=s(323264),y=s(522568),k=s(309742),v=s(901962),b=s(714778),j=s(536378),C=s(223487),w=s(890030),E=s(747079),N=s(267447),S=s(780208),T=s(632012),I=s(325984),A=s(783782),M=s(507815),z=s(316367),L=s(413324),O=s(824851),P=s(373703),R=s(839970),D=s(77143),F=s(823865),q=s(470056),G=s(613542),U=s(245814),K=s(655793),H=s(16475);let B=(0,E.Ju)(function(e){let t=U.hS({open:e.open,onClose:e.onClose}),{library:s,onClose:r,createLibraryImport:l}=e,o=(0,i.wA)(),u=(0,C.tS)();(0,k.h)(()=>{y.az.trackDefinedEvent("ds_import.library_warning_modal_shown",{library_key:s.library_key,file_key:u||""})});let x=a.useCallback(()=>{y.az.trackDefinedEvent("ds_import.library_warning_modal_continue_clicked",{library_key:s.library_key,file_key:u||""}),l(s),o((0,j.AS)()),r()},[l,o,s,r,u]);return(0,n.jsx)(K.bL,{manager:t,width:"lg",height:"fixed",children:(0,n.jsxs)(c.vo,{children:[(0,n.jsx)(c.Y9,{children:(0,n.jsx)(c.hE,{children:(0,g.t)("figmake.ds_imports.library_selector_warning_modal.title")})}),(0,n.jsx)(c.nB,{children:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xou54vl x1xmf6yo x1e56ztr",children:[(0,n.jsxs)("div",{className:"x78zum5 xou54vl x6s0dn4",children:[(0,n.jsx)(H.D,{thumbnailUrl:s.thumbnail_url,coverThumbnail:!0,name:s.library_name}),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1jnr06f",children:[(0,n.jsx)("span",{className:"x17hqfcz xemv814 x1ma9mv9",children:s.library_name}),(0,n.jsx)("span",{className:"x1n0bwc9 xclx6tv x17akokd x1qxcl5b",children:s.team_name})]})]}),(0,n.jsx)("p",{children:(0,g.t)("figmake.ds_imports.library_selector_warning_modal.body")})]})}),(0,n.jsx)(c.wi,{children:(0,n.jsx)(c.jk,{children:(0,n.jsx)(d.$n,{onClick:x,children:(0,g.t)("figmake.ds_imports.library_selector_warning_modal.continue")})})})]})})},"ChatLibrarySelectorWarningModal");var V=s(568659),$=s(328772);let W={textSecondary:{kMwMTN:"x1n0bwc9",$$css:!0}};function Y({closeModal:e,hasExistingChatMessages:t,chatController:s}){let i=(0,S.z)(),{libraryImport:r,libraryRequestStatus:o,libraryResults:c}=(0,R.S)({chatController:s}),d=a.useMemo(()=>i(c||[]),[c,i]),u=r?.frozen,x=a.useMemo(()=>new Set(r?.libraries.map(e=>e.library_key)||[]),[r?.libraries]);return"errors"===o?(0,n.jsx)(Q,{}):"loading"===o?(0,n.jsx)(z.$,{className:"x1y1aw1k xjkvuk6 xh8yej3 x78zum5 xdt5ytf x167g77z",children:(0,l.y1)(3).map(e=>(0,n.jsx)(M.Q,{},e))}):0===x.size&&0===c.length?(0,n.jsx)(Q,{}):(0,n.jsx)(z.$,{className:"x1y1aw1k xjkvuk6 xh8yej3 x78zum5 xdt5ytf x167g77z",children:(0,n.jsx)("div",{children:(0,n.jsx)(T.Tp,{entrypoint:N.r6.FIGMAKE,initialTab:void 0,initialUpdatesModalScope:w.aD.CURRENT,children:(0,n.jsx)(v.dP,{children:d.map((a,i)=>{let r=x.has(a.library_key);return(0,n.jsx)(Z,{library:a,index:i,isSelected:r,hasExistingChatMessages:t,closeModal:e,chatController:s,status:u?"FROZEN":"READY_FOR_IMPORT"},`ImportReadyLibraryListItem-${a.library_key}`)})})})})})}var X=(e=>(e.READY_FOR_IMPORT="READY_FOR_IMPORT",e.FROZEN="FROZEN",e))(X||{});function Z({library:e,index:t,isSelected:s,hasExistingChatMessages:a,closeModal:r,chatController:l,status:o}){let c=(0,i.wA)(),d=(0,C.tS)(),{createLibraryImport:u,isLibraryTogglePending:x}=(0,R.S)({chatController:l}),m=(0,O.zy)(),p=x(e.library_key);if(m){let a;switch(o){case"READY_FOR_IMPORT":a=(0,n.jsx)(J,{library:e,isSelected:s,chatController:l});break;case"FROZEN":a=void 0}return(0,n.jsx)(A.V,{header:e.library_name,subheader:e.team_name,thumbnailUrl:e.thumbnail_url,coverThumbnail:!0,callToAction:a,name:e.library_name,onClick:void 0,kbPath:[I.m3.TabBodySection.Body,t]})}return(0,n.jsx)(A.V,{header:e.library_name,subheader:e.team_name,thumbnailUrl:e.thumbnail_url,coverThumbnail:!0,callToAction:void 0,name:e.library_name,onClick:()=>{p||"READY_FOR_IMPORT"!==o||(y.az.trackDefinedEvent("ds_import.library_selector_overlay_library_selected",{library_key:e.library_key,file_key:d||""}),a&&!m?(r(),c(j.to({type:B,data:{library:e,chatController:l,createLibraryImport:u}}))):(u(e),r()))},kbPath:[I.m3.TabBodySection.Body,t]})}function J({library:e,isSelected:t,chatController:s}){let a=(0,O.zy)(),{toggleLibrarySelection:i,isLibraryTogglePending:r}=(0,R.S)({chatController:s});if(!a)return null;let l=r(e.library_key),o=t?(0,g.t)("sites.modal.make_kits_remove_button_text"):(0,g.t)("sites.modal.make_kits_add_button_text");return(0,n.jsx)(d.$n,{variant:t?"secondary":"primary",disabled:l,onClick:()=>i(e),children:o})}function Q(){let e=(0,f.Xr)(F.jx),t=(0,f.md)(q.FX),s=(0,C.tS)();return(0,k.h)(()=>{y.az.trackDefinedEvent("ds_import.library_selector_empty_state_seen",{file_key:s||""})}),(0,n.jsx)("div",{className:"x9f619 x167g77z xh8yej3 x5yr21d x78zum5 x6s0dn4 xl56j7k xwib8y2",children:(0,n.jsxs)("div",{className:"xhwf2h4 x167g77z x78zum5 xdt5ytf x6s0dn4 xl56j7k x2b8uid",children:[(0,n.jsx)(m.l,{}),(0,n.jsx)("div",{..._.Ay.props(h.g.textBodyMediumStrong),children:(0,g.t)("sites.modal.no_libraries_found")}),(0,n.jsxs)("div",{..._.Ay.props(h.g.textBodyMedium,W.textSecondary),children:[(0,g.t)("sites.modal.select_library_banner_subtitle"),"\xa0",(0,n.jsx)(b.Ph,{href:$.kC,newTab:!0,children:(0,g.t)("sites.modal.learn_more")})]}),!t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np xl56j7k x2b8uid x6s0dn4",children:[(0,n.jsx)("div",{className:"x1dmp6jm xqtp20y xmkeg23 x1y0btm7 x7z60cl"}),"\xa0",(0,n.jsx)("div",{..._.Ay.props(h.g.textBodyMedium,W.textSecondary),children:(0,g.t)("sites.modal.or")}),"\xa0",(0,n.jsx)("div",{className:"x1dmp6jm xqtp20y xmkeg23 x1y0btm7 x7z60cl"})]}),(0,n.jsx)("div",{..._.Ay.props(h.g.textBodyMedium,W.textSecondary),children:(0,g.t)("sites.modal.add_guidelines_text")}),(0,n.jsx)(d.$n,{variant:"primary",onClick:()=>{y.az.trackDefinedEvent("ds_import.library_selector_empty_state_guidelines_clicked",{file_key:s||""});let t=(0,r.$d)(),n=t[$.dY]||t[$.x1]||null;n&&((0,P.Zr)(n),e(F.Ic.CODE),n.codeFilePath&&(0,L.ci)(n.codeFilePath))},children:(0,g.t)("sites.modal.add_guidelines_button_text")})]})]})})}function ee(){let{getTriggerProps:e,manager:t}=u.b(),s=(0,i.wA)(),r=a.useCallback(()=>{s(j.ES(es))},[s]);return(0,n.jsxs)(u.bL,{manager:t,children:[(0,n.jsx)(x.d,{...e(),"aria-label":(0,g.t)("figmake.empty_state.settings"),children:(0,n.jsx)(p.J,{})}),(0,n.jsxs)(u.mc,{children:[(0,n.jsx)(G.R,{onClickCallback:r}),(0,n.jsx)(G.P8,{onClickCallback:r})]})]})}let et=()=>(0,i.d4)(e=>(0,O.zy)()?!!e.modalShown&&e.modalShown.type===V.W.type:!!e.modalShown&&e.modalShown.type===es.type),es=(0,E.Ju)(function(e){let{defaultPosition:t,hasExistingChatMessages:s,chatController:r}=e,l=(0,i.wA)(),d=a.useCallback(()=>{l((0,j.AS)())},[l]);a.useEffect(()=>(D.Uy.on("submit",d),()=>{D.Uy.removeListener("submit",d)}),[d]);let{libraryImport:u}=(0,R.S)({chatController:r}),x=u?.frozen,m=(0,g.t)("sites.modal.select_library");return(0,n.jsx)(o.bL,{defaultPosition:t,width:400,maxHeight:326,onClose:d,children:(0,n.jsxs)(c.vo,{children:[(0,n.jsxs)(c.Y9,{children:[(0,n.jsx)(c.hE,{children:m}),(0,n.jsx)(c.jk,{children:(0,n.jsx)(ee,{})})]}),(0,n.jsx)(c.nB,{padding:0,children:(0,n.jsx)("div",{...{0:{className:"x78zum5 xdt5ytf xou54vl xsbggsw xh8yej3 x9f619"},1:{className:"x78zum5 xdt5ytf xou54vl xh8yej3 x9f619 x159c2z0 x99ztlj x1s3m9h8"}}[!!x<<0],children:(0,n.jsx)(Y,{closeModal:d,hasExistingChatMessages:s,chatController:r})})})]})})},"ChatLibrarySelectorOverlay",E.ZU.YES)},482132:(e,t,s)=>{s.d(t,{D:()=>U});var n=s(239976),a=s(105652),i=s(20002),r=s(735786),l=s(378721);let o=(0,a.memo)(function(e){return(0,n.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M13.5 5A2.5 2.5 0 0 1 16 7.5c0 .82-.397 1.544-1.006 2a2.5 2.5 0 0 1 1.006 2 2.5 2.5 0 0 1-2.5 2.5 2.5 2.5 0 0 1-1.5-.504V15.5a2.5 2.5 0 0 1-5 0c0-.82.396-1.544 1.005-2a2.493 2.493 0 0 1 0-4A2.5 2.5 0 0 1 7 7.5 2.5 2.5 0 0 1 9.5 5zm3.5 9a.5.5 0 0 1 .5.5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 .5-.5m-7.5 0a1.5 1.5 0 1 0 1.5 1.5V14zm0-4a1.5 1.5 0 0 0 0 3H11v-3zm4 0a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3m-4-4a1.5 1.5 0 1 0 0 3H11V6zM12 9h1.5a1.5 1.5 0 0 0 0-3H12z"})})});var c=s(418379),d=s(255398),u=s(379141),x=s(270450),m=s(445019);s(323264);var p=s(522568),h=s(536378),g=s(223487),f=s(415315),_=s(991007),y=s(183290),k=s(245814),v=s(958840),b=s(655793),j=s(517478),C=s(545414),w=s(454705),E=s(747079),N=s(961998),S=s(87195),T=s(522314);let I=(0,E.Ju)(function({onClose:e,open:t,chatMessagesNodeGuid:s}){let i=k.hS({open:t,onClose:e}),[r,l]=(0,a.useState)(""),[o,c]=(0,a.useState)(null),d=(0,a.useId)(),m=`${d}-url-input-error-message`,p=(0,x.kc)().allow_node_links_in_make,h=(0,T.yB)(),g=(0,v.X)(void 0,p),f=async t=>{let s=t.clipboardData.getData("Text");if(s)try{await h(s),l(""),c(null),e()}catch(e){[N.QO.NON_FIGMA_URL,N.QO.NO_NODE_ID].includes(e.message)&&c(e.message)}};return(0,n.jsx)(b.bL,{manager:i,width:"fit-content",children:(0,n.jsxs)(j.vo,{children:[(0,n.jsx)(j.Y9,{children:(0,n.jsx)(j.hE,{children:(0,u.tx)("figmake.attachments.attach_design_modal_title")})}),(0,n.jsx)(j.nB,{children:(0,n.jsxs)(w.J,{brand:"design",children:[(0,n.jsx)("div",{className:"x1l76qip",children:(0,n.jsx)(S.f,{onClose:e,chatMessagesNodeGuid:s})}),p&&(0,n.jsxs)("div",{className:"xehsoiq x1ef8nbk xh8yej3",children:[(0,n.jsx)(C.p,{id:"figma-frame-url-input",ref:g,value:r,onChange:e=>{l(e),""===e&&c(null)},placeholder:(0,u.t)("figmake.attachments.link_to_figma_frame"),size:"lg","aria-invalid":null!==o,"aria-describedby":o?m:void 0,htmlAttributes:{onPaste:f},...{0:{className:"xh8yej3"},1:{className:"xh8yej3 xqsu7zk"}}[!!o<<0]}),o&&(0,n.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x172n1ly x7hzu26",id:m,children:o===N.QO.NO_NODE_ID?(0,u.t)("figmake.attachments.url_doesnt_include_node_id_toast"):(0,u.t)("figmake.attachments.link_to_figma_frame")})]})]})})]})})},"AttachDesignModal",E.ZU.YES);var A=s(670664),M=s(451563),z=s(723850),L=s(75962),O=s(807461),P=s(629332),R=s(518798);function D(){let e=(0,R.nA)(),{mcpClients:t,isLoading:s}=(0,P.Qh)(),i=(0,m.Xr)(O.EO),l=(0,z.hC)(),o=a.useCallback(()=>{l("ai_chat_mcp.settings_directory_opened",{featureEntrypoint:"figmake"}),i({screen:O.ck.LIST_MCP_CLIENTS,selectedMcpServer:null,isVisible:!0})},[i,l]);if(s)return null;let c=t.sort((e,t)=>e.server.name.localeCompare(t.server.name));return c.length<=5||e?(0,n.jsxs)(n.Fragment,{children:[!e&&c.map(e=>(0,n.jsx)(F,{client:e},e.id)),(0,n.jsxs)(r.q7,{onClick:o,children:[(0,n.jsx)(r.Q$,{children:(0,n.jsx)(A.t,{})}),(0,n.jsx)("div",{children:(0,u.t)("figmake.mcp_clients.manage_connectors")})]})]}):(0,n.jsxs)(r.g8,{children:[(0,n.jsxs)(r.ZP,{children:[(0,n.jsx)(r.Q$,{children:(0,n.jsx)(A.t,{})}),(0,n.jsx)("div",{children:(0,u.t)("figmake.mcp_clients.connectors")})]}),(0,n.jsxs)(r.MJ,{children:[c.map(e=>(0,n.jsx)(F,{client:e},e.id)),(0,n.jsxs)(r.q7,{onClick:o,children:[(0,n.jsx)(r.Q$,{children:(0,n.jsx)(M.W,{})}),(0,u.t)("figmake.mcp_clients.manage_connectors_overflow")]})]})]})}function F({client:e}){let t=(0,m.Xr)(O.EO);return(0,n.jsx)(r.q7,{onClick:()=>{t({screen:O.ck.INSPECT_MCP_CLIENT,selectedMcpServer:e.server,isVisible:!0})},children:(0,n.jsxs)("div",{className:"x78zum5 x6s0dn4 xh8yej3 xip9j14 x1xn8yn6 xktpd3l",children:[(0,n.jsx)(r.Q$,{children:e.server.logoUrl?(0,n.jsx)(L.oW,{className:"x1xp8n7a xmix8c7 x19y5rnk x19kjcj4 x10d6zji",src:e.server.logoUrl,alt:e.server.name}):(0,n.jsx)(A.t,{})}),(0,n.jsx)("div",{children:e.server.name})]})},e.id)}var q=s(160849),G=s(24867);function U({enableAssetImport:e,enableImageAttachment:t,enableConnections:s,attachments:k,isViewOnly:v,chatMessagesNodeGuid:b,createLoadedAttachment:j,shouldProcessDroppedAttachments:C,toggleComponent:w}){let E=(0,g.q5)(),N=(0,i.wA)(),S=a.useRef(null),{getTriggerProps:T,manager:A}=r.b(),[M,z]=(0,m.fp)(y.Ki),L=(0,x.kc)().bake_mcp_client_admin_disabled,O=(0,R.Ey)(),P=(0,R.dH)(),F=L?O:P;a.useEffect(()=>{C&&M&&M.length>0&&(async()=>{try{let e=M.map(async e=>{await (0,G.zF)(e,j)});await Promise.all(e)}catch(e){console.error(e)}finally{z(null)}})()},[C,M,j,z]);let U=a.useCallback(async e=>{let t=e.target.files?.[0];t&&(await (0,G.zF)(t,j),S.current&&(S.current.value=""))},[j]),K=e?(0,n.jsxs)(r.q7,{onClick:()=>{p.az.trackDefinedEvent("figmake.attach_design_clicked",{fileKey:E?.key}),N(h.to({type:I,data:{chatMessagesNodeGuid:b}}))},disabled:v||k.length>=q.qQ,children:[(0,n.jsx)(r.Q$,{children:(0,n.jsx)(o,{})}),(0,n.jsx)("div",{className:"xifkd7f",children:(0,u.t)("figmake.attachments.attach_a_design")})]}):null,H=t?(0,n.jsxs)(r.q7,{disabled:v||k.length>=q.qQ,onClick:()=>{S.current?.click()},children:[(0,n.jsx)(r.Q$,{children:(0,n.jsx)(c.T,{})}),(0,n.jsx)("div",{className:"xifkd7f",children:(0,u.t)("figmake.attachments.upload_image")})]}):null,B=F&&s?(0,n.jsx)(D,{}):null;if(!t&&!e&&!s)return null;let V=F?(0,u.t)("sites.panel.make.add_context"):(0,u.t)("sites.panel.make.attach_design"),$=()=>{p.az.trackDefinedEvent("figmake.add_button_clicked",{fileKey:E?.key})},W=v||!F&&k.length>=q.qQ;return(0,n.jsxs)(r.bL,{manager:A,children:[w?(0,n.jsx)(w,{...T({onClick:$}),disabled:W,"data-onboarding-key":_._g}):(0,n.jsx)(l.K,{...T({onClick:$}),"aria-label":V,"data-tooltip-show-above":!0,"data-onboarding-key":_.wj,disabled:W,children:(0,n.jsx)(d.$,{})}),t&&(0,n.jsx)("input",{type:"file",className:"x1s85apg",ref:S,accept:f.xp.join(","),"data-testid":"image-attachment-input",onChange:U}),(0,n.jsxs)(r.mc,{children:[(0,n.jsxs)(r.YJ,{children:[K,H]}),B]})]})}},467102:(e,t,s)=>{s.d(t,{$:()=>J});var n=s(239976),a=s(940901),i=s(134670),r=s(836848),l=s(328414),o=s(379141),c=s(445019);s(323264);var d=s(610265),u=s(482144),x=s(842582),m=s(714778),p=s(375296),h=s(732730),g=s(315230),f=s(632399),_=s(598334),y=s(680912),k=s(550534),v=s(223487),b=s(920675),j=s(790016),C=s(947467),w=s(13939),E=s(558604),N=s(988102),S=s(447995),T=s(581121),I=s(184670),A=s(254287),M=s(274579),z=s(870141),L=s(211464),O=s(203250),P=s(30827);function R({rounded:e,...t}){return e?(0,n.jsx)(x.e6,{className:"x1d36bvo xl98q1r xexx8yu x18d9i69 x8rdmch xctkrei x1ndnbji x152byy6 x1gldbt3 xui8u7j x11wqxpx x1tk3asg x13zgbb3 x131gfan x1yb3fay x1y7m5u1 x1uwn04i x3nfvp2 x1n2onr6 x193iq5w xuxw1ft",...t}):(0,n.jsx)(x.$z,{variant:"primary",...t})}function D({featureType:e,shouldUseRoundedButton:t}){let s=(0,j.No)(),i=s.unwrapOr(null)?.tier||null,r=(0,v.q5)(),l=r?.teamId??"",c=(0,M.$Y)(l),d=(0,v.XO)()??null,u=(0,f.y)(l,k.C.METER_LIMIT_TOAST.from({editorType:d,featureType:e}));return i===a.PlanTier.STARTER&&(0,L.z)("bake_starter_limit")&&c?(0,n.jsx)(R,{rounded:t,onClick:u,children:(0,o.tx)("figmake.meter_limit.view_plans")}):null}function F({shouldUseRoundedButton:e}){let{handleUpgrade:t,getIsUpgradeHandlerLoading:s}=(0,C.wH)({entryPoint:h.tc.CODE_CHAT_LIMIT,folderId:null}),a=(0,v.XO)()??null,i=(0,_.Ci)(a);return i?s()?(0,n.jsx)(R,{rounded:e,disabled:!0,children:(0,o.tx)("figmake.meter_limit.request_upgrade")}):(0,n.jsx)(R,{rounded:e,onClick:t({licenseType:i,editorType:a,upgradeReason:P.i.CODE_CHAT_LIMIT,entryPoint:h.tc.CODE_CHAT_LIMIT}),children:(0,o.tx)("figmake.meter_limit.request_upgrade")}):null}function q({shouldUseRoundedButton:e}){let{getPendingRequest:t}=(0,C.wH)({entryPoint:h.tc.CODE_CHAT_LIMIT,folderId:null}),s=(0,v.XO)()??null,a=(0,_.Ci)(s);if(!a||![b.G_.FIGMAKE,b.G_.DESIGN].includes(a))return null;let i=t(a);return i?(0,n.jsx)(I.K,{pendingUpgradeRequest:i}):(0,n.jsx)(R,{rounded:e,disabled:!0,children:(0,o.tx)("fullscreen.toolbar.request.request_sent")})}function G(){let e=(0,v.XO)()??null,t=(0,_.Ci)(e),s=(0,E.a7)(t),{meterResetDate:n,meteringWindow:a}=(0,S.Ig)(s);if(!n)return{resetDate:null,isResetDateToday:!1,formattedResetDate:null,meteringWindow:null};let i=(0,y.A0)(n);if(!i)return{resetDate:null,isResetDateToday:!1,formattedResetDate:null,meteringWindow:null};let r=(0,d.A)(i).isSame((0,d.A)(),"day"),l=(0,d.A)(i).format("LL");return{resetDate:i,isResetDateToday:r,formattedResetDate:l,meteringWindow:a}}function U(){let{formattedResetDate:e,meteringWindow:t}=G();return e?t===i.co.DAILY?(0,o.tx)("figmake.meter_limit.plans_ai_credit_limit_reached_reset_imminent"):(0,o.tx)("figmake.meter_limit.plans_ai_credit_limit_reached",{resetDate:e}):null}function K(){let{formattedResetDate:e}=G();return e?(0,o.tx)("figmake.meter_limit.reached_your_current_credits_limit",{resetDate:e}):(0,o.tx)("figmake.meter_limit.primary")}function H(){let{resetDate:e}=G(),{getPlanAndPlanUser:t,getIsUpgradeHandlerLoading:s}=(0,C.wH)({entryPoint:h.tc.CODE_CHAT_LIMIT,folderId:null}),n=(0,v.XO)()??null,a=(0,_.Ci)(n);if(!a||!e||s())return null;let{planUser:i}=t(a);if(!i)return(0,o.tx)("figmake.meter_limit.seat_type_generic_credit_limit_reached",{resetDate:e});{let t=(0,E.BG)(i);return(0,o.tx)("figmake.meter_limit.seat_type_credit_limit_reached",{seatType:(0,p.JT)(t),resetDate:e})}}function B(){let e=(0,w.eP)({forAiMetering:!0});return null===e.data?null:(0,p.JT)(e.data)}function V(){let{meteringWindow:e,resetDate:t,isResetDateToday:s}=G(),n=w.nJ({forAiMetering:!0})?.data?.name;return t&&n?e===i.co.DAILY?(0,o.tx)("ai_credits_meter.out_of_daily_credits_in_plan_upgrade_plan",{planName:n}):s?(0,o.tx)("ai_credits_meter.out_of_credits_in_plan_upgrade_plan.same_date_reset",{planName:n,resetDate:t}):(0,o.tx)("ai_credits_meter.out_of_credits_in_plan_upgrade_plan",{planName:n,resetDate:t}):null}function $(){return(0,E.T3)()?(0,n.jsx)(V,{}):(0,n.jsx)(U,{})}function W(){let{meteringWindow:e,resetDate:t,isResetDateToday:s}=G(),r=B(),l=(0,w.nJ)({forAiMetering:!0});if(!t||!l?.data)return null;let c=(0,n.jsx)(m.Ph,{newTab:!0,trusted:!0,href:T._t,children:(0,o.tx)("general.learn_more")}),d=l.data.name;return l.data.tier===a.PlanTier.STUDENT?s?(0,o.tx)("ai_credits_meter.seat_in_edu_plan_is_out_of_credits_until_they_reset.same_date_reset",{planName:d,resetDate:t,learnMoreLink:c}):(0,o.tx)("ai_credits_meter.seat_in_edu_plan_is_out_of_credits_until_they_reset",{planName:d,resetDate:t,learnMoreLink:c}):l.data.activeTrialLicenseTypes?.includes(b.G_.FIGMAKE)||!r?s?(0,o.tx)("ai_credits_meter.seat_in_plan_is_out_of_credits_until_they_reset_no_seat_type.same_date_reset",{planName:d,resetDate:t,learnMoreLink:c}):(0,o.tx)("ai_credits_meter.seat_in_plan_is_out_of_credits_until_they_reset_no_seat_type",{planName:d,resetDate:t,learnMoreLink:c}):e===i.co.DAILY?(0,o.tx)("ai_credits_meter.out_of_daily_credits_for_seat_type_in_plan",{seatType:r,planName:d}):s?(0,o.tx)("ai_credits_meter.seat_in_plan_is_out_of_credits_until_they_reset.same_date_reset",{seatType:r,planName:d,resetDate:t,learnMoreLink:c}):(0,o.tx)("ai_credits_meter.seat_in_plan_is_out_of_credits_until_they_reset",{seatType:r,planName:d,resetDate:t,learnMoreLink:c})}function Y(){return(0,E.T3)()?(0,n.jsx)(W,{}):(0,n.jsx)(K,{})}function X(){let{resetDate:e,meteringWindow:t,isResetDateToday:s}=G(),n=B(),a=w.nJ({forAiMetering:!0})?.data?.name;return e&&n&&a?t===i.co.DAILY?(0,o.tx)("ai_credits_meter.out_of_daily_credits_for_seat_type_in_plan",{seatType:n,planName:a}):s?(0,o.tx)("ai_credits_meter.out_of_credits_for_seat_type_in_plan.same_date_reset",{seatType:n,planName:a,resetDate:e}):(0,o.tx)("ai_credits_meter.out_of_credits_for_seat_type_in_plan",{seatType:n,planName:a,resetDate:e}):null}function Z(){return(0,E.T3)()?(0,n.jsx)(X,{}):(0,n.jsx)(H,{})}function J({testId:e,renderer:t,featureType:s,shouldUseRoundedButton:a=!1}){let i=(0,z.l)(),d=(0,j.No)(),x=d.unwrapOr(null)?.tier||null,p=d.unwrapOr(null)?.key||null,h=(0,O.Tk)(s),f=h?.restriction,_=h?.meteringWindow,y=h?.aiAction,k=(0,g.yy)(),b=(0,c.md)(v.Hu),C=b?.workspace_id??null,w=k?.id??null,E=(0,N.P)(w,C),S="loaded"===E.status&&"Unassigned"!==E.data?E.data?.name??"":"";if(!f||f===O.ee.DISABLE_WITHOUT_TOAST||f===O.ee.DISABLE_WHILE_LOADING)return null;let T=function(e,t,s,a,i){switch(e){case O.ee.UNAVAILABLE_ON_EDU_PLANS:return{title:(0,o.tx)("figmake.view_only.unavailable_on_edu")};case O.ee.UNAVAILABLE_FOR_EDU_USER:return{title:(0,o.tx)("figmake.view_only.you_dont_have_access",{learnMoreLink:(0,n.jsx)(m.Ph,{newTab:!0,trusted:!0,href:u.R,children:(0,o.tx)("general.learn_more")})}),icon:(0,n.jsx)(l.s,{})};case O.ee.UNAVAILABLE_ON_PLAN:return{title:(0,o.tx)("figmake.view_only.unavailable_on_plan",{learnMoreLink:(0,n.jsx)(m.Ph,{newTab:!0,trusted:!0,href:u._,children:(0,o.tx)("general.learn_more")})}),icon:(0,n.jsx)(l.s,{})};case O.ee.UNAVAILABLE_ON_SEAT:return{title:(0,o.tx)("figmake.view_only.unavailable_on_seat",{learnMoreLink:(0,n.jsx)(m.Ph,{newTab:!0,trusted:!0,href:u._,children:(0,o.tx)("general.learn_more")})}),icon:(0,n.jsx)(l.s,{})};case O.ee.INTERIM_VIEW_ONLY_COMING_SOON:return{title:(0,o.tx)("figmake.view_only.coming_soon_title"),content:()=>(0,o.tx)("figmake.view_only.check_back_in_coming_weeks_learn_more",{learnMoreLink:(0,n.jsx)(m.Ph,{newTab:!0,trusted:!0,href:u._,children:(0,o.tx)("general.learn_more")})}),icon:(0,n.jsx)(l.s,{})};case O.ee.VIEW_ONLY_ASK_TO_EDIT:return{title:void 0,content:()=>(0,o.tx)("figmake.view_only.banner_message"),button:(0,n.jsx)(A.RJ,{viewOnly:!0,variant:"primary"}),icon:null};case O.ee.METER_LIMIT:return{title:void 0,content:()=>(0,n.jsx)(Y,{})};case O.ee.METER_LIMIT_UPGRADE_PLAN:return{content:()=>(0,n.jsx)($,{}),button:(0,n.jsx)(D,{featureType:a,shouldUseRoundedButton:i}),icon:null};case O.ee.METER_LIMIT_UPGRADE_SEAT:return{title:void 0,content:()=>(0,n.jsx)(Z,{}),button:(0,n.jsx)(F,{shouldUseRoundedButton:i}),icon:null};case O.ee.METER_LIMIT_UPGRADE_SEAT_PENDING:return{title:void 0,content:()=>(0,n.jsx)(Z,{}),button:(0,n.jsx)(q,{shouldUseRoundedButton:i}),icon:null};case O.ee.PLAN_AI_DISABLED:return{title:(0,o.tx)("living_designs.chat.disabled_reason.title.not_available"),content:()=>s?(0,o.tx)("living_designs.chat.disabled_reason.subtitle.ai_disabled_in_org_or_workspace",{planName:t,workspaceName:s}):(0,o.tx)("living_designs.chat.disabled_reason.subtitle.ai_disabled_in_plan",{planName:t})};case O.ee.DISABLE_CATCH_ALL:return{title:(0,o.tx)("living_designs.chat.disabled_reason.title.not_available")};case O.ee.DISABLE_WHILE_LOADING:case O.ee.DISABLE_WITHOUT_TOAST:return{title:null};default:(0,r.xb)(e)}}(f,k?.name||b?.name||"",S,s,a);return(0,n.jsx)(t,{testId:e,config:T,trackingProperties:{meteringWindow:_,codeChatRestriction:f,isViewOnly:i,tier:x,aiAction:y,planParentId:p?.parentId||null,planType:p?.type||null}})}},360485:(e,t,s)=>{s.d(t,{U:()=>w});var n=s(239976),a=s(105652),i=s(363638),r=s(607696),l=s(534399),o=s(846779),c=s(854225),d=s(270450),u=s(445019),x=s(677394),m=s(916626),p=s(223487),h=s(597298),g=s(788995),f=s(183290),_=s(399488),y=s(55886),k=s(276473),v=s(934985),b=s(441014),j=s(60123);let C=e=>({hideTextBetweenToolCalls:!0,addCompletedToolCallInfo:(0,y.S)(e),consolidateReasoning:i.v.getFeatureGate("chat_consolidate_reasoning")}),w=(0,m.w)(function({setInput:e,chatMessagesNode:t,chatController:s,chatMessagesNodeGuid:m,codeInstanceGuid:w,layerDisplayName:E,sendMessage:N,emptyState:S,sendDisabled:T,enableAssetImport:I=!1,enableImageAttachment:A=!1,showChatHeader:M=!1,featureType:z,enableDragUpload:L=!1,enableDsImport:O=!1,enableConnections:P=!1,isResizingPanel:R,showCodeStreaming:D,rootPath:F,onChatInputBlur:q,onChatInputFocus:G,forceReadOnly:U,hideChatBox:K,resumableMakeInProgress:H,currentUserCanHandleResumableMake:B,cleanUpResumableMake:V}){let $=(0,p.tS)(),W=s.getMessages(),Y=(0,b.B)(t),X=(0,f.s0)(m),Z=(0,u.md)((0,f.Z3)(m)),J=(0,v.E)(t,s,z,{shouldIncludeFile:z===r.lV.FIGMAKE?o.ru:void 0,isExchangeActive:Y.length>0}),Q=(0,a.useMemo)(()=>{if(!W)return null;for(let e=W.length-1;e>=0;e--){let t=W[e];if(t?.type===c.K$p.USER_MESSAGE)return t}return null},[W]),ee=(0,a.useMemo)(()=>!!Q&&Q.type===c.K$p.USER_MESSAGE&&(0,l.gG)((0,r.MK)(Q,(0,d.kc)().make_chat_contents_cache??!1)),[Q]),et=(0,a.useMemo)(()=>W.map(e=>e.userId)||[],[W]),es=(0,x.zN)((0,h.zy)(et)),en=(0,a.useMemo)(()=>Y.map(e=>e.userId)||[],[Y]),ea=(0,x.zN)((0,h.zy)(en)),ei=(0,a.useMemo)(()=>C(z),[z]),er=(0,a.useMemo)(()=>(function(e){let t=(0,y.S)(e);return{hideTextBetweenToolCalls:!1,hideTextBetweenCompletedToolCalls:t,addCompletedToolCallInfo:t,consolidateReasoning:i.v.getFeatureGate("chat_consolidate_reasoning")}})(z),[z]),{messages:el,messagesMetadata:eo}=(0,k.d)({chatMessages:W,exchangeMessages:Y,chatMessagesUsers:es,exchangeMessagesUsers:ea,chatMessagesOptions:ei,exchangeMessagesOptions:er,chatController:s}),ec=(0,a.useMemo)(()=>{let{changedFiles:e,hasBaseline:t,error:s}=J;return e.length>0&&t&&!s&&0===Y.length?[...el,{type:"system",id:j.ct,isOptimisticMessage:!0,uniqueId:`${j.ct}-optimistic`,systemMessageType:"manual_edit",changedFiles:e,codeSnapshotKey:void 0,fileVersionId:void 0,title:void 0}]:el},[el,J,Y.length]),ed=(0,a.useMemo)(()=>{let e,t;let s=new Map;return ec.forEach(n=>{switch(n.type){case"assistant":if(n.messages.length>0){let e=n.messages[n.messages.length-1];t=e?.id}break;case"system":t=n.id;break;case"user":t&&e&&s.set(t,(0,g.Pd)($,m,e)),t=void 0,e=n.id}}),t&&e&&s.set(t,(0,g.Pd)($,m,e)),s},[ec,$,m]);!function(e,t){let s=(0,u.md)(f.st),n=(0,u.Xr)(f.PO);(0,a.useEffect)(()=>{if(0===e.length)return;let t=e.find(e=>e.type===c.K$p.USER_MESSAGE);t&&n(t.id===s)},[e,s,n]),(0,a.useEffect)(()=>{if(!t)return;let e=()=>{n(!1)};return t.signal.addEventListener("abort",e),()=>{t.signal.removeEventListener("abort",e)}},[t,n])}(Y,Z);let eu=(0,a.useMemo)(()=>new Set(Y.map(e=>e.id)),[Y]);return(0,n.jsx)(_.r,{canCancelGeneration:H&&B,chatController:s,chatMessagesNodeGuid:m,cleanUpResumableMake:V,clientLifecycleIdMap:ed,codeFileChanges:J,codeInstanceGuid:w,currentUserCanHandleResumableMake:B,emptyState:S,enableAssetImport:I,enableConnections:P,enableDragUpload:L,enableDsImport:O,enableImageAttachment:A,exchangeMessageIds:eu,featureType:z,forceReadOnly:U,generationInProgress:H,hideChatBox:K,isLastUserMessageAutoErrorFix:ee,isResizingPanel:R,layerDisplayName:E,messagesForRendering:ec,messagesMetadata:eo,onChatInputBlur:q,onChatInputFocus:G,resumableMakeInProgress:H,rootPath:F,sendDisabled:T,sendMessage:N,setInput:e,showChatHeader:M,showCodeStreaming:D,typingUsers:X})},"CodeChat")},109833:(e,t,s)=>{s.d(t,{u:()=>b});var n=s(105652),a=s(607696),i=s(534399),r=s(820328),l=s(854225),o=s(445019),c=s(975616),d=s(223487),u=s(605985),x=s(660259),m=s(395823),p=s(183290),h=s(200498),g=s(518798),f=s(820198),_=s(211464),y=s(445602),k=s(351572),v=s(379196);function b({chatMessagesNode:e,chatController:t,disabled:s=!1,featureType:b}){let[j,C]=n.useState(!1),{exchange:w}=(0,p.$W)(e?.guid||"");n.useEffect(()=>{w&&!j&&C(!0)},[w,j]);let[E,N]=(0,o.fp)((0,h.o0)(e?.guid||"")),S=(0,o.md)((0,h.Nm)(e?.guid||"")),T=t.getMessages(),I=(0,o.md)(x.Xl),A=(0,o.md)(x.p7),M=(0,u.iZ)(),z=(0,d.tS)(),L=n.useMemo(()=>{if(T&&T.length>0){let e=(0,i.EY)(T);if(e)return e}if(w?.messages&&w.messages.length>0){let e=w.messages.slice().reverse().find(e=>e.type===l.K$p.USER_MESSAGE);if(e)return e.id}return null},[T,w]),[O,P]=n.useState(new Map),R=n.useMemo(()=>{if(T&&T.length>0){let e=T[T.length-1];if(e?.type===l.K$p.TOOL_MESSAGE&&e?.toolCalls.some(e=>a.AD.includes(e.toolName)))return!0}if(w?.messages&&w?.messages.length>0){let e=w.messages[w.messages.length-1];if(e?.type===l.K$p.TOOL_MESSAGE&&e?.toolCalls.some(e=>a.AD.includes(e.toolName)))return!0}return!1},[T,w]),D=(0,y.L)(),F=b===a.lV.FIGMAKE?D:void 0,q=(0,m.Xu)(),G=(0,f.GM)(),U=(0,g.dH)(),K=(0,_.z)("make_fewer_error_fix_attempts")?1:2;return{triggerSelfHeal:n.useCallback(async(e,n,l)=>{let o=await (0,c.ly)("auto-error-fix");if(o)try{if(E||s||!j||!t.isInitialized||q&&(I||A===x.Ut.DEPLOYING||R)||0===n.length||!L||!S||"user"===S||l!==v.S4.BUILD||(O.get(L)||0)>=K)return;await function({chatController:e,lastUserMessageId:t,errors:s,onStart:n,handleSubmitMessage:a}){let l=Array.from(new Set(s));n();let o={plainText:"",hidden:!0,errors:l,origin:r.z.AUTO_ERROR_FIX},c=t;if(!c){let t=e.getMessages();c=(0,i.EY)(t)??null}return a({userMessageContent:o,rawUserChatDetails:void 0,autoFixingUserMessageId:c,changedFiles:[]})}({chatController:t,lastUserMessageId:L,errors:n,onStart:()=>{N(!0),P(e=>(e.set(L,(e.get(L)||0)+1),e))},handleSubmitMessage:({userMessageContent:s,autoFixingUserMessageId:n,rawUserChatDetails:i,changedFiles:r})=>(0,k.v)({userMessageContent:s,user:M,chatMessagesNode:e,chatController:t,rawUserChatDetails:i,featureType:b,setInput:()=>{},fileKey:z,autoFixingUserMessageId:n,onFinish:()=>{N(!1)},canUseSupabase:q,todoAutoAccept:G,changedFiles:r,model:F,requestInitiator:a.bG.SYSTEM,canUseMcpConnectors:U})})}finally{await o.release()}},[E,s,j,q,L,S,O,t,I,A,R,N,M,b,z,F,K,U,G])}}},276473:(e,t,s)=>{s.d(t,{d:()=>c});var n=s(105652),a=s(607696),i=s(940728);let r={usersById:{},loading:!1,hasError:!1},l={hideTextBetweenToolCalls:!1},o={hideTextBetweenToolCalls:!1};function c({chatMessages:e,exchangeMessages:t,chatMessagesUsers:s=r,exchangeMessagesUsers:c=r,chatMessagesOptions:d=l,exchangeMessagesOptions:u=o,chatController:x}){let m=(0,n.useMemo)(()=>{let s=new Set,n=[];for(let t of e){let e=(0,a._$)(t);s.add(e)}for(let e of t){let t=(0,a._$)(e);s.has(t)||n.push(e)}return n},[e,t]),{messages:p,messagesMetadata:h}=(0,i.t)(e,s,{...d,isExchangeMessages:!1},x),{messages:g,messagesMetadata:f}=(0,i.t)(m,c,{...u,isExchangeMessages:!0}),_=(0,i.v)(h,f);return{messages:(0,n.useMemo)(()=>[...p,...g],[p,g]),messagesMetadata:_}}},253386:(e,t,s)=>{s.d(t,{L:()=>i});var n=s(607696);s(323264);let a={defaultTypography:{kLWn49:"xno9bf3",kGuDYH:"x17akokd",k63SB2:"x1yuz8eb",kb6lSQ:"xqp8s7e",$$css:!0},figmakeTypography:{kLWn49:"x1fc57z9",kGuDYH:"x1lh6uom",k63SB2:"x1yuz8eb",kb6lSQ:"xuf8qxk",$$css:!0},userMessageTypography:{kLWn49:"xno9bf3",kGuDYH:"x17akokd",k63SB2:"x1yuz8eb",kb6lSQ:"xqp8s7e",$$css:!0},figmakeUserMessageTypography:{kGuDYH:"x1lh6uom",k63SB2:"x1yuz8eb",kLWn49:"xdod15v",kb6lSQ:"x12638g3",$$css:!0},artifactTypography:{kMwMTN:"x1n0bwc9",kLWn49:"xno9bf3",kGuDYH:"x17akokd",k63SB2:"x1yuz8eb",kb6lSQ:"xqp8s7e",$$css:!0},figmakeArtifactTypography:{kMwMTN:"x1n0bwc9",kLWn49:"x1o2sk6j",kGuDYH:"x1lh6uom",k63SB2:"x1yuz8eb",kb6lSQ:"xuf8qxk",$$css:!0},artifactActiveTypography:{kMwMTN:"x1ptu4o3",kLWn49:"x14kxzw3",kGuDYH:"xiqqdae",k63SB2:"x6xwguf",kb6lSQ:"xqp8s7e",$$css:!0},figmakeArtifactActiveTypography:{kMwMTN:"x1ptu4o3",kLWn49:"x1o2sk6j",kGuDYH:"x1lh6uom",k63SB2:"x6xwguf",kb6lSQ:"xr8fz4w",$$css:!0}};function i(e){let t=e===n.lV.FIGMAKE,s=t?a.figmakeUserMessageTypography:a.userMessageTypography,i=t?a.figmakeArtifactTypography:a.artifactTypography;return{userMessageTypographyStyle:s,artifactActiveTypographyStyle:t?a.figmakeArtifactActiveTypography:a.artifactActiveTypography,artifactTypographyStyle:i,defaultTypographyStyle:t?a.figmakeTypography:a.defaultTypography}}},683900:(e,t,s)=>{s.d(t,{nm:()=>G,ye:()=>q});var n=s(105652),a=s(20002),i=s(895807),r=s(291061),l=s(607696),o=s(146119),c=s(603901),d=s(646673),u=s(846779),x=s(836848),m=s(295870),p=s(692376),h=s(798913),g=s(466082),f=s(379141),_=s(445019),y=s(522568),k=s(274574),v=s(7995),b=s(129416),j=s(337812),C=s(888903),w=s(287736),E=s(772293),N=s(223487),S=s(605985),T=s(840864),I=s(183290),A=s(200498),M=s(106333),z=s(515066),L=s(594242),O=s(211464),P=s(417643),R=s(844552),D=(e=>(e.FAILED_TO_RETRIEVE_CODE_FILES="FAILED_TO_RETRIEVE_CODE_FILES",e))(D||{});class F extends Error{constructor(e,t,s){super(t),this.type=e,this.status=s,this.name="RestoreVersionError"}}let q=(0,T.q)();function G({codeSnapshotKey:e,codeSnapshotBlobstoreContentKey:t,chatMessagesNodeGuid:s,featureType:i,persistentEntityId:l,clientLifecycleId:o,restoreToVersionTitle:c,chatController:d}){let u=(0,S.iZ)(),x=(0,N.q5)(),p=x?.key||null,h=(0,a.wA)(),[k,b]=(0,_.fp)(q(s)),j=d?.chatSdkState?.threadId??null,E=(0,R.A)();return{codeRestoreVersion:n.useMemo(()=>{if(p&&e&&u&&s&&x?.canEdit)return async()=>{if(k){h(C.F.enqueue({message:(0,f.t)("figmake.chat.version_restore_in_progress")}));return}let n=v.J.startUserFlow({name:"make_restore_snapshot",team:m.e.MAKE,priority:r.bx.P1});try{b(!0),h(C.F.enqueue({message:(0,f.t)("figmake.chat.a11y_restoring_a_previous_version"),role:"status"}));let a=(0,g.UN)().get(s);if(!a||!d)throw Error(`Chat messages not found: ${s}`);await U({fileKey:p,codeSnapshotKey:e,blobstoreArgs:{threadId:j,blobstoreContentKey:t},user:u,featureType:i,chatMessagesNode:a,chatController:d,userFlow:n,restoreToVersionTitle:c}),E({showVisualBells:!1}),y.az.trackDefinedEvent("ai_for_production.version_restore_clicked",{success:!0,codeSnapshotKey:e,fileKey:p,featureType:i,persistentEntityId:l,clientLifecycleId:o}),h(C.F.enqueue({message:(0,f.t)("figmake.chat.a11y_restoring_version_completed"),role:"status"}))}catch(s){let t=s instanceof F?s.type:"";y.az.trackDefinedEvent("ai_for_production.version_restore_clicked",{success:!1,errorType:t,errorMessage:s.message,codeSnapshotKey:e,fileKey:p,featureType:i,persistentEntityId:l,clientLifecycleId:o}),s instanceof F&&"FAILED_TO_RETRIEVE_CODE_FILES"===s.type&&409===s.status?h(C.F.enqueue({message:(0,f.t)("figmake.chat.version_restore_try_again_soon"),icon:w.zX.EXCLAMATION})):h(C.F.enqueue({message:(0,f.t)("figmake.chat.version_restore_failed"),error:!0}))}finally{b(!1),n.end()}}},[d,s,o,j,t,e,E,h,i,p,k,x?.canEdit,l,c,b,u])}}async function U({fileKey:e,codeSnapshotKey:t,blobstoreArgs:s,user:n,featureType:a,chatMessagesNode:r,chatController:g,userFlow:f,restoreToVersionTitle:y}){let v;try{v=(await (0,L.lm)({fileKey:e,codeSnapshotKey:t,blobstoreArgs:s,featureType:a,chatSdkPhase1Enabled:g.chatSdkPhase1Enabled})).files,_.zl.set((0,M.o)(r.guid),{codeSnapshotKey:t,files:v,isLoading:!1,error:!1,lastAttemptedKey:t})}catch(t){let e=t instanceof j.Dr?t.status:void 0;throw new F("FAILED_TO_RETRIEVE_CODE_FILES",t.message,e)}let C=(0,O.z)("multi_file_code_layers"),w=(0,o.Pq)(a,r,{multi_file_code_layers:C,bake_canvas:(0,O.z)("bake_canvas")}),N=a===l.lV.FIGMAKE,S=(C||(0,O.z)("bake_canvas"))&&r.codeFilePath,T=a===l.lV.FIGMAKE_IN_DESIGN,R={codeSnapshotKey:t,blobstoreContentKey:s.blobstoreContentKey},D=(0,z.Zi)(n,R,y),q=N?(0,u.qx)():S||T?(0,u.qx)(w):(0,u.qx)(),G=Object.fromEntries(q.map(e=>[e.codeFileFullPathWithoutScheme,e])),U=await (0,k.cK)({fileKey:e,threadId:g.chatSdkState?.threadId}),K=h.Hq.ai("restore-version",()=>{(0,x.vA)(void 0!==p.glU,"Fullscreen must be defined");let e=e=>{let t=P.O.get(e.guid);t&&(t.hasSystemEdited=!0)};if(N||S||T){let{entrypointFilePath:t}=function(e,t){let s;let n=[];for(let a of e)(0,o.sx)(a,t)?s=a:(a.codeFilePath=`${d.GX}${a.codeFileFullPathWithoutScheme}`,n.push(a));return(0,o.zK)(n),{entrypointFilePath:s?.codeFileFullPathWithoutScheme}}(q,a),s=Object.fromEntries((0,u.qx)(w).map(e=>[e.codeFileFullPathWithoutScheme,e])),n=Object.entries(v),l=n[0],c=t?(0,i.m0)(w,t):void 0,x=1===n.length&&l&&t&&l[0]!==c;for(let[t,a]of n){let n=x&&c?c:(0,i.m0)(w,t),{codeFile:l}=(0,o.Ur)(s,w,n,a,void 0,{trackSystemEditedSession:e,reportErrorToSentry:e=>{(0,b.$D)(m.e.MAKE,e)}});l&&(l.sourceCode=a,_.zl.set((0,A.Nm)(r.guid),"assistant"))}}else{let t=Object.entries(v);(0,x.vA)(1===q.length,"Code layer must have exactly one code file"),(0,x.vA)(1===t.length,"Code layer snapshot must have exactly one code file");let[s,n]=t[0],{codeFile:a}=(0,o.Ur)(G,w,q[0].codeFileFullPathWithoutScheme,n,void 0,{trackSystemEditedSession:e,reportErrorToSentry:e=>{(0,b.$D)(m.e.MAKE,e)}});a&&(a.sourceCode=n,_.zl.set((0,A.Nm)(r.guid),"assistant"))}g.appendMessages([D],U);let t=(0,o.iB)(),s=a===l.lV.FIGMAKE?(0,u._J)(t):q[0];return s&&(0,c.J)(s),(0,I.wi)(r.guid,{switchTo:null}),E.Y5.commit()});await (0,k.Ui)({commitContext:"restore_snapshot",chatController:g,nodeChatMessages:[D],fileKey:e,syncResult:U,fullscreenCommitSeqNum:K,userFlow:f})}},63760:(e,t,s)=>{s.d(t,{C:()=>o});var n=s(105652),a=s(445019),i=s(522568),r=s(943866),l=s(183290);function o({chatMessagesNodeGuid:e,inspectedElement:t,inspectedComponent:s,attachments:o,fileKey:c,persistentEntityId:d}){let u=(0,a.md)((0,l.mC)(e))||"",{figmaNodeTokensEstimate:x,imageTokensEstimate:m,figmaNodeAttachmentCount:p,imageNodeAttachmentCount:h}=function(e){let{figmaNodeLength:t,imageTokens:s,figmaNodeCount:n,imageCount:a}=e.reduce((e,t)=>{if("success"!==t.status)return e;if("FIGMA_NODE"===t.type){let s=t.codeFiles.reduce((e,t)=>e+t.code.length,0);return{figmaNodeLength:e.figmaNodeLength+s,imageTokens:e.imageTokens,figmaNodeCount:e.figmaNodeCount+1,imageCount:e.imageCount}}if("IMAGE"===t.type){let s=t.image?.length/750||0;return{figmaNodeLength:e.figmaNodeLength,imageTokens:e.imageTokens+s,figmaNodeCount:e.figmaNodeCount,imageCount:e.imageCount+1}}return e},{figmaNodeLength:0,imageTokens:0,figmaNodeCount:0,imageCount:0});return{figmaNodeTokensEstimate:t/3,imageTokensEstimate:s,figmaNodeAttachmentCount:n,imageNodeAttachmentCount:a}}(o),g=u.length/3,f=t?JSON.stringify(t).length/3:0,_=s?JSON.stringify(s).length/3:0,y=x+m+g+f+_,k=y<=15e4,v=(0,r.ZC)(k);return(0,n.useEffect)(()=>{v&&!k&&i.az.trackDefinedEvent("ai_for_production.code_chat_client_side_context_limit_exceeded",{total_number_of_tokens_estimate:y,image_tokens_estimate:m,figma_node_tokens_estimate:x,text_tokens_estimate:g,point_and_prompt_tokens_estimate:f,text_character_count:u.length,image_attachment_count:h,figma_node_attachment_count:p,direct_selection_count:t?1:0,file_key:c,persistent_entity_id:d})},[k,u,t,s,o,v,c,d,x,m,g,f,_,p,h,y]),y<=15e4}},76075:(e,t,s)=>{s.d(t,{Ng:()=>j,TH:()=>E,YT:()=>S,aQ:()=>C,vG:()=>A});var n=s(105652),a=s(20002),i=s(836848),r=s(692376),l=s(379141),o=s(445019),c=s(74372),d=s(522568),u=s(506738),x=s(19047),m=s(888903),p=s(287736),h=s(111273),g=s(223487),f=s(605985),_=s(285268),y=s(183290),k=s(203250),v=s(493130),b=s(17248);let j=(0,o.eU)(!1),C=(0,o.eU)(!1),w=(0,o.eU)(!1),E=(0,o.eU)(null),N=(0,o.eU)(null);function S(){let[e,t]=(0,o.fp)(E),[s,a]=(0,o.fp)(N),i=(0,n.useRef)(!1),r=(0,n.useCallback)((t,{error:n,message:a}={})=>{if(e){let i={...e,status:t,...n&&{error:n}},r=e.type,l=["send-comments-to-make","send-to-make-from-figjam"].includes(r),o=!!e.selectedNodeId&&"send-to-make-from-figjam"!==r;if(l){let e="success"===t&&a!==s;d.az.trackDefinedEvent("activation.send_to_make.generated_prompt_submitted",{...i,didEditInitialMessage:e})}o&&d.az.trackDefinedEvent("activation.send_to_make_from_design.prompt_with_attachments",i)}},[e,s]);return(0,n.useCallback)((s,{error:n,message:l}={})=>{null===e||i.current||(i.current=!0,"success"===s?r("success",{message:l}):n&&r("error",{error:n}),t(null),a(null))},[t,e,r,a])}async function T({fileKey:e,selectedNodeIds:t}){if(!t||0===t.length)throw Error("copyNodeToMakeFromDesign: selectedNodeIds are undefined or empty");let s=await (0,v.R)({fileKey:e,selectedGuids:t});r.glU?.applyNodesFromBuffer(s,e,t,!0)}function I(e){switch(e.type){case"send-comments-to-make":case"send-to-make-from-figjam":if(!e.selectedNodeId)return[];return[e.selectedNodeId];case"send-to-make-from-design":case"send-to-make-from-devmode":return e.selectedNodeIds}}function A(e){let t=(0,a.wA)(),s=(0,b.EI)(),{disabled:v,loading:C}=(0,k.y3)(),S=(0,g.tS)(),A=(0,o.md)(h.Fk),[M,z]=(0,o.fp)(w),L=(0,o.Xr)((0,y.mC)(e)),O=function(){let e=(0,n.useRef)("");return e.current||(e.current=(0,c.g)()),e.current}(),P=(0,o.Xr)(h.$K),R=r.Ez5?.figmakeState(),D=(0,o.Xr)(j),F=(0,o.Xr)(E),q=(0,o.Xr)(N),G=(0,f.TA)(),U=!v&&!C&&s,K=(0,n.useCallback)(()=>{t(m.F.enqueue({message:(0,l.t)("figmake.send_to_make.generating_prompt"),type:"send-to-make-prompt-generating",icon:p.zX.SPINNER,preventDismissal:!0}))},[t]),H=(0,n.useCallback)(()=>{t(m.F.dequeue({matchType:"send-to-make-prompt-generating"})),t(m.F.enqueue({message:(0,l.t)("figmake.send_to_make_from_design.error.something-went-wrong"),type:"send-to-make-from-design-failed",icon:p.zX.EXCLAMATION,error:!0,timeoutOverride:3e3}))},[t]),B=(0,n.useCallback)(e=>{t(m.F.enqueue({message:e?(0,l.t)("figmake.send_to_make_from_design.visual_bell.copying_complex_frames"):(0,l.t)("figmake.send_to_make_from_design.visual_bell.copying_frames"),type:"send-to-make-from-design-load",icon:p.zX.SPINNER,preventDismissal:!0,timeoutOverride:3e5}))},[t]),V=(0,n.useCallback)(()=>{t(m.F.dequeue({matchType:"send-to-make-from-design-load"})),t(m.F.enqueue({message:(0,l.t)("figmake.send_to_make_from_design.error.something-went-wrong"),type:"send-to-make-from-design-failed",icon:p.zX.EXCLAMATION,error:!0,timeoutOverride:3e3}))},[t]),$=(0,n.useCallback)(()=>{t(m.F.dequeue({matchType:"send-to-make-from-design-load"})),t(m.F.enqueue({message:(0,l.t)("figmake.send_to_make_from_design.visual_bell.complete"),type:"send-to-make-from-design-complete",icon:p.zX.CHECK,timeoutOverride:3e3}))},[t]),W=(0,n.useCallback)(e=>{let t=I(e);return{userId:G??"",makeFileKey:S??"",fileKey:e.fileKey,fileVersion:e.fileVersion,pageGuid:e.pageGuid,selectedNodeId:t.join(","),exceedsMakePasteThreshold:e.exceedsMakePasteThreshold,source:e.source,type:e.type}},[G,S]),Y=(0,n.useCallback)(async(e,t,s=!1)=>{let n=I(e);try{await T({fileKey:e.fileKey,selectedNodeIds:n}),d.az.trackDefinedEvent("activation.send_to_make_from_design.file_bootstrapped_from_design",{...t,status:"success"}),s||$()}catch(e){(0,x.x1)("sendToMakeFromDesign","copyNodeToMakeFromDesign failed with some error",{...t,error:e?.message??JSON.stringify(e)},{reportAsSentryError:!0}),d.az.trackDefinedEvent("activation.send_to_make_from_design.file_bootstrapped_from_design",{...t,status:"error",error:e?.message??JSON.stringify(e)}),D(!1),s||V()}},[$,V,D]);(0,u.R)(()=>{A?.type==="send-comments-to-make"||A?.type==="send-to-make-from-figjam"?K():B(A?.exceedsMakePasteThreshold)},[A],([e])=>!!e),(0,u.R)(()=>{if(M)return;z(!0),(0,i.KF)(!!A,"makeCreationData is undefined. This should never happen"),(0,i.KF)("send-comments-to-make"===A.type,"makeCreationData type is not send-comments-to-make"),D(!0);let e=W(A);F({...e}),d.az.trackDefinedEvent("activation.send_comments_to_make.generate_prompt_from_comments",{...e,status:"pending"}),Promise.all([(0,_.DK)(A.comments,"comments",O),Y(A,e,!0)]).then(([s])=>{if(L(s.prompt),q(s.prompt),d.az.trackDefinedEvent("activation.send_comments_to_make.generate_prompt_from_comments",{...e,status:"success"}),t(m.F.dequeue({matchType:"send-to-make-prompt-generating"})),!A.selectedNodeId){P(o.Ut),D(!1),z(!1),$();return}P(o.Ut),z(!1)}).catch(t=>{L(A.comments.join("\n")),d.az.trackDefinedEvent("activation.send_comments_to_make.generate_prompt_from_comments",{...e,status:"error",error:t?.message??JSON.stringify(t)}),P(o.Ut),D(!1),z(!1),H()})},[G,S,U,A,R,M],()=>!!G&&!!S&&U&&!!A&&!!R&&!M&&"send-comments-to-make"===A.type),(0,u.R)(()=>{if(M)return;z(!0),(0,i.KF)(!!A,"makeCreationData is undefined. This should never happen"),(0,i.KF)("send-to-make-from-design"===A.type||"send-to-make-from-devmode"===A.type,"makeCreationData type is not send-to-make-from-design or send-to-make-from-devmode"),D(!0);let e=W(A);F({...e}),Y(A,e).finally(()=>{P(o.Ut),z(!1)})},[G,S,U,A,R,M],()=>!!G&&!!S&&U&&!!A&&!!R&&!M&&("send-to-make-from-design"===A.type||"send-to-make-from-devmode"===A.type)),(0,u.R)(()=>{if(!M){if(z(!0),(0,i.KF)(!!A,"makeCreationData is undefined. This should never happen"),(0,i.KF)("send-to-make-from-figjam"===A.type,"makeCreationData type is not send-to-make-from-figjam"),F({...W(A)}),1===A.textNodes.length&&A.textNodes[0]){let e=A.textNodes[0];Promise.resolve().then(()=>{L(e),q(e),P(o.Ut),D(!1),z(!1),$()});return}D(!0),(0,_.DK)(A.textNodes,"figjam-stickies",O).then(e=>{L(e.prompt),q(e.prompt),t(m.F.dequeue({matchType:"send-to-make-prompt-generating"})),P(o.Ut),D(!1),z(!1),$()}).catch(e=>{P(o.Ut),D(!1),z(!1),H()})}},[G,S,U,A,R,M],()=>!!G&&!!S&&U&&!!A&&!!R&&!M&&"send-to-make-from-figjam"===A.type)}},335213:(e,t,s)=>{s.d(t,{S:()=>a});var n=s(105652);function a({textareaRef:e,maxHeight:t}){return(0,n.useCallback)(()=>{if(e&&"current"in e&&e.current){let s=e.current;s.style.height="auto";let n=window.getComputedStyle(s),a=parseFloat(n.paddingTop),i=parseFloat(n.paddingBottom),r=Math.min(s.scrollHeight-a-i,t);return s.style.height=`${r}px`,r}},[t,e])}},235591:(e,t,s)=>{s.d(t,{O:()=>u,Z:()=>d});var n=s(105652),a=s(445019),i=s(575015),r=s(223487),l=s(920675),o=s(569313),c=s(211464);function d(){return!!u()}function u(){let e=(0,a.md)(r.ze),t=(0,o.Vc)(e),s=!!(0,c.z)("resumable_makes_cortex_killswitch");return(0,n.useMemo)(()=>{if((0,i.nl)()||s)return!1;switch(t?.data?.tier){case l.Ag.ORG:case l.Ag.ENTERPRISE:return!!(0,c.z)("resumable_makes_org_enterprise");case l.Ag.PRO:case l.Ag.STUDENT:return!!(0,c.z)("resumable_makes_pro_student");case l.Ag.STARTER:return!!(0,c.z)("resumable_makes");default:return}},[s,t?.data?.tier])}},607231:(e,t,s)=>{s.d(t,{R:()=>c});var n=s(105652),a=s(312884),i=s(732838),r=s(723850),l=s(750665),o=s(680912);function c({onAuthSuccess:e,onAuthFailure:t}){let[s,c]=n.useState({isAuthorizing:!1,server:null,window:null}),d=(0,o.Ay)(),u=(0,r.hC)(),x=n.useRef(!1),m=n.useCallback(async t=>{x.current||(x.current=!0,u("ai_chat_mcp.server_login_success",{mcpServerId:t.id,featureEntrypoint:"figmake"}),await e(t))},[e,u]),p=n.useCallback(e=>{x.current||(x.current=!0,u("ai_chat_mcp.server_login_failure",{mcpServerId:e.id,featureEntrypoint:"figmake"}),t(e))},[t,u]),h=n.useCallback(async e=>{let t=await l.Ay.mcp.listTools({id:e.id},d);return t.needsAuthorization?{needsAuth:!0,authorizationUrl:t.authorizationUrl}:{needsAuth:!1}},[d]),g=n.useCallback(async(e,t)=>{try{let{needsAuth:s}=await h(e);s||(m(e),c({isAuthorizing:!1,server:null,window:null})),s&&t.isLastAuthCheck&&(p(e),c({isAuthorizing:!1,server:null,window:null}))}catch(t){console.error("Error checking server authorization:",t),p(e),c({isAuthorizing:!1,server:null,window:null})}},[h,p,m]);return n.useEffect(()=>{let{isAuthorizing:e,window:t,server:n}=s;if(!e||!t)return;let a=setInterval(()=>{t.closed&&(clearInterval(a),g(n,{isLastAuthCheck:!0}))},500),i=()=>{"visible"===document.visibilityState&&g(n,{isLastAuthCheck:!1})};return document.addEventListener("visibilitychange",i),()=>{clearInterval(a),document.removeEventListener("visibilitychange",i)}},[s,g]),n.useEffect(()=>{let{isAuthorizing:e,server:t}=s;if(!e||!(0,i.y3)())return;let n=setInterval(async()=>{document.hasFocus()&&await g(t,{isLastAuthCheck:!1})},1e3),a=setTimeout(()=>{g(t,{isLastAuthCheck:!0})},3e5);return()=>{clearInterval(n),clearTimeout(a)}},[s,g]),{initiateOauth:n.useCallback(async e=>{let t;x.current=!1,u("ai_chat_mcp.server_login_initiated",{mcpServerId:e.id,featureEntrypoint:"figmake"});try{let s=await h(e);if(!s.needsAuth){await m(e);return}t=s.authorizationUrl}catch(t){console.error("Error checking server authorization:",t),p(e);return}let s=(0,a.FJ)(t,"_blank");if(!s&&!(0,i.y3)()){console.error("Failed to open OAuth window"),p(e);return}c({isAuthorizing:!0,server:e,window:s})},[h,p,m,u])}}},629332:(e,t,s)=>{s.d(t,{Qh:()=>w,Rr:()=>I,Wy:()=>S,g8:()=>N,oJ:()=>j,pA:()=>A,q6:()=>T});var n=s(105652),a=s(607696),i=s(270450),r=s(445019),l=s(446232),o=s(723850),c=s(719749),d=s(391596),u=s(750665),x=s(680912),m=s(590277),p=s(223487),h=s(610604),g=s(538349),f=s(611034),_=s(183290),y=s(807461),k=s(671661);let v=g.M4.Query({fetch:async e=>(await f.p.getMcpServers(e.fileKey??void 0)).data.meta.servers}),b=(0,m.BG)({strictRecords:!0,strictLists:!1,ignore:e=>"createdAt"===e[1]});function j(){let e=(0,r.md)(p.ze),[t,{refetch:s}]=(0,g.IT)(v({fileKey:e})),n=(0,c.Rs)((0,h.ksf)({}),{enabled:!!e}),a="loading"===t.status,o="loading"===n.status,d=(0,i.kc)().bake_mcp_client_lg;return{mcpServers:(0,m.u8)({label:m.A5.McpClient.useMcpServers,oldValue:t.data??[],oldValueReady:!a,newValue:(0,l.unwrap)(n.data?.mcpServers,[])??[],newValueReady:!o,enableFullRead:d,maxReports:2,comparator:b}),isLoading:d?o:a,refetch:s}}let C=g.M4.Query({fetch:async e=>(await f.p.getMcpClients(e.fileKey??void 0)).data.meta.clients});function w(e=!0){let t=(0,r.md)(p.ze),[s,{refetch:a}]=(0,g.IT)(C({fileKey:t}),{enabled:e}),o=(0,c.Rs)((0,h.ksf)({})),u="loading"===s.status,x="loading"===o.status,f=(0,i.kc)().bake_mcp_client_lg,_=(0,m.u8)({label:m.A5.McpClient.useMcpClients,oldValue:s.data??[],oldValueReady:!u,newValue:n.useMemo(()=>{let e=(0,l.unwrap)(o.data?.mcpClients,[])??[],t=new Map(((0,l.unwrap)(o.data?.mcpServers,[])??[]).map(e=>[e.id,e]));return e.map(e=>{let s=t.get(e.mcpServerId);return s?{...e,server:s}:null}).filter(e=>null!==e)},[o.data?.mcpClients,o.data?.mcpServers]),newValueReady:!x,enableFullRead:f,maxReports:2,comparator:b}),k=f?x:u;return(0,d.En)(_.map(e=>E({serverId:e.mcpServerId}))),n.useEffect(()=>{k||_?.forEach(e=>y.rz(e.server.id))},[k,_]),{mcpClients:_,isLoading:k,refetch:a}}let E=g.M4.Query({fetch:async e=>{let t=(0,x.Ay)(),{serverId:s}=e,n=await u.Ay.mcp.listTools({id:s},t);return n.needsAuthorization?[]:n.tools.tools}});function N(e){let[t,{refetch:s}]=(0,g.IT)(E({serverId:e})),n="loading"===t.status,a="errors"===t.status;return{tools:t.data??[],isLoading:n,isError:a,refetch:s}}function S(e){let t=(0,d.En)(e.map(e=>E({serverId:e.mcpServerId})));return n.useMemo(()=>{let s=new Map;for(let n=0;n<e.length;n++){let a=e[n],i=t[n];if(a){if(i&&"loaded"===i.status){let e=i.data??[];s.set(a.server.id,e.map(e=>({name:e.name})))}else s.set(a.server.id,[])}}return s},[e,t])}function T(){let e=(0,o.hC)();return n.useCallback(async(t,s,n,a,i)=>{e("ai_chat_mcp.tool_run_initiated",{toolName:a,mcpServerId:t,featureEntrypoint:"figmake",autoRunEnabled:i.autoRunEnabled,clientLifecycleId:i.clientLifecycleId,persistentEntityId:i.persistentEntityId,toolCallId:s});try{let r=await u.Ay.mcp.callTool({serverId:t,toolName:a,toolArgs:n},(0,x.Ay)()),l={success:!0,message:`Successfully executed MCP tool '${a}' from server '${t}'`,data:JSON.stringify(r.result?.content)};return e("ai_chat_mcp.tool_run_success",{toolName:a,mcpServerId:t,featureEntrypoint:"figmake",clientLifecycleId:i.clientLifecycleId,persistentEntityId:i.persistentEntityId,toolCallId:s}),l}catch(r){console.error("Error calling MCP tool:",r);let n=r instanceof Error?r.message:"string"==typeof r?r:"Unknown error";return e("ai_chat_mcp.tool_run_failure",{toolName:a,mcpServerId:t,featureEntrypoint:"figmake",clientLifecycleId:i.clientLifecycleId,persistentEntityId:i.persistentEntityId,toolCallId:s}),{success:!1,message:`Failed to execute MCP tool: ${n}`,data:void 0}}},[e])}function I(e,t){let s=(0,r.Xr)(y.iw),a=(0,k.Y)(),i=T(),l=(0,o.hC)(),c=(0,r.md)((0,_.Z3)(t));return n.useEffect(()=>{function t(){e.forEach(e=>{s({toolCallId:e,toolResult:void 0})})}return c?.signal.addEventListener("abort",t),()=>{c?.signal.removeEventListener("abort",t)}},[c,e,s]),{executeBatchToolCalls:n.useCallback(async(e,t)=>{a({results:await Promise.all(e.map(async({toolCallId:e,serverId:n,fullToolName:a,serverToolName:r,toolArgs:l})=>{let o=await i(n,e,l,r,t);return s({toolCallId:e,toolResult:o}),{toolCallId:e,toolName:a,toolResult:o}}))})},[s,a,i]),cancelBatchToolCalls:function(e,t){a({results:e.map(e=>{l("ai_chat_mcp.tool_run_cancelled",{toolName:e.serverToolName,mcpServerId:e.serverId,featureEntrypoint:"figmake",clientLifecycleId:t.clientLifecycleId,persistentEntityId:t.persistentEntityId,toolCallId:e.toolCallId});let n={success:!1,message:`User dismissed mcp tool call - ${e.fullToolName}`,data:void 0};return s({toolCallId:e.toolCallId,toolResult:n}),{toolCallId:e.toolCallId,toolName:e.fullToolName,toolResult:n}})})}}}function A(e=!0){let{mcpClients:t,isLoading:s}=w(e),i=(0,r.md)(y.RN),l=(0,r.md)(y.KU),o=(0,d.En)(t.map(e=>E({serverId:e.mcpServerId})));return n.useMemo(()=>{if(!e||s)return 0;let n=0;for(let e=0;e<t.length;e++){let s=t[e],r=o[e];if(!s||i[s.server.id]?.disabled===!0||!r||"loaded"!==r.status)continue;let{readToolsDisabled:c,writeToolsDisabled:d}=i[s.server.id]||{};for(let e of r.data??[]){let t=e.annotations?.readOnlyHint;if(c&&t||d&&!t)continue;let i=(0,a.YW)(s.server.name,e.name);l[i]?.disabled!==!0&&n++}}return n},[e,t,o,s,i,l])}},441014:(e,t,s)=>{s.d(t,{B:()=>l});var n=s(105652),a=s(117298),i=s.n(a),r=s(183290);function l(e){let[t,s]=(0,n.useState)([]),{exchange:a}=(0,r.$W)(e?.guid),l=(0,n.useRef)([]);return n.useEffect(()=>{let e=a?.messages||[];i()(e,l.current)||(l.current=e,s(e))},[a?.messages]),t}},480652:(e,t,s)=>{s.d(t,{q:()=>c});var n=s(105652),a=s(607696),i=s(445019),r=s(522568),l=s(562418);let o=(0,s(840864).H)({});function c(e,t,s,c,d,u){let[x,m]=(0,i.fp)(o(d)),p=`${d||"unknown"}-${c}`,h=x[p]||{selectedFeedback:null,shouldShowAdditionalFeedback:!1},g=n.useCallback(e=>{m({...x,[p]:e})},[m,x,p]),{persistentEntityId:f,clientLifecycleId:_}=e,y=(0,l.ow)(),k=s===a.lV.FIGMAKE?"figmake":s===a.lV.CODE_IN_SITES?"sites":y?"figjam":"design",v=n.useCallback((e,n,a)=>{_&&r.az.trackDefinedEvent("ai_for_production.chat_feedback",{feedbackType:e,productType:k,feedback:n,messageId:a,fileKey:t||void 0,featureType:s,persistentEntityId:f,clientLifecycleId:_,location:u})},[t,s,_,f,k,u]);return{feedbackState:h,setFeedbackState:g,sentimentFeedbackCallback:n.useCallback((e,t)=>{v(e.toString(),t,c)},[v,c]),additionalFeedbackCallback:n.useCallback((e,t)=>{v(e.toString(),t,c)},[v,c]),categoryFeedbackCallback:n.useCallback((e,t)=>{v(e.toString(),t,c)},[v,c]),productType:k}}},940728:(e,t,s)=>{s.d(t,{v:()=>h,t:()=>p});var n=s(105652),a=s(607696),i=s(534399),r=s(854225),l=s(270450),o=s(677394),c=s(379141);let d=["write_tool","edit_tool","read","view_tool","fast_apply_tool","delete_tool"];var u=s(820198),x=s(444244),m=s(395823);function p(e,t,s,p){let h=(0,o.k9)(()=>s,[s]),g=!h.isExchangeMessages&&!!(0,l.kc)().make_chat_contents_cache;return(0,n.useMemo)(()=>{let s=[],n={},l=e;p&&p.pagination&&p.pagination.hasMore&&!h.ignorePaginationFiltering&&(l=function(e,t){let s=e.findIndex(e=>e.type===r.K$p.USER_MESSAGE||e.type===r.K$p.SYSTEM_MESSAGE&&!!(0,a.U1)(e,t));return s<0?[]:s>0?e.slice(s):e}(l,g));let o=!1;for(let e=0;e<l.length;e++){let p=l[e];switch(p.type){case r.K$p.USER_MESSAGE:{let e=function(e,t,s){let n=t.usersById?.[e.userId];if(!n)return{renderableMessage:null,isAutoErrorFix:!1};let r=(0,a.MK)(e,s),l=(0,i.gG)(r);return r.hidden?{renderableMessage:null,isAutoErrorFix:l}:{renderableMessage:{type:"user",user:n,id:e.id,uniqueId:(0,a._$)(e),plainText:r.plainText||"",imports:r.imports,inspectedElement:r.inspectedElement,inspectedComponent:r.inspectedComponent,inspectedLibrary:r.inspectedLibrary,selectedNodeIds:r.selectedNodeIds,libraryKey:r.libraryKey,sentAt64:e.sentAt64?.toString()},isAutoErrorFix:l}}(p,t,g);e.renderableMessage&&s.push(e.renderableMessage),o=e.isAutoErrorFix;continue}case r.K$p.SYSTEM_MESSAGE:{let e=function(e,t){let s=(0,a.U1)(e,t);if(!s)return null;let n={type:"system",id:e.id,uniqueId:(0,a._$)(e),systemMessageType:s.type,title:"title"in s?s.title:void 0,sentAt64:e.sentAt64?.toString()};switch(s.type){case"restore":return{...n,systemMessageType:"restore",codeSnapshotKey:s.codeSnapshot?.codeSnapshotKey,fileVersionId:s.codeSnapshot?.fileVersionId};case"manual_edit":return{...n,systemMessageType:"manual_edit",changedFiles:s.changedFiles,codeSnapshotKey:s.codeSnapshot?.codeSnapshotKey,fileVersionId:s.codeSnapshot?.fileVersionId};case"duplicated_file":return{...n,systemMessageType:"duplicated_file",fileKeyHash:s.fileKeyHash};case"deleted_chat_history":return{...n,systemMessageType:"deleted_chat_history",userId:s.userId,timestamp:s.timestamp};default:return{...n,systemMessageType:"generic",plainText:s.plainText||""}}}(p,g);e&&s.push(e),o=!1;continue}case r.K$p.ASSISTANT_MESSAGE:{let{assistantMessages:t,title:i,lastGroupMessageIndex:f}=function(e,t,s,n){let i=(0,a.BM)([s]),l=(0,a.lr)(s,n).title,o=t,c=!1;for(let s=t+1;s<e.length;s++){let t=e[s];if(!t)break;let d=(0,a.lr)(t,n);l||=d.title;let u=t.type===r.K$p.ASSISTANT_MESSAGE,x=t.type===r.K$p.TOOL_MESSAGE;if(!(u||x))break;if(o=s,x){if(function(e,t){let s=t.toolResults;if(!s||0===s.length)return!1;let n=e[e.length-1];if(!n)return!1;let i=(0,a.BM)([n])[0];if(!i)return!1;for(let n of(e.push(...(0,a.BM)([t])),s))if(i.toolCalls.find(e=>e.toolCallId===n.toolCallId&&e.toolName===n.toolName)&&(i.toolResults.push(n),(0,m.d4)(n.toolName)))return!0;return!1}(i,t)){c=!0;break}}else i.push(...(0,a.BM)([t]));if(c)break}return{assistantMessages:i,title:l,lastGroupMessageIndex:o}}(l,e,p,g),{messageContent:_,messagesMetadata:y}=function(e,t={},s=!1,n){let i;let{hideTextBetweenToolCalls:l=!1,hideTextBetweenCompletedToolCalls:o=!1,addCompletedToolCallInfo:m=!1,consolidateReasoning:p=!1}=t,h=[],g=new Set,f={readFileCount:0,writeFileCount:0,editFileCount:0,deleteFileCount:0},_=new Map;e.forEach(e=>{(e.type===r.K$p.ASSISTANT_MESSAGE||e.type===r.K$p.TOOL_MESSAGE)&&e.toolResults?.forEach(e=>{_.set(e.toolCallId,e),n&&u.RB(e,n)})}),e.forEach(e=>{if(e.type===r.K$p.ASSISTANT_MESSAGE){let n=(0,a.lr)(e,s),i={id:e.id,sentAt64:e.sentAt64},r=[];switch(n.signedReasoning&&r.push({...i,type:"reasoning",reasoning:n.signedReasoning.text}),n.mode){case"code":n.codeFilePath&&r.push({...i,type:"code",code:n.code,file:n.codeFilePath});break;case"message":r.push({...i,type:"message",message:n.plainText});break;case"visible_message":var t;r.push({...i,type:"visible_message",message:(t=n.plainText)?t.replace(/<figma[^>]*>([\s\S]*?)<\/figma>/g,(e,t)=>e.includes("\n")?"":e):t,codeSnapshot:n.codeSnapshot});break;case"plan":r.push({...i,type:"plan",plan:n.plainText,title:n.title||""});break;case"summary":r.push({...i,type:"summary",summary:n.plainText,codeSnapshot:n.codeSnapshot});break;case"work":r.push({...i,type:"work",work:n.plainText});break;default:n.plainText.length>0&&r.push({...i,type:"message",message:n.plainText})}if(e.toolCalls){let t=function(e,t,s,n){let i=[],r=[];for(let l of e)if("call_mcp_tool"!==l.toolName||t.has(l.toolCallId)){if((0,a.Eb)(l.toolName)&&((0,x.t)(l.toolName)||(0,x.c)(l.toolName))&&!t.has(l.toolCallId)){let e=(0,a.Vm)(l);e&&i.push(e);let t=s.get(l.toolCallId);if(t){let e=(0,a.Xy)(t);e&&r.push(e)}}}else try{let e=JSON.parse(l.argsJson),t=e.tool_name,o=e.tool_input,c=e.serverId,d=e.serverLogoUrl,u=e.serverName;if(t&&null!=o&&c&&d){let e={type:"toolCall",toolCallId:l.toolCallId,toolName:t,partialArgs:{...o,serverId:c,serverLogoUrl:d,serverName:u,userId:n}};i.push(e);let x=s.get(l.toolCallId);if(x){let e=(0,a.Xy)(x);e&&r.push(e)}}}catch(e){}if(i.length>0)return{type:"mcpClientSideToolCall",toolCalls:i,toolResults:r}}(e.toolCalls,g,_,e.userId);t&&(r.push({...i,...t}),t.toolCalls.forEach(e=>{g.add(e.toolCallId)})),e.toolCalls.forEach(e=>{if("call_mcp_tool"!==e.toolName){if("run_mcp_tool"===e.toolName){if(g.has(e.toolCallId))return;g.add(e.toolCallId);let t=(0,a.Vm)(e);if(!t)return;let s={...i,type:"mcpServerSideToolCall",toolCall:t},n=_.get(e.toolCallId);if(n){let e=(0,a.Xy)(n);e&&(s.toolResult=e)}r.push(s);return}if((0,a.Eb)(e.toolName)){if(g.has(e.toolCallId))return;g.add(e.toolCallId);let t=(0,a.Vm)(e);if(!t)return;let s={...i,type:"clientSideToolCall",toolCall:t},n=_.get(e.toolCallId);if(n){let e=(0,a.Xy)(n);e&&(s.toolResult=e)}r.push(s)}else{if(g.has(e.toolCallId))return;g.add(e.toolCallId);let s={...i,type:"toolCall",name:e.toolName},n=_.get(e.toolCallId);if(m&&n){var t;if(s.isCompleted=!0,t=n.toolName,d.includes(t)){let e=(0,a.Xy)(n);e&&(s.toolResult=e,e.result?.success&&function(e,t){switch(t){case"read":case"view_tool":e.readFileCount++;break;case"write_tool":e.writeFileCount++;break;case"edit_tool":case"fast_apply_tool":e.editFileCount++;break;case"delete_tool":e.deleteFileCount++}}(f,e.toolName))}}r.push(s)}}})}h.push(...r)}});let y=h;p&&(y=function(e){if(0===e.length)return e;let t=new Set(["toolCall","clientSideToolCall","mcpClientSideToolCall","mcpServerSideToolCall"]),s=[],n=-1;for(let a=0;a<e.length;a++){let i=e[a];if("reasoning"===i.type){let e=i.reasoning?.trim();if(!e)continue;if(n>=0){let t=s[n];"reasoning"===t.type&&(s[n]={...t,reasoning:t.reasoning+"\n\n"+e})}else s.push({...i,reasoning:e}),n=s.length-1}else s.push(i),t.has(i.type)||(n=-1)}return s}(y)),(l||o)&&(y=function(e,t){let s=-1;for(let t=e.length-1;t>=0;t--)if(e[t]?.type==="visible_message"){s=t;break}return e.filter((n,a)=>{if("visible_message"!==n.type||s===a)return!0;let i=e[a-1],r=e[a+1],l=i?.type==="toolCall"||i?.type==="clientSideToolCall",o=r?.type==="toolCall"||r?.type==="clientSideToolCall";if(t){if(i?.type==="toolCall"&&i?.isCompleted&&r?.type==="toolCall"&&r?.isCompleted)return!1}else if(l&&o)return!1;return!0})}(y,o));let k=function(e){let{readFileCount:t,writeFileCount:s,editFileCount:n,deleteFileCount:a}=e,i=t+s+n+a;if(0===i)return;let r=[];return t>0&&r.push((0,c.t)("figmake.chat.read_files",{count:t})),n>0&&r.push((0,c.t)("figmake.chat.edited_files",{count:n})),s>0&&r.push((0,c.t)("figmake.chat.wrote_files",{count:s})),a>0&&r.push((0,c.t)("figmake.chat.deleted_files",{count:a})),{totalFileCount:i,displayStrings:r}}(f);return k&&(i={groupedToolCallData:k}),{messageContent:y,messagesMetadata:i}}(t,h,g,n);s.push({type:"assistant",uniqueId:(0,a._$)(p),messages:_,isAutoErrorFix:o,title:i,sentAt64:p.sentAt64?.toString(),messagesMetadata:y}),o=!1,e=f;continue}case r.K$p.TOOL_MESSAGE:p.toolResults.forEach(e=>{(0,u.RB)(e,n)});continue}}return h.isExchangeMessages&&s.forEach(e=>{e.isExchangeMessage=!0}),{messages:s,messagesMetadata:n}},[e,p,t,h,g])}function h(e,t){return(0,n.useMemo)(()=>{let s=e.todoMetadata,n=t.todoMetadata;if(!s&&!n)return{};if(!s)return{todoMetadata:n?{...n,orphanedExchangeTodos:[]}:void 0};if(!n)return{todoMetadata:{...s,orphanedExchangeTodos:[]}};let a=s.todoStatusMap;for(let[e,t]of n.todoStatusMap){let s=a.get(e);if(s)for(let[e,n]of t)s.set(e,n);else a.set(e,t)}if(s.currentTodoId&&n.orphanedExchangeTodos.length>0){let e=a.get(s.currentTodoId);if(e)for(let t of n.orphanedExchangeTodos){let s=e.get(t.content);s&&(s.status=t.status)}}return{todoMetadata:{todoStatusMap:a,currentTodoId:n.currentTodoId??s.currentTodoId,orphanedExchangeTodos:[]}}},[e,t])}},580763:(e,t,s)=>{s.d(t,{E:()=>H,p:()=>B});var n=s(105652),a=s(363638),i=s(295870),r=s(692376),l=s(854225),o=s(798913),c=s(582300),d=s(445019),u=s(117298),x=s.n(u),m=s(522568),p=s(943866),h=s(129416),g=s(384203),f=s(223487),_=s(157750),y=s(522178),k=s(160849),v=s(24867),b=s(336976),j=s(919278),C=s(646673),w=s(466082),E=s(419312),N=s(130771),S=s(348149);s(17147);var T=s(750665),I=s(961230);let A=new class{constructor(){this.worker=null,this.pendingRequests=new Map,this.handleWorkerMessage=e=>{let{type:t,id:s}=e.data,n=this.pendingRequests.get(s);if(!n){console.warn("Received response for unknown request:",s);return}this.pendingRequests.delete(s),"AST_DIFF_RESULT"===t?n.resolve(e.data.result):"AST_DIFF_ERROR"===t&&n.reject(Error(e.data.error))},this.handleWorkerError=e=>{for(let[t,s]of(console.error("Worker error:",e),this.pendingRequests))s.reject(Error("Worker error: "+e.message));this.pendingRequests.clear()}}getWorker(){return this.worker||(this.worker=(0,I.x)(Fig.astDiffWorkerURL),this.worker.addEventListener("message",this.handleWorkerMessage.bind(this)),this.worker.addEventListener("error",this.handleWorkerError.bind(this))),this.worker}processASTDiff(e,t,s={}){let n=this.getWorker(),a=crypto.randomUUID(),i={type:"AST_DIFF",id:a,oldCode:e,newCode:t,options:s};return new Promise((e,t)=>{this.pendingRequests.set(a,{resolve:e,reject:t}),n.postMessage(i)})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null),this.pendingRequests.clear()}};var M=(e=>(e.Added="added",e.Removed="removed",e.Modified="modified",e))(M||{});let z=void 0;async function L(e,t){await new Promise(s=>{let n=setInterval(()=>{e.sourceCode.startsWith("// Converting designs to code")||t.sourceCode.startsWith("// Converting designs to code")||(clearInterval(n),s(!0))},50)});try{let s=e.sourceCode.replace(/import .* from .*\n/g,"").trim(),n=t.sourceCode.replace(/import .* from .*\n/g,"").trim(),i=await A.processASTDiff(n,s,{ignoreComments:!0,ignoreWhitespace:!0,ignoreFormatting:!0}),r=await (0,S.w0)("make_apply_diff_strategy"),l=r.getValue("strategy","llm"),o=r.getValue("modelOverride",null),c=null;return"llm"===l?c=(await T.Ay.internal.explainDiff({diffs:i.filteredDiff,modelOverride:o??void 0})).explanation:"local"===l&&(c=i.filteredDiff.map(e=>{let t=function(e){let t=e.nodeName?.toLowerCase()??"",s=e.value?.toLowerCase()??"";return s.includes("bg-")||s.includes("text-")||t.includes("color")?"Color":s.match(/^(w-|h-|top-|left-|right-|bottom-|p-|px-|py-|pt-|pr-|pb-|pl-|m-|mx-|my-|mt-|mr-|mb-|ml-)/)||t.includes("width")||t.includes("height")||t.includes("padding")||t.includes("margin")?"Positioning":s.match(/^(font-|text-\d|leading-|tracking-)/)||t.includes("font")||t.includes("weight")?"Formatting":e.state===M.Added?"New Element":e.state===M.Removed?"Removal":"Change"}(e),s=function(e){let{tree:t,description:s}=function(e){let t=e.match(/className\.(\S+)\s+of\s+(<\w+>)\s+in\s+(.+)/);if(t){let[,,e,s]=t,n=s.split(" -> ").reverse().join(" -> ");return{element:e,tree:`\`${n} -> ${e}\``,description:e.replace(/[<>]/g,"")}}let s=e.match(/(<\w+>)\s+in\s+(.+)/);if(s){let[,e,t]=s,n=t.split(" -> ").reverse().join(" -> ");return{element:e,tree:`\`${n} -> ${e}\``,description:e.replace(/[<>]/g,"")}}return{element:e,tree:e,description:e}}(e.nodeName??""),n=[t,e.sourceFile?`source: \`${e.sourceFile}:${e.sourceLine}:${e.sourceColumn}\``:""].filter(Boolean).join(", ");if(e.state===M.Added)return`${s} (tree: ${n}) added with value \`${e.value}\``;if(e.state===M.Removed)return`${s} (tree: ${n}) removed value \`${e.value}\``;if(e.oldValue&&e.value){let t=e.nodeName?.match(/className\.(\w+)/);if(t){let a=t[1];return`${s} (tree: ${n}) ${a} changed from \`${e.oldValue}\` to \`${e.value}\``}return`${s} (tree: ${n}) changed from \`${e.oldValue}\` to \`${e.value}\``}return`${s} (tree: ${n}) changed to \`${e.value}\``}(e);return`  - **${t}**: ${s}`}).join("\n")),a.v.getFeatureGate("bake_m2d_download_diff")&&c&&z?.(c,l),c}catch(e){return console.error("AST diff processing failed:",e),null}}var O=s(211464),P=s(754158);async function R(e,t,s,n,a,i){let r;let c=performance.now();i({step:l.doA.START_HTML_TO_DESIGN,attachmentType:"FIGMA_NODE",attachmentId:n,nodeGuid:a.guid,elapsedMs:0});let d=await t?.sitesPreview?.sendMessage("getDOMNodes",{});if(!e||!d)return;let u=await (0,b.N5)(d,{scene:s,decodeImage:E.UD,tracking:l.HzA.TRACK,rootFrameName:t?.fileName},{attachBuildDataToNodes:{enabled:!0,fileKey:t?.fileKey}});return i({step:l.doA.END_HTML_TO_DESIGN,attachmentType:"FIGMA_NODE",attachmentId:n,nodeGuid:a.guid,elapsedMs:performance.now()-c}),o.l7.ai("figmake",()=>{let e=u.createCodeLayerFromDesign("make-diff-on-paste",!1,C.n0,n);if(1!==e.length){let e=Error("Expected exactly one code layer to be created");throw i({step:l.doA.ROUNDTRIP_CREATE_CODE_LAYER_FROM_DESIGN,attachmentType:"FIGMA_NODE",attachmentId:n,nodeGuid:a.guid,elapsedMs:performance.now()-c,error:e.message}),e}i({step:l.doA.ROUNDTRIP_CREATE_CODE_LAYER_FROM_DESIGN,attachmentType:"FIGMA_NODE",attachmentId:n,nodeGuid:a.guid,elapsedMs:performance.now()-c}),r=e[0]}),r}async function D(e,t,s,n,a,i){let r=i.get(e),l=i.get(t);if(!r||!l)return;let o=await L(r,l),c={status:"success",nodeGuid:s.guid,image:null,type:"DIFF",diffs:o??"",uniqueId:n??(0,j.lA)()};a(e=>e.map(e=>(0,k.ak)(e,s.guid)?c:e)),m.az.trackDefinedEvent("ai_for_production.chat_attachment_added",{attachmentType:"DIFF",fileKey:d.zl.get(f.yV)?.key??void 0,imageSize:0})}async function F(e,t,s,n,a){let i,r;let c=(0,w.UN)(),u=(0,N.I8)(e),x=e.getPluginData("make_to_design_build_data","sourceMakeFile"),m=(0,O.z)("bake_m2d_roundtrip"),p=m&&null!==x&&x===a?.fileKey;o.l7.ai("figmake custom fonts",()=>{u.forEach(e=>{e.fontFamily&&e.fontWeight&&(0,P.HL)({fontFamily:e.fontFamily,styleName:e.fontWeight,postscript:e.postscript||""})})});let h=performance.now();try{i=function(e,t,s,n,a){let i;if(o.l7.ai("figmake",()=>{let r=e.createCodeLayerFromDesign("paste",s,C.n0,t);if(0===r.length){let s=Error("Failed to create code layer from design");throw n({step:l.doA.CREATE_CODE_LAYER_FROM_DESIGN,attachmentType:"FIGMA_NODE",attachmentId:t,nodeGuid:e.guid,elapsedMs:performance.now()-a,error:s.message}),s}if(r.length>1){let s=Error("More than one code layer was created");throw n({step:l.doA.CREATE_CODE_LAYER_FROM_DESIGN,attachmentType:"FIGMA_NODE",attachmentId:t,nodeGuid:e.guid,elapsedMs:performance.now()-a,error:s.message}),s}i=r[0]}),!i)throw Error("Code layer GUID is undefined after creation");return i}(e,n,!p,s,h)}catch(u){(0,v.$L)([n]);let a=d.zl.get(k.Ah).find(t=>(0,k.ak)(t,e.guid));t(t=>t.filter(t=>!(0,k.ak)(t,e.guid))),o.Hq.system("figmake",()=>{let t=c.get(e.guid);t&&t.removeSelfAndChildren()});let i=a?.designToCodeErrors,r=l.FDn.DESIGN_2_REACT_OTHER;i&&i[0]&&(r=i[0]),s({step:l.doA.CREATE_CODE_LAYER_FROM_DESIGN,attachmentType:"FIGMA_NODE",attachmentId:n,nodeGuid:e.guid,elapsedMs:performance.now()-h,error:r.toString()}),(0,k.hH)(l.FDn.DESIGN_2_REACT_OTHER);return}m&&(r=await R(p,a,c,n,e,s)),s({step:l.doA.CREATE_CODE_LAYER_FROM_DESIGN,attachmentType:"FIGMA_NODE",attachmentId:n,nodeGuid:e.guid,elapsedMs:performance.now()-h}),await (0,E.Jr)().loadAllImagesUnder([i],l.MoD.ALL,"rev-image-paste"),r&&await (0,E.Jr)().loadAllImagesUnder([r],l.MoD.ALL,"rev-image-diff-paste"),r&&await D(i,r,e,n,t,c)}async function q(e,t,s,n){let a=performance.now();try{let i=await (0,j.rt)(e),o=await (0,j.Zz)(e);if(r.glU?.addImageNodeAsImageImport(e.id),!i)throw Error("Failed to export image attachment from internal canvas node");n({step:l.doA.EXTRACT_IMAGE_ATTACHMENT,attachmentType:"IMAGE",attachmentId:t,nodeGuid:e.guid,elapsedMs:performance.now()-a});let c={status:"success",nodeGuid:e.guid,image:i,imageHash:o,type:"IMAGE",uniqueId:t};s(t=>t.map(t=>(0,k.ak)(t,e.guid)?c:t)),n({step:l.doA.FINISH_ATTACHMENT,attachmentType:"IMAGE",attachmentId:t,nodeGuid:e.guid,elapsedMs:performance.now()-a}),m.az.trackDefinedEvent("ai_for_production.chat_attachment_added",{attachmentType:"IMAGE",fileKey:d.zl.get(f.yV)?.key??void 0,imageSize:i.length,attachmentId:t})}catch(s){throw n({step:l.doA.EXTRACT_IMAGE_ATTACHMENT,attachmentType:"IMAGE",attachmentId:t,nodeGuid:e.guid,elapsedMs:performance.now()-a,error:s.message}),s}}var G=s(223976),U=s(76075);async function K(e,t,s,n,a,r,o){let u=t.get(e);if(!u){let t=Error("Pasted node not found in scene");return(0,h.$D)(i.e.MAKE_EDITING,t,{extra:{nodeGuid:e,attachmentId:s}}),a({step:l.doA.START,attachmentType:"UNKNOWN",attachmentId:s,nodeGuid:e,elapsedMs:0,error:t.message}),{success:!1,error:t.message}}r?.fileKey&&await (0,G.K6)(e,r.fileKey)&&d.zl.set(G.dt,t=>{let s=new Set(t);return s.add(e),s});let x=(0,y.A)(u)?"IMAGE":"FIGMA_NODE";(0,h.Bc)({pending_make_attachment_id:s,pending_make_attachment_type:x});let p=performance.now();try{if("FIGMA_NODE"===x){let t,i,d;let{count:m,instanceCount:h}=(t=0,i=0,d=0,(0,c.hV)(u,e=>{t++;try{e?.isInstance&&i++}catch(e){d++}}),{count:t,instanceCount:i,couldNotCount:d});a({step:l.doA.START,attachmentType:x,attachmentId:s,nodeGuid:e,elapsedMs:0,nodeCount:m,instanceCount:h}),o&&(0,v.W5)(o,[s]),await F(u,n,a,s,r),a({step:l.doA.PASTE_COMPLETED,attachmentType:x,attachmentId:s,nodeGuid:e,elapsedMs:performance.now()-p,nodeCount:m,instanceCount:h})}else a({step:l.doA.START,attachmentType:x,attachmentId:s,nodeGuid:e,elapsedMs:0}),await q(u,s,n,a),a({step:l.doA.PASTE_COMPLETED,attachmentType:x,attachmentId:s,nodeGuid:e,elapsedMs:performance.now()-p});return{success:!0}}catch(t){return(0,v.$L)([s]),a({step:l.doA.PASTE_COMPLETED,attachmentType:x,attachmentId:s,nodeGuid:e,elapsedMs:performance.now()-p,error:t.message}),n(t=>t.map(t=>(0,k.ak)(t,e)?{...t,status:"error"}:t)),(0,h.$D)(i.e.MAKE_EDITING,t,{extra:{pastedItemType:x,attachmentId:s}}),m.az.trackDefinedEvent("ai_for_production.chat_attachment_failed",{attachmentType:x,fileKey:d.zl.get(f.yV)?.key??void 0,attachmentId:s,errorMessage:t.message}),(0,k.hH)(l.FDn.DESIGN_2_REACT_OTHER),{success:!1,error:t.message}}finally{(0,h.Bc)({pending_make_attachment_id:void 0,pending_make_attachment_type:void 0})}}async function H(e,t,s,n,i,c,u,x){let p;if(!e||0===e.length)return;let h="",g=[];for(let s of e){let e=t.get(s);e&&("TEXT"===e.type?(h&&(h+="\n"),h+=e.characters,o.l7.system("clean-up-chat-box-pasted-text-node",()=>{e.removeSelfAndChildren()})):g.push(s))}if(r.n1M?.clearPastedDesign(),g.length>0&&d.zl.get(k.Ah).filter(e=>"error"!==e.status).length+g.length>k.qQ){(0,k.hH)(l.FDn.MAXIMUM_ATTACHMENTS_EXCEEDED);return}h&&n(h),g.length>0&&x?.(g);let f=d.zl.get(U.TH),_=d.zl.get(U.Ng),y=[],b=[];for(let e of(a.v.getFeatureGate("bake_large_paste_warning")&&(p=(0,v.eg)([])),g)){let n=c(e),a=await K(e,t,n,s,i,u,p);_&&(a.success?b.push(e):a.error&&y.push(`nodeGuid: ${e}, error: ${a.error}`))}_&&(f&&m.az.trackDefinedEvent("activation.send_to_make_from_design.frame_pasted_as_attachment",{...f,status:y.length>0?"error":"success",...y.length>0?{error:y.join("\n")}:{selectedNodeId:b.join(",")}}),d.zl.set(U.Ng,!1),d.zl.set(U.aQ,!0))}function B(e,t,s,a){let i=(0,g.eY)(),l=r.Ez5?.figmakeState(),o=(0,_.ut)(l?.pastedNodeGuids,[]),c=(0,p.ZC)(o),{setAttachments:d,claimAPendingAttachmentOrMakeOne:u,createPendingAttachmentsForNodes:m}=(0,k._9)(e);n.useEffect(()=>{o.length>0&&!x()(o,c)&&H(o,i,d,t,s,u,a,m)},[i,d,t,u,s,o,c,m,a])}},522314:(e,t,s)=>{s.d(t,{Mq:()=>_,tl:()=>f,yB:()=>y});var n=s(105652),a=s(20002),i=s(692376),r=s(854225),l=s(379141),o=s(270450),c=s(445019),d=s(522568),u=s(888903),x=s(287736),m=s(223487),p=s(961998),h=s(493130),g=s(160849),f=(e=>(e.EMPTY_STATE_INPUT="empty_state_input",e.CHAT_SIDEBAR_INPUT="chat_sidebar_input",e.ATTACHMENT_MODAL="attachment_modal",e))(f||{});let _=({origin:e})=>{let t=k({origin:e}),s=(0,a.wA)(),i=(0,m.tS)();return n.useCallback(async n=>{if(!(0,o.kc)().allow_node_links_in_make)return;let a=n.clipboardData.getData("Text");if(!a)return;let{error:x,fileKey:m,nodeId:h}=(0,p.xI)(a);if(x){x===p.QO.NO_NODE_ID&&(d.az.trackDefinedEvent("figmake.design_url_pasted_without_node_id_error",{fileKey:i??"",sourceFileKey:m,origin:e}),s(u.F.enqueue({type:"figmake_attachment_failed_to_load",message:(0,l.t)("figmake.attachments.url_doesnt_include_node_id_toast"),timeoutOverride:5e3})));return}if(c.zl.get(g.qG)){(0,g.hH)(r.FDn.MAXIMUM_ATTACHMENTS_EXCEEDED);return}m&&h&&(n.preventDefault(),await t({fileKey:m,nodeId:h}))},[t,s,i,e])},y=()=>{let e=k({origin:"attachment_modal"}),t=(0,m.tS)();return n.useCallback(async s=>{if(!(0,o.kc)().allow_node_links_in_make)return;let{error:n,fileKey:a,nodeId:i}=(0,p.xI)(s);if(n)throw n===p.QO.NO_NODE_ID&&d.az.trackDefinedEvent("figmake.design_url_pasted_without_node_id_error",{fileKey:t??"",sourceFileKey:a,origin:"attachment_modal"}),Error(n);a&&i&&await e({fileKey:a,nodeId:i})},[e,t])};function k({origin:e}){let t=(0,a.wA)(),s=(0,m.q5)();return n.useCallback(async({fileKey:n,nodeId:a})=>{try{t(u.F.enqueue({message:(0,l.t)("figmake.send_to_make_from_design.visual_bell.copying_frames"),type:"send-to-make-from-design-load",icon:x.zX.SPINNER,preventDismissal:!0,timeoutOverride:3e5})),await v(n,a),d.az.trackDefinedEvent("figmake.node_pasted_from_url",{fileKey:s?.key??"",pastedNodeGuid:a,sourceFileKey:n,origin:e}),d.az.trackDefinedEvent("figmake.attach_design_attachment_added",{fileKey:s?.key,type:"url"}),t(u.F.dequeue({matchType:"send-to-make-from-design-load"})),t(u.F.enqueue({message:(0,l.t)("figmake.send_to_make_from_design.visual_bell.complete"),type:"send-to-make-from-design-complete",icon:x.zX.CHECK,timeoutOverride:3e3}))}catch(e){t(u.F.dequeue({matchType:"send-to-make-from-design-load"})),t(u.F.enqueue({type:"figmake_attachment_failed_to_load",message:(0,l.t)("figmake.attachments.cant_access_url_toast"),timeoutOverride:5e3}))}},[t,s,e])}async function v(e,t){let s=await (0,h.R)({fileKey:e,selectedGuids:[t]});i.glU?.applyNodesFromBuffer(s,e,[t],!0)}},568659:(e,t,s)=>{s.d(t,{W:()=>ee});var n=s(239976),a=s(105652),i=s(20002),r=s(25378),l=s(836848),o=s(424364),c=s(942356),d=s(931547),u=s(517478),x=s(205073),m=s(245495),p=s(524924),h=s(179189),g=s(310955),f=s(379141),_=s(677394),y=s(445019),k=s(323264),v=s(522568),b=s(309742),j=s(901962),C=s(933870),w=s(863412),E=s(585066),N=s(536378),S=s(223487),T=s(890030),I=s(747079),A=s(267447),M=s(632012),z=s(325984),L=s(783782),O=s(507815),P=s(658028),R=s(830346),D=s(754158),F=s(212891),q=s(527588),G=s(717135),U=s(718343),K=s(77143),H=s(823865),B=s(696002),V=s(973452),$=s(917681);let W={textSecondary:{kMwMTN:"x1n0bwc9",$$css:!0}};function Y({closeModal:e,entrypoint:t}){let s=a.useRef(null);a.useEffect(()=>{s.current&&s.current.focus()},[]);let[i,r]=a.useState("");return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"xnm25rq x1ug7bdz x1y1aw1k xwib8y2 x7wzq59 x13vifvy x1yjdb4r x1vjfegm",children:(0,n.jsx)(x.D,{ref:s,value:i,onChange:e=>{r(e)},"aria-label":(0,f.t)("general.search"),placeholder:(0,f.t)("sites.modal.search_all_make_kits")})}),(0,n.jsx)(C.P,{className:"xjkvuk6 xh8yej3 x78zum5 xdt5ytf x167g77z",children:(0,n.jsx)(M.Tp,{entrypoint:A.r6.FIGMAKE,initialTab:void 0,initialUpdatesModalScope:T.aD.CURRENT,children:(0,n.jsx)(j.dP,{children:(0,n.jsx)(X,{closeModal:e,searchQuery:i,entrypoint:t})})})})]})}function X({closeModal:e,searchQuery:t,entrypoint:s}){let i=(0,D.tI)(),l=(0,r.N)(),c=(0,P.S)(l),d=(0,_.wm)(q.OP,[c]),u=a.useCallback(e=>d.includes(e.id)?"selected_and_not_removable":i.includes(e.id)?"selected_and_removable":"unselected",[d,i]),x=(0,y.Xr)(H.jx),{queryResult:m,queryStatus:p}=(0,F.x)({query:t}),h=(0,a.useRef)(null),g=a.useCallback(t=>{if(i.includes(t.id)&&"chat"===s)return()=>{(0,G.el)(t.library_name,"consuming"),x(H.Ic.CODE),e()}},[i,x,e,s]),f="loading"===p&&0===m.length;if("errors"===p)return(0,n.jsx)(Q,{closeModal:e});if(f)return(0,n.jsx)(n.Fragment,{children:(0,o.y1)(3).map(e=>(0,n.jsx)(O.Q,{},e))});if(m?.length===0)return(0,n.jsx)(Q,{closeModal:e});null===h.current&&(h.current=new Set(i));let k=h.current,v=m||[],b=v.filter(e=>k.has(e.id)),C=v.filter(e=>!k.has(e.id));return(0,n.jsx)(M.Tp,{entrypoint:A.r6.FIGMAKE,initialTab:void 0,initialUpdatesModalScope:T.aD.CURRENT,children:(0,n.jsxs)(j.dP,{children:[b.map((e,t)=>(0,n.jsx)(L.V,{header:(0,n.jsx)(w.G,{text:e.library_name,className:"x67bb7w"}),subheader:e.team_name,thumbnailUrl:e.thumbnail_url,coverThumbnail:!0,callToAction:(0,n.jsx)(J,{library:e,selectedState:u(e),entrypoint:s}),name:e.library_name,onClick:g(e),kbPath:[z.m3.TabBodySection.Body,t]},`SelectedMakeLibraryListItem-${e.library_key}`)),b.length>0&&C.length>0&&(0,n.jsx)("div",{className:"xjm9jq1 xh8yej3 xbpqucl x1xmf6yo x1e56ztr"}),C.map((e,t)=>{let a=t+b.length;return(0,n.jsx)(L.V,{header:(0,n.jsx)(w.G,{text:e.library_name,className:"x67bb7w"}),subheader:e.team_name,thumbnailUrl:e.thumbnail_url,coverThumbnail:!0,callToAction:(0,n.jsx)(J,{library:e,selectedState:u(e),entrypoint:s}),name:e.library_name,onClick:g(e),kbPath:[z.m3.TabBodySection.Body,a]},`MakeLibraryListItem-${e.library_key}`)})]})})}var Z=(e=>(e.UNSELECTED="unselected",e.SELECTED_AND_REMOVABLE="selected_and_removable",e.SELECTED_AND_NOT_REMOVABLE="selected_and_not_removable",e))(Z||{});function J({library:e,selectedState:t,entrypoint:s}){let a=(0,B.hk)(),{toggleLibrarySelection:i}=(0,D.cH)(),r=(0,y.md)(D.aX),o=r[e.id]?.status==="error";if(r[e.id]?.status==="loading")return(0,n.jsx)(c.$n,{variant:"secondary",disabled:!0,children:(0,n.jsx)(E.k,{size:"sm"})});if(o)return(0,n.jsx)(c.$n,{variant:"secondary",disabled:!0,children:(0,n.jsx)(m.R,{className:"xhbv7l3"})});switch(t){case"unselected":return(0,n.jsx)(c.$n,{variant:"primary",onClick:()=>{i(e),"chat"===s&&a&&(0,U.e)(e.id,e.library_name,a)},children:(0,f.t)("sites.modal.make_kits_add_button_text")});case"selected_and_removable":return(0,n.jsx)(c.$n,{variant:"secondary",onClick:()=>i(e),children:(0,f.t)("sites.modal.make_kits_remove_button_text")});case"selected_and_not_removable":if("empty_state"===s)return null;return(0,n.jsx)(p.a,{});default:(0,l.xb)(t)}}function Q({closeModal:e}){let t=(0,S.tS)(),s=(0,R.y2)(),i=(0,y.Xr)(V.j),r=a.useCallback(()=>{s(),i($.p.LIBRARIES),e()},[s,e,i]);return(0,b.h)(()=>{v.az.trackDefinedEvent("ds_import.library_selector_empty_state_seen",{file_key:t||""})}),(0,n.jsx)("div",{className:"x9f619 x167g77z xh8yej3 x5yr21d x78zum5 x6s0dn4 xl56j7k x4i7bpe x1sgudl8",children:(0,n.jsxs)("div",{className:"xhwf2h4 x167g77z x78zum5 xdt5ytf x6s0dn4 xl56j7k x2b8uid",children:[(0,n.jsx)(h.l,{}),(0,n.jsx)("div",{...k.Ay.props(g.g.textBodyMediumStrong),children:(0,f.t)("sites.modal.no_make_libraries_added")}),(0,n.jsx)("div",{...k.Ay.props(g.g.textBodyMedium,W.textSecondary),children:(0,f.t)("sites.modal.no_make_libraries_added_subtitle")}),(0,n.jsx)("div",{className:"x1xmf6yo",children:(0,n.jsx)(c.$n,{variant:"primary",onClick:r,children:(0,f.t)("sites.modal.select_library_cta")})})]})})}let ee=(0,I.Ju)(function(e){let{defaultPosition:t,entrypoint:s}=e,r=(0,i.wA)(),l=a.useCallback(()=>{r((0,N.AS)())},[r]);a.useEffect(()=>(K.Uy.on("submit",l),()=>{K.Uy.removeListener("submit",l)}),[l]);let o=(0,f.t)("sites.modal.make_kits_header"),x=(0,R.y2)(),m=(0,y.Xr)(V.j),p=a.useCallback(()=>{x(),m($.p.LIBRARIES),l()},[x,l,m]),h=(0,n.jsx)("div",{className:"x78zum5 x1l2rt3b xdd8jsf xl56j7k x6s0dn4 x883omv",children:(0,n.jsxs)("div",{className:"x78zum5 xlrdbfi x1qughib x6s0dn4 x2lah0s",children:[(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1cy8zhl",children:[(0,n.jsx)("div",{...k.Ay.props(g.g.textBodyMediumStrong),children:(0,f.t)("sites.modal.make_kits_footer_title")}),(0,n.jsx)("div",{...k.Ay.props(g.g.textBodyMedium,W.textSecondary),children:(0,f.t)("sites.modal.make_kits_footer_subtitle")})]}),(0,n.jsx)(c.$n,{variant:"secondary",onClick:p,children:(0,f.t)("sites.modal.make_kits_import_library_button_text")})]})});return(0,n.jsx)(d.bL,{defaultPosition:t,width:400,maxHeight:378,onClose:l,children:(0,n.jsxs)(u.vo,{children:[(0,n.jsx)(u.Y9,{children:(0,n.jsx)(u.hE,{children:o})}),(0,n.jsx)(u.nB,{padding:0,children:(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xou54vl xsbggsw xh8yej3 x9f619",children:(0,n.jsx)(Y,{closeModal:l,entrypoint:s})})}),(0,n.jsx)(u.wi,{children:h})]})})},"MakeLibrarySelectorOverlay",I.ZU.YES)},518798:(e,t,s)=>{s.d(t,{Ey:()=>m,Gt:()=>u,KS:()=>x,Qw:()=>g,dH:()=>h,nA:()=>p,xA:()=>d,y8:()=>o});var n=s(940901),a=s(405228),i=s(223487),r=s(231349),l=s(211464);function o(e){let t={...e};return delete t.serverId,delete t.serverLogoUrl,delete t.userId,delete t.serverName,t}let c=a.z.union([a.z.object({success:a.z.boolean(),message:a.z.string(),data:a.z.string()}),a.z.object({success:a.z.boolean(),message:a.z.string(),result:a.z.any()})]).transform(e=>{let t="data"in e?e.data:"result"in e?JSON.stringify(e.result):void 0;return{success:e.success,message:e.message,data:t}});function d({hasDismissedToolCall:e,isExecutingTool:t,isMostRecentMessage:s,isCurrentUserInitiator:n,toolResult:a}){return t?r.lh.LOADING:e?r.lh.CANCELLED:a?a.success?r.lh.SUCCESS:r.lh.FAILED:!s&&n?r.lh.CANCELLED:r.lh.IDLE}function u({status:e,result:t,completeToolName:s}){return e===r.lh.CANCELLED&&!t||t?.message===`User dismissed mcp tool call - ${s}`}function x(e,t){if(e)return e;if(t){let e=c.safeParse(t.result);if(e.success)return e.data}}function m(){let e=(0,i.q5)(),t=e?.planPublicInfo?.tier;return t===n.PlanTier.ENTERPRISE?(0,l.z)("bake_mcp_client_ent"):t===n.PlanTier.ORG?(0,l.z)("bake_mcp_client_org"):t===n.PlanTier.PRO||t===n.PlanTier.STUDENT?(0,l.z)("bake_mcp_client_pro"):(0,l.z)("bake_mcp_client_starter")}function p(){let e=(0,i.q5)(),t=e?.plan?.isMcpClientDisabled;return!!(t?.status==="loaded"&&t.data)}function h(){let e=(0,i.q5)(),t=e?.planPublicInfo?.tier,s=e?.plan?.isMcpClientDisabled,a=s?.status==="loaded"&&s.data;return t===n.PlanTier.ENTERPRISE?(0,l.z)("bake_mcp_client_ent")&&!a:t===n.PlanTier.ORG?(0,l.z)("bake_mcp_client_org")&&!a:t===n.PlanTier.PRO||t===n.PlanTier.STUDENT?(0,l.z)("bake_mcp_client_pro")&&!a:(0,l.z)("bake_mcp_client_starter")&&!a}function g(e,t,s,n,a){if(!n.some(t=>t.id===e))return{isValid:!1,reason:"server_not_connected",availableServerCount:s.length};if(s.some(t=>t.server.id===e)&&t&&a){let n=a.get(e);if(n&&!n.some(e=>e.name===t))return{isValid:!1,reason:"tool_not_found",availableServerCount:s.length}}return{isValid:!0}}},978589:(e,t,s)=>{s.d(t,{_:()=>a});var n=s(607696);function a(e,t){if(t===n.lV.AI_ASSISTANT){let t="id"in e?e.id:void 0;return"assistant"===e.type&&(t=e.messages[0]?.id),(0,n.wm)({id:t,timestamp:Number(e.sentAt64)})}return e.uniqueId??(0,n.wm)({id:"id"in e?e.id:void 0,timestamp:Number(e.sentAt64)})}},840720:(e,t,s)=>{s.d(t,{Pc:()=>C,J5:()=>w,R:()=>j});var n=s(239976),a=s(600643),i=s(105652),r=s(471348),l=s(378721),o=s(400394),c=s(404269),d=s(623494),u=s(692376),x=s(379141),m=s(445019);s(323264);var p=s(17147),h=s(487626),g=s(316527),f=s(243771),_=s(748765),y=s(604687);function k({assetType:e,assets:t,label:s,labelPlural:a,mediaByGuid:r}){let{onExportAll:u}=(0,f.p0)({assetType:e,assets:t,mediaByGuid:r}),x=Object.keys(t).length,m=Object.values(t),[g,_]=i.useState(!1),k=i.useRef(null),{visibleItems:b,showMoreButton:j}=(0,h.y)({items:m,pageSize:3,shouldResetOnSelectionChange:!0});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"x78zum5 xilkfi8 x6s0dn4 x1nfngrj x1ef8nbk xkh2ocl",children:[(0,n.jsxs)("div",{className:"x78zum5 x1iyjqo2 x2lah0s x1r8uery x6s0dn4 x1akne3o",children:[(0,n.jsx)(o._,{})," ",(0,n.jsx)("span",{className:"xilkfi8 xclx6tv x17akokd x1j61x8r x1qxcl5b xno9bf3 x1akne3o",children:(0,p.td)(x,s,a)})]}),(0,n.jsx)("div",{ref:k,children:(0,n.jsx)(l.K,{"aria-label":(0,f.IP)(e),htmlAttributes:{"data-tooltip":(0,f.IP)(e),"data-tooltip-type":"text"},onClick:()=>_(e=>!e),children:(0,n.jsx)(c.n,{})})}),(0,n.jsx)(l.K,{"aria-label":(0,f.aX)(e),htmlAttributes:{"data-tooltip":(0,f.aX)(e),"data-tooltip-type":"text"},onClick:u,children:(0,n.jsx)(d.W,{})})]}),b.map(e=>(0,n.jsx)(v,{asset:e,mediaByGuid:r},e.assetId)),j&&(0,n.jsx)("div",{className:"x1vi7shn xxyw1jk",children:j}),g&&(0,n.jsx)(f.SG,{assetType:e,rowRef:k,onClose:()=>_(!1),pickerPosition:k.current?(0,y.VZ)(k.current,248,!1):void 0})]})}function v({asset:e,mediaByGuid:t}){let s=t?.[e.assetId];return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x1qjc9v5 xkh2ocl x1nfngrj x19y5rnk xf7z5ut x4vwp2a",children:(0,n.jsx)(f.$1,{assetInfo:e,media:s,addPadding:!1},e.assetId)})}function b({nodeId:e,assetTypes:t}){let[s,a]=(0,m.fp)(g.g);(0,i.useEffect)(()=>{u.w3z?.requestAssetScanForAiChat(e)},[e]);let[l,o]=(0,i.useState)(void 0);(0,i.useEffect)(()=>{s.has(e)&&(o(u.w3z?.getAssetsForAiChat(e)),a(t=>new Set([...t].filter(t=>t!==e))))},[e,s,a]);let c=(0,f.tR)();if(!l)return null;let d={},p=!1;if((t=t||r.IG).forEach(e=>{switch(e){case"ASSET_ICON":l.icons&&Object.keys(l.icons).length>0&&(d[_.PW.ASSET_ICON]=l.icons,p=!0);break;case"ASSET_ILLUSTRATION":l.illustrations&&Object.keys(l.illustrations).length>0&&(d[_.PW.ASSET_ILLUSTRATION]=l.illustrations,p=!0);break;case"ASSET_IMAGE":l.images&&Object.keys(l.images).length>0&&(d[_.PW.ASSET_IMAGE]=l.images,p=!0);break;case"ASSET_GIF":l.gifs&&Object.keys(l.gifs).length>0&&(d[_.PW.ASSET_GIF]=l.gifs,p=!0)}},[]),!p)return null;let h=d[_.PW.ASSET_ICON],y=d[_.PW.ASSET_GIF],v=d[_.PW.ASSET_IMAGE],b=d[_.PW.ASSET_ILLUSTRATION];return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1qjc9v5 xt0e3qv x16v0e3u xmkeg23 x1y0btm7 x7z60cl x1mxnbhz xyzh45r",children:[h&&(0,n.jsx)(k,{assetType:_.PW.ASSET_ICON,assets:h,mediaByGuid:c,label:(0,x.t)("dev_handoff.assets.icon"),labelPlural:(0,x.t)("dev_handoff.assets.icons")}),y&&(0,n.jsx)(k,{assetType:_.PW.ASSET_GIF,assets:y,mediaByGuid:c,label:(0,x.t)("dev_handoff.assets.gif"),labelPlural:(0,x.t)("dev_handoff.assets.gifs")}),v&&(0,n.jsx)(k,{assetType:_.PW.ASSET_IMAGE,assets:v,mediaByGuid:c,label:(0,x.t)("dev_handoff.assets.image"),labelPlural:(0,x.t)("dev_handoff.assets.images")}),b&&(0,n.jsx)(k,{assetType:_.PW.ASSET_ILLUSTRATION,assets:b,mediaByGuid:c,label:(0,x.t)("dev_handoff.assets.illustration"),labelPlural:(0,x.t)("dev_handoff.assets.illustrations")})]})}class j extends a.Kp{static getType(){return"figma-asset-dialog"}static clone(e){return new j(e.__nodeId,e.__assetTypes,e.__key)}constructor(e,t,s){super(s),this.__nodeId=e,this.__assetTypes=t}getNodeId(){return this.__nodeId}getAssetTypes(){return this.__assetTypes}createDOM(e){let t=document.createElement("div"),s=e?.theme?.figmaAssetDialog||e?.theme?.figmaAssetDialog;return s&&(t.className=s),t}decorate(){let e=this.__assetTypes.split(",");return(0,n.jsx)(b,{nodeId:this.__nodeId,assetTypes:e})}updateDOM(){return!1}static importJSON(e){let{nodeId:t,assetTypes:s}=e;return C({nodeId:t,assetTypes:s})}exportJSON(){return{type:"figma-asset-dialog",nodeId:this.__nodeId,assetTypes:this.__assetTypes,version:1,children:[],direction:null,format:"",indent:0}}}function C({nodeId:e,assetTypes:t}){let s=new j(e,t);return(0,a.pT)(s)}function w(e){return e instanceof j}},579762:(e,t,s)=>{s.d(t,{Y:()=>a,f:()=>i});var n=s(840720);function a({nodeId:e,assetTypes:t}){return`<figma-asset-dialog node-id="${e}" asset-types="${t.join(",")}" />`}let i={dependencies:[n.R],export:(e,t)=>{if(!(0,n.J5)(e))return null;let s=e.getNodeId(),a=e.getAssetTypes();return`<figma-asset-dialog node-id="${s}" asset-types="${a}" />`},importRegExp:/<figma-asset-dialog node-id="([^"]+)" asset-types="([^"]+)" ?\/>/,regExp:/<figma-asset-dialog node-id="([^"]+)" asset-types="([^"]+)" ?\/>$/,replace:(e,t)=>{let[,s,a]=t;if(!s||!a)return;let i=(0,n.Pc)({nodeId:s,assetTypes:a});e.replace(i)},trigger:">",type:"text-match"}},60123:(e,t,s)=>{s.d(t,{a_:()=>A,M_:()=>I,ct:()=>S,Re:()=>T,pr:()=>N,V:()=>E});var n=s(239976),a=s(988083),i=s(379141),r=s(445019),l=s(323264),o=s(259714),c=s(223487),d=s(597298),u=s(256536),x=s(105652),m=s(943360),p=s(524924),h=s(718801),g=s(270450),f=s(253386),_=s(934985),y=s(172397);let k={container:{k1xSpc:"x78zum5",kVAM5u:"x7z60cl",kaIpWk:"x9h44rk",kMzoRj:"xmkeg23",ksu8eU:"x1y0btm7",k8WAf4:"x1vvogim",kg3NbH:"xaope02",kLWn49:"x1o2sk6j",kXwgrk:"xdt5ytf",kMwMTN:"x1n0bwc9",$$css:!0}};function v({changes:e,startExpanded:t=!1,maxHeight:s,chatMessagesNodeGuid:a,featureType:r,allowIndividualFileRestore:o=!1}){let[c,d]=(0,x.useState)(t),{defaultTypographyStyle:u}=(0,f.L)(r),{restoreFile:h}=(0,_.q)({chatMessagesNodeGuid:a,featureType:r}),g=o?h:void 0;if(0===e.length)return null;if(1===e.length){let t=e[0];return t?(0,n.jsx)("div",{...l.Ay.props(k.container,u),style:s?{maxHeight:s,overflowY:"auto"}:void 0,children:(0,n.jsx)(b,{change:t,getRestoreCallback:g})}):null}return(0,n.jsxs)("div",{...l.Ay.props(k.container,u),style:s?{maxHeight:s,overflowY:"auto"}:void 0,children:[(0,n.jsxs)(m.E,{className:"x78zum5 x6s0dn4 x167g77z x1ypdohk x87ps6o x1qughib x1n0bwc9",onClick:()=>d(!c),children:[(0,n.jsx)("span",{children:(0,i.t)("figmake.edits.edited_files",{fileCount:e.length})}),(0,n.jsx)("span",{...{0:{className:"xtc4nxu x1bmturs"},1:{className:"xtc4nxu x1bmturs x1iffjtl"}}[!!c<<0],children:(0,n.jsx)(p.a,{})})]}),c&&(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x167g77z x1vvogim xnjsko4",children:e.map((e,t)=>(0,n.jsx)(b,{change:e,getRestoreCallback:g},`${e.path}-${t}`))})]})}function b({change:e,getRestoreCallback:t}){let s=!!(0,g.kc)().make_jump_to_file_via_changes,a=(0,y.j)(),r=x.useCallback(()=>{a(e.path)},[a,e.path]),l=e=>e.split("/").pop()??e,o=t?.(e.path);return(0,n.jsxs)("div",{className:"x78zum5 x6s0dn4 x167g77z x1qughib xjwf9q1",children:[s?(0,n.jsx)(m.E,{className:"x11g6tue xfn42iu xng3xce x1r7ld26 x1717udv xdpxx8g x1ypdohk x98rzlu xb3r6kr xlyipyv xuxw1ft x1n0bwc9 x1c5oinq xt0b8zv",onClick:r,children:l(e.path)}):(0,n.jsx)("span",{className:"x11g6tue xfn42iu xng3xce x1r7ld26 x1717udv xdpxx8g x1ypdohk x98rzlu xb3r6kr xlyipyv xuxw1ft x1n0bwc9 x1c5oinq xt0b8zv",children:l(e.path)}),(0,n.jsxs)("span",{className:"x1jnr06f x78zum5 x6s0dn4",children:[e.addedLines>0&&(0,n.jsx)("span",{className:"xq6u9c4",children:(0,i.t)("figmake.edits.lines_added",{count:e.addedLines})}),e.removedLines>0&&(0,n.jsx)("span",{className:"x172n1ly",children:(0,i.t)("figmake.edits.lines_removed",{count:e.removedLines})}),o&&(0,n.jsx)(m.E,{className:"xfawy5m x12oqio5 xet2fuk x1ypdohk xjbqb8w x12tve8b x1n0bwc9 x1c5oinq xfn42iu xng3xce x1r7ld26 x78zum5 x6s0dn4 xl56j7k xvy4d1p xxk0z11",onClick:o,children:(0,n.jsx)(h.H,{className:"x1wt4b31 x1kky2od xlup9mm"})})]})]})}var j=s(683900),C=s(594242),w=s(751526);function E({message:e,chatMessagesNodeGuid:t,codeVersionNumber:s,featureType:a,trackingContext:r,title:o,layerDisplayName:c,isCurrentVersion:d,chatController:x}){let{defaultTypographyStyle:m}=(0,f.L)(a),{codeSnapshotKey:p,blobstoreContentKey:h}=(0,C.Lt)(e)??{},{codeRestoreVersion:g}=(0,j.nm)({codeSnapshotKey:p,codeSnapshotBlobstoreContentKey:h,chatMessagesNodeGuid:t,featureType:a,restoreToVersionTitle:o,chatController:x,...r}),_=(0,n.jsx)(u.F,{type:"code_version",isCurrentVersion:d,codeVersionNumber:s,restoreVersion:g,chatMessagesNodeGuid:t,layerDisplayName:c,versionTitle:o,featureType:a});return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xou54vl",children:[(0,n.jsx)("div",{...l.Ay.props(m),children:(0,i.t)("figmake.chat.restoring_a_previous_version")}),_]})}function N({message:e,chatMessagesNodeGuid:t,codeVersionNumber:s,featureType:a,trackingContext:r,title:o,layerDisplayName:c,isCurrentVersion:d,chatController:x}){let{defaultTypographyStyle:m}=(0,f.L)(a),p=o&&(0,i.t)("figmake.chat.edited_version",{versionTitle:o}),{codeSnapshotKey:h,blobstoreContentKey:g}=(0,C.Lt)(e)??{},{codeRestoreVersion:_}=(0,j.nm)({chatController:x,codeSnapshotKey:h,codeSnapshotBlobstoreContentKey:g,chatMessagesNodeGuid:t,featureType:a,restoreToVersionTitle:p,...r}),y=(0,n.jsx)(u.F,{type:"code_version",isCurrentVersion:d,codeVersionNumber:s,restoreVersion:_,chatMessagesNodeGuid:t,layerDisplayName:c,versionTitle:p,featureType:a});return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xou54vl",children:[(0,n.jsx)("div",{...l.Ay.props(m),children:(0,i.t)("figmake.edits.manual_edit_message")}),(0,n.jsx)(v,{changes:e.changedFiles,startExpanded:!0,chatMessagesNodeGuid:t,featureType:a}),y]})}let S="in-progress-manual-edit";function T({chatMessagesNodeGuid:e,chatController:t,featureType:s,codeFileChanges:o,layerDisplayName:d,codeVersionNumber:x}){let{defaultTypographyStyle:m}=(0,f.L)(s),{changedFiles:p,error:h,hasBaseline:g}=o,_=t?.getMessages(),y=(0,r.md)(c.yV);if(h||!g||0===p.length)return null;let k=(_?(0,a.eB)(_):void 0)||y?.name,b=k&&(0,i.t)("figmake.chat.edited_version",{versionTitle:k}),j=async()=>{},C=(0,n.jsx)(u.F,{type:"code_version",isCurrentVersion:!0,codeVersionNumber:x,restoreVersion:j,chatMessagesNodeGuid:e,layerDisplayName:d,versionTitle:b,featureType:s});return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xou54vl","data-testid":"system-chat-message-in-progress-manual-edit",children:[(0,n.jsx)("div",{...l.Ay.props(m),children:(0,i.t)("figmake.edits.manual_edit_message")}),(0,n.jsx)(v,{changes:p,startExpanded:!0,chatMessagesNodeGuid:e,featureType:s,allowIndividualFileRestore:!0}),C]})}function I(){return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xou54vl","data-testid":"system-chat-message-duplicated-file",children:[(0,n.jsx)("p",{className:"xuzfeq1 x8yk33q x1e00guj x18zpg43 x22v61l",children:(0,i.t)("figmake.duplicated_file_system_message")}),(0,n.jsx)(M,{})]})}function A({message:e}){let{user:t}=(0,d.wW)(e.userId??null),s=t?.handle;if(!e.timestamp)return null;let a=new Date(e.timestamp),r=(0,i.t)("figmake.chat_management.messages.chat_history_cleared_timestamp",{time:a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),date:a.toLocaleDateString([],{month:"long",day:"numeric",year:"numeric"})});return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xou54vl","data-testid":"system-chat-message-deleted-chat-history",children:(0,n.jsx)("div",{className:"x1n0bwc9 x1k4tb9n",children:(0,i.t)("figmake.chat_management.messages.chat_history_cleared",{timestamp:r})+(s?(0,i.t)("figmake.chat_management.messages.chat_history_cleared_user",{username:s}):"")})})}function M(){return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x1cy8zhl x1jnr06f x9h44rk xmkeg23 x1y0btm7 x7z60cl x1y1aw1k xyfqnmn xwib8y2 x163pfp",children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,n.jsx)("div",{className:"xvy4d1p xxk0z11 x78zum5 xl56j7k x6s0dn4",children:(0,n.jsx)(o.B,{svg:w.A,useOriginalSrcFills_DEPRECATED:!0,svgWidth:"14px",svgHeight:"14px"})}),(0,n.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly","data-testid":"system-chat-message-supabase-disconnected-cta",children:(0,i.t)("figmake.supabase.duplicated_file.cta")})]})})}},231349:(e,t,s)=>{s.d(t,{VD:()=>a,lh:()=>i,t4:()=>n});var n=(e=>(e.PENDING="pending",e.SUCCESS="success",e.FAILURE="failure",e))(n||{}),a=(e=>(e.TOOL_CALL_SUCCESS="tool_call_success",e.TOOL_CALL_CANCELLED="tool_call_cancelled",e.TOOL_CALL_DISABLED="tool_call_disabled",e.TOOL_CALL_PENDING="tool_call_pending",e))(a||{}),i=(e=>(e.IDLE="idle",e.LOADING="loading",e.SUCCESS="success",e.FAILED="failed",e.CANCELLED="cancelled",e))(i||{})},961998:(e,t,s)=>{s.d(t,{Dv:()=>o,QO:()=>c,xI:()=>d});var n=s(2227),a=s(904690),i=s(17147),r=s(453214),l=s(819475);function o(e){let t=e.match(/(http|ftp|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:\/~+#-]*[\w@?^=%&\/~+#-])/g);return!!(t&&[...t].findIndex(e=>(function(e){if((0,i.gU)(e)){let t=new URL(e);if((0,r.F4)(t.hostname))return!0}return!1})(e))>-1)}var c=(e=>(e.NON_FIGMA_URL="non-figma-url",e.NO_NODE_ID="no-node-id",e))(c||{});function d(e){if(!e||!o(e))return{error:"non-figma-url"};let t=e.trim();try{let e=new URL(t).pathname;if(!e.startsWith("/design/"))return{error:"non-figma-url"};let s=(0,a.zv)(e),i=(0,l.zU)(t),r=i&&n.fn(n.sH(i)),o=i===n.Xy||"0:1"===i;if(!s||!r||o)return{error:"no-node-id"};return{fileKey:s,nodeId:i}}catch(e){return{error:"non-figma-url"}}}},601493:(e,t,s)=>{s.d(t,{C:()=>r});var n=s(854225),a=s(415315),i=s(160849);function r(e,t){if(0===e.length)return{valid:!1,imageFiles:null};let s=Array.from(e),r=s.filter(e=>e&&a.xp.some(t=>e.type.startsWith(t.replace("*",""))));return r.length<s.length&&((0,i.hH)(n.FDn.UNSUPPORTED_FILE_TYPE),0===r.length)?{valid:!1,imageFiles:null}:t.filter(e=>"error"!==e.status).length+r.length>i.qQ?((0,i.hH)(n.FDn.MAXIMUM_ATTACHMENTS_EXCEEDED),{valid:!1,imageFiles:null}):{valid:!0,imageFiles:r}}},636379:(e,t,s)=>{s.d(t,{Ey:()=>g,G$:()=>f,WL:()=>u,c$:()=>x,hi:()=>p,wu:()=>h});var n=s(105652),a=s(25378),i=s(607696),r=s(445019),l=s(597562),o=s(276473),c=s(441014),d=s(978589);function u(e){return e.some(e=>"toolCall"===e.type&&(0,i.TD)(e.name))}function x(e){let t=0,s=-1,n=[];return{codeVersionNumbers:e.map((e,a)=>{if("system"===e.type){if("restore"===e.systemMessageType||"manual_edit"===e.systemMessageType)return s=a,t++,n.push({versionNumber:t,messageIndex:a,title:e.title,message:e,sentAt64:e.sentAt64}),t}else if("assistant"===e.type){let i=e.messages.some(e=>"summary"===e.type),r=u(e.messages);return(i||r)&&(s=a,t++,n.push({versionNumber:t,messageIndex:a,title:e.title,message:e,sentAt64:e.sentAt64})),t}return 0}),currentVersionMessageIndex:s,versions:n}}function m(e,t){let{codeVersionNumbers:s,currentVersionMessageIndex:n,versions:a}=x(e),i=new Map;e.forEach((e,n)=>{let a=(0,d._)(e,t);i.set(a,s[n]??0)});let r=n>=0&&n<e.length?(0,d._)(e[n],t):null;return{versionNumbersByUniqueId:i,currentVersionMessageIndex:n,currentVersionUniqueId:r,versions:a}}function p(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()?"Today":e.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}function h(e){let t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${s}-${n}`}function g(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()?e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):e.toLocaleTimeString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function f(e,t,s){let i=(0,r.Xr)(l.J),d=function(e,t,s){let i=!!s?.pagination;return(0,n.useMemo)(()=>{if(i)return null;let{versionNumbersByUniqueId:s,currentVersionMessageIndex:n,currentVersionUniqueId:r}=m(e,t),l=r?{messageIndex:n,fileSequenceNumber:s.get(r)??0,chatMessageId:r,versionName:null,sourceCodeHash:(0,a.N)().getSourceCodeHash()}:null;return{versionNumbersByUniqueId:s,currentVersionUniqueId:r,currentVersionInfo:l}},[i,e,t])}(e,t,s),u=function(e,t,s){let i=!!t?.pagination,r=t?.getNodeChatMessages()??[],l=(0,c.B)(t?.chatMessagesNode??null),{messages:d}=(0,o.d)({chatMessages:r,exchangeMessages:l,chatMessagesOptions:{ignorePaginationFiltering:!0},exchangeMessagesOptions:{ignorePaginationFiltering:!0},chatController:t});return s&&s.isOptimisticMessage&&"system"===s.type&&(d=[...d,s]),(0,n.useMemo)(()=>{if(!i)return null;let{versionNumbersByUniqueId:t,currentVersionMessageIndex:s,currentVersionUniqueId:n}=m(d,e),r=n?{messageIndex:s,fileSequenceNumber:t.get(n)??0,chatMessageId:n,versionName:null,sourceCodeHash:(0,a.N)().getSourceCodeHash()}:null;return{versionNumbersByUniqueId:t,currentVersionUniqueId:n,currentVersionInfo:r}},[i,d,e])}(t,s,e.length>0?e[e.length-1]:void 0),x=d??u;return(0,n.useEffect)(()=>{x.currentVersionInfo&&i(x.currentVersionInfo)},[x.currentVersionInfo,i]),{versionNumbersByUniqueId:x.versionNumbersByUniqueId,currentVersionUniqueId:x.currentVersionUniqueId}}},480659:(e,t,s)=>{s.d(t,{p:()=>o});var n=s(239976),a=s(731112);s(323264);let i=e=>`var(${e})`,r={bg:"--animation-bg",fill:"--animation-fill",stroke:"--animation-stroke",strokeLight:"--animation-stroke-light"},l={light:{[r.strokeLight]:i("--ramp-violet-200"),[r.stroke]:i("--ramp-violet-300"),[r.fill]:i("--ramp-violet-100"),[r.bg]:i("--color-bg")},dark:{[r.strokeLight]:i("--color-border"),[r.stroke]:i("--color-border"),[r.fill]:i("--color-bg-secondary"),[r.bg]:i("--color-bg")}};function o(){let e=(0,a.G)(),t=(0,n.jsxs)("svg",{width:"417",height:"321",viewBox:"0 0 417 321",fill:"none",children:[(0,n.jsxs)("g",{clipPath:"url(#clip0_8424_179506)",children:[(0,n.jsx)("line",{x1:"0.5",y1:"2.0461e-08",x2:"0.499987",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"32.5",y1:"1",x2:"32.5",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"64.5",y1:"1",x2:"64.5",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"96.5",y1:"1",x2:"96.5",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"128.5",y1:"1",x2:"128.5",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"160.5",y1:"1",x2:"160.5",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"192.5",y1:"1",x2:"192.5",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"224.5",y1:"1",x2:"224.5",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"256.5",y1:"1",x2:"256.5",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"288.5",y1:"1",x2:"288.5",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"320.5",y1:"1",x2:"320.5",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"352.5",y1:"1",x2:"352.5",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"384.5",y1:"1",x2:"384.5",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"416.5",y1:"1",x2:"416.5",y2:"321",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"416",y1:"0.5",x2:"-9.081e-08",y2:"0.499983",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"416",y1:"32.5",x2:"-9.081e-08",y2:"32.5",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"416",y1:"64.5",x2:"-9.081e-08",y2:"64.5",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"416",y1:"96.5",x2:"-9.081e-08",y2:"96.5",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"416",y1:"128.5",x2:"-9.081e-08",y2:"128.5",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"416",y1:"160.5",x2:"-9.081e-08",y2:"160.5",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"416",y1:"192.5",x2:"-9.081e-08",y2:"192.5",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"416",y1:"224.5",x2:"-9.081e-08",y2:"224.5",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"416",y1:"256.5",x2:"-9.081e-08",y2:"256.5",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"416",y1:"288.5",x2:"-9.081e-08",y2:"288.5",stroke:i(r.strokeLight)}),(0,n.jsx)("line",{x1:"416",y1:"320.5",x2:"-9.081e-08",y2:"320.5",stroke:i(r.strokeLight)}),(0,n.jsx)("rect",{width:"573",height:"441",transform:"translate(-79 -61)",fill:"url(#paint0_radial_8424_179506)"}),(0,n.jsx)("rect",{x:"138.1",y:"98.4353",width:"133",height:"91",rx:"13.5",transform:"rotate(8 138.1 98.4353)",fill:i(r.bg),stroke:i(r.stroke),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"141.5",y:"114.5",width:"133",height:"91",rx:"13.5",fill:i(r.bg),stroke:i(r.stroke)}),(0,n.jsx)("rect",{x:"150",y:"123",width:"74",height:"74",rx:"5",fill:i(r.fill)}),(0,n.jsx)("rect",{x:"232",y:"123",width:"34",height:"74",rx:"5",fill:i(r.fill)})]}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("radialGradient",{id:"paint0_radial_8424_179506",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(286.5 220.5) rotate(90) scale(220.5 286.5)",children:[(0,n.jsx)("stop",{stopColor:i(r.bg),stopOpacity:"0"}),(0,n.jsx)("stop",{offset:"0.117896",stopColor:i(r.bg),stopOpacity:"0.0737185"}),(0,n.jsx)("stop",{offset:"0.213837",stopColor:i(r.bg),stopOpacity:"0.153748"}),(0,n.jsx)("stop",{offset:"0.2912",stopColor:i(r.bg),stopOpacity:"0.2384"}),(0,n.jsx)("stop",{offset:"0.353363",stopColor:i(r.bg),stopOpacity:"0.325985"}),(0,n.jsx)("stop",{offset:"0.403704",stopColor:i(r.bg),stopOpacity:"0.414815"}),(0,n.jsx)("stop",{offset:"0.4456",stopColor:i(r.bg),stopOpacity:"0.5032"}),(0,n.jsx)("stop",{offset:"0.48243",stopColor:i(r.bg),stopOpacity:"0.589452"}),(0,n.jsx)("stop",{offset:"0.51757",stopColor:i(r.bg),stopOpacity:"0.671881"}),(0,n.jsx)("stop",{offset:"0.5544",stopColor:i(r.bg),stopOpacity:"0.7488"}),(0,n.jsx)("stop",{offset:"0.596296",stopColor:i(r.bg),stopOpacity:"0.818519"}),(0,n.jsx)("stop",{offset:"0.646637",stopColor:i(r.bg),stopOpacity:"0.879348"}),(0,n.jsx)("stop",{offset:"0.7088",stopColor:i(r.bg),stopOpacity:"0.9296"}),(0,n.jsx)("stop",{offset:"0.786163",stopColor:i(r.bg),stopOpacity:"0.967585"}),(0,n.jsx)("stop",{offset:"0.882104",stopColor:i(r.bg),stopOpacity:"0.991615"}),(0,n.jsx)("stop",{offset:"1",stopColor:i(r.bg)})]}),(0,n.jsx)("clipPath",{id:"clip0_8424_179506",children:(0,n.jsx)("rect",{width:"417",height:"321",fill:i(r.bg)})})]})]});return(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x6s0dn4 x1n2onr6",style:l[e.color],children:t})}},997729:(e,t,s)=>{s.d(t,{R1:()=>B,dB:()=>Z,e0:()=>J,iE:()=>Y,mt:()=>V,n:()=>X,q3:()=>$,x6:()=>H});var n=s(239976),a=s(105652),i=s(20002),r=s(363638),l=s(942356),o=s(378721),c=s(39899),d=s(27412),u=s(816748),x=s(169909),m=s(899457),p=s(692376),h=s(379141),g=s(270450),f=s(445019);s(323264);var _=s(522568),y=s(864693),k=s(141288),v=s(431757),b=s(910970),j=s(474917),C=s(328452),w=s(477948),E=s(772293),N=s(515283),S=s(223487),T=s(236410),I=s(402791),A=s(222060),M=s(136572),z=s(145652),L=s(637578),O=s(682499),P=s(696002),R=s(329983),D=s(629648),F=s(909051),q=s(991007);function G(e,t,s=b.qB.SIGN_IN){let n=(0,I.Y9)();return a.useCallback(()=>{(0,C.UK)(e),n({origin:t,formState:s})},[n,e,t,s])}function U(){let e=G("SIGN_UP_BUTTON_BANNER",y.ty.FIGMA_REV_LOGGED_OUT_HEADER,b.qB.SIGN_UP);return(0,n.jsx)(l.WW,{htmlAttributes:{"data-test-id":"email-btn"},onClick:e,children:(0,h.tx)("footer_banner.sign_up_with_email")})}function K(){let e=(0,i.wA)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(N.H,{large:!0,brandTextColor:!0,onClick:()=>{(0,C.UK)("GOOGLE_SSO_BUTTON"),(0,y.Rm)({dispatch:e,origin:y.ty.FIGMA_REV_LOGGED_OUT_HEADER_WITH_GOOGLE,redirectUrl:k.Ay.location.pathname}).then(t=>{"login"===t.type&&e(v.My({userId:t.user.id}))},t=>{(0,j.g)("google_signup_error",y.ty.FIGMA_REV_LOGGED_OUT_HEADER_WITH_GOOGLE,{error:t.message}),(0,g.kc)().ff_show_auth_modal_on_google_sso_error&&(0,y.Y2)({dispatch:e,origin:y.ty.FIGMA_REV_LOGGED_OUT_HEADER_WITH_GOOGLE,message:t.message,redirectUrl:k.Ay.location.pathname,errorType:t.errorType})})},children:(0,h.t)("footer_banner.continue_with_google")}),(0,n.jsx)(A.P,{origin:y.DT.LOGGED_OUT_FILE,overrideUseFedCMPrompt:!1})]})}function H(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(U,{}),(0,n.jsx)("div",{className:"xmkeg23 x1y0btm7 x7z60cl x7xtdkp",children:(0,n.jsx)(K,{})})]})}function B(){let e=G("SHARE_BUTTON",y.ty.FIGMA_REV_LOGGED_OUT_HEADER);return(0,n.jsx)(l.WW,{variant:"primary",onClick:e,children:(0,h.t)("fullscreen.toolbar.multiplayer.share")})}function V(){let{canDuplicate:e}=(0,M.tz)(),t=(0,R.aI)();return e&&t}function $({blockWithAuthModal:e}){let{duplicateFile:t}=(0,M.tz)(),s=V(),a=G(p.rcl.PAGE_DUPLICATE,y.ty.FIGMA_REV_LOGGED_OUT_HEADER);return s?(0,n.jsx)(l.WW,{variant:"secondary",onClick:e?a:t,htmlAttributes:{"data-onboarding-key":q.S$},children:(0,h.t)("figmake.make_a_copy")}):(0,n.jsx)(n.Fragment,{})}let W=(0,z.ex)("figmake_open_fullscreen_preview_new_tab",function(){return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xl56j7k x6s0dn4",children:[(0,n.jsx)("div",{children:(0,h.t)("figmake.open_new_tab_preview")}),(0,n.jsx)("div",{className:"xkrz9af xt970qd x5k8d2m",children:(0,h.t)("figmake.open_new_tab_preview_footer")})]})});function Y({openInSameTab:e=!1,disabled:t=!1,asLargeVariant:s=!1}){let{openFigmakeFullscreenInNewTab:i,openFigmakeFullscreenInSameTab:r}=(0,P.Ve)(),l=(0,S.tS)(),c=(0,f.md)(O.mo),u=a.useCallback(()=>{_.az.trackDefinedEvent("ai_for_production.figmake_open_preview_in_new_tab_clicked",{fileKey:l??"",hasRoute:(0,L.Q)(c)}),i()},[i,l,c]),x=a.useCallback(()=>{_.az.trackDefinedEvent("ai_for_production.figmake_open_preview_in_same_tab_clicked",{fileKey:l??"",hasRoute:(0,L.Q)(c)}),r()},[r,l,c]),m=s?w.J:o.K,p=d.X;return(0,n.jsx)(m,{onClick:e?x:u,"aria-label":(0,h.t)("figmake.open_new_tab_preview"),"data-testid":"open-fullscreen-preview-button",disabled:t,htmlAttributes:{"data-tooltip":W,"data-tooltip-type":T.Ib.SPECIAL,"data-tooltip-offset-y":2,"data-onboarding-key":q.NR},children:(0,n.jsx)(p,{})})}function X(){let e=(0,P.Gu)()??!1,t=a.useCallback(()=>{E.Y5.triggerActionEnumInUserEditScope(p.rcl.COPY_MAKE_FOR_DESIGN)},[]);if(!r.v.getFeatureGate("bake_canvas"))return null;let s=(0,h.t)("figmake.copy-make-for-design");return(0,n.jsx)(w.J,{onClick:t,"aria-label":s,"data-testid":"copy-make-for-design-button",htmlAttributes:{"data-tooltip":s,"data-tooltip-type":T.Ib.TEXT,"data-tooltip-max-width":200},disabled:e,children:(0,n.jsx)(u.L,{})})}function Z(){let{canEnableComments:e,isCommentModeActive:t,disableComments:s,enableComments:i}=(0,D.jy)(),r=a.useCallback(()=>{t?s():i()},[s,i,t]);a.useEffect(()=>{t&&!e&&s()},[t,e,s]);let l=t?(0,h.t)("figmake.hide_comments"):(0,h.t)("figmake.show_comments");return(0,g.kc)().comments_in_make?(0,n.jsx)(c.f,{variant:"highlighted",checked:t,disabled:!e,onChange:r,onIcon:(0,n.jsx)(x.O,{}),offIcon:(0,n.jsx)(x.O,{}),"aria-label":l,"data-tooltip":l,size:"lg"}):null}function J({asLargeVariant:e}={}){let{handleRefresh:t}=(0,F.u)();if(!t)return null;let s=e?w.J:o.K;return(0,n.jsx)(s,{onClick:t,"aria-label":(0,h.t)("figmake.refresh"),htmlAttributes:{"data-tooltip":(0,h.t)("figmake.refresh"),"data-tooltip-type":T.Ib.TEXT},children:(0,n.jsx)(m.T,{})})}},909051:(e,t,s)=>{s.d(t,{h:()=>r,u:()=>l});var n=s(239976),a=s(105652);let i=(0,a.createContext)(null);function r({children:e,value:t}){return(0,n.jsx)(i.Provider,{value:t,children:e})}function l(){let e=(0,a.useContext)(i);if(!e)throw Error("useHeaderContext must be used within HeaderProvider");return e}},768853:(e,t,s)=>{s.d(t,{mP:()=>ee,fY:()=>Q,VW:()=>J});var n=s(105652),a=s(836848),i=s(295870),r=s(692376),l=s(270450),o=s(445019),c=s(74372),d=s(723850),u=s(289555),x=s(129416),m=s(337812),p=s(772293),h=s(223487),g=s(322519),f=s(870141),_=s(682499),y=s(200498),k=s(865449),v=s(823865),b=s(20002),j=s(379141),C=s(888903),w=s(287736);let E="html-to-design-processing",N="copied-to-clipboard",S="error",T="html-to-design-copy-manual";var I=s(348149),A=s(336976),M=s(854225),z=s(798913),L=s(466082),O=s(522568),P=s(3219),R=s(319971),D=s(419312),F=s(737473),q=s(766274);let G=new class{constructor(){this.HtmlToDesignValidator=(0,q.vh)()}convertHtmlToDesign(e){let{fileKey:t,html:s,width:n,height:a}=e;return this.HtmlToDesignValidator.validate(async({xr:e})=>await e.post(`/api/${t}/html-to-design`,{html:s,width:n,height:a}))}};var U=s(223976);function K(e){if(e&&null===e.offsetParent)throw Error("Cannot serialize HTML because the iframe is hidden")}var H=(e=>(e[e.API=0]="API",e[e.LOCAL=1]="LOCAL",e))(H||{});async function B(e,t){let s;let n=e.sitesPreview,i=new P.M4;i.start();let o=(0,c.g)(),d=(0,U.X0)({h2dSessionId:o,fileKey:e.fileKey,mode:1===e.mode?"local":"api",featureType:"html_to_clipboard",onPageHide:()=>{d.trackError(A.G3.END_ABORTED,Error("pagehide"))}});d.track(A.G3.START);let u=()=>{if(t?.aborted)throw t?.reason};try{if(1===e.mode){(0,l.kc)().make_keep_preview_onscreen&&K(n.iframe);let a=await n.sendMessage("getDOMNodes",{options:{assertLayoutValid:!(0,l.kc)().make_keep_preview_onscreen}},{rejectOnAbort:!0});u();let i=JSON.stringify(a)?.length||0;if(d.track(A.G3.SERIALIZE_HTML,{serializedJsonLength:i}),!a?.root)throw Error("No DOM data received from preview iframe");let r=(0,l.kc)().bake_m2d_roundtrip?e.referenceId??await W(e.fileKey):void 0;u();let o=await (0,A.N5)(a,{decodeImage:D.UD,rootFrameName:e.fileName,scene:(0,L.UN)(),tracking:M.HzA.IGNORE,trackPerformance:d,trackDefinedEvent:(0,A.G$)(O.az.trackDefinedEvent)},{attachBuildDataToNodes:{enabled:!!(0,l.kc)().bake_m2d_roundtrip,fileKey:e.fileKey,referenceId:r??void 0},abortSignal:t});e.isFileViewOnly||(await new Promise(e=>requestAnimationFrame(()=>requestAnimationFrame(e))),await (0,D.Jr)().imageUploadPromise(),d.track(A.G3.IMAGE_UPLOAD_COMPLETE)),u(),s=o.guid}else if(0===e.mode){let{html:t,rect:a}=await n.getHTMLForElement(),i=(await G.convertHtmlToDesign({fileKey:e.fileKey,html:t,width:Math.ceil(a.width),height:Math.ceil(a.height)})).data.meta.buffer;s=$(i)}else(0,a.xb)(e);let o=e.copyId;o&&(await (0,U.FH)({sourceNodeGuid:s,copyId:o,sourceFileKey:e.fileKey,persistentEntityId:e.persistentEntityId||""}),u());let c=null;try{c=z.l7.system("clipboard-payload",()=>{if(!r.glU)return null;let t=e.isFileViewOnly?M.Rup.HASHES_AND_DATA:M.Rup.HASHES_ONLY;return r.glU.getClipboardDataForGuids([s],t)??null})}finally{z.l7.system("delete-node",()=>{let e=(0,L.UN)();e.get(s)?.removeSelfAndChildren()})}if(!c)throw Error("Failed to generate clipboard payload");let x=i.getElapsedTime();return i.stop(),O.az.trackDefinedEvent("figmake.m2d_conversion_time",{fileKey:e.fileKey,mode:1===e.mode?"local":"api",target:"clipboard",elapsedTimeMs:x}),d.track(A.G3.COPY_TO_CLIPBOARD),d.trackFromStart(A.G3.END_SUCCESS),c}catch(e){throw"AbortError"===e.name?d.trackError(A.G3.END_ABORTED,e):d.trackError(A.G3.END_FAILURE,e),e}finally{d.removeEventListeners()}}async function V(e){let t;let s=new P.M4;s.start();let n=(0,c.g)(),i=(0,U.X0)({h2dSessionId:n,fileKey:e.fileKey,mode:1===e.mode?"local":"api",featureType:"html_to_canvas_node",onPageHide:()=>{i.trackError(A.G3.END_ABORTED,Error("pagehide"))}});i.track(A.G3.START);try{if(1===e.mode){(0,l.kc)().make_keep_preview_onscreen&&K(e.sitesPreview.iframe);let s=await e.sitesPreview.sendMessage("getDOMNodes",{},{rejectOnAbort:!0}),n=JSON.stringify(s)?.length||0;if(i.track(A.G3.SERIALIZE_HTML,{serializedJsonLength:n}),!s?.root)throw Error("No DOM data received from preview iframe");let a=(0,l.kc)().bake_m2d_roundtrip?e.referenceId??(e.fileKey?await W(e.fileKey):void 0):void 0;t=(await (0,A.N5)(s,{decodeImage:D.UD,rootFrameName:e.fileName,scene:(0,L.UN)(),tracking:M.HzA.TRACK,trackPerformance:i,trackDefinedEvent:O.az.trackDefinedEvent},{attachBuildDataToNodes:{enabled:!!(0,l.kc)().bake_m2d_roundtrip,fileKey:e.fileKey,referenceId:a??void 0}})).guid}else if(0===e.mode){let{html:s,rect:n}=await e.sitesPreview.getHTMLForElement(),a=(await G.convertHtmlToDesign({fileKey:e.fileKey,html:s,width:Math.ceil(n.width),height:Math.ceil(n.height)})).data.meta.buffer;t=$(a)}else(0,a.xb)(e);let n=e.canvasNodeGuid,o=z.l7.system("move-internal-node-to-canvas",()=>{let e=(0,L.UN)(),s=e.get(t);if(!s)throw Error("Html to design created node that was not found");let a=s.size.x,i=s.size.y,l=(n?e.get(n)?.parentGuid:e.getCurrentPage()?.guid)??"",o=function(e,t,s){if(!r.qmM)throw Error("InteractionCpp is not defined");let n=r.qmM.findBestBoundsForNewNodeRelativeToNode(e,t,s);return{x:n.origin.x,y:n.origin.y}}(n??"",a,i);return e.get(l)?.appendChild(s),s.x=o.x,s.y=o.y,s.guid}),c=s.getElapsedTime();return s.stop(),O.az.trackDefinedEvent("figmake.m2d_conversion_time",{fileKey:e.fileKey,mode:1===e.mode?"local":"api",target:"canvas",elapsedTimeMs:c}),i.track(A.G3.ADD_TO_CANVAS),i.trackFromStart(A.G3.END_SUCCESS),o}catch(e){throw i.trackError(A.G3.END_FAILURE,e),e}finally{i.removeEventListeners()}}function $(e){let t=(0,R.Ze)(e);if(!t)throw Error("Failed to decode clipboard buffer");return z.l7.user("paste-buffer-to-internal-canvas",()=>{let e=(0,L.UN)(),s=e.createNode("FRAME");s.stackMode="VERTICAL",s.stackPrimarySizing="RESIZE_TO_FIT_WITH_IMPLICIT_SIZE",s.stackCounterSizing="RESIZE_TO_FIT_WITH_IMPLICIT_SIZE";let n=e.getInternalCanvas();if(n)n.appendChild(s);else throw Error("Internal canvas not found");if(!r.glU?.directlyPasteSuggestion(t,s.parentGuid??"",null,s.guid))throw s.removeSelfAndChildren(),Error("Failed to paste buffer to canvas");let a=s.childrenNodes[0]?.clone(),i=a&&e.get(a);if(!i)throw s.removeSelfAndChildren(),Error("Failed to paste buffer to canvas");return n.appendChild(i),s.removeSelfAndChildren(),i.guid})}async function W(e){try{let{data:t}=await F.S.getOrCreateReferenceId({fileKey:e});return t.meta.reference_id}catch{throw Error("Failed to get or create reference id for roundtrip")}}var Y=s(696002);let X=(0,o.eU)(!1),Z=(0,g.bt)(e=>e.mirror.appModel.multiplayerSessionState);function J(){return(0,o.md)(X)}function Q(){let e=(0,Y.hk)(),t=(0,Y.cf)(),{componentPreviewState:s}=(0,k.k)(t?.guid),n=(0,o.md)(_.mK),a=(0,o.md)((0,y.o0)(e?.guid??"")),i=(0,u.wK)(),c=(0,o.md)(Z)===r.kul.JOINED,d=(0,o.md)(v.jx),x=(0,l.kc)().make_keep_preview_onscreen,m=d===v.Ic.PREVIEW;return(x||m)&&s===k.d.LOADED&&!!n?.getHTMLForElement&&!a&&i&&c}function ee(){let e=(0,d.hC)(),t=function(){let{getDynamicConfig:e}=(0,I.bY)("m2d_conversion_method");return(0,n.useMemo)(()=>e().get("method",H.LOCAL,e=>e===H.API||e===H.LOCAL),[e])}(),s=(0,h.tS)(),r=(0,h.IA)()??void 0,l=(0,f.l)(),[u,g]=(0,o.fp)(X),{showProcessing:y,showSuccess:k,showError:v,showHtmlSizeError:A,showManualCopy:M,dismissProcessingBell:z}=function(){let e=(0,b.wA)(),t=n.useRef(null),s=n.useCallback(()=>{t.current&&(clearTimeout(t.current),t.current=null),e(C.F.dequeue({matchType:E}))},[e]),a=n.useCallback(s=>{t.current=window.setTimeout(()=>{e(C.F.enqueue({type:E,message:(0,j.t)("figmake.m2d.converting_make_to_design"),icon:w.zX.SPINNER,timeoutOverride:1/0,onDismiss:s}))},300)},[e]),i=n.useCallback(t=>{s(),e(C.F.enqueue({type:N,message:"clipboard"===t?(0,j.t)("figmake.m2d.copied_to_clipboard"):(0,j.t)("figmake.m2d.pasted_to_canvas")}))},[e,s]);return{showProcessing:a,showSuccess:i,showError:n.useCallback(()=>{s(),e(C.F.enqueue({type:S,message:(0,j.t)("figmake.m2d.failed_to_copy"),icon:w.zX.EXCLAMATION}))},[e,s]),showHtmlSizeError:n.useCallback(()=>{s(),e(C.F.enqueue({type:"html-too-large",message:(0,j.t)("figmake.m2d.html_too_large"),icon:w.zX.EXCLAMATION}))},[e,s]),showManualCopy:n.useCallback(t=>{s(),e(C.F.enqueue({type:T,message:(0,j.t)("figmake.m2d.click_to_copy_to_clipboard"),icon:w.zX.CLIPBOARD,timeoutOverride:1/0,button:{primary:{text:(0,j.t)("figmake.m2d.copy_button"),action:()=>{(async()=>{try{await t(),e(C.F.dequeue({matchType:T})),e(C.F.enqueue({type:N,message:(0,j.t)("figmake.m2d.copied_to_clipboard"),icon:w.zX.CHECK}))}catch{e(C.F.enqueue({type:S,message:(0,j.t)("figmake.m2d.failed_to_copy"),icon:w.zX.EXCLAMATION}))}})()}},secondary:{text:(0,j.t)("general.cancel"),action:()=>{e(C.F.dequeue({matchType:T}))}}}}))},[e,s]),dismissProcessingBell:s}}(),L=(0,o.md)(_.mK);n.useEffect(()=>()=>{z()},[z]);let O=Q();return{handleHtmlToDesign:n.useCallback(async n=>{let{target:o,fileName:d,persistentEntityId:h}=n;if(u||!s||!O)return;if(!L?.getHTMLForElement)throw Error("Snapshot HTML is not available for preview");g(!0);let f=new AbortController;y(()=>{f.abort(),z(),g(!1)});try{if("canvas"===o)await V({mode:t,sitesPreview:L,fileName:d,fileKey:s,referenceId:r}),k("canvas");else if("clipboard"===o){let n;let a=(0,c.g)();try{n=await B({mode:t,sitesPreview:L,fileName:d,fileKey:s,referenceId:r,copyId:a,persistentEntityId:h,isFileViewOnly:l},f.signal),e("figmake.m2d_node_copied_to_clipboard",{persistentEntityId:h,copyId:a,error:!1,isFileViewOnly:l})}catch(t){throw"AbortError"!==t.name&&e("figmake.m2d_node_copied_to_clipboard",{persistentEntityId:h,copyId:a,error:!0,isFileViewOnly:l}),t}if(f.signal.aborted)return;let i=async(t,s)=>{try{if(!await p.Y5.writeToClipboard(t.text,t.metadata,t.buffer,t.textHtml))throw Error("Failed to write to clipboard");e("figmake.m2d_data_written_to_clipboard",{persistentEntityId:h,copyId:a,error:!1,isManual:s})}catch(t){throw e("figmake.m2d_data_written_to_clipboard",{persistentEntityId:h,copyId:a,error:!0,isManual:s}),t}};try{"undefined"!=typeof document&&"visible"===document.visibilityState&&document.hasFocus()?(await i(n,!1),k("clipboard")):M(()=>i(n,!0))}catch(e){M(()=>i(n,!0))}}else(0,a.xb)(o)}catch(e){if(!f.signal.aborted){if(e instanceof m.Dr&&(413===e.status||408===e.status)){A();return}e instanceof Error&&(0,x.$D)(i.e.MAKE,e,{tags:{target:o,mode:t}}),v()}}finally{g(!1),z(),f.abort()}},[L,s,r,u,g,O,y,k,v,A,M,z,t,l,e]),isProcessing:u,isEnabled:O}}},991007:(e,t,s)=>{s.d(t,{$i:()=>n,E9:()=>g,FW:()=>h,HB:()=>m,NR:()=>l,S$:()=>i,Xe:()=>a,_g:()=>x,eq:()=>r,hj:()=>p,kx:()=>o,oD:()=>c,t$:()=>d,wj:()=>u});let n="full_view_body",a="figma_back_to_files",i="make_a_copy_button",r="make_publish_button",l="fullscreen_preview_button",o="point_and_edit",c="ds_import_selected_library",d="ds_import_use_design_system",u="code_chat_attach_design",x="code_chat_toggle_component",m="code_chat_message_container",p="make.trigger_publish_menu_open",h="make_empty_state_overlay_input",g="html_to_design_button"},709898:(e,t,s)=>{s.d(t,{Ay:()=>_});var n=s(239976),a=s(105652),i=s(346524),r=s(731112),l=s(379141),o=s(323264),c=s(384795),d=s(622043);let u={ENTER_TO_LOOP:600,LAYOUT_STEP:600,EXPAND_TO_ICON:300,ICON_TO_CODE:300,CODE_DURATION:6e3,CODE_EXIT:300,ICONS_DURATION:6e3,ICONS_EXIT:300,RESET_PAUSE:800},x=e=>`var(${e})`,m={bg:"--animation-bg",stroke:"--animation-stroke",strokeLight:"--animation-stroke-light",fill:"--animation-fill",icon:"--animation-icon"},p={light:{[m.bg]:x("--color-bg"),[m.stroke]:x("--ramp-violet-400"),[m.strokeLight]:x("--ramp-violet-300"),[m.fill]:x("--ramp-violet-100"),[m.icon]:x("--color-icon-brand")},dark:{[m.bg]:x("--color-bg"),[m.stroke]:x("--color-border"),[m.strokeLight]:x("--color-border"),[m.fill]:x("--color-bg-secondary"),[m.icon]:x("--color-icon-secondary")}};function h(e,t="top"){let s="light"===e?"255, 255, 255":"44, 44, 44",n=[{position:0,alpha:1},{position:.1179,alpha:.991615},{position:.2138,alpha:.967585},{position:.2912,alpha:.9296},{position:.3534,alpha:.879348},{position:.4037,alpha:.818519},{position:.4456,alpha:.7488},{position:.4824,alpha:.671881},{position:.5176,alpha:.589452},{position:.5544,alpha:.5032},{position:.5963,alpha:.414815},{position:.6466,alpha:.325985},{position:.7088,alpha:.2384},{position:.7862,alpha:.153748},{position:.8821,alpha:.0737185},{position:1,alpha:0}].map(e=>`rgba(${s}, ${e.alpha}) ${100*e.position}%`).join(", ");return`linear-gradient(${"top"===t?"to bottom":"to top"}, ${n})`}let g={light:{top:h("light","top"),bottom:h("light","bottom")},dark:{top:h("dark","top"),bottom:h("dark","bottom")}},f={container:{kzqmXN:"xdpfuu1",kZKoxP:"x1jn0hjm",kWkggS:"x1yjdb4r",k1xSpc:"x78zum5",kXwgrk:"xdt5ytf",kGNEyG:"x6s0dn4",kjj79g:"xl56j7k",$$css:!0}};function _({frozenPhase:e,styleXStyle:t}){let[s,i]=(0,a.useState)(e||"enter"),[l,d]=(0,a.useState)(0),h=(0,a.useRef)(0),g=(0,r.G)();(0,a.useEffect)(()=>{let t;if(e)return;let n=e=>{i(()=>e)};return({enter:()=>{t=setTimeout(()=>n("loop"),u.ENTER_TO_LOOP)},loop:()=>{t=setTimeout(()=>{d(e=>{let t=(e+1)%5;return 0===t&&(h.current+=1,h.current>=1&&setTimeout(()=>n("exit"),200)),t})},u.LAYOUT_STEP)},exit:()=>n("expand"),expand:()=>{t=setTimeout(()=>n("icon"),u.EXPAND_TO_ICON)},icon:()=>{t=setTimeout(()=>n("code"),u.ICON_TO_CODE)},code:()=>{t=setTimeout(()=>n("codeExit"),u.CODE_DURATION)},codeExit:()=>{t=setTimeout(()=>n("fallingIcons"),u.CODE_EXIT)},fallingIcons:()=>{t=setTimeout(()=>n("fallingIconsExit"),u.ICONS_DURATION)},fallingIconsExit:()=>{t=setTimeout(()=>n("reset"),u.ICONS_EXIT)},reset:()=>{t=setTimeout(()=>n("enter"),u.RESET_PAUSE)},fixingErrors:()=>{}})[s](),()=>clearTimeout(t)},[s,l,e]),(0,a.useEffect)(()=>{e||(i(()=>"enter"),d(0),h.current=0)},[e]);let _={initial:{width:79},step1:{width:120,transition:{duration:.4,ease:"easeOut"}},step2:{width:79,transition:{duration:.4,ease:"easeOut"}},expand:{width:250,height:170,x:1,y:1,transition:{duration:.6,type:"spring",bounce:0}},reset:{width:79,height:79.0029,x:0,y:0,transition:{duration:.6,type:"spring"}}},v={initial:{width:79,x:172.499},step1:{width:120,x:131.499},step2:{width:79,x:172.499}},C={initial:{width:159,x:0},step1:{width:118,x:0},step2:{width:159,x:0}},w=()=>{switch(l){case 0:default:return"initial";case 1:return"step1";case 2:return"step2"}},E=()=>{switch(l){case 3:return"step1";case 4:return"step2";default:return"initial"}},N={hidden:{opacity:0,scale:1,y:8},show:{opacity:1,scale:1,y:0,transition:{duration:.4,type:"spring"}},exit:{opacity:0,scale:.6,y:8,transition:{duration:.4,type:"spring"}}},S={...N,exit:{opacity:0,scale:.6,y:-8,transition:{duration:.4,type:"spring"}}},T={...N,exit:{width:250,height:170,x:1,y:1,scale:1,opacity:1,transition:{ease:"easeOut",duration:.3}}},I=()=>{switch(s){case"exit":case"expand":return"exit";case"icon":case"code":case"codeExit":case"fixingErrors":case"fallingIcons":case"fallingIconsExit":return"hidden";case"reset":return"show";default:return}};return(0,n.jsx)("div",{...o.xk(f.container,t),style:p[g.color],children:(0,n.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k xwzcjdk xs4flsr xe8ttls x1rea2x4",children:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x6s0dn4 x1rea2x4",children:[(0,n.jsxs)("div",{className:"x1ymmuzg x1ri49h8 x1n2onr6 x1rea2x4",children:["expand"===s||"icon"===s||"fixingErrors"===s||"code"===s||"codeExit"===s||"fallingIcons"===s||"fallingIconsExit"===s?(0,n.jsx)(c.P.div,{className:"x10l6tqk xqyf9gi x1a842fp x4pepcl x1yjdb4r xoegz02",initial:{opacity:0},animate:{opacity:"fallingIconsExit"===s||"reset"===s?0:1},transition:{duration:.3}}):null,(0,n.jsxs)(c.P.svg,{width:"252",height:"172",viewBox:"0 0 252 172",fill:"none",xmlns:"http://www.w3.org/2000/svg",variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.15,delayChildren:.1,type:"spring",duration:.4}}},initial:"hidden",animate:"show",style:{position:"relative",zIndex:9},children:[(0,n.jsx)(c.P.g,{variants:T,children:(0,n.jsx)(c.P.rect,{animate:"loop"===s?_[w()]:"expand"===s||"icon"===s||"code"===s||"codeExit"===s||"fallingIcons"===s||"fallingIconsExit"===s||"fixingErrors"===s?_.expand:"reset"===s?_.reset:_.initial,height:"79.0029",initial:_.initial,rx:"12.5015",stroke:x(m.stroke),strokeDasharray:"6 6",strokeWidth:"0.997067",transition:{type:"spring",stiffness:300,damping:25,duration:.3},x:"0.498534",y:"0.498534"})}),(0,n.jsx)(c.P.g,{variants:S,animate:I(),children:(0,n.jsx)(c.P.rect,{y:"0.498534",height:"79.0029",rx:"12.5015",stroke:x(m.stroke),strokeWidth:"0.997067",strokeDasharray:"6 6",initial:{x:92.4985,width:159.003},animate:"loop"===s?{x:1===l?132.4985:92.4985,width:({initial:{width:159,x:0},step1:{width:118,x:12},step2:{width:159,x:0}})[w()].width}:{x:92.4985,width:159.003},transition:{duration:.4,ease:"easeOut"}})}),(0,n.jsx)(c.P.g,{variants:S,animate:I(),children:(0,n.jsx)(c.P.rect,{animate:"loop"===s?{width:C[E()].width}:C.initial,height:"79.0029",initial:C.initial,rx:"12.5015",stroke:x(m.stroke),strokeDasharray:"6 6",strokeWidth:"0.997067",transition:{duration:.4,ease:"easeOut"},x:"0.498534",y:"92.4985"})}),(0,n.jsx)(c.P.g,{variants:S,animate:I(),children:(0,n.jsx)(c.P.rect,{y:"92.4985",height:"79.0029",rx:"12.5015",stroke:x(m.stroke),strokeWidth:"0.997067",strokeDasharray:"6 6",initial:{x:172.499,width:79},animate:"loop"===s?{x:v[E()].x,width:v[E()].width}:{x:172.499,width:79},transition:{duration:.4,ease:"easeOut"}})})]}),(0,n.jsx)(b,{animationPhase:s}),(0,n.jsx)(k,{animationPhase:s}),(0,n.jsx)(j,{animationPhase:s})]}),(0,n.jsx)(y,{animationPhase:s})]})})})}function y({animationPhase:e}){let[t,s]=(0,a.useState)(0);(0,a.useEffect)(()=>{let e=setInterval(()=>{s(e=>(e+1)%4)},350);return()=>clearInterval(e)},[]);let r=e=>"fixingErrors"===e?(0,l.t)("figmake.thinking_state.fixing_errors"):"expand"===e||"icon"===e||"code"===e?(0,l.t)("figmake.thinking_state.label_3"):"codeExit"===e||"fallingIcons"===e||"fallingIconsExit"===e?(0,l.t)("figmake.thinking_state.label_2"):(0,l.t)("figmake.thinking_state.label_1"),o=(0,a.useMemo)(()=>r(e),[e]);return(0,n.jsxs)("div",{className:"xqui205 xemv814 xno9bf3 x1betce5 x1n0bwc9 x1kpxq89 x78zum5 xl56j7k x87ps6o",style:{display:"flex",alignItems:"baseline"},children:[(0,n.jsx)(i.E,{"aria-live":"polite",children:o}),(0,n.jsx)("div",{"aria-hidden":"true",children:(0,n.jsx)(d.N,{mode:"wait",children:(0,n.jsxs)(c.P.span,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.3,ease:"easeOut"},children:[(0,n.jsx)("span",{children:o}),(0,n.jsx)(c.P.span,{style:{display:"inline-block",width:"0.3em",textAlign:"left",marginLeft:"0"},"aria-hidden":"true",children:".".repeat(t)})]},o)})})]})}function k({animationPhase:e}){let t="code"===e||"fixingErrors"===e,s="codeExit"===e,a=(0,r.G)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.P.div,{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"200px",height:"140px",overflow:"hidden",zIndex:7},variants:{initial:{opacity:0},show:{opacity:1,transition:{duration:.4}},exit:{opacity:0,transition:{duration:.4}}},initial:"initial",animate:s?"exit":t?"show":"initial",children:(0,n.jsx)(c.P.div,{style:{position:"absolute",width:"100%"},variants:{initial:{y:128,opacity:1,transition:{duration:.4,type:"spring"}},animate:{y:-300,opacity:1,transition:{duration:8,ease:"linear",repeat:1/0,repeatType:"loop"}},exit:{y:-300,opacity:0,transition:{duration:.4,type:"spring"}}},initial:"initial",animate:s?"exit":t?"animate":"initial",children:(0,n.jsxs)("svg",{width:"189",height:"400",viewBox:"0 0 189 400",fill:"none",children:[(0,n.jsx)("rect",{x:"0.5",y:"0.5",width:"110",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"0.5",y:"23.5",width:"159",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"0.5",y:"47.5",width:"77",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"0.5",y:"70.5",width:"188",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"0.5",y:"94.5",width:"141",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"0.5",y:"117.5",width:"110",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"0.5",y:"140.5",width:"165",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"0.5",y:"170.5",width:"110",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"0.5",y:"193.5",width:"159",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"0.5",y:"217.5",width:"77",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"0.5",y:"240.5",width:"188",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"0.5",y:"264.5",width:"141",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"0.5",y:"287.5",width:"110",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"}),(0,n.jsx)("rect",{x:"0.5",y:"310.5",width:"165",height:"11",rx:"3.5",fill:x(m.fill),stroke:x(m.strokeLight),strokeDasharray:"4 4"})]})})}),(0,n.jsx)(c.P.div,{style:{position:"absolute",width:"238px",height:"82px",left:"8px",top:"4px",background:g[a.color].top,zIndex:8,pointerEvents:"none"},initial:{opacity:0},animate:{opacity:t?1:0},transition:{duration:.4}}),(0,n.jsx)(c.P.div,{style:{position:"absolute",width:"238px",height:"62px",left:"8px",top:"110px",background:g[a.color].bottom,zIndex:8,pointerEvents:"none"},initial:{opacity:0},animate:{opacity:t?1:0},transition:{duration:.4}})]})}let v={duration:.4,type:"spring"};function b({animationPhase:e}){let t={initial:{opacity:0,scale:0,x:12,y:124,transition:v},show:{opacity:1,scale:1,x:12,y:124,transition:v},exit:{opacity:0,scale:.6,x:12,y:124,transition:{...v,delay:.1}}};return(0,n.jsxs)(c.P.svg,{width:"36",height:"36",viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",top:0,left:0,zIndex:9,background:x(m.bg),borderRadius:36,transformOrigin:"center"},variants:t,initial:"initial",animate:"codeExit"===e?"exit":"icon"===e||"code"===e||"fixingErrors"===e?"show":"initial",children:[(0,n.jsx)("rect",{x:"0.5",y:"0.5",width:"35",height:"35",rx:"17.5",fill:x(m.bg),fillOpacity:"0.3"}),(0,n.jsx)("rect",{x:"0.5",y:"0.5",width:"35",height:"35",rx:"17.5",stroke:x(m.strokeLight)}),(0,n.jsx)("path",{d:"M14.8779 13.0316C15.0963 12.8874 15.3927 12.9116 15.585 13.1038C15.777 13.2961 15.8014 13.5926 15.6572 13.8109L15.585 13.8988L11.4824 18.0013L15.585 22.1038C15.8044 22.3235 15.8045 22.6792 15.585 22.8988C15.3654 23.1181 15.0096 23.1181 14.79 22.8988L10.29 18.3988C10.1847 18.2934 10.1251 18.1503 10.125 18.0013C10.125 17.8894 10.1585 17.7805 10.2197 17.6888L10.29 17.6038L14.79 13.1038L14.8779 13.0316ZM20.415 13.1029C20.6073 12.9107 20.9037 12.8864 21.1221 13.0306L21.21 13.1029L25.71 17.6029L25.7803 17.6878C25.8416 17.7796 25.875 17.8883 25.875 18.0003C25.875 18.1494 25.8154 18.2923 25.71 18.3978L21.21 22.8978C20.9903 23.1174 20.6347 23.1174 20.415 22.8978C20.1954 22.6781 20.1955 22.3225 20.415 22.1029L24.5176 18.0003L20.415 13.8978L20.3428 13.8099C20.1986 13.5916 20.2229 13.2951 20.415 13.1029Z",fill:x(m.icon)})]})}function j({animationPhase:e}){let t=(e,t,s,n,a)=>({initial:{x:e,y:-50,rotate:t,opacity:1,scale:1},animate:{x:e,y:[-64,236],rotate:s,opacity:1,scale:1,transition:{duration:2.2,ease:"linear",repeat:1/0,repeatDelay:0,repeatType:"loop",delay:n,times:[0,1]}},exit:{x:e,y:[-64,236],opacity:0,rotate:s,scale:.6,transition:{duration:.4,type:"spring"}}}),s=t(34,0,-5,0,0),a=t(138,-5,5,.2,0),i=t(75,0,-15,.5,.1),l=t(183,-5,5,.7,.15),o=t(20,0,15,1,.2),d=t(128,-5,5,1.2,.25),u=t(70,0,-12,1.5,.25),x=t(164,-6,6,1.7,.3),m=()=>{switch(e){case"fallingIcons":return"animate";case"fallingIconsExit":case"reset":return"exit";default:return"initial"}},p=(0,r.G)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(c.P.div,{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:252,height:172,zIndex:7,overflow:"hidden"},animate:{opacity:"fallingIconsExit"===e||"reset"===e?0:1},transition:{duration:.3},children:[(0,n.jsx)(c.P.div,{style:{position:"absolute"},variants:o,initial:"initial",animate:m(),children:(0,n.jsx)(C,{})}),(0,n.jsx)(c.P.div,{style:{position:"absolute"},variants:a,initial:"initial",animate:m(),children:(0,n.jsx)(w,{})}),(0,n.jsx)(c.P.div,{style:{position:"absolute"},variants:u,initial:"initial",animate:m(),children:(0,n.jsx)(N,{})}),(0,n.jsx)(c.P.div,{style:{position:"absolute"},variants:s,initial:"initial",animate:m(),children:(0,n.jsx)(S,{})}),(0,n.jsx)(c.P.div,{style:{position:"absolute"},variants:d,initial:"initial",animate:m(),children:(0,n.jsx)(E,{})}),(0,n.jsx)(c.P.div,{style:{position:"absolute"},variants:i,initial:"initial",animate:m(),children:(0,n.jsx)(I,{})}),(0,n.jsx)(c.P.div,{style:{position:"absolute"},variants:l,initial:"initial",animate:m(),children:(0,n.jsx)(A,{})}),(0,n.jsx)(c.P.div,{style:{position:"absolute"},variants:x,initial:"initial",animate:m(),children:(0,n.jsx)(T,{})})]}),(0,n.jsx)(c.P.div,{style:{position:"absolute",width:"238px",height:"92px",left:"8px",top:"-10px",background:g[p.color].top,zIndex:7,pointerEvents:"none"}}),(0,n.jsx)(c.P.div,{style:{position:"absolute",width:"238px",height:"62px",left:"8px",top:"110px",background:g[p.color].bottom,zIndex:7,pointerEvents:"none"}})]})}function C(){return(0,n.jsxs)("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",children:[(0,n.jsxs)("g",{clipPath:"url(#clip0_7376_774364)",children:[(0,n.jsx)("path",{d:"M6.66699 19.9998C6.66699 19.5089 7.06496 19.1109 7.55588 19.1109H32.4448C32.9357 19.1109 33.3337 19.5089 33.3337 19.9998C33.3337 20.4908 32.9357 20.8887 32.4448 20.8887H7.55588C7.06496 20.8887 6.66699 20.4908 6.66699 19.9998Z",fill:x(m.icon)}),(0,n.jsx)("path",{d:"M20.0003 6.6665C20.4912 6.6665 20.8892 7.06447 20.8892 7.55539L20.8892 32.4443C20.8892 32.9352 20.4912 33.3332 20.0003 33.3332C19.5094 33.3332 19.1114 32.9352 19.1114 32.4443L19.1114 7.55539C19.1114 7.06447 19.5094 6.6665 20.0003 6.6665Z",fill:x(m.icon)}),(0,n.jsx)("path",{d:"M29.4284 10.5717C29.7755 10.9189 29.7755 11.4817 29.4284 11.8288L11.8293 29.4279C11.4822 29.7751 10.9194 29.7751 10.5722 29.4279C10.2251 29.0808 10.2251 28.518 10.5722 28.1708L28.1713 10.5717C28.5185 10.2246 29.0813 10.2246 29.4284 10.5717Z",fill:x(m.icon)}),(0,n.jsx)("path",{d:"M10.5729 10.5718C10.92 10.2246 11.4828 10.2246 11.83 10.5718L29.4291 28.1709C29.7762 28.518 29.7762 29.0808 29.4291 29.4279C29.0819 29.7751 28.5191 29.7751 28.172 29.4279L10.5729 11.8288C10.2258 11.4817 10.2258 10.9189 10.5729 10.5718Z",fill:x(m.icon)})]}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"clip0_7376_774364",children:(0,n.jsx)("rect",{width:"26.6667",height:"26.6667",fill:"white",transform:"translate(6.66699 6.6665)"})})})]})}function w(){return(0,n.jsxs)("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",children:[(0,n.jsx)("g",{clipPath:"url(#clip0_7376_774366)",children:(0,n.jsx)("path",{d:"M13.333 7.49951H26.667C28.0474 7.49969 29.1668 8.61906 29.167 9.99951V29.5815C29.167 30.3037 28.3103 30.6848 27.7744 30.2007L21.1172 24.187C20.4827 23.6139 19.5173 23.6139 18.8828 24.187L12.2256 30.2007C11.6897 30.6848 10.833 30.3037 10.833 29.5815V9.99951C10.8332 8.61906 11.9526 7.49969 13.333 7.49951Z",stroke:x(m.icon),strokeWidth:"1.66667"})}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"clip0_7376_774366",children:(0,n.jsx)("rect",{width:"26.6667",height:"26.6667",fill:x(m.bg),transform:"translate(6.66699 6.6665)"})})})]})}function E(){return(0,n.jsxs)("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",children:[(0,n.jsx)("mask",{id:"path-1-inside-1_7376_774367",fill:"white",children:(0,n.jsx)("path",{d:"M20 6.6665C27.3636 6.6665 33.3327 12.6359 33.333 19.9995C33.333 27.3633 27.3638 33.3335 20 33.3335C17.6248 33.3335 15.3954 32.7111 13.4639 31.6226L8.99609 33.1128C7.69316 33.5471 6.45339 32.3073 6.8877 31.0044L8.37695 26.5347C7.28885 24.6034 6.66699 22.3741 6.66699 19.9995C6.66726 12.6359 12.6364 6.6665 20 6.6665Z"})}),(0,n.jsx)("path",{d:"M20 6.6665L20 4.99984H20V6.6665ZM33.333 19.9995L34.9997 19.9995L34.9997 19.9995L33.333 19.9995ZM20 33.3335L20 35.0002H20L20 33.3335ZM13.4639 31.6226L14.2822 30.1706L13.638 29.8076L12.9365 30.0415L13.4639 31.6226ZM8.99609 33.1128L9.52314 34.6939L9.52345 34.6938L8.99609 33.1128ZM6.8877 31.0044L8.46883 31.5314L8.4689 31.5312L6.8877 31.0044ZM8.37695 26.5347L9.95816 27.0615L10.1918 26.3604L9.829 25.7165L8.37695 26.5347ZM6.66699 19.9995L5.00033 19.9995V19.9995H6.66699ZM20 6.6665L20 8.33317C26.4431 8.33317 31.6661 13.5564 31.6663 19.9996L33.333 19.9995L34.9997 19.9995C34.9994 11.7155 28.2842 4.99984 20 4.99984L20 6.6665ZM33.333 19.9995H31.6663C31.6663 26.443 26.4432 31.6668 20 31.6668L20 33.3335L20 35.0002C28.2844 35.0002 34.9997 28.2836 34.9997 19.9995H33.333ZM20 33.3335V31.6668C17.9196 31.6668 15.9711 31.1224 14.2822 30.1706L13.4639 31.6226L12.6456 33.0745C14.8197 34.2998 17.33 35.0002 20 35.0002V33.3335ZM13.4639 31.6226L12.9365 30.0415L8.46874 31.5318L8.99609 33.1128L9.52345 34.6938L13.9912 33.2036L13.4639 31.6226ZM8.99609 33.1128L8.46905 31.5317L8.46883 31.5314L6.8877 31.0044L5.30656 30.4773C4.43794 33.0832 6.91728 35.5626 9.52314 34.6939L8.99609 33.1128ZM6.8877 31.0044L8.4689 31.5312L9.95816 27.0615L8.37695 26.5347L6.79575 26.0078L5.30649 30.4776L6.8877 31.0044ZM8.37695 26.5347L9.829 25.7165C8.87765 24.028 8.33366 22.0796 8.33366 19.9995H6.66699H5.00033C5.00033 22.6687 5.70006 25.1789 6.9249 27.3528L8.37695 26.5347ZM6.66699 19.9995L8.33366 19.9996C8.33389 13.5564 13.5569 8.33317 20 8.33317V6.6665V4.99984C11.7158 4.99984 5.00062 11.7155 5.00033 19.9995L6.66699 19.9995Z",fill:x(m.icon),mask:"url(#path-1-inside-1_7376_774367)"})]})}function N(){return(0,n.jsx)("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",children:(0,n.jsx)("path",{d:"M20.3008 8.3374C26.6049 8.49711 31.666 13.6578 31.666 20.0005L31.6621 20.3013C31.5022 26.6052 26.3424 31.6663 20 31.6665L19.6982 31.6626C13.4947 31.5049 8.49424 26.5049 8.33691 20.3013L8.33301 20.0005C8.33301 13.5574 13.557 8.33385 20 8.3335L20.3008 8.3374ZM20 10.0005C14.4775 10.0008 10 14.4779 10 20.0005C10.0004 25.5228 14.4777 30.0001 20 30.0005C25.5225 30.0003 29.9996 25.5229 30 20.0005C30 14.4777 25.5227 10.0007 20 10.0005ZM25.3779 21.6733C25.622 21.7048 25.842 21.8433 25.9756 22.0542C26.1282 22.2957 26.1468 22.5989 26.0244 22.8569C24.9887 25.0369 22.8027 26.5682 20.248 26.6616L20 26.6655C17.4227 26.6654 15.1891 25.203 14.0801 23.0659L13.9756 22.8569C13.8533 22.5989 13.8719 22.2956 14.0244 22.0542C14.1771 21.8129 14.443 21.6666 14.7285 21.6665H25.2715L25.3779 21.6733ZM16.2744 23.3325C17.1903 24.3557 18.5203 24.9994 20 24.9995L20.3701 24.9858C21.7008 24.8885 22.8867 24.2697 23.7256 23.3325H16.2744ZM16.667 14.9995C17.5873 14.9997 18.3329 15.7462 18.333 16.6665C18.333 17.5869 17.5873 18.3333 16.667 18.3335C15.7465 18.3335 15 17.587 15 16.6665C15.0001 15.7461 15.7466 14.9995 16.667 14.9995ZM23.333 14.9995C24.2534 14.9995 24.9999 15.7461 25 16.6665C25 17.587 24.2535 18.3335 23.333 18.3335C22.4127 18.3333 21.667 17.5869 21.667 16.6665C21.6671 15.7462 22.4127 14.9997 23.333 14.9995Z",fill:x(m.icon)})})}function S(){return(0,n.jsx)("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",children:(0,n.jsx)("path",{d:"M21.3291 11.0493C23.8048 8.61828 27.7764 8.54181 30.3457 10.8208L30.5898 11.0493C33.0574 13.4725 33.1348 17.348 30.8213 19.8618L30.5898 20.1001L20 30.4976L9.41113 20.1001C6.86394 17.5989 6.86394 13.5505 9.41113 11.0493C11.8869 8.61826 15.8585 8.54168 18.4277 10.8208L18.6719 11.0493L19.416 11.7808L20 12.354L20.584 11.7808L21.3291 11.0493Z",stroke:x(m.icon),strokeWidth:"1.66667"})})}function T(){return(0,n.jsx)("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",children:(0,n.jsx)("path",{d:"M19.0352 5.30728C19.6528 4.86836 20.4988 4.89969 21.084 5.40103L32.751 15.401C33.1204 15.7177 33.333 16.1801 33.333 16.6667V31.6667C33.3328 32.587 32.5864 33.3336 31.666 33.3336H25C24.0798 33.3335 23.3332 32.5869 23.333 31.6667V21.6667H16.666V31.6667C16.6658 32.5869 15.9202 33.3335 15 33.3336H8.33301C7.41279 33.3335 6.66619 32.5869 6.66602 31.6667V16.6667C6.66602 16.1803 6.8789 15.7177 7.24805 15.401L18.915 5.40103L19.0352 5.30728ZM8.33301 16.6667V31.6667H15V19.9997H25V31.6667H31.666V16.6667L20 6.66666L8.33301 16.6667Z",fill:x(m.icon)})})}function I(){return(0,n.jsx)("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M29.5131 13.2457C30.8458 15.1227 31.5882 17.3443 31.6611 19.6277C31.6648 19.7453 31.6668 19.863 31.667 19.9809C31.667 19.9873 31.6671 19.9936 31.6672 19.9998C31.6672 21.8408 30.1747 23.3332 28.3337 23.3332C27.3381 23.3332 26.4445 22.8967 25.8337 22.2047V14.9998C25.8337 14.5396 25.4606 14.1665 25.0003 14.1665C24.5401 14.1665 24.167 14.5396 24.167 14.9998V15.9174C23.1082 14.8369 21.6326 14.1665 20.0003 14.1665C16.7787 14.1665 14.167 16.7782 14.167 19.9998C14.167 23.2215 16.7787 25.8332 20.0003 25.8332C21.9338 25.8332 23.6476 24.8925 24.709 23.4439C25.6199 24.4023 26.907 24.9998 28.3337 24.9998C31.0475 24.9998 33.2563 22.8379 33.3317 20.1424C33.3327 20.1275 33.3332 20.1125 33.3333 20.0973C33.3335 20.0729 33.3336 20.0485 33.3337 20.0241C33.3337 20.016 33.3337 20.0079 33.3337 19.9998C33.3337 19.9927 33.3337 19.9855 33.3337 19.9783C33.3293 17.2275 32.4736 14.5365 30.8721 12.2808C29.0862 9.76561 26.4835 7.9474 23.5074 7.13601C20.5313 6.32463 17.3659 6.57028 14.5506 7.8311C11.7353 9.09192 9.44429 11.2899 8.06788 14.0505C6.69148 16.8112 6.31487 19.9637 7.00223 22.9708C7.68958 25.978 9.39837 28.6538 11.8374 30.5424C14.2765 32.4309 17.2949 33.4153 20.3784 33.3278C23.1437 33.2494 25.8078 32.3133 28.0073 30.6613C28.039 30.6375 28.0707 30.6135 28.1022 30.5894C28.4677 30.3097 28.503 29.7811 28.2011 29.4337C27.9222 29.1129 27.4532 29.0593 27.0933 29.2708C27.0781 29.2797 27.063 29.2891 27.0482 29.299C27.0341 29.3085 27.0201 29.3183 27.0064 29.3286C25.0818 30.7741 22.7507 31.5932 20.3312 31.6618C17.6331 31.7384 14.992 30.877 12.8578 29.2246C10.7236 27.5721 9.22843 25.2307 8.62699 22.5995C8.02556 19.9682 8.35509 17.2098 9.55944 14.7942C10.7638 12.3786 12.7684 10.4554 15.2318 9.35219C17.6952 8.24897 20.4649 8.03403 23.069 8.74399C25.6731 9.45395 27.9505 11.0449 29.5131 13.2457ZM24.167 19.9998C24.167 22.301 22.3015 24.1665 20.0003 24.1665C17.6992 24.1665 15.8337 22.301 15.8337 19.9998C15.8337 17.6987 17.6992 15.8332 20.0003 15.8332C22.3015 15.8332 24.167 17.6987 24.167 19.9998Z",fill:x(m.icon)})})}function A(){return(0,n.jsx)("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",children:(0,n.jsx)("path",{d:"M20 6.6665C12.6364 6.6665 6.66699 12.6358 6.66699 19.9998C6.66699 27.3639 12.6364 33.3332 20 33.3332C27.3637 33.3332 33.3337 27.3639 33.3337 19.9998C33.3337 12.6358 27.3637 6.6665 20 6.6665ZM20 8.33317C26.4431 8.33317 31.667 13.5564 31.667 19.9998C31.667 22.8207 30.5955 25.3998 28.8223 27.3332C27.6031 25.1332 25.3337 23.6665 22.7087 23.4332C24.3753 22.4998 25.4837 20.7332 25.4837 18.7498C25.4837 15.7498 23.0003 13.3332 20.0003 13.3332C17.0003 13.3332 14.517 15.7498 14.517 18.7498C14.517 20.7332 15.6253 22.4998 17.292 23.4332C14.667 23.6665 12.3976 25.1332 11.1784 27.3332C9.40521 25.3998 8.33366 22.8207 8.33366 19.9998C8.33366 13.5564 13.5569 8.33317 20 8.33317ZM16.1837 18.7498C16.1837 16.6665 17.9003 14.9998 20.0003 14.9998C22.1003 14.9998 23.817 16.6665 23.817 18.7498C23.817 20.8332 22.1003 22.4998 20.0003 22.4998C17.9003 22.4998 16.1837 20.8332 16.1837 18.7498ZM12.9587 28.6665C13.9587 26.1665 16.7503 24.1665 20.0003 24.1665C23.2503 24.1665 26.042 26.1665 27.042 28.6665C24.9587 30.4998 22.6003 31.6665 20 31.6665C17.3997 31.6665 15.042 30.4998 12.9587 28.6665Z",fill:x(m.icon)})})}},637904:(e,t,s)=>{s.d(t,{m:()=>y});var n=s(239976),a=s(105652),i=s(865702),r=s(445019),l=s(323264),o=s(499735),c=s(233277),d=s(239811),u=s(66806),x=s(495004),m=s(436134);let p=Math.max(...Object.values(x.WW).map(e=>e.height).filter(e=>void 0!==e)),h={k3aq6I:"xsqj5wx",k3nNDw:"x1dp6rp6",$$css:!0},g={kzqmXN:"x5lhr3w",kZKoxP:"x16ye13r",$$css:!0},f={k3aq6I:"xsqj5wx",$$css:!0},_={deviceWithHandles:{kVAEAm:"x1n2onr6",k1xSpc:"x78zum5",kGNEyG:"x6s0dn4",kjj79g:"x1nhvcw1",kXwgrk:"xdt5ytf",$$css:!0},deviceWithHandlesScaledZoom:e=>[{kKQXaZ:null!=e?"x12651j4":e,$$css:!0},{"--x-zoom":null!=e?e:void 0}],deviceWithHandlesScaledTransform:e=>[h,{"--x-transform":`scale(${e})`}],device:{kaIpWk:"xqx0amy",kVQacm:"xb3r6kr",kWkggS:"x1v8gsql",k1xSpc:"x78zum5",kGNEyG:"x6s0dn4",kjj79g:"xl56j7k",keoZOQ:"xw7yly9",kVAEAm:"x1n2onr6",$$css:!0},deviceWithDimensions:(e,t)=>[g,{"--x-width":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(`${e}px`),"--x-height":(e=>"number"==typeof e?e+"px":null!=e?e:void 0)(`${t}px`)}],resizeHandleScaled:e=>[f,{"--x-transform":`scale(${e})`}],noop:{k1xSpc:"xjp7ctv",$$css:!0}};function y({children:e}){let[t]=(0,r.fp)(x.gn),[s,i]=(0,r.fp)(x.u3),[o,c]=(0,r.fp)(x.dD),[u,m]=(0,r.fp)(x.sH),[h,g]=a.useState(void 0),f=(0,r.Xr)(x.P1),[y,v]=a.useState(0),b=a.useRef(null),j=a.useMemo(()=>"zoom"in document.createElement("div").style,[]);a.useEffect(()=>{if(!t)return;let e=()=>{if(b.current){let e=b.current.getBoundingClientRect();v(e.height),f(e)}};e();let s=new ResizeObserver(e);return b.current&&s.observe(b.current),()=>{s.disconnect()}},[b,t,f]);let C=()=>({top:0,left:0,right:s,bottom:o}),w=(e,t)=>{(e[d.OP.LEFT]||e[d.OP.RIGHT])&&i(Math.min(Math.max(t.right-t.left,x.Yh),x.g_)),e[d.OP.BOTTOM]&&c(Math.min(Math.max(t.bottom,x.fw),x.L9))};a.useEffect(()=>{y&&m(Math.min(Math.max(.5,(y-40)/p),1))},[y,m,u]);let E=1/u;return(0,n.jsxs)("div",{...{0:{className:"xjp7ctv"},1:{className:"xh8yej3 x5yr21d x1n2onr6 xb3r6kr"}}[!!t<<0],ref:b,children:[(0,n.jsx)("div",{...{0:{className:"xjp7ctv"},1:{className:"xh8yej3 x5yr21d x1v8gsql xb3r6kr"}}[!!t<<0],children:(0,n.jsxs)("div",{...l.Ay.props(t?[_.deviceWithHandles,j?_.deviceWithHandlesScaledZoom(u):_.deviceWithHandlesScaledTransform(u)]:_.noop),children:[(0,n.jsxs)("div",{...{0:{className:"xjp7ctv"},1:{className:"x78zum5 x6s0dn4 x1n2onr6"}}[!!t<<0],children:[t&&(0,n.jsx)("div",{...l.Ay.props(_.resizeHandleScaled(E)),children:(0,n.jsx)(k,{getCurrentContainerBounds:C,resizeTo:w,isResizing:h,setIsResizing:g,direction:d.OP.LEFT})}),(0,n.jsx)("div",{...l.Ay.props(t?[_.device,_.deviceWithDimensions(s,o)]:_.noop),children:(0,n.jsx)("div",{...{0:{className:"xjp7ctv"},1:{className:"xh8yej3 x5yr21d xb3r6kr x1n2onr6 xqx0amy"}}[!!t<<0],children:e})}),t&&(0,n.jsx)("div",{...l.Ay.props(_.resizeHandleScaled(E)),children:(0,n.jsx)(k,{getCurrentContainerBounds:C,resizeTo:w,isResizing:h,setIsResizing:g,direction:d.OP.RIGHT})})]}),t&&(0,n.jsx)("div",{...l.Ay.props(_.resizeHandleScaled(E)),children:(0,n.jsx)(k,{getCurrentContainerBounds:C,resizeTo:w,isResizing:h,setIsResizing:g,direction:d.OP.BOTTOM})})]})}),t&&h&&(0,n.jsx)("div",{className:"x10l6tqk x10a8y8t x1vjfegm x71s49j"})]})}function k({resizeTo:e,getCurrentContainerBounds:t,isResizing:s,setIsResizing:a,direction:r}){let l=`resizeHandle-${r}`,{startResizing:x}=(0,u.Q)({resizeTo:e,getCurrentContainerBounds:t,isResizing:s,setIsResizing:a,setResizeDirections:i.lQ,lockAspectRatio:!1,hidden:!1,recordingKey:l,mirrorResizeHorizontally:!0}),p=o.rf(l,"mousedown",e=>{e.stopPropagation(),e.preventDefault(),x([r],{x:e.clientX,y:e.clientY})}),h=r===d.OP.BOTTOM?m.C6:m.I9;return(0,n.jsx)(c.S.div,{"data-point-and-edit-tool":!0,className:h,onMouseDown:p,children:(0,n.jsx)("div",{className:"x1evwjr3"})})}},652219:(e,t,s)=>{s.d(t,{r:()=>g,Y:()=>h});var n=s(239976),a=s(39899),i=s(105652);let r=(0,i.memo)(function(e){return(0,n.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24L",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M18 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6l-.204-.01A2 2 0 0 1 4 18V6a2 2 0 0 1 1.796-1.99L6 4zM5 16v2a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2zM6 5a1 1 0 0 0-1 1v9h14V6a1 1 0 0 0-1-1z"})})}),l=(0,i.memo)(function(e){return(0,n.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,n.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M7.5 7h9a.5.5 0 0 1 .5.5V14H7V7.5a.5.5 0 0 1 .5-.5M6 15V7.5A1.5 1.5 0 0 1 7.5 6h9A1.5 1.5 0 0 1 18 7.5v9a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 6 16.5zm11 0v1.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V15z",clipRule:"evenodd"})})});var o=s(379141),c=s(445019);s(323264);var d=s(716342),u=s(924278),x=s(682499),m=s(823865),p=s(379196);function h(){let[e]=(0,c.fp)(m.jx);return e===m.Ic.CODE}function g({openText:e,hideText:t,asLargeVariant:s}){let[i,m]=(0,c.fp)(x.YD),[h]=(0,p.jT)(),[g]=(0,u.PM)(),f=h?.filter(e=>"error"===e.type),_=g.filter(e=>"error"===e.level),y=f&&f.length>0||_&&_.length>0,k=i?t:e,v=y?(0,o.t)("figmake.toolbar.console_drawer_button.error_indicator_a11y_description"):"",b=(0,n.jsxs)("div",{className:"x1n2onr6",children:[y&&(0,n.jsx)("div",{className:"x10l6tqk xndqk7f x1pzoy33 x51ohtg xqu0tyb x16rqkct xxvmw7z xmkeg23 x1y0btm7 xdkfplz","data-testid":"console-error-indicator"}),s?(0,n.jsx)(r,{}):(0,n.jsx)(l,{})]}),j=s?d.y:a.f;return(0,n.jsx)(j,{"aria-description":v,"aria-label":k,checked:i,htmlAttributes:{"data-tooltip":k,"data-tooltip-type":"text"},offIcon:b,onChange:()=>m(!i),onIcon:b,recordingKey:"toggleConsoleDrawerButton",variant:"highlighted"})}},610424:(e,t,s)=>{s.d(t,{l:()=>u});var n=s(239976),a=s(105652),i=s(39899),r=s(727029),l=s(379141),o=s(445019),c=s(716342),d=s(629648);function u({disabled:e,sitesPreview:t,asLargeVariant:s,onboardingKey:u,showTooltipAbove:x,codeInstanceGuid:m}){let{isCommentModeActive:p,disableComments:h}=(0,d.jy)(),g=(0,o.md)(t.directManipulationEditor.directManipulationEnabledAtom),f=a.useCallback(()=>{let e=!g;p&&(h(),e=!0),t.setDirectManipulationEnabled({enabled:e,codeInstanceGuid:m})},[g,p,t,m,h]),_=s?c.y:i.f,y=(0,n.jsx)(r.Z,{});return(0,n.jsx)(_,{"aria-label":(0,l.t)("figmake.chat.click_to_inspect.label"),checked:!p&&g,disabled:e,htmlAttributes:{"data-onboarding-key":u,"data-tooltip-show-above":x||void 0,"data-tooltip-show-below":!x||void 0},offIcon:y,onChange:f,onIcon:y,variant:"highlighted"})}},883844:(e,t,s)=>{s.d(t,{n:()=>x});var n=s(239976),a=s(39899),i=s(670245),r=s(281919),l=s(379141),o=s(445019),c=s(716342),d=s(236410),u=s(495004);function x({asLargeVariant:e}={}){let[t,s]=(0,o.fp)(u.gn),m=e?c.y:a.f,p=e?(0,n.jsx)(i.J,{}):(0,n.jsx)(r.k,{});return(0,n.jsx)(m,{"data-point-and-edit-tool":!0,variant:"highlighted",checked:t,onIcon:p,offIcon:p,recordingKey:"toggleMobilePreviewButton","aria-label":(0,l.t)("figmake.mobile_preview"),htmlAttributes:{"data-tooltip":(0,l.t)("figmake.mobile_preview"),"data-tooltip-type":d.Ib.TEXT},onChange:()=>s(!t)})}},671661:(e,t,s)=>{s.d(t,{S:()=>h,Y:()=>g});var n=s(607696),a=s(692376),i=s(445019),r=s(223487),l=s(605985),o=s(395823),c=s(807461),d=s(368417),u=s(518798),x=s(820198),m=s(445602),p=s(351572);function h(){let e=(0,r.tS)(),t=n.lV.FIGMAKE,s=(0,d.YP)({}),h=s.chatMessagesNode,g=(0,l.iZ)(),f=(0,o.Xu)(),_=(0,i.md)(c.LR),y=(0,u.dH)(),k=(0,m.L)(),v=(0,x.GM)();return({toolCallId:i,toolName:r,toolResult:l})=>{a.glU&&g&&h&&s.isInitialized&&(0,p.v)({clientSideToolResults:[{toolCallId:i,toolName:r,result:l}],user:g,chatMessagesNode:h,chatController:s,rawUserChatDetails:void 0,featureType:t,setInput:()=>{},fileKey:e,autoFixingUserMessageId:null,onFinish:()=>{},model:k,canUseSupabase:f,todoAutoAccept:v,requestInitiator:n.bG.USER,mcpPreferences:_,canUseMcpConnectors:y})}}function g(){let e=(0,r.tS)(),t=n.lV.FIGMAKE,s=(0,d.YP)({}),x=s.chatMessagesNode,h=(0,l.iZ)(),g=(0,o.Xu)(),f=(0,i.md)(c.LR),_=(0,u.dH)(),y=(0,m.L)();return({results:i})=>{if(!a.glU||!h||!x||!s.isInitialized)return;let r=i.map(e=>({toolCallId:e.toolCallId,toolName:e.toolName,result:e.toolResult}));(0,p.v)({clientSideToolResults:r,user:h,chatMessagesNode:x,chatController:s,rawUserChatDetails:void 0,featureType:t,setInput:()=>{},fileKey:e,autoFixingUserMessageId:null,onFinish:()=>{},model:y,canUseSupabase:g,todoAutoAccept:!0,requestInitiator:n.bG.USER,mcpPreferences:f,canUseMcpConnectors:_})}}},51907:(e,t,s)=>{s.d(t,{K:()=>B});var n=s(239976),a=s(943360),i=s(942356),r=s(255398),l=s(379141),o=s(445019);s(323264);var c=s(391596),d=s(297094),u=s(585066),x=s(223487),m=s(538349),p=s(463838),h=s(788995),g=s(671661),f=s(997129),_=s(74122),y=s(59610),k=s(306809),v=s(105652),b=s(20002),j=s(245814),C=s(655793),w=s(517478),E=s(378721),N=s(254056),S=s(15683),T=s(288350),I=s(64939),A=s(536378),M=s(747079),z=s(660259),L=s(585109),O=s(866401),P=s(947700),R=s(674738),D=s(299823);function F({activeProjects:e,projectIdToPause:t,setProjectIdToPause:s}){let a=(0,o.md)(z.kz);return(0,n.jsx)(S.b,{legend:(0,n.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:(0,l.t)("figmake.settings.pause_project.radio.label")}),value:t,onChange:s,readonly:!!a,children:e.map(e=>(0,n.jsx)(S.c,{value:e.id,label:(0,n.jsx)(T.J,{children:(0,n.jsx)(q,{project:e})})},e.id))})}function q({project:e}){return(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:e.name}),(0,n.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,l.tx)("figmake.settings.pause_project.created",{timestamp:(0,n.jsx)(d.h1,{date:e.created_at})})})]},e.id)}function G({props:e,projectIdToPause:t}){let s=(0,x.tS)(),[a,r]=(0,o.fp)(z.kz),c=(0,y.h5)({toolCallId:e.toolCallId,toolName:e.toolName,trackingContext:e.trackingContext,source:e.source}),d=async()=>{if(!s){console.error("No open file key found");return}if(!t){console.error("No selected project found");return}r(t);try{await p.R.pauseProject({fileKey:s,projectId:t});let n=setInterval(async()=>{let a=await m.M4.fetch((0,P.GO)({fileKey:s,projectId:t}),{policy:"networkOnly"});a?.status.toLowerCase()===f.TL.INACTIVE&&(e.onClose(),clearInterval(n),(0,R.l4)(),r(null),e.connectToExistingProject?e.connectToExistingProject():c())},2e3)}catch(e){r(null),(0,k.ZH)(e)}};return a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,l.t)("figmake.supabase.pausing_project.subtitle")}),(0,n.jsx)(i.$n,{variant:"secondary",onClick:()=>e.onClose(),disabled:!0,children:(0,l.t)("figmake.pause_project_modal.button.cancel")}),(0,n.jsx)(L.lV,{variant:"destructive",children:(0,l.t)("figmake.pause_project_modal.button.loading")})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.$n,{variant:"secondary",onClick:()=>e.onClose(),children:(0,l.t)("figmake.pause_project_modal.button.cancel")}),(0,n.jsx)(i.$n,{variant:"destructive",onClick:d,disabled:!t,children:(0,l.t)("figmake.pause_project_modal.button.submit")})]})}let U=(0,M.Ju)(function(e){let t=j.hS({...e}),{organization:s}=(0,f.mS)(),{activeProjects:a}=(0,f.YY)(),i=(0,b.wA)(),r=!!e.toolCallId&&!!e.toolName,[o,c]=(0,v.useState)(void 0);return(0,n.jsx)(C.bL,{manager:t,width:394,children:(0,n.jsxs)(w.vo,{children:[(0,n.jsxs)(w.Y9,{children:[r&&(0,n.jsx)(E.K,{"aria-label":(0,l.t)("figmake.supabase.pause_project_modal.back"),onClick:()=>{e.onClose(),i((0,A.to)({type:O.Z,data:{toolCallId:e.toolCallId,toolName:e.toolName,trackingContext:e.trackingContext,source:e.source},showModalsBeneath:!0}))},children:(0,n.jsx)(I.C,{})}),(0,n.jsx)(w.hE,{children:(0,l.t)("figmake.pause_project_modal.title")})]}),(0,n.jsx)(w.nB,{scrolling:"manual",children:(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf xou54vl",children:[(0,n.jsx)("div",{children:(0,l.tx)("figmake.pause_project_modal.body_with_link",{upgradeLink:(0,n.jsx)(N.N,{href:(0,D.$X)(s?.id||""),newTab:!0,children:(0,l.t)("figmake.pause_project_modal.upgrade_link")})})}),(0,n.jsx)(F,{activeProjects:a,projectIdToPause:o,setProjectIdToPause:c})]})}),(0,n.jsx)(w.wi,{children:(0,n.jsx)(w.jk,{className:"x78zum5 x1q0g3np x13a6bvl x167g77z x1xn8qrt xdqyycr xh8yej3 x9f619",children:(0,n.jsx)(G,{props:e,projectIdToPause:o})})})]})})},"PauseProjectModal");function K({toolCallId:e,toolName:t,connectToExistingProject:s,trackingContext:n,source:a}){let i=(0,b.wA)();return()=>i((0,A.to)({type:U,data:{toolCallId:e,toolName:t,connectToExistingProject:s,trackingContext:n,source:a},showModalsBeneath:!0}))}let H=(0,M.Ju)(function(e){let t=j.hS({open:e.open,onClose:e.onClose}),s=(0,y.h5)({toolCallId:e.toolCallId,toolName:e.toolName,trackingContext:e.trackingContext,source:e.source});return(0,n.jsx)(C.bL,{manager:t,width:386,children:(0,n.jsxs)(w.vo,{children:[(0,n.jsx)(w.Y9,{children:(0,n.jsx)(w.hE,{children:(0,l.t)("figmake.supabase_cost_warning_modal.title")})}),(0,n.jsx)(w.nB,{children:(0,n.jsx)("div",{children:(0,n.jsxs)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up",children:[(0,l.t)("figmake.supabase_cost_warning_modal.body")," ",(0,n.jsx)(N.N,{href:D.Sy,newTab:!0,children:(0,l.t)("general.learn_more")})]})})}),(0,n.jsx)(w.wi,{children:(0,n.jsxs)(w.jk,{className:"x78zum5 x1q0g3np x13a6bvl x167g77z x1xn8qrt xdqyycr xh8yej3 x9f619",children:[(0,n.jsx)(i.$n,{variant:"secondary",onClick:e.onClose,children:(0,l.t)("figmake.supabase.cancel")}),(0,n.jsx)(i.$n,{variant:"destructive",onClick:()=>{e.onClose(),s()},children:(0,l.t)("figmake.supabase_cost_warning_modal.submit")})]})})]})})},"SupabaseCostWarningModal");function B({onSubmit:e,toolCallId:t,toolName:s,trackingContext:i,source:r}){let{existingProjects:o,isLoading:c}=(0,f.tE)(),d=function({onSubmit:e,toolCallId:t,toolName:s,trackingContext:n,source:a}){let{needsToPauseProject:i}=(0,f.Lz)(),r=(0,y.h5)({toolCallId:t,toolName:s,trackingContext:n,source:a}),l=K({toolCallId:t,toolName:s,trackingContext:n,source:a}),o=function({toolCallId:e,toolName:t,trackingContext:s,source:n}){let a=(0,b.wA)();return()=>a((0,A.to)({type:H,data:{toolCallId:e,toolName:t,trackingContext:s,source:n},showModalsBeneath:!0}))}({toolCallId:t,toolName:s,trackingContext:n,source:a}),c=function(){let{organization:e}=(0,f.mS)();return e?.plan!=="free"}();return()=>{if(e&&e(),c){o();return}if(i){l();return}r()}}({onSubmit:e,toolCallId:t,toolName:s,trackingContext:i,source:r});if(c)return(0,n.jsx)(u.k,{});let x=o.filter(e=>e.status.toLowerCase()!==f.TL.REMOVED);return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"xt970qd x1hr3lfm",children:(0,n.jsx)(a.E,{"aria-label":(0,l.t)("figmake.settings.connect_existing_project.create_project.button"),onClick:d,children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1v2ro7d",children:[(0,n.jsx)(W,{}),(0,n.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:(0,l.t)("figmake.settings.connect_existing_project.create_project.button")})]})})}),(0,n.jsx)("div",{className:"xyamay9 x1l90r2v",children:(0,n.jsx)(L.cG,{})}),(0,n.jsx)("div",{className:"x78zum5 xdt5ytf xou54vl xt970qd x1hr3lfm xl56j7k x1cy8zhl",children:x.map(a=>(0,n.jsx)(V,{project:a,onSubmit:e,toolCallId:t,toolName:s,trackingContext:i,source:r},a.id))})]})}function V({project:e,onSubmit:t,toolCallId:s,toolName:a,trackingContext:r,source:u}){let y=e.status.toLowerCase()===f.TL.INACTIVE||e.status.toLowerCase()===f.TL.PAUSING,v=function({onSubmit:e,project:t,isPaused:s,toolCallId:n,toolName:a,source:i,trackingContext:r}){let{needsToPauseProject:l}=(0,f.Lz)(),d=(0,x.tS)(),{organization:u}=(0,f.mS)(),y=u?.id,[,v]=(0,c.IT)((0,P.TT)({fileKey:d})),[,b]=(0,c.IT)((0,P.YF)({fileKey:d})),j=(0,g.S)(),C=(0,o.Xr)(_.Kj),w=async()=>{if(!d||!y){console.error("No open file key or organization ID found");return}e&&e(),C({project:t,state:"connecting"});try{await p.R.connectFile({fileKey:d,supabaseProjectId:t.id,supabaseOrgId:y})}catch(e){(0,k.AW)(e),C(null)}if((0,h.uF)(r||{persistentEntityId:"",clientLifecycleId:""},i,d,"existing"),await v.refetch(),s){try{await p.R.restoreFile({fileKey:d})}catch(e){(0,k.oT)(e),C(null)}E()}else N()},E=()=>{let e=setInterval(async()=>{let t=await m.M4.fetch((0,P.TT)({fileKey:d}),{policy:"networkOnly"});t?.connectedProject?.status.toLowerCase()===f.TL.ACTIVE_HEALTHY&&(clearInterval(e),N(),b.refetch())},2e3)},N=()=>{C(null),n&&a&&j({toolCallId:n,toolName:a,toolResult:{success:!0,message:"Connected to Supabase."}})},S=K({toolCallId:n,toolName:a,connectToExistingProject:w,trackingContext:r,source:i});return async()=>{s&&l?(e&&e(),S()):await w()}}({project:e,isPaused:y,onSubmit:t,toolCallId:s,toolName:a,trackingContext:r,source:u});return(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1v2ro7d xh8yej3",children:[(0,n.jsx)(L.mj,{variant:"existing_project",inactive:y}),(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 x1v2ro7d xh8yej3",children:[(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1cy8zhl",children:[(0,n.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:e.name}),(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1cy8zhl x1jnr06f",children:[(0,n.jsx)($,{isPaused:y}),(0,n.jsx)("span",{children:"\xb7"}),(0,n.jsx)("span",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,l.tx)("figmake.settings.pause_project.created",{timestamp:(0,n.jsx)(d.h1,{date:e.created_at})})})]})]}),(0,n.jsx)(i.$n,{variant:"secondary",onClick:v,children:(0,l.t)("figmake.settings.connect_existing_project.project.button")})]})]},e.id)}function $({isPaused:e}){return e?(0,n.jsx)("span",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x1n0bwc9",children:(0,l.t)("figmake.settings.connect_existing_project.status.project.paused")}):(0,n.jsx)("span",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh xq6u9c4",children:(0,l.t)("figmake.settings.connect_existing_project.status.project.active")})}function W(){return(0,n.jsx)("div",{className:"x78zum5 x1td3qas x10w6t97 xfawy5m xl56j7k x6s0dn4 x1sxf85j x30nh5c",children:(0,n.jsx)(r.$,{})})}},866401:(e,t,s)=>{s.d(t,{Z:()=>d});var n=s(239976),a=s(245814),i=s(655793),r=s(517478),l=s(379141);s(323264);var o=s(747079),c=s(51907);let d=(0,o.Ju)(function(e){let t=a.hS({open:e.open,onClose:e.onClose});return(0,n.jsx)(i.bL,{manager:t,width:386,children:(0,n.jsxs)(r.vo,{children:[(0,n.jsx)(r.Y9,{children:(0,n.jsx)(r.hE,{children:(0,l.t)("figmake.connect_existing_projects_modal.title")})}),(0,n.jsx)(r.nB,{children:(0,n.jsx)("div",{className:"x1y1aw1k x1l90r2v",children:(0,n.jsx)(c.K,{onSubmit:e.onClose,toolCallId:e.toolCallId,toolName:e.toolName,trackingContext:e.trackingContext,source:e.source})})})]})})},"SupabaseConnectExistingProjectsModal")},59610:(e,t,s)=>{s.d(t,{AP:()=>R,h5:()=>D});var n=s(239976),a=s(105652),i=s(20002),r=s(245814),l=s(655793),o=s(517478),c=s(942356),d=s(545414),u=s(943360),x=s(39899),m=s(858948),p=s(3831),h=s(300284),g=s(379141),f=s(323264),_=s(61598),y=s(536378),k=s(964731),v=s(223487),b=s(538349),j=s(463838),C=s(747079),w=s(248046),E=s(788995),N=s(671661),S=s(947700),T=s(585109),I=s(299823),A=s(306809);function M({value:e,setValue:t,disabled:s}){let a=(0,g.t)("figmake.settings.create_project_modal.project_name.label"),i=(0,g.t)("figmake.settings.create_project_modal.project_name.placeholder");return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1v2ro7d",children:[(0,n.jsx)("div",{className:"x78zum5 x1q0g3np x1qughib",children:(0,n.jsx)("label",{htmlFor:a,className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:a})}),(0,n.jsx)("div",{className:"x78zum5 xdt5ytf x1jnr06f",children:(0,n.jsx)(d.p,{type:"text",id:a,value:e,onChange:t,placeholder:i,size:"lg",disabled:s})})]})}function z({value:e,setValue:t,helperText:s,disabled:i}){let r=(0,g.t)("figmake.settings.create_project_modal.db_pass.label"),l=(0,g.t)("figmake.settings.create_project_modal.db_pass.placeholder"),[o,c]=a.useState(!1),[f,y]=a.useState(!1);return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1v2ro7d",children:[(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib",children:[(0,n.jsx)("label",{htmlFor:r,className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:r}),(0,n.jsxs)(u.E,{onClick:e=>{e.preventDefault(),t((0,_.b)()),y(!0),c(!0),setTimeout(()=>{c(!1)},500)},className:"x1lcq9ky x1n0bwc9 x78zum5 x1q0g3np",children:[(0,n.jsx)(m._,{...{0:{className:"xmauxvm"},1:{className:"xzpxq2u xxkxylk xmauxvm"}}[!!o<<0]}),(0,n.jsx)("span",{children:(0,g.t)("figmake.settings.create_project_modal.password.generate")})]})]}),(0,n.jsxs)("div",{className:"x1n2onr6 x1rg5ohu",children:[(0,n.jsx)(d.p,{type:f?"text":"password",id:r,value:e,onChange:t,placeholder:l,size:"lg",disabled:i}),(0,n.jsx)("span",{className:"x10l6tqk x19up5dg xbfrwjf xmauxvm",children:(0,n.jsx)(x.f,{checked:f,onIcon:(0,n.jsx)(p.T,{}),offIcon:(0,n.jsx)(h.A,{}),"aria-label":(0,g.t)("figmake.settings.create_project_modal.password.view_hide"),htmlAttributes:{"data-tooltip":(0,g.t)("figmake.settings.create_project_modal.password.view_hide"),"data-tooltip-type":"text"},onChange:()=>y(e=>!e)})})]}),s&&(0,n.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:s})]})}var L=(e=>(e.US_EAST_1="us-east-1",e.US_EAST_2="us-east-2",e.US_WEST_1="us-west-1",e.AP_SOUTHEAST_1="ap-southeast-1",e.AP_NORTHEAST_1="ap-northeast-1",e.AP_NORTHEAST_2="ap-northeast-2",e.AP_SOUTHEAST_2="ap-southeast-2",e.EU_WEST_1="eu-west-1",e.EU_WEST_2="eu-west-2",e.EU_WEST_3="eu-west-3",e.EU_NORTH_1="eu-north-1",e.EU_CENTRAL_1="eu-central-1",e.EU_CENTRAL_2="eu-central-2",e.CA_CENTRAL_1="ca-central-1",e.AP_SOUTH_1="ap-south-1",e.SA_EAST_1="sa-east-1",e))(L||{});function O({selectedRegion:e,setSelectedRegion:t}){let s=(0,i.wA)(),a=(0,k.Um)(),r=e=>{switch(e){case"us-east-1":return(0,g.t)("figmake.settings.create_project_modal.region.us_east_1");case"us-east-2":return(0,g.t)("figmake.settings.create_project_modal.region.us_east_2");case"us-west-1":return(0,g.t)("figmake.settings.create_project_modal.region.us_west_1");case"ap-southeast-1":return(0,g.t)("figmake.settings.create_project_modal.region.ap_southeast_1");case"ap-northeast-1":return(0,g.t)("figmake.settings.create_project_modal.region.ap_northeast_1");case"ap-northeast-2":return(0,g.t)("figmake.settings.create_project_modal.region.ap_northeast_2");case"ap-southeast-2":return(0,g.t)("figmake.settings.create_project_modal.region.ap_southeast_2");case"eu-west-1":return(0,g.t)("figmake.settings.create_project_modal.region.eu_west_1");case"eu-west-2":return(0,g.t)("figmake.settings.create_project_modal.region.eu_west_2");case"eu-west-3":return(0,g.t)("figmake.settings.create_project_modal.region.eu_west_3");case"eu-north-1":return(0,g.t)("figmake.settings.create_project_modal.region.eu_north_1");case"eu-central-1":return(0,g.t)("figmake.settings.create_project_modal.region.eu_central_1");case"eu-central-2":return(0,g.t)("figmake.settings.create_project_modal.region.eu_central_2");case"ca-central-1":return(0,g.t)("figmake.settings.create_project_modal.region.ca_central_1");case"ap-south-1":return(0,g.t)("figmake.settings.create_project_modal.region.ap_south_1");case"sa-east-1":return(0,g.t)("figmake.settings.create_project_modal.region.sa_east_1");default:throw Error("Unknown region")}};return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1v2ro7d",children:[(0,n.jsx)("label",{id:"supabase-project-database-region-select",className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:(0,g.t)("figmake.settings.create_project_modal.region.label")}),(0,n.jsx)(w.l6,{ariaLabelledBy:"supabase-project-database-region-select",inputClassName:f.Ay.classNames(P.select),id:"supabase-project-database-region-select",property:e,formatter:{format:r},onChange:t,dispatch:s,dropdownShown:a,children:Object.values(L).map(e=>(0,n.jsx)(w.c$,{value:e,children:r(e)},e))})]})}let P={select:{kZKoxP:"x1kowl60",kC7eKd:"x6sinrp",ku1ltF:null,kHypHr:null,kWkggS:null,kKwaWg:null,kl9DO0:null,k1YJky:null,kDwdnV:null,kAiEkY:null,kz484i:null,kgSjnq:null,$$css:!0}},R=(0,C.Ju)(function(e){let[t,s]=(0,a.useState)(!1),i=r.hS({...e,preventUserClose:t}),d=(0,v.q5)(),[u,x]=(0,a.useState)(d?.name||""),[m,p]=(0,a.useState)(""),[h,f]=(0,a.useState)(),[_,y]=(0,a.useState)("us-east-1"),[k,C]=(0,a.useState)(!1),[w,L]=(0,a.useState)(!0),[P,R]=(0,a.useState)(!1),D=(0,N.S)(),{toolCallId:F,toolName:q,onClose:G}=e,U=(0,a.useCallback)(()=>{C(!1),s(!1),R(!1),F&&q&&D({toolCallId:F,toolName:q,toolResult:{success:!0,message:"Connected to Supabase."}}),G()},[F,q,D,G]);!function(e,t,{intervalMsBetweenAttempts:s=2e3,enabled:n=!1,maxAttempts:i=5}={}){let r=(0,a.useRef)(!1);(0,a.useEffect)(()=>{if(!n||r.current)return;let a=!1;r.current=!0;let l=0,o=e=>new Promise(t=>setTimeout(t,e));return(async()=>{for(;!a&&l<i;){l++;try{if(await e()){t();break}}catch(e){console.error(e)}finally{await o(s)}}})(),()=>{a=!0,r.current=!1}},[n,s,e,i,t])}((0,a.useCallback)(async()=>{if(!d)return!1;let{connectedProject:e}=await b.M4.fetch((0,S.TT)({fileKey:d.key}),{policy:"networkOnly"});return!!e?.public_anon_key},[d]),U,{intervalMsBetweenAttempts:2e3,enabled:P}),(0,a.useEffect)(()=>{u.length>0&&m.length>0?L(!1):L(!0),m.length>=4&&f(void 0)},[u,m]);let K=async()=>{if(!d)return;if(m.length<4){f("dbPassTooShort");return}s(!0),C(!0);let t=await j.R.createProject({fileKey:d.key,projectName:u,dbPass:m,region:_}).then(e=>{let{id:t,organization_id:s,name:n,region:a,created_at:i,status:r}=e.data.meta;return{id:t,organization_id:s,name:n,region:a,created_at:i,status:r}}).catch(e=>{(0,A.YH)(e)});if(!t||!await j.R.connectFile({fileKey:d.key,supabaseProjectId:t.id,supabaseOrgId:t.organization_id}).catch(e=>{(0,A.AW)(e)})){C(!1);return}(0,E.uF)(e.trackingContext||{persistentEntityId:"",clientLifecycleId:""},e.source,d.key,"new"),R(!0)},H="dbPassTooShort"===h?(0,g.tx)("figmake.settings.create_project_modal.db_pass.too_short"):(0,g.tx)("figmake.settings.create_project_modal.db_pass.context",{learnMoreLink:(0,n.jsx)("a",{target:"_blank",href:I.kS,children:(0,g.t)("general.learn_more")})});return(0,n.jsx)(l.bL,{manager:i,width:386,children:(0,n.jsxs)(o.Rq,{onSubmit:K,children:[(0,n.jsx)(o.Y9,{children:(0,n.jsx)(o.hE,{children:(0,g.t)("figmake.settings.create_project_modal.title")})}),(0,n.jsx)(o.nB,{scrolling:"manual",children:(0,n.jsxs)("div",{className:"x1vvogim xnjsko4 x78zum5 xdt5ytf x1c1vhfx",children:[(0,n.jsx)(M,{value:u,setValue:x,disabled:k}),(0,n.jsx)(O,{selectedRegion:_,setSelectedRegion:y}),(0,n.jsx)(z,{value:m,setValue:p,helperText:H,disabled:k})]})}),(0,n.jsx)(o.wi,{children:(0,n.jsxs)(o.jk,{className:"x78zum5 x1q0g3np x13a6bvl x167g77z x1xn8qrt xdqyycr xh8yej3 x9f619",children:[k&&(0,n.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,g.t)("figmake.supabase.creating_project.subtitle")}),(0,n.jsx)(c.$n,{variant:"secondary",onClick:e.onClose,children:(0,g.t)("figmake.settings.create_project_modal.button.cancel")}),k?(0,n.jsx)(T.lV,{variant:"primary",children:(0,g.t)("figmake.settings.create_project_modal.button.submit.loading")}):(0,n.jsx)(c.$n,{variant:"primary",type:"submit",disabled:w,children:(0,g.t)("figmake.settings.create_project_modal.button.submit")})]})})]})})},"CreateProjectModal");function D({toolCallId:e,toolName:t,trackingContext:s,source:n}){let a=(0,i.wA)();return()=>a((0,y.to)({type:R,data:{toolCallId:e,toolName:t,trackingContext:s,source:n},showModalsBeneath:!0}))}},306809:(e,t,s)=>{s.d(t,{AW:()=>u,EQ:()=>p,YH:()=>o,ZH:()=>c,fQ:()=>d,lN:()=>m,oT:()=>x,wH:()=>l});var n=s(295870),a=s(129416),i=s(838213),r=s(674738);function l(e){(0,i.r)(),(0,a.$D)(n.e.MAKE,e)}function o(e){if(e.message.match(/^(.*?)Project with name (.+?) already exists in your organization\.$/)){(0,r.ym)();return}if(e.message.match(/^(.*)maximum limits for the number of active free projects(.*)$/)){(0,r.ZK)();return}(0,r.u)(),l(e)}function c(e){(0,r.it)(),l(e)}function d(e){l(e)}function u(e){(0,r.jx)(),l(e)}function x(e){(0,r.n9)(),l(e)}function m(e){(0,r.m8)(),l(e)}class p extends Error{constructor(){super("No index.tsx file found in the code files"),this.name="NoIndexFileError"}}},585109:(e,t,s)=>{s.d(t,{cG:()=>P,jc:()=>z,lV:()=>L,ls:()=>O,Gt:()=>I,p1:()=>A,mj:()=>N});var n=s(239976),a=s(942356),i=s(881619),r=s(379141);s(323264);var l=s(259714),o=s(863412),c=s(585066),d=s(363337),u=s(105652),x=s(20002),m=s(295870),p=s(796557),h=s(4245),g=s(312884),f=s(129416),_=s(964731),y=s(223487),k=s(236410),v=s(463838),b=s(469543),j=s(299823);function C({connectedOrg:e}){let t=(0,y.tS)()||"",s=(0,x.wA)(),a=(0,_.BK)("CONNECTED_ORG_MORE_MENU"),i=u.useCallback(async()=>{try{await v.R.deauthorizeFile({fileKey:t})}catch(e){(0,f.$D)(m.e.MAKE,e)}},[t]),l=u.useMemo(()=>[{displayText:(0,r.t)("figmake.settings.connected_project.dropdown.manage_organization"),callback:()=>{(0,g.FJ)((0,j.n1)(e.id))}},{displayText:"",separator:!0},{displayText:(0,r.t)("figmake.settings.connected_org.dropdown.disconnect"),callback:()=>{i()}}],[e,i]),o=u.useRef(null),c=o.current?.getBoundingClientRect();return c||(a.showing&&(0,f.$D)(m.e.AI_PRODUCTIVITY,Error("FigMake connected project view: dropdownBoundingRect is null")),c=new DOMRect(0,0,0,0)),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.d,{"aria-expanded":a.showing,ref:o,"aria-label":(0,r.t)("figmake.settings.connected_org.dropdown.label"),onClick:()=>a.toggle(),htmlAttributes:{"data-tooltip-type":k.Ib.TEXT,"data-tooltip":(0,r.t)("figmake.settings.connected_org.dropdown.label")},children:(0,n.jsx)(h.J,{})}),a.showing&&(0,n.jsx)(b.j,{dispatch:s,parentRect:c,onSelectItem:e=>{e.callback&&e.callback()},showPoint:!1,items:l,lean:"left"})]})}var w=s(997129),E=s(751526);function N({inactive:e,variant:t="connected_project"}){return(0,n.jsx)("div",{...{0:{className:"x78zum5 xl56j7k x6s0dn4 x1sxf85j x1606gwu x100vrsf x1vqgdyp xmkeg23 x1y0btm7 x7z60cl"},2:{className:"x78zum5 xl56j7k x6s0dn4 x1sxf85j x1v8gsql x100vrsf x1vqgdyp xmkeg23 x1y0btm7 x7z60cl"},1:{className:"x78zum5 xl56j7k x6s0dn4 x1sxf85j x1606gwu x1td3qas x10w6t97"},3:{className:"x78zum5 xl56j7k x6s0dn4 x1sxf85j x1v8gsql x1td3qas x10w6t97"}}[!!e<<1|!("existing_project"!==t)<<0],children:(0,n.jsx)(l.B,{svg:E.A,useOriginalSrcFills_DEPRECATED:!0,svgWidth:"16px",svgHeight:"16px",...{0:{},1:{className:"xy712c7"}}[!!e<<0]})})}function S(){let{organization:e}=(0,w.mS)();return(0,n.jsx)("div",{className:"x1tamke2 xh8yej3 x9f619",children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 xh8yej3",children:[(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1nhvcw1 xdpxx8g",children:[e&&(0,n.jsx)(o.G,{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly x256u9z xuxw1ft xb3r6kr xlyipyv",text:e?.name}),(0,n.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,r.t)("figmake.settings.project.org_info.title")})]}),e&&(0,n.jsx)(C,{connectedOrg:e})]})})}function T(){return(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1qughib x1cy8zhl xdpxx8g x1y8v6su x1tamke2 xh8yej3 x9f619",children:[(0,n.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:(0,r.t)("figmake.settings.project.header.title")}),(0,n.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,r.t)("figmake.settings.project.header.subtitle")})]})}function I({showDefaultHeader:e=!1,children:t}){return(0,n.jsxs)(n.Fragment,{children:[e?(0,n.jsx)(T,{}):(0,n.jsx)(S,{}),(0,n.jsx)(P,{}),t]})}function A({badge:e,actions:t,inactive:s,header:a,subheader:i}){return(0,n.jsx)("div",{className:"x1tamke2",children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 xh8yej3",children:[(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x1nhvcw1 x6s0dn4 x1v2ro7d",children:[(0,n.jsx)(N,{inactive:s}),(0,n.jsxs)("div",{className:"x78zum5 xdt5ytf x1nhvcw1 x1cy8zhl",children:[(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,n.jsx)(o.G,{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly x1racy4e xuxw1ft xb3r6kr xlyipyv",text:a}),e]}),i||(0,n.jsx)(M,{})]})]}),(0,n.jsx)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:t})]})})}function M(){return(0,n.jsx)(o.G,{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9 x256u9z xuxw1ft xb3r6kr xlyipyv",text:(0,r.t)("figmake.settings.project.project_info.title")})}function z({url:e,linkText:t}){return(0,n.jsxs)("a",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 x1wt4b31 xebhuq6",target:"_blank",href:e,children:[(0,n.jsx)(i.G,{}),(0,n.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up",children:t})]})}function L({variant:e,children:t}){return(0,n.jsx)(a.$n,{variant:e,disabled:!0,children:(0,n.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4",children:[(0,n.jsx)(c.k,{}),(0,n.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up",children:t})]})})}function O({size:e}){let t=(0,w.RK)();return t?(0,n.jsx)(d.H8,{user:t,size:e}):null}function P(){return(0,n.jsx)("div",{className:"x178xt8z x13fuv20 x16ufvko xh8yej3"})}},674738:(e,t,s)=>{s.d(t,{A9:()=>_,SR:()=>y,ZK:()=>u,it:()=>h,jx:()=>m,l4:()=>g,m8:()=>k,n9:()=>p,rq:()=>f,u:()=>x,ym:()=>d});var n=s(379141),a=s(312884),i=s(102462),r=s(888903),l=s(287736),o=s(299823),c=(e=>(e.PROJECT_NAME_TAKEN="supabase-project-name-taken",e.ACTIVE_FREE_PROJECT_LIMIT="supabase-active-free-project-limit",e.PROJECT_CREATION_UNSUCCESSFUL="supabase-project-creation-unsuccessful",e.PROJECT_CONNECTION_UNSUCCESSFUL="supabase-project-connection-unsuccessful",e.PROJECT_RESTORE_UNSUCCESSFUL="supabase-project-restore-unsuccessful",e.PAUSING_PROJECT_UNSUCCESSFUL="supabase-pausing-project-unsuccessful",e.PAUSING_PROJECT_SUCCESSFUL="supabase-pausing-project-successful",e.DEPLOY_UNSUCCESSFUL="supabase-deploy-unsuccessful",e.DEPLOY_SUCCESSFUL="supabase-deploy-successful",e.NOTHING_TO_DEPLOY="supabase-nothing-to-deploy",e.AUTHENTICATION_UNSUCCESSFUL="supabase-authentication-unsuccessful",e))(c||{});function d(){i.D.dispatch(r.F.enqueue({message:(0,n.t)("figmake.supabase.errors.project_name_taken"),type:"supabase-project-name-taken",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function u(){i.D.dispatch(r.F.enqueue({message:(0,n.t)("figmake.supabase.errors.project_creation_unsuccessful.need_to_pause"),type:"supabase-active-free-project-limit",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0,button:{text:(0,n.t)("figmake.supabase.errors.project_creation_unsuccessful.need_to_pause.button"),action:()=>{(0,a.FJ)(o.v7,"_blank")}}}))}function x(){i.D.dispatch(r.F.enqueue({message:(0,n.t)("figmake.supabase.errors.project_creation_unsuccessful"),type:"supabase-project-creation-unsuccessful",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function m(){i.D.dispatch(r.F.enqueue({message:(0,n.t)("figmake.supabase.errors.project_connection_unsuccessful"),type:"supabase-project-connection-unsuccessful",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function p(){i.D.dispatch(r.F.enqueue({message:(0,n.t)("figmake.supabase.errors.project_restore_unsuccessful"),type:"supabase-project-restore-unsuccessful",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function h(){i.D.dispatch(r.F.enqueue({message:(0,n.t)("figmake.supabase.errors.pausing_project_unsuccessful"),type:"supabase-pausing-project-unsuccessful",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function g(){i.D.dispatch(r.F.enqueue({message:(0,n.t)("figmake.supabase.errors.pausing_project_successful"),type:"supabase-pausing-project-successful",icon:l.zX.CHECK,timeoutOverride:3e3}))}function f(){i.D.dispatch(r.F.enqueue({message:(0,n.t)("figmake.supabase.errors.deploy_unsuccessful"),type:"supabase-deploy-unsuccessful",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function _(){i.D.dispatch(r.F.enqueue({message:(0,n.t)("figmake.supabase.errors.deploy_successful"),type:"supabase-deploy-successful",icon:l.zX.CHECK,timeoutOverride:3e3}))}function y(){i.D.dispatch(r.F.enqueue({message:(0,n.t)("figmake.supabase.errors.nothing_to_deploy"),type:"supabase-nothing-to-deploy",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function k(){i.D.dispatch(r.F.enqueue({message:(0,n.t)("figmake.supabase.errors.authentication_unsuccessful"),type:"supabase-authentication-unsuccessful",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}},844552:(e,t,s)=>{s.d(t,{A:()=>g});var n=s(846779),a=s(445019),i=s(74372),r=s(223487),l=s(538349),o=s(463838),c=s(660259),d=s(379196),u=s(696002),x=s(306809),m=s(947700),p=s(924278),h=s(674738);function g(){let e=(0,a.Xr)(c.p7),t=(0,u.cf)(),s=(0,d.vD)(t?.guid??null),g=(0,d.DM)(s),f=(0,r.tS)(),_=(0,a.Xr)(c.Xl),y=(0,a.Xr)(c.GV),k=(0,a.Xr)(p.GA),[,v]=(0,p.PM)();return async t=>{let{showVisualBells:s}=t;if(!f){console.error("No open file key found");return}try{e(c.Ut.DEPLOYING);let t=(0,n.$d)(),a={};for(let[e,s]of Object.entries(t))if(e.includes("/supabase/functions/server/")){let t=e.split("/").pop(),n=s.sourceCode;t&&n&&(a[t]=n)}if(!a["index.tsx"])throw new x.EQ;let i=await o.R.deployEdgeFunction({fileKey:f,files:a});k(i.data.meta.version),(0,p.ZO)(),setTimeout(()=>{l.M4.fetch((0,m.gZ)({fileKey:f,functionName:"make-server"}),{policy:"networkOnly"})},5e3),g(),s&&(0,h.A9)()}catch(t){if(t instanceof x.EQ){s&&(0,h.SR)();return}s&&(0,h.rq)(),(0,x.wH)(t);let e={id:(0,i.g)(),event_message:`Error while deploying: ${t instanceof Error?t.message:String(t)}`,timestamp:Date.now().toString(),level:"error"};v(t=>[...t,e])}finally{e(c.Ut.INIT),_(!1),y(!1)}}}},786164:(e,t,s)=>{s.d(t,{m:()=>_});var n=s(291061),a=s(607696),i=s(295870),r=s(854225),l=s(798913),o=s(270450),c=s(274574),d=s(7995),u=s(490894),x=s(772293),m=s(223487),p=s(605985),h=s(515066),g=s(696002),f=s(395823);function _({chatController:e}){let t=(0,m.q5)(),s=t?.key,_=(0,p.iZ)(),y=t?.trackTags,k=y?.isDuplicatedFromSupabaseConnectedFile,v=k?.status==="loaded"&&k.data,b=(0,g.hk)(),j=e.isInitialized?e.getNodeChatMessages():void 0;(0,f.p3)()&&s&&b&&j&&(async()=>{let t=await (0,u.qV)(s),m=j.some(e=>{if(e.type!==r.K$p.SYSTEM_MESSAGE)return!1;let s=(0,a.U1)(e,!!(0,o.kc)().make_chat_contents_cache);return s?.type==="duplicated_file"&&s.fileKeyHash===t});if(v&&!m&&t&&_){let a=d.J.startUserFlow({name:"make_duplicated_file",team:i.e.MAKE,priority:n.bx.P1}),r=(0,h.IO)(_,t),o=await (0,c.cK)({fileKey:s,threadId:e.chatSdkState?.threadId}),u=l.Hq.ai("add-duplicated-file-system-message",()=>(e.appendMessages([r],o),x.Y5.commit()));await (0,c.Ui)({commitContext:"duplicated_file",nodeChatMessages:[r],chatController:e,fileKey:s,syncResult:o,fullscreenCommitSeqNum:u,userFlow:a}),a.end()}})()}},350339:(e,t,s)=>{s.d(t,{M:()=>r});var n=s(159773),a=s(105652),i=s(239976);let r=(0,a.memo)(function(e){return(0,n.O)()?(0,i.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,i.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M7.293 2.293a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1 0 1.414l-1.146 1.147a.5.5 0 1 1-.707-.708L12 7 8 3 4 7l1.146 1.146a.5.5 0 1 1-.707.708L3.293 7.707a1 1 0 0 1 0-1.414zm-2.147 8.353a.501.501 0 0 0 .708.708L7.5 9.707V13.5a.5.5 0 0 0 1 0V9.707l1.646 1.647a.5.5 0 1 0 .708-.708l-2.5-2.5a.5.5 0 0 0-.708 0z",clipRule:"evenodd"})}):(0,i.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,i.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M7.854 2.146a.5.5 0 0 0-.708 0l-5 5a.5.5 0 0 0 0 .708l1.5 1.5a.5.5 0 1 0 .708-.707L3.207 7.5 7.5 3.207 11.793 7.5l-1.147 1.147a.5.5 0 0 0 .707.707l1.5-1.5a.5.5 0 0 0 0-.708zm-3.208 8.5a.5.5 0 0 0 .707.708L7 9.707V13.5a.5.5 0 0 0 1 0V9.707l1.646 1.647a.5.5 0 0 0 .707-.707l-2.5-2.5a.5.5 0 0 0-.707 0z",clipRule:"evenodd"})})})},881619:(e,t,s)=>{s.d(t,{G:()=>i});var n=s(105652),a=s(239976);let i=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M11.5 13a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .5-.5h2a.5.5 0 0 0 0-1h-2A1.5 1.5 0 0 0 3 4.5v7A1.5 1.5 0 0 0 4.5 13zM7.646 8.354a.5.5 0 0 0 .708 0L12 4.707V7.5a.5.5 0 0 0 1 0v-4a.5.5 0 0 0-.5-.5h-4a.5.5 0 0 0 0 1h2.793L7.646 7.646a.5.5 0 0 0 0 .708"})})})},400394:(e,t,s)=>{s.d(t,{_:()=>i});var n=s(105652),a=s(239976);let i=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,"data-fpl-icon-size":"16",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color-3, var(--color-icon-tertiary))",fillRule:"evenodd",d:"M8.5 2.568c0-.295.252-.529.543-.478q.521.092 1.009.27c.277.1.379.43.231.685a.544.544 0 0 1-.652.227 5 5 0 0 0-.68-.181.544.544 0 0 1-.451-.523m-4.953 8.58a.54.54 0 0 1 .677.13q.231.266.498.498c.196.17.259.453.13.677-.148.256-.484.332-.71.142a6 6 0 0 1-.737-.737c-.19-.226-.114-.562.142-.71m2.822 1.58a.544.544 0 0 0-.652.227.47.47 0 0 0 .231.685q.487.178 1.01.27a.47.47 0 0 0 .542-.478.544.544 0 0 0-.452-.522 5 5 0 0 1-.68-.182m5.49-9.323a.47.47 0 0 0-.71.142.544.544 0 0 0 .129.677q.266.231.498.498c.17.196.453.259.677.13.256-.148.332-.484.142-.71a6 6 0 0 0-.737-.737m1.096 6.878a.47.47 0 0 0 .685-.231q.178-.487.27-1.01a.47.47 0 0 0-.478-.542.544.544 0 0 0-.523.452q-.066.35-.181.679a.544.544 0 0 0 .227.652m-.36 1.575c.19-.226.114-.562-.142-.71a.544.544 0 0 0-.677.13q-.231.266-.498.498a.54.54 0 0 0-.13.677c.148.256.484.332.71.142q.4-.336.737-.737M10.05 13.64c.277-.1.379-.43.231-.685a.544.544 0 0 0-.652-.227q-.33.114-.68.182a.544.544 0 0 0-.451.522c0 .295.252.529.543.478q.522-.092 1.009-.27M5.717 3.045c.13.225.407.312.652.227q.33-.114.68-.181a.544.544 0 0 0 .45-.523c0-.295-.252-.529-.542-.478q-.522.092-1.009.27c-.277.1-.379.43-.231.685m-1.575.36c.226-.19.562-.114.71.142a.54.54 0 0 1-.13.677 5 5 0 0 0-.498.498.54.54 0 0 1-.677.13c-.256-.148-.332-.484-.142-.71q.336-.4.737-.737M3.045 5.717a.47.47 0 0 0-.685.231 6 6 0 0 0-.27 1.01.47.47 0 0 0 .478.542c.26 0 .473-.197.522-.452q.068-.35.182-.679a.544.544 0 0 0-.227-.652M2.568 8.5c-.295 0-.529.252-.478.543q.092.522.27 1.009c.1.277.43.379.685.231a.544.544 0 0 0 .227-.652 5 5 0 0 1-.182-.68.544.544 0 0 0-.522-.451m10.864-1a.544.544 0 0 1-.523-.452 5 5 0 0 0-.181-.679.544.544 0 0 1 .227-.652.47.47 0 0 1 .685.231q.178.487.27 1.01a.47.47 0 0 1-.478.542",clipRule:"evenodd"})})})},727029:(e,t,s)=>{s.d(t,{Z:()=>i});var n=s(105652),a=s(239976);let i=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24L",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M11.293 11.293a1 1 0 0 1 1.059-.23l8 3 .146.07a1 1 0 0 1-.102 1.785l-.154.052-3.418.854-.854 3.418a1 1 0 0 1-1.906.11l-3-8a1 1 0 0 1 .23-1.06m-2.11 5.968a.49.49 0 0 1 .642-.25c.248.103.385.386.282.634L9.16 19.93a.5.5 0 0 1-.923-.384zM15 20l1-4 4-1-8-3zm-8.782-6.242c.248-.103.53.032.634.28a.49.49 0 0 1-.25.643l-2.282.946a.5.5 0 0 1-.382-.924zm-2.552-5.25a.5.5 0 0 1 .654-.27l2.279.944a.49.49 0 0 1 .25.643c-.104.248-.386.383-.634.28l-2.278-.943a.5.5 0 0 1-.27-.653m15.88-.27a.5.5 0 0 1 .382.924l-2.28.944c-.248.103-.53-.033-.634-.28a.49.49 0 0 1 .25-.644zM8.508 3.668a.5.5 0 0 1 .653.27l.943 2.277c.102.248-.033.53-.28.633a.49.49 0 0 1-.643-.25L8.238 4.32a.5.5 0 0 1 .271-.653m6.193.27a.5.5 0 0 1 .924.382l-.944 2.278a.49.49 0 0 1-.643.25c-.248-.103-.383-.385-.28-.633z"})})})},670245:(e,t,s)=>{s.d(t,{J:()=>i});var n=s(105652),a=s(239976);let i=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24L",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M18.5 8A1.5 1.5 0 0 1 20 9.5v9a1.5 1.5 0 0 1-1.5 1.5h-4a1.5 1.5 0 0 1-1.5-1.5v-9A1.5 1.5 0 0 1 14.5 8zm-4 1a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5zm3.153-4.992A1.5 1.5 0 0 1 19 5.5v1.047c0 .26-.24.453-.5.453a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 0-.5-.5h-12a.5.5 0 0 0-.5.5V8h6.715c.323 0 .526.38.42.687-.06.176-.219.313-.405.313H5v7.5a.5.5 0 0 0 .5.5h6a.5.5 0 0 1 0 1h-6a1.5 1.5 0 0 1-1.492-1.347L4 16.5v-11A1.5 1.5 0 0 1 5.5 4h12zM16.5 16a.5.5 0 1 1 0 1 .5.5 0 0 1 0-1"})})})},670664:(e,t,s)=>{s.d(t,{t:()=>i});var n=s(105652),a=s(239976);let i=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M11.44 6.662a2.026 2.026 0 0 1 2.996 0 2.35 2.35 0 0 1 .596 1.919 2.03 2.03 0 0 1 1.762.597l.038.04.026.027.038.042c.788.885.776 2.286-.038 3.154l-4.336 4.624a.16.16 0 0 0 0 .213l.89.95a.475.475 0 0 1 0 .64.406.406 0 0 1-.599 0l-.89-.95a1.105 1.105 0 0 1 0-1.491l4.335-4.625a1.42 1.42 0 0 0 0-1.918l-.024-.027-.024-.024a1.215 1.215 0 0 0-1.774.024l-3.62 3.863-.017.015a.405.405 0 0 1-.583-.015.474.474 0 0 1 0-.64l3.62-3.861a1.42 1.42 0 0 0 0-1.918 1.216 1.216 0 0 0-1.797 0l-4.794 5.113-.016.017a.405.405 0 0 1-.583-.017.473.473 0 0 1 0-.639zm1.198 1.277a.406.406 0 0 1 .6 0 .474.474 0 0 1 0 .64L9.692 12.36a1.42 1.42 0 0 0 0 1.918c.496.53 1.301.53 1.798 0l3.545-3.782a.406.406 0 0 1 .6 0 .474.474 0 0 1 0 .64l-3.547 3.782a2.026 2.026 0 0 1-2.957.04l-.039-.04c-.827-.882-.827-2.314 0-3.196z"})})})},899457:(e,t,s)=>{s.d(t,{T:()=>i});var n=s(105652),a=s(239976);let i=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M10.003 7.375A5.5 5.5 0 0 1 16.61 9.5H14a.5.5 0 0 0 0 1h3.5a.5.5 0 0 0 .5-.5V6.5a.5.5 0 0 0-1 0v1.847a6.5 6.5 0 1 0-.128 8.456.5.5 0 1 0-.75-.662 5.5 5.5 0 1 1-6.119-8.766",clipRule:"evenodd"})})})},513466:(e,t,s)=>{s.d(t,{X:()=>i});var n=s(105652),a=s(239976);let i=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24L",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M4.5 16a.5.5 0 0 1 .5.5V18a1 1 0 0 0 1 1h1.5a.5.5 0 0 1 0 1H6a2 2 0 0 1-2-2v-1.5a.5.5 0 0 1 .5-.5m8.593-1.184c-.425-1.081.643-2.147 1.723-1.723l4.342 1.705h.001c1.17.46 1.105 2.137-.095 2.508l-1.343.414-.413 1.343h-.001c-.36 1.165-1.944 1.26-2.461.202l-.047-.107-1.706-4.34zm1.358-.793a.33.33 0 0 0-.428.428l1.707 4.341a.33.33 0 0 0 .622-.023l.569-1.85 1.849-.568a.33.33 0 0 0 .023-.622zm1.651-7.018A1 1 0 0 1 17 8v2l-.005.102a1 1 0 0 1-.893.893L16 11h-5v5l-.005.102A1 1 0 0 1 10 17H8a1 1 0 0 1-.995-.898L7 16V8a1 1 0 0 1 1-1h8zM8 16h2v-1h-.5a.5.5 0 0 1 0-1h.5v-1h-.5a.5.5 0 0 1 0-1h.5v-1H8zm0-6h2V8H8zm3 0h1v-.5a.5.5 0 0 1 1 0v.5h1v-.5a.5.5 0 0 1 1 0v.5h1V8h-5zM7.5 4a.5.5 0 0 1 0 1H6a1 1 0 0 0-1 1v1.5a.5.5 0 0 1-1 0V6a2 2 0 0 1 2-2zM18 4a2 2 0 0 1 2 2v1.5a.5.5 0 0 1-1 0V6a1 1 0 0 0-1-1h-1.5a.5.5 0 0 1 0-1z"})})})},349051:(e,t,s)=>{s.d(t,{I:()=>i});var n=s(105652),a=s(239976);let i=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,"data-fpl-icon-size":"24",children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M9 6.804a6 6 0 1 1-2.98 5.694.47.47 0 0 1 .48-.499c.276 0 .498.225.525.5A5 5 0 1 0 8 9h1.5a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5v-3a.5.5 0 0 1 1 0v2.187a6 6 0 0 1 2-1.883m3 2.195a.5.5 0 0 1 .5.5v2.293l1.354 1.354a.5.5 0 0 1-.707.706l-1.5-1.498-.063-.077A.5.5 0 0 1 11.5 12V9.499a.5.5 0 0 1 .5-.5"})})})}}]);

//# debugId=d1f4f461-3eac-5414-96a7-2689bfaf0e02

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/f2419b5f6dc66782c9f9abdf8f429d5d59446581/1976-383bcb9aa45c47c6.min.js.map